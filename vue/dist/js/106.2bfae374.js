"use strict";(self["webpackChunkvue"]=self["webpackChunkvue"]||[]).push([[106],{1106:function(t,e,n){n.r(e),n.d(e,{default:function(){return xlt}});n(560),n(88),n(8858),n(1318),n(3228),n(4224),n(1121),n(7133);var o=n(6369),i=n(258),r=n(5107),s=n(4025),a=n(6930);t=n.hmd(t);var l=Object.defineProperty,h=Object.defineProperties,c=Object.getOwnPropertyDescriptors,u=Object.getOwnPropertySymbols,d=Object.prototype.hasOwnProperty,g=Object.prototype.propertyIsEnumerable,f=Math.pow,m=(t,e,n)=>e in t?l(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,p=(t,e)=>{for(var n in e||(e={}))d.call(e,n)&&m(t,n,e[n]);if(u)for(var n of u(e))g.call(e,n)&&m(t,n,e[n]);return t},w=(t,e)=>h(t,c(e)),A=(t,e)=>{var n={};for(var o in t)d.call(t,o)&&e.indexOf(o)<0&&(n[o]=t[o]);if(null!=t&&u)for(var o of u(t))e.indexOf(o)<0&&g.call(t,o)&&(n[o]=t[o]);return n},v=function(t){return t&&t.Math===Math&&t},y=v("object"==typeof globalThis&&globalThis)||v("object"==typeof window&&window)||v("object"==typeof self&&self)||v("object"==typeof i.c&&i.c)||v("object"==typeof i.c&&i.c)||function(){return this}()||Function("return this")(),C={},b=function(t){try{return!!t()}catch(e){return!0}},S=b,E=!S((function(){return 7!==Object.defineProperty({},1,{get:function(){return 7}})[1]})),R=b,M=!R((function(){var t=function(){}.bind();return"function"!=typeof t||t.hasOwnProperty("prototype")})),T=M,k=Function.prototype.call,x=T?k.bind(k):function(){return k.apply(k,arguments)},I={},O={}.propertyIsEnumerable,H=Object.getOwnPropertyDescriptor,D=H&&!O.call({1:2},1);I.f=D?function(t){var e=H(this,t);return!!e&&e.enumerable}:O;var N,P,_=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}},B=M,L=Function.prototype,V=L.call,W=B&&L.bind.bind(V,V),F=B?W:function(t){return function(){return V.apply(t,arguments)}},j=F,U=j({}.toString),Y=j("".slice),z=function(t){return Y(U(t),8,-1)},G=F,Q=b,K=z,X=Object,q=G("".split),Z=Q((function(){return!X("z").propertyIsEnumerable(0)}))?function(t){return"String"===K(t)?q(t,""):X(t)}:X,J=function(t){return null==t},$=J,tt=TypeError,et=function(t){if($(t))throw new tt("Can't call method on "+t);return t},nt=Z,ot=et,it=function(t){return nt(ot(t))},rt="object"==typeof document&&document.all,st="undefined"==typeof rt&&void 0!==rt?function(t){return"function"==typeof t||t===rt}:function(t){return"function"==typeof t},at=st,lt=function(t){return"object"==typeof t?null!==t:at(t)},ht=y,ct=st,ut=function(t){return ct(t)?t:void 0},dt=function(t,e){return arguments.length<2?ut(ht[t]):ht[t]&&ht[t][e]},gt=F,ft=gt({}.isPrototypeOf),mt="undefined"!=typeof navigator&&String(navigator.userAgent)||"",pt=y,wt=mt,At=pt.process,vt=pt.Deno,yt=At&&At.versions||vt&&vt.version,Ct=yt&&yt.v8;Ct&&(N=Ct.split("."),P=N[0]>0&&N[0]<4?1:+(N[0]+N[1])),!P&&wt&&(N=wt.match(/Edge\/(\d+)/),(!N||N[1]>=74)&&(N=wt.match(/Chrome\/(\d+)/),N&&(P=+N[1])));var bt=P,St=bt,Et=b,Rt=y,Mt=Rt.String,Tt=!!Object.getOwnPropertySymbols&&!Et((function(){var t=Symbol("symbol detection");return!Mt(t)||!(Object(t)instanceof Symbol)||!Symbol.sham&&St&&St<41})),kt=Tt,xt=kt&&!Symbol.sham&&"symbol"==typeof Symbol.iterator,It=dt,Ot=st,Ht=ft,Dt=xt,Nt=Object,Pt=Dt?function(t){return"symbol"==typeof t}:function(t){var e=It("Symbol");return Ot(e)&&Ht(e.prototype,Nt(t))},_t=String,Bt=function(t){try{return _t(t)}catch(e){return"Object"}},Lt=st,Vt=Bt,Wt=TypeError,Ft=function(t){if(Lt(t))return t;throw new Wt(Vt(t)+" is not a function")},jt=Ft,Ut=J,Yt=function(t,e){var n=t[e];return Ut(n)?void 0:jt(n)},zt=x,Gt=st,Qt=lt,Kt=TypeError,Xt=function(t,e){var n,o;if("string"===e&&Gt(n=t.toString)&&!Qt(o=zt(n,t))||Gt(n=t.valueOf)&&!Qt(o=zt(n,t))||"string"!==e&&Gt(n=t.toString)&&!Qt(o=zt(n,t)))return o;throw new Kt("Can't convert object to primitive value")},qt={exports:{}},Zt=y,Jt=Object.defineProperty,$t=function(t,e){try{Jt(Zt,t,{value:e,configurable:!0,writable:!0})}catch(n){Zt[t]=e}return e},te=y,ee=$t,ne="__core-js_shared__",oe=te[ne]||ee(ne,{}),ie=oe,re=ie;(qt.exports=function(t,e){return re[t]||(re[t]=void 0!==e?e:{})})("versions",[]).push({version:"3.35.1",mode:"global",copyright:"Â© 2014-2024 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.35.1/LICENSE",source:"https://github.com/zloirock/core-js"});var se=qt.exports,ae=et,le=Object,he=function(t){return le(ae(t))},ce=F,ue=he,de=ce({}.hasOwnProperty),ge=Object.hasOwn||function(t,e){return de(ue(t),e)},fe=F,me=0,pe=Math.random(),we=fe(1..toString),Ae=function(t){return"Symbol("+(void 0===t?"":t)+")_"+we(++me+pe,36)},ve=y,ye=se,Ce=ge,be=Ae,Se=Tt,Ee=xt,Re=ve.Symbol,Me=ye("wks"),Te=Ee?Re.for||Re:Re&&Re.withoutSetter||be,ke=function(t){return Ce(Me,t)||(Me[t]=Se&&Ce(Re,t)?Re[t]:Te("Symbol."+t)),Me[t]},xe=x,Ie=lt,Oe=Pt,He=Yt,De=Xt,Ne=ke,Pe=TypeError,_e=Ne("toPrimitive"),Be=function(t,e){if(!Ie(t)||Oe(t))return t;var n,o=He(t,_e);if(o){if(void 0===e&&(e="default"),n=xe(o,t,e),!Ie(n)||Oe(n))return n;throw new Pe("Can't convert object to primitive value")}return void 0===e&&(e="number"),De(t,e)},Le=Be,Ve=Pt,We=function(t){var e=Le(t,"string");return Ve(e)?e:e+""},Fe=y,je=lt,Ue=Fe.document,Ye=je(Ue)&&je(Ue.createElement),ze=function(t){return Ye?Ue.createElement(t):{}},Ge=E,Qe=b,Ke=ze,Xe=!Ge&&!Qe((function(){return 7!==Object.defineProperty(Ke("div"),"a",{get:function(){return 7}}).a})),qe=E,Ze=x,Je=I,$e=_,tn=it,en=We,nn=ge,on=Xe,rn=Object.getOwnPropertyDescriptor;C.f=qe?rn:function(t,e){if(t=tn(t),e=en(e),on)try{return rn(t,e)}catch(n){}if(nn(t,e))return $e(!Ze(Je.f,t,e),t[e])};var sn={},an=E,ln=b,hn=an&&ln((function(){return 42!==Object.defineProperty((function(){}),"prototype",{value:42,writable:!1}).prototype})),cn=lt,un=String,dn=TypeError,gn=function(t){if(cn(t))return t;throw new dn(un(t)+" is not an object")},fn=E,mn=Xe,pn=hn,wn=gn,An=We,vn=TypeError,yn=Object.defineProperty,Cn=Object.getOwnPropertyDescriptor,bn="enumerable",Sn="configurable",En="writable";sn.f=fn?pn?function(t,e,n){if(wn(t),e=An(e),wn(n),"function"==typeof t&&"prototype"===e&&"value"in n&&En in n&&!n[En]){var o=Cn(t,e);o&&o[En]&&(t[e]=n.value,n={configurable:Sn in n?n[Sn]:o[Sn],enumerable:bn in n?n[bn]:o[bn],writable:!1})}return yn(t,e,n)}:yn:function(t,e,n){if(wn(t),e=An(e),wn(n),mn)try{return yn(t,e,n)}catch(o){}if("get"in n||"set"in n)throw new vn("Accessors not supported");return"value"in n&&(t[e]=n.value),t};var Rn=E,Mn=sn,Tn=_,kn=Rn?function(t,e,n){return Mn.f(t,e,Tn(1,n))}:function(t,e,n){return t[e]=n,t},xn={exports:{}},In=E,On=ge,Hn=Function.prototype,Dn=In&&Object.getOwnPropertyDescriptor,Nn=On(Hn,"name"),Pn=Nn&&"something"===function(){}.name,_n=Nn&&(!In||In&&Dn(Hn,"name").configurable),Bn={EXISTS:Nn,PROPER:Pn,CONFIGURABLE:_n},Ln=F,Vn=st,Wn=ie,Fn=Ln(Function.toString);Vn(Wn.inspectSource)||(Wn.inspectSource=function(t){return Fn(t)});var jn,Un,Yn,zn=Wn.inspectSource,Gn=y,Qn=st,Kn=Gn.WeakMap,Xn=Qn(Kn)&&/native code/.test(String(Kn)),qn=se,Zn=Ae,Jn=qn("keys"),$n=function(t){return Jn[t]||(Jn[t]=Zn(t))},to={},eo=Xn,no=y,oo=lt,io=kn,ro=ge,so=ie,ao=$n,lo=to,ho="Object already initialized",co=no.TypeError,uo=no.WeakMap,go=function(t){return Yn(t)?Un(t):jn(t,{})},fo=function(t){return function(e){var n;if(!oo(e)||(n=Un(e)).type!==t)throw new co("Incompatible receiver, "+t+" required");return n}};if(eo||so.state){var mo=so.state||(so.state=new uo);mo.get=mo.get,mo.has=mo.has,mo.set=mo.set,jn=function(t,e){if(mo.has(t))throw new co(ho);return e.facade=t,mo.set(t,e),e},Un=function(t){return mo.get(t)||{}},Yn=function(t){return mo.has(t)}}else{var po=ao("state");lo[po]=!0,jn=function(t,e){if(ro(t,po))throw new co(ho);return e.facade=t,io(t,po,e),e},Un=function(t){return ro(t,po)?t[po]:{}},Yn=function(t){return ro(t,po)}}var wo={set:jn,get:Un,has:Yn,enforce:go,getterFor:fo},Ao=F,vo=b,yo=st,Co=ge,bo=E,So=Bn.CONFIGURABLE,Eo=zn,Ro=wo,Mo=Ro.enforce,To=Ro.get,ko=String,xo=Object.defineProperty,Io=Ao("".slice),Oo=Ao("".replace),Ho=Ao([].join),Do=bo&&!vo((function(){return 8!==xo((function(){}),"length",{value:8}).length})),No=String(String).split("String"),Po=xn.exports=function(t,e,n){"Symbol("===Io(ko(e),0,7)&&(e="["+Oo(ko(e),/^Symbol\(([^)]*)\).*$/,"$1")+"]"),n&&n.getter&&(e="get "+e),n&&n.setter&&(e="set "+e),(!Co(t,"name")||So&&t.name!==e)&&(bo?xo(t,"name",{value:e,configurable:!0}):t.name=e),Do&&n&&Co(n,"arity")&&t.length!==n.arity&&xo(t,"length",{value:n.arity});try{n&&Co(n,"constructor")&&n.constructor?bo&&xo(t,"prototype",{writable:!1}):t.prototype&&(t.prototype=void 0)}catch(i){}var o=Mo(t);return Co(o,"source")||(o.source=Ho(No,"string"==typeof e?e:"")),t};Function.prototype.toString=Po((function(){return yo(this)&&To(this).source||Eo(this)}),"toString");var _o=xn.exports,Bo=st,Lo=sn,Vo=_o,Wo=$t,Fo=function(t,e,n,o){o||(o={});var i=o.enumerable,r=void 0!==o.name?o.name:e;if(Bo(n)&&Vo(n,r,o),o.global)i?t[e]=n:Wo(e,n);else{try{o.unsafe?t[e]&&(i=!0):delete t[e]}catch(s){}i?t[e]=n:Lo.f(t,e,{value:n,enumerable:!1,configurable:!o.nonConfigurable,writable:!o.nonWritable})}return t},jo={},Uo=Math.ceil,Yo=Math.floor,zo=Math.trunc||function(t){var e=+t;return(e>0?Yo:Uo)(e)},Go=zo,Qo=function(t){var e=+t;return e!==e||0===e?0:Go(e)},Ko=Qo,Xo=Math.max,qo=Math.min,Zo=function(t,e){var n=Ko(t);return n<0?Xo(n+e,0):qo(n,e)},Jo=Qo,$o=Math.min,ti=function(t){var e=Jo(t);return e>0?$o(e,9007199254740991):0},ei=ti,ni=function(t){return ei(t.length)},oi=it,ii=Zo,ri=ni,si=function(t){return function(e,n,o){var i,r=oi(e),s=ri(r),a=ii(o,s);if(t&&n!==n){for(;s>a;)if(i=r[a++],i!==i)return!0}else for(;s>a;a++)if((t||a in r)&&r[a]===n)return t||a||0;return!t&&-1}},ai={includes:si(!0),indexOf:si(!1)},li=F,hi=ge,ci=it,ui=ai.indexOf,di=to,gi=li([].push),fi=function(t,e){var n,o=ci(t),i=0,r=[];for(n in o)!hi(di,n)&&hi(o,n)&&gi(r,n);for(;e.length>i;)hi(o,n=e[i++])&&(~ui(r,n)||gi(r,n));return r},mi=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],pi=fi,wi=mi,Ai=wi.concat("length","prototype");jo.f=Object.getOwnPropertyNames||function(t){return pi(t,Ai)};var vi={};vi.f=Object.getOwnPropertySymbols;var yi=dt,Ci=F,bi=jo,Si=vi,Ei=gn,Ri=Ci([].concat),Mi=yi("Reflect","ownKeys")||function(t){var e=bi.f(Ei(t)),n=Si.f;return n?Ri(e,n(t)):e},Ti=ge,ki=Mi,xi=C,Ii=sn,Oi=function(t,e,n){for(var o=ki(e),i=Ii.f,r=xi.f,s=0;s<o.length;s++){var a=o[s];!Ti(t,a)&&(!n||!Ti(n,a))&&i(t,a,r(e,a))}},Hi=b,Di=st,Ni=/#|\.prototype\./,Pi=function(t,e){var n=Bi[_i(t)];return n===Vi||n!==Li&&(Di(e)?Hi(e):!!e)},_i=Pi.normalize=function(t){return String(t).replace(Ni,".").toLowerCase()},Bi=Pi.data={},Li=Pi.NATIVE="N",Vi=Pi.POLYFILL="P",Wi=Pi,Fi=y,ji=C.f,Ui=kn,Yi=Fo,zi=$t,Gi=Oi,Qi=Wi,Ki=function(t,e){var n,o,i,r,s,a,l=t.target,h=t.global,c=t.stat;if(o=h?Fi:c?Fi[l]||zi(l,{}):Fi[l]&&Fi[l].prototype,o)for(i in e){if(s=e[i],t.dontCallGetSet?(a=ji(o,i),r=a&&a.value):r=o[i],n=Qi(h?i:l+(c?".":"#")+i,t.forced),!n&&void 0!==r){if(typeof s==typeof r)continue;Gi(s,r)}(t.sham||r&&r.sham)&&Ui(s,"sham",!0),Yi(o,i,s,t)}},Xi=z,qi=Array.isArray||function(t){return"Array"===Xi(t)},Zi=E,Ji=qi,$i=TypeError,tr=Object.getOwnPropertyDescriptor,er=Zi&&!function(){if(void 0!==this)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(t){return t instanceof TypeError}}(),nr=er?function(t,e){if(Ji(t)&&!tr(t,"length").writable)throw new $i("Cannot set read only .length");return t.length=e}:function(t,e){return t.length=e},or=TypeError,ir=9007199254740991,rr=function(t){if(t>ir)throw or("Maximum allowed index exceeded");return t},sr=Ki,ar=he,lr=ni,hr=nr,cr=rr,ur=b,dr=ur((function(){return 4294967297!==[].push.call({length:4294967296},1)})),gr=function(){try{Object.defineProperty([],"length",{writable:!1}).push()}catch(t){return t instanceof TypeError}},fr=dr||!gr();sr({target:"Array",proto:!0,arity:1,forced:fr},{push:function(t){var e=ar(this),n=lr(e),o=arguments.length;cr(n+o);for(var i=0;i<o;i++)e[n]=arguments[i],n++;return hr(e,n),n}});var mr=M,pr=Function.prototype,wr=pr.apply,Ar=pr.call,vr="object"==typeof Reflect&&Reflect.apply||(mr?Ar.bind(wr):function(){return Ar.apply(wr,arguments)}),yr=F,Cr=Ft,br=function(t,e,n){try{return yr(Cr(Object.getOwnPropertyDescriptor(t,e)[n]))}catch(o){}},Sr=lt,Er=function(t){return Sr(t)||null===t},Rr=Er,Mr=String,Tr=TypeError,kr=function(t){if(Rr(t))return t;throw new Tr("Can't set "+Mr(t)+" as a prototype")},xr=br,Ir=gn,Or=kr,Hr=Object.setPrototypeOf||("__proto__"in{}?function(){var t,e=!1,n={};try{t=xr(Object.prototype,"__proto__","set"),t(n,[]),e=n instanceof Array}catch(o){}return function(n,o){return Ir(n),Or(o),e?t(n,o):n.__proto__=o,n}}():void 0),Dr=sn.f,Nr=function(t,e,n){n in t||Dr(t,n,{configurable:!0,get:function(){return e[n]},set:function(t){e[n]=t}})},Pr=st,_r=lt,Br=Hr,Lr=function(t,e,n){var o,i;return Br&&Pr(o=e.constructor)&&o!==n&&_r(i=o.prototype)&&i!==n.prototype&&Br(t,i),t},Vr=ke,Wr=Vr("toStringTag"),Fr={};Fr[Wr]="z";var jr="[object z]"===String(Fr),Ur=jr,Yr=st,zr=z,Gr=ke,Qr=Gr("toStringTag"),Kr=Object,Xr="Arguments"===zr(function(){return arguments}()),qr=function(t,e){try{return t[e]}catch(n){}},Zr=Ur?zr:function(t){var e,n,o;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(n=qr(e=Kr(t),Qr))?n:Xr?zr(e):"Object"===(o=zr(e))&&Yr(e.callee)?"Arguments":o},Jr=Zr,$r=String,ts=function(t){if("Symbol"===Jr(t))throw new TypeError("Cannot convert a Symbol value to a string");return $r(t)},es=ts,ns=function(t,e){return void 0===t?arguments.length<2?"":e:es(t)},os=lt,is=kn,rs=function(t,e){os(e)&&"cause"in e&&is(t,"cause",e.cause)},ss=F,as=Error,ls=ss("".replace),hs=function(t){return String(new as(t).stack)}("zxcasd"),cs=/\n\s*at [^:]*:[^\n]*/,us=cs.test(hs),ds=function(t,e){if(us&&"string"==typeof t&&!as.prepareStackTrace)for(;e--;)t=ls(t,cs,"");return t},gs=b,fs=_,ms=!gs((function(){var t=new Error("a");return!("stack"in t)||(Object.defineProperty(t,"stack",fs(1,7)),7!==t.stack)})),ps=kn,ws=ds,As=ms,vs=Error.captureStackTrace,ys=function(t,e,n,o){As&&(vs?vs(t,e):ps(t,"stack",ws(n,o)))},Cs=dt,bs=ge,Ss=kn,Es=ft,Rs=Hr,Ms=Oi,Ts=Nr,ks=Lr,xs=ns,Is=rs,Os=ys,Hs=E,Ds=function(t,e,n,o){var i="stackTraceLimit",r=o?2:1,s=t.split("."),a=s[s.length-1],l=Cs.apply(null,s);if(l){var h=l.prototype;if(bs(h,"cause")&&delete h.cause,!n)return l;var c=Cs("Error"),u=e((function(t,e){var n=xs(o?e:t,void 0),i=o?new l(t):new l;return void 0!==n&&Ss(i,"message",n),Os(i,u,i.stack,2),this&&Es(h,this)&&ks(i,this,u),arguments.length>r&&Is(i,arguments[r]),i}));u.prototype=h,"Error"!==a?Rs?Rs(u,c):Ms(u,c,{name:!0}):Hs&&i in l&&(Ts(u,l,i),Ts(u,l,"prepareStackTrace")),Ms(u,l);try{h.name!==a&&Ss(h,"name",a),h.constructor=u}catch(d){}return u}},Ns=Ki,Ps=y,_s=vr,Bs=Ds,Ls="WebAssembly",Vs=Ps[Ls],Ws=7!==new Error("e",{cause:7}).cause,Fs=function(t,e){var n={};n[t]=Bs(t,e,Ws),Ns({global:!0,constructor:!0,arity:1,forced:Ws},n)},js=function(t,e){if(Vs&&Vs[t]){var n={};n[t]=Bs(Ls+"."+t,e,Ws),Ns({target:Ls,stat:!0,constructor:!0,arity:1,forced:Ws},n)}};Fs("Error",(function(t){return function(e){return _s(t,this,arguments)}})),Fs("EvalError",(function(t){return function(e){return _s(t,this,arguments)}})),Fs("RangeError",(function(t){return function(e){return _s(t,this,arguments)}})),Fs("ReferenceError",(function(t){return function(e){return _s(t,this,arguments)}})),Fs("SyntaxError",(function(t){return function(e){return _s(t,this,arguments)}})),Fs("TypeError",(function(t){return function(e){return _s(t,this,arguments)}})),Fs("URIError",(function(t){return function(e){return _s(t,this,arguments)}})),js("CompileError",(function(t){return function(e){return _s(t,this,arguments)}})),js("LinkError",(function(t){return function(e){return _s(t,this,arguments)}})),js("RuntimeError",(function(t){return function(e){return _s(t,this,arguments)}}));var Us,Ys,zs,Gs,Qs=z,Ks=F,Xs=function(t){if("Function"===Qs(t))return Ks(t)},qs=Xs,Zs=Ft,Js=M,$s=qs(qs.bind),ta=function(t,e){return Zs(t),void 0===e?t:Js?$s(t,e):function(){return t.apply(e,arguments)}},ea=dt,na=ea("document","documentElement"),oa=F,ia=oa([].slice),ra=TypeError,sa=function(t,e){if(t<e)throw new ra("Not enough arguments");return t},aa=mt,la=/(?:ipad|iphone|ipod).*applewebkit/i.test(aa),ha=y,ca=z,ua="process"===ca(ha.process),da=y,ga=vr,fa=ta,ma=st,pa=ge,wa=b,Aa=na,va=ia,ya=ze,Ca=sa,ba=la,Sa=ua,Ea=da.setImmediate,Ra=da.clearImmediate,Ma=da.process,Ta=da.Dispatch,ka=da.Function,xa=da.MessageChannel,Ia=da.String,Oa=0,Ha={},Da="onreadystatechange";wa((function(){Us=da.location}));var Na=function(t){if(pa(Ha,t)){var e=Ha[t];delete Ha[t],e()}},Pa=function(t){return function(){Na(t)}},_a=function(t){Na(t.data)},Ba=function(t){da.postMessage(Ia(t),Us.protocol+"//"+Us.host)};(!Ea||!Ra)&&(Ea=function(t){Ca(arguments.length,1);var e=ma(t)?t:ka(t),n=va(arguments,1);return Ha[++Oa]=function(){ga(e,void 0,n)},Ys(Oa),Oa},Ra=function(t){delete Ha[t]},Sa?Ys=function(t){Ma.nextTick(Pa(t))}:Ta&&Ta.now?Ys=function(t){Ta.now(Pa(t))}:xa&&!ba?(zs=new xa,Gs=zs.port2,zs.port1.onmessage=_a,Ys=fa(Gs.postMessage,Gs)):da.addEventListener&&ma(da.postMessage)&&!da.importScripts&&Us&&"file:"!==Us.protocol&&!wa(Ba)?(Ys=Ba,da.addEventListener("message",_a,!1)):Ys=Da in ya("script")?function(t){Aa.appendChild(ya("script"))[Da]=function(){Aa.removeChild(this),Na(t)}}:function(t){setTimeout(Pa(t),0)});var La={set:Ea,clear:Ra},Va=Ki,Wa=y,Fa=La.clear;Va({global:!0,bind:!0,enumerable:!0,forced:Wa.clearImmediate!==Fa},{clearImmediate:Fa});var ja="function"==typeof Bun&&Bun&&"string"==typeof Bun.version,Ua=y,Ya=vr,za=st,Ga=ja,Qa=mt,Ka=ia,Xa=sa,qa=Ua.Function,Za=/MSIE .\./.test(Qa)||Ga&&function(){var t=Ua.Bun.version.split(".");return t.length<3||"0"===t[0]&&(t[1]<3||"3"===t[1]&&"0"===t[2])}(),Ja=function(t,e){var n=e?2:1;return Za?function(o,i){var r=Xa(arguments.length,1)>n,s=za(o)?o:qa(o),a=r?Ka(arguments,n):[],l=r?function(){Ya(s,this,a)}:s;return e?t(l,i):t(l)}:t},$a=Ki,tl=y,el=La.set,nl=Ja,ol=tl.setImmediate?nl(el,!1):el;/*! @license DOMPurify 2.4.7 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/2.4.7/LICENSE */function il(t){return il="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},il(t)}function rl(t,e){return rl=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},rl(t,e)}function sl(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function al(t,e,n){return al=sl()?Reflect.construct:function(t,e,n){var o=[null];o.push.apply(o,e);var i=Function.bind.apply(t,o),r=new i;return n&&rl(r,n.prototype),r},al.apply(null,arguments)}function ll(t){return hl(t)||cl(t)||ul(t)||gl()}function hl(t){if(Array.isArray(t))return dl(t)}function cl(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}function ul(t,e){if(t){if("string"==typeof t)return dl(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if("Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return dl(t,e)}}function dl(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,o=new Array(e);n<e;n++)o[n]=t[n];return o}function gl(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}$a({global:!0,bind:!0,enumerable:!0,forced:tl.setImmediate!==ol},{setImmediate:ol});var fl=Object.hasOwnProperty,ml=Object.setPrototypeOf,pl=Object.isFrozen,wl=Object.getPrototypeOf,Al=Object.getOwnPropertyDescriptor,vl=Object.freeze,yl=Object.seal,Cl=Object.create,bl="undefined"!=typeof Reflect&&Reflect,Sl=bl.apply,El=bl.construct;Sl||(Sl=function(t,e,n){return t.apply(e,n)}),vl||(vl=function(t){return t}),yl||(yl=function(t){return t}),El||(El=function(t,e){return al(t,ll(e))});var Rl=_l(Array.prototype.forEach),Ml=_l(Array.prototype.pop),Tl=_l(Array.prototype.push),kl=_l(String.prototype.toLowerCase),xl=_l(String.prototype.toString),Il=_l(String.prototype.match),Ol=_l(String.prototype.replace),Hl=_l(String.prototype.indexOf),Dl=_l(String.prototype.trim),Nl=_l(RegExp.prototype.test),Pl=Bl(TypeError);function _l(t){return function(e){for(var n=arguments.length,o=new Array(n>1?n-1:0),i=1;i<n;i++)o[i-1]=arguments[i];return Sl(t,e,o)}}function Bl(t){return function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return El(t,n)}}function Ll(t,e,n){var o;n=null!==(o=n)&&void 0!==o?o:kl,ml&&ml(t,null);for(var i=e.length;i--;){var r=e[i];if("string"==typeof r){var s=n(r);s!==r&&(pl(e)||(e[i]=s),r=s)}t[r]=!0}return t}function Vl(t){var e,n=Cl(null);for(e in t)!0===Sl(fl,t,[e])&&(n[e]=t[e]);return n}function Wl(t,e){for(;null!==t;){var n=Al(t,e);if(n){if(n.get)return _l(n.get);if("function"==typeof n.value)return _l(n.value)}t=wl(t)}function o(t){return console.warn("fallback value for",t),null}return o}var Fl=vl(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),jl=vl(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),Ul=vl(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),Yl=vl(["animate","color-profile","cursor","discard","fedropshadow","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),zl=vl(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover"]),Gl=vl(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),Ql=vl(["#text"]),Kl=vl(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns","slot"]),Xl=vl(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),ql=vl(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),Zl=vl(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),Jl=yl(/\{\{[\w\W]*|[\w\W]*\}\}/gm),$l=yl(/<%[\w\W]*|[\w\W]*%>/gm),th=yl(/\${[\w\W]*}/gm),eh=yl(/^data-[\-\w.\u00B7-\uFFFF]/),nh=yl(/^aria-[\-\w]+$/),oh=yl(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),ih=yl(/^(?:\w+script|data):/i),rh=yl(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),sh=yl(/^html$/i),ah=function(){return"undefined"==typeof window?null:window},lh=function(t,e){if("object"!==il(t)||"function"!=typeof t.createPolicy)return null;var n=null,o="data-tt-policy-suffix";e.currentScript&&e.currentScript.hasAttribute(o)&&(n=e.currentScript.getAttribute(o));var i="dompurify"+(n?"#"+n:"");try{return t.createPolicy(i,{createHTML:function(t){return t},createScriptURL:function(t){return t}})}catch(r){return console.warn("TrustedTypes policy "+i+" could not be created."),null}};function hh(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ah(),e=function(t){return hh(t)};if(e.version="2.4.7",e.removed=[],!t||!t.document||9!==t.document.nodeType)return e.isSupported=!1,e;var n=t.document,o=t.document,i=t.DocumentFragment,r=t.HTMLTemplateElement,s=t.Node,a=t.Element,l=t.NodeFilter,h=t.NamedNodeMap,c=void 0===h?t.NamedNodeMap||t.MozNamedAttrMap:h,u=t.HTMLFormElement,d=t.DOMParser,g=t.trustedTypes,f=a.prototype,m=Wl(f,"cloneNode"),p=Wl(f,"nextSibling"),w=Wl(f,"childNodes"),A=Wl(f,"parentNode");if("function"==typeof r){var v=o.createElement("template");v.content&&v.content.ownerDocument&&(o=v.content.ownerDocument)}var y=lh(g,n),C=y?y.createHTML(""):"",b=o,S=b.implementation,E=b.createNodeIterator,R=b.createDocumentFragment,M=b.getElementsByTagName,T=n.importNode,k={};try{k=Vl(o).documentMode?o.documentMode:{}}catch(Qt){}var x={};e.isSupported="function"==typeof A&&S&&void 0!==S.createHTMLDocument&&9!==k;var I,O,H=Jl,D=$l,N=th,P=eh,_=nh,B=ih,L=rh,V=oh,W=null,F=Ll({},[].concat(ll(Fl),ll(jl),ll(Ul),ll(zl),ll(Ql))),j=null,U=Ll({},[].concat(ll(Kl),ll(Xl),ll(ql),ll(Zl))),Y=Object.seal(Object.create(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),z=null,G=null,Q=!0,K=!0,X=!1,q=!0,Z=!1,J=!1,$=!1,tt=!1,et=!1,nt=!1,ot=!1,it=!0,rt=!1,st="user-content-",at=!0,lt=!1,ht={},ct=null,ut=Ll({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]),dt=null,gt=Ll({},["audio","video","img","source","image","track"]),ft=null,mt=Ll({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),pt="http://www.w3.org/1998/Math/MathML",wt="http://www.w3.org/2000/svg",At="http://www.w3.org/1999/xhtml",vt=At,yt=!1,Ct=null,bt=Ll({},[pt,wt,At],xl),St=["application/xhtml+xml","text/html"],Et="text/html",Rt=null,Mt=o.createElement("form"),Tt=function(t){return t instanceof RegExp||t instanceof Function},kt=function(t){Rt&&Rt===t||((!t||"object"!==il(t))&&(t={}),t=Vl(t),I=I=-1===St.indexOf(t.PARSER_MEDIA_TYPE)?Et:t.PARSER_MEDIA_TYPE,O="application/xhtml+xml"===I?xl:kl,W="ALLOWED_TAGS"in t?Ll({},t.ALLOWED_TAGS,O):F,j="ALLOWED_ATTR"in t?Ll({},t.ALLOWED_ATTR,O):U,Ct="ALLOWED_NAMESPACES"in t?Ll({},t.ALLOWED_NAMESPACES,xl):bt,ft="ADD_URI_SAFE_ATTR"in t?Ll(Vl(mt),t.ADD_URI_SAFE_ATTR,O):mt,dt="ADD_DATA_URI_TAGS"in t?Ll(Vl(gt),t.ADD_DATA_URI_TAGS,O):gt,ct="FORBID_CONTENTS"in t?Ll({},t.FORBID_CONTENTS,O):ut,z="FORBID_TAGS"in t?Ll({},t.FORBID_TAGS,O):{},G="FORBID_ATTR"in t?Ll({},t.FORBID_ATTR,O):{},ht="USE_PROFILES"in t&&t.USE_PROFILES,Q=!1!==t.ALLOW_ARIA_ATTR,K=!1!==t.ALLOW_DATA_ATTR,X=t.ALLOW_UNKNOWN_PROTOCOLS||!1,q=!1!==t.ALLOW_SELF_CLOSE_IN_ATTR,Z=t.SAFE_FOR_TEMPLATES||!1,J=t.WHOLE_DOCUMENT||!1,et=t.RETURN_DOM||!1,nt=t.RETURN_DOM_FRAGMENT||!1,ot=t.RETURN_TRUSTED_TYPE||!1,tt=t.FORCE_BODY||!1,it=!1!==t.SANITIZE_DOM,rt=t.SANITIZE_NAMED_PROPS||!1,at=!1!==t.KEEP_CONTENT,lt=t.IN_PLACE||!1,V=t.ALLOWED_URI_REGEXP||V,vt=t.NAMESPACE||At,Y=t.CUSTOM_ELEMENT_HANDLING||{},t.CUSTOM_ELEMENT_HANDLING&&Tt(t.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(Y.tagNameCheck=t.CUSTOM_ELEMENT_HANDLING.tagNameCheck),t.CUSTOM_ELEMENT_HANDLING&&Tt(t.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(Y.attributeNameCheck=t.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),t.CUSTOM_ELEMENT_HANDLING&&"boolean"==typeof t.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements&&(Y.allowCustomizedBuiltInElements=t.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),Z&&(K=!1),nt&&(et=!0),ht&&(W=Ll({},ll(Ql)),j=[],!0===ht.html&&(Ll(W,Fl),Ll(j,Kl)),!0===ht.svg&&(Ll(W,jl),Ll(j,Xl),Ll(j,Zl)),!0===ht.svgFilters&&(Ll(W,Ul),Ll(j,Xl),Ll(j,Zl)),!0===ht.mathMl&&(Ll(W,zl),Ll(j,ql),Ll(j,Zl))),t.ADD_TAGS&&(W===F&&(W=Vl(W)),Ll(W,t.ADD_TAGS,O)),t.ADD_ATTR&&(j===U&&(j=Vl(j)),Ll(j,t.ADD_ATTR,O)),t.ADD_URI_SAFE_ATTR&&Ll(ft,t.ADD_URI_SAFE_ATTR,O),t.FORBID_CONTENTS&&(ct===ut&&(ct=Vl(ct)),Ll(ct,t.FORBID_CONTENTS,O)),at&&(W["#text"]=!0),J&&Ll(W,["html","head","body"]),W.table&&(Ll(W,["tbody"]),delete z.tbody),vl&&vl(t),Rt=t)},xt=Ll({},["mi","mo","mn","ms","mtext"]),It=Ll({},["foreignobject","desc","title","annotation-xml"]),Ot=Ll({},["title","style","font","a","script"]),Ht=Ll({},jl);Ll(Ht,Ul),Ll(Ht,Yl);var Dt=Ll({},zl);Ll(Dt,Gl);var Nt=function(t){var e=A(t);(!e||!e.tagName)&&(e={namespaceURI:vt,tagName:"template"});var n=kl(t.tagName),o=kl(e.tagName);return!!Ct[t.namespaceURI]&&(t.namespaceURI===wt?e.namespaceURI===At?"svg"===n:e.namespaceURI===pt?"svg"===n&&("annotation-xml"===o||xt[o]):!!Ht[n]:t.namespaceURI===pt?e.namespaceURI===At?"math"===n:e.namespaceURI===wt?"math"===n&&It[o]:!!Dt[n]:t.namespaceURI===At?!(e.namespaceURI===wt&&!It[o]||e.namespaceURI===pt&&!xt[o])&&(!Dt[n]&&(Ot[n]||!Ht[n])):!("application/xhtml+xml"!==I||!Ct[t.namespaceURI]))},Pt=function(t){Tl(e.removed,{element:t});try{t.parentNode.removeChild(t)}catch(n){try{t.outerHTML=C}catch(o){t.remove()}}},_t=function(t,n){try{Tl(e.removed,{attribute:n.getAttributeNode(t),from:n})}catch(o){Tl(e.removed,{attribute:null,from:n})}if(n.removeAttribute(t),"is"===t&&!j[t])if(et||nt)try{Pt(n)}catch(o){}else try{n.setAttribute(t,"")}catch(o){}},Bt=function(t){var e,n;if(tt)t="<remove></remove>"+t;else{var i=Il(t,/^[\r\n\t ]+/);n=i&&i[0]}"application/xhtml+xml"===I&&vt===At&&(t='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+t+"</body></html>");var r=y?y.createHTML(t):t;if(vt===At)try{e=(new d).parseFromString(r,I)}catch(a){}if(!e||!e.documentElement){e=S.createDocument(vt,"template",null);try{e.documentElement.innerHTML=yt?C:r}catch(a){}}var s=e.body||e.documentElement;return t&&n&&s.insertBefore(o.createTextNode(n),s.childNodes[0]||null),vt===At?M.call(e,J?"html":"body")[0]:J?e.documentElement:s},Lt=function(t){return E.call(t.ownerDocument||t,t,l.SHOW_ELEMENT|l.SHOW_COMMENT|l.SHOW_TEXT,null,!1)},Vt=function(t){return t instanceof u&&("string"!=typeof t.nodeName||"string"!=typeof t.textContent||"function"!=typeof t.removeChild||!(t.attributes instanceof c)||"function"!=typeof t.removeAttribute||"function"!=typeof t.setAttribute||"string"!=typeof t.namespaceURI||"function"!=typeof t.insertBefore||"function"!=typeof t.hasChildNodes)},Wt=function(t){return"object"===il(s)?t instanceof s:t&&"object"===il(t)&&"number"==typeof t.nodeType&&"string"==typeof t.nodeName},Ft=function(t,n,o){x[t]&&Rl(x[t],(function(t){t.call(e,n,o,Rt)}))},jt=function(t){var n;if(Ft("beforeSanitizeElements",t,null),Vt(t)||Nl(/[\u0080-\uFFFF]/,t.nodeName))return Pt(t),!0;var o=O(t.nodeName);if(Ft("uponSanitizeElement",t,{tagName:o,allowedTags:W}),t.hasChildNodes()&&!Wt(t.firstElementChild)&&(!Wt(t.content)||!Wt(t.content.firstElementChild))&&Nl(/<[/\w]/g,t.innerHTML)&&Nl(/<[/\w]/g,t.textContent)||"select"===o&&Nl(/<template/i,t.innerHTML))return Pt(t),!0;if(!W[o]||z[o]){if(!z[o]&&Yt(o)&&(Y.tagNameCheck instanceof RegExp&&Nl(Y.tagNameCheck,o)||Y.tagNameCheck instanceof Function&&Y.tagNameCheck(o)))return!1;if(at&&!ct[o]){var i=A(t)||t.parentNode,r=w(t)||t.childNodes;if(r&&i)for(var s=r.length,l=s-1;l>=0;--l)i.insertBefore(m(r[l],!0),p(t))}return Pt(t),!0}return t instanceof a&&!Nt(t)||("noscript"===o||"noembed"===o||"noframes"===o)&&Nl(/<\/no(script|embed|frames)/i,t.innerHTML)?(Pt(t),!0):(Z&&3===t.nodeType&&(n=t.textContent,n=Ol(n,H," "),n=Ol(n,D," "),n=Ol(n,N," "),t.textContent!==n&&(Tl(e.removed,{element:t.cloneNode()}),t.textContent=n)),Ft("afterSanitizeElements",t,null),!1)},Ut=function(t,e,n){if(it&&("id"===e||"name"===e)&&(n in o||n in Mt))return!1;if((!K||G[e]||!Nl(P,e))&&(!Q||!Nl(_,e)))if(!j[e]||G[e]){if(!(Yt(t)&&(Y.tagNameCheck instanceof RegExp&&Nl(Y.tagNameCheck,t)||Y.tagNameCheck instanceof Function&&Y.tagNameCheck(t))&&(Y.attributeNameCheck instanceof RegExp&&Nl(Y.attributeNameCheck,e)||Y.attributeNameCheck instanceof Function&&Y.attributeNameCheck(e))||"is"===e&&Y.allowCustomizedBuiltInElements&&(Y.tagNameCheck instanceof RegExp&&Nl(Y.tagNameCheck,n)||Y.tagNameCheck instanceof Function&&Y.tagNameCheck(n))))return!1}else if(!ft[e]&&!Nl(V,Ol(n,L,""))&&("src"!==e&&"xlink:href"!==e&&"href"!==e||"script"===t||0!==Hl(n,"data:")||!dt[t])&&(!X||Nl(B,Ol(n,L,"")))&&n)return!1;return!0},Yt=function(t){return t.indexOf("-")>0},zt=function(t){var n,o,i,r;Ft("beforeSanitizeAttributes",t,null);var s=t.attributes;if(s){var a={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:j};for(r=s.length;r--;){n=s[r];var l=n,h=l.name,c=l.namespaceURI;if(o="value"===h?n.value:Dl(n.value),i=O(h),a.attrName=i,a.attrValue=o,a.keepAttr=!0,a.forceKeepAttr=void 0,Ft("uponSanitizeAttribute",t,a),o=a.attrValue,!a.forceKeepAttr&&(_t(h,t),a.keepAttr)){if(!q&&Nl(/\/>/i,o)){_t(h,t);continue}Z&&(o=Ol(o,H," "),o=Ol(o,D," "),o=Ol(o,N," "));var u=O(t.nodeName);if(Ut(u,i,o)){if(rt&&("id"===i||"name"===i)&&(_t(h,t),o=st+o),y&&"object"===il(g)&&"function"==typeof g.getAttributeType&&!c)switch(g.getAttributeType(u,i)){case"TrustedHTML":o=y.createHTML(o);break;case"TrustedScriptURL":o=y.createScriptURL(o);break}try{c?t.setAttributeNS(c,h,o):t.setAttribute(h,o),Ml(e.removed)}catch(d){}}}}Ft("afterSanitizeAttributes",t,null)}},Gt=function t(e){var n,o=Lt(e);for(Ft("beforeSanitizeShadowDOM",e,null);n=o.nextNode();)Ft("uponSanitizeShadowNode",n,null),!jt(n)&&(n.content instanceof i&&t(n.content),zt(n));Ft("afterSanitizeShadowDOM",e,null)};return e.sanitize=function(o){var r,a,l,h,c,u=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(yt=!o,yt&&(o="\x3c!--\x3e"),"string"!=typeof o&&!Wt(o)){if("function"!=typeof o.toString)throw Pl("toString is not a function");if(o=o.toString(),"string"!=typeof o)throw Pl("dirty is not a string, aborting")}if(!e.isSupported){if("object"===il(t.toStaticHTML)||"function"==typeof t.toStaticHTML){if("string"==typeof o)return t.toStaticHTML(o);if(Wt(o))return t.toStaticHTML(o.outerHTML)}return o}if($||kt(u),e.removed=[],"string"==typeof o&&(lt=!1),lt){if(o.nodeName){var d=O(o.nodeName);if(!W[d]||z[d])throw Pl("root node is forbidden and cannot be sanitized in-place")}}else if(o instanceof s)r=Bt("\x3c!----\x3e"),a=r.ownerDocument.importNode(o,!0),1===a.nodeType&&"BODY"===a.nodeName||"HTML"===a.nodeName?r=a:r.appendChild(a);else{if(!et&&!Z&&!J&&-1===o.indexOf("<"))return y&&ot?y.createHTML(o):o;if(r=Bt(o),!r)return et?null:ot?C:""}r&&tt&&Pt(r.firstChild);for(var g=Lt(lt?o:r);l=g.nextNode();)3===l.nodeType&&l===h||jt(l)||(l.content instanceof i&&Gt(l.content),zt(l),h=l);if(h=null,lt)return o;if(et){if(nt)for(c=R.call(r.ownerDocument);r.firstChild;)c.appendChild(r.firstChild);else c=r;return(j.shadowroot||j.shadowrootmod)&&(c=T.call(n,c,!0)),c}var f=J?r.outerHTML:r.innerHTML;return J&&W["!doctype"]&&r.ownerDocument&&r.ownerDocument.doctype&&r.ownerDocument.doctype.name&&Nl(sh,r.ownerDocument.doctype.name)&&(f="<!DOCTYPE "+r.ownerDocument.doctype.name+">\n"+f),Z&&(f=Ol(f,H," "),f=Ol(f,D," "),f=Ol(f,N," ")),y&&ot?y.createHTML(f):f},e.setConfig=function(t){kt(t),$=!0},e.clearConfig=function(){Rt=null,$=!1},e.isValidAttribute=function(t,e,n){Rt||kt({});var o=O(t),i=O(e);return Ut(o,i,n)},e.addHook=function(t,e){"function"==typeof e&&(x[t]=x[t]||[],Tl(x[t],e))},e.removeHook=function(t){if(x[t])return Ml(x[t])},e.removeHooks=function(t){x[t]&&(x[t]=[])},e.removeAllHooks=function(){x={}},e}var ch,uh,dh=hh();//! moment.js
//! version : 2.29.4
//! authors : Tim Wood, Iskren Chernev, Moment.js contributors
//! license : MIT
//! momentjs.com
function gh(){return ch.apply(null,arguments)}function fh(t){ch=t}function mh(t){return t instanceof Array||"[object Array]"===Object.prototype.toString.call(t)}function ph(t){return null!=t&&"[object Object]"===Object.prototype.toString.call(t)}function wh(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function Ah(t){if(Object.getOwnPropertyNames)return 0===Object.getOwnPropertyNames(t).length;var e;for(e in t)if(wh(t,e))return!1;return!0}function vh(t){return void 0===t}function yh(t){return"number"==typeof t||"[object Number]"===Object.prototype.toString.call(t)}function Ch(t){return t instanceof Date||"[object Date]"===Object.prototype.toString.call(t)}function bh(t,e){var n,o=[],i=t.length;for(n=0;n<i;++n)o.push(e(t[n],n));return o}function Sh(t,e){for(var n in e)wh(e,n)&&(t[n]=e[n]);return wh(e,"toString")&&(t.toString=e.toString),wh(e,"valueOf")&&(t.valueOf=e.valueOf),t}function Eh(t,e,n,o){return og(t,e,n,o,!0).utc()}function Rh(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidEra:null,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],era:null,meridiem:null,rfc2822:!1,weekdayMismatch:!1}}function Mh(t){return null==t._pf&&(t._pf=Rh()),t._pf}function Th(t){if(null==t._isValid){var e=Mh(t),n=uh.call(e.parsedDateParts,(function(t){return null!=t})),o=!isNaN(t._d.getTime())&&e.overflow<0&&!e.empty&&!e.invalidEra&&!e.invalidMonth&&!e.invalidWeekday&&!e.weekdayMismatch&&!e.nullInput&&!e.invalidFormat&&!e.userInvalidated&&(!e.meridiem||e.meridiem&&n);if(t._strict&&(o=o&&0===e.charsLeftOver&&0===e.unusedTokens.length&&void 0===e.bigHour),null!=Object.isFrozen&&Object.isFrozen(t))return o;t._isValid=o}return t._isValid}function kh(t){var e=Eh(NaN);return null!=t?Sh(Mh(e),t):Mh(e).userInvalidated=!0,e}uh=Array.prototype.some?Array.prototype.some:function(t){var e,n=Object(this),o=n.length>>>0;for(e=0;e<o;e++)if(e in n&&t.call(this,n[e],e,n))return!0;return!1};var xh=gh.momentProperties=[],Ih=!1;function Oh(t,e){var n,o,i,r=xh.length;if(vh(e._isAMomentObject)||(t._isAMomentObject=e._isAMomentObject),vh(e._i)||(t._i=e._i),vh(e._f)||(t._f=e._f),vh(e._l)||(t._l=e._l),vh(e._strict)||(t._strict=e._strict),vh(e._tzm)||(t._tzm=e._tzm),vh(e._isUTC)||(t._isUTC=e._isUTC),vh(e._offset)||(t._offset=e._offset),vh(e._pf)||(t._pf=Mh(e)),vh(e._locale)||(t._locale=e._locale),r>0)for(n=0;n<r;n++)o=xh[n],i=e[o],vh(i)||(t[o]=i);return t}function Hh(t){Oh(this,t),this._d=new Date(null!=t._d?t._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),!1===Ih&&(Ih=!0,gh.updateOffset(this),Ih=!1)}function Dh(t){return t instanceof Hh||null!=t&&null!=t._isAMomentObject}function Nh(t){!1===gh.suppressDeprecationWarnings&&"undefined"!=typeof console&&console.warn&&console.warn("Deprecation warning: "+t)}function Ph(t,e){var n=!0;return Sh((function(){if(null!=gh.deprecationHandler&&gh.deprecationHandler(null,t),n){var o,i,r,s=[],a=arguments.length;for(i=0;i<a;i++){if(o="","object"==typeof arguments[i]){for(r in o+="\n["+i+"] ",arguments[0])wh(arguments[0],r)&&(o+=r+": "+arguments[0][r]+", ");o=o.slice(0,-2)}else o=arguments[i];s.push(o)}Nh(t+"\nArguments: "+Array.prototype.slice.call(s).join("")+"\n"+(new Error).stack),n=!1}return e.apply(this,arguments)}),e)}var _h,Bh={};function Lh(t,e){null!=gh.deprecationHandler&&gh.deprecationHandler(t,e),Bh[t]||(Nh(e),Bh[t]=!0)}function Vh(t){return"undefined"!=typeof Function&&t instanceof Function||"[object Function]"===Object.prototype.toString.call(t)}function Wh(t){var e,n;for(n in t)wh(t,n)&&(e=t[n],Vh(e)?this[n]=e:this["_"+n]=e);this._config=t,this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)}function Fh(t,e){var n,o=Sh({},t);for(n in e)wh(e,n)&&(ph(t[n])&&ph(e[n])?(o[n]={},Sh(o[n],t[n]),Sh(o[n],e[n])):null!=e[n]?o[n]=e[n]:delete o[n]);for(n in t)wh(t,n)&&!wh(e,n)&&ph(t[n])&&(o[n]=Sh({},o[n]));return o}function jh(t){null!=t&&this.set(t)}gh.suppressDeprecationWarnings=!1,gh.deprecationHandler=null,_h=Object.keys?Object.keys:function(t){var e,n=[];for(e in t)wh(t,e)&&n.push(e);return n};var Uh={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"};function Yh(t,e,n){var o=this._calendar[t]||this._calendar.sameElse;return Vh(o)?o.call(e,n):o}function zh(t,e,n){var o=""+Math.abs(t),i=e-o.length,r=t>=0;return(r?n?"+":"":"-")+Math.pow(10,Math.max(0,i)).toString().substr(1)+o}var Gh=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|N{1,5}|YYYYYY|YYYYY|YYYY|YY|y{2,4}|yo?|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,Qh=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,Kh={},Xh={};function qh(t,e,n,o){var i=o;"string"==typeof o&&(i=function(){return this[o]()}),t&&(Xh[t]=i),e&&(Xh[e[0]]=function(){return zh(i.apply(this,arguments),e[1],e[2])}),n&&(Xh[n]=function(){return this.localeData().ordinal(i.apply(this,arguments),t)})}function Zh(t){return t.match(/\[[\s\S]/)?t.replace(/^\[|\]$/g,""):t.replace(/\\/g,"")}function Jh(t){var e,n,o=t.match(Gh);for(e=0,n=o.length;e<n;e++)Xh[o[e]]?o[e]=Xh[o[e]]:o[e]=Zh(o[e]);return function(e){var i,r="";for(i=0;i<n;i++)r+=Vh(o[i])?o[i].call(e,t):o[i];return r}}function $h(t,e){return t.isValid()?(e=tc(e,t.localeData()),Kh[e]=Kh[e]||Jh(e),Kh[e](t)):t.localeData().invalidDate()}function tc(t,e){var n=5;function o(t){return e.longDateFormat(t)||t}for(Qh.lastIndex=0;n>=0&&Qh.test(t);)t=t.replace(Qh,o),Qh.lastIndex=0,n-=1;return t}var ec={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"};function nc(t){var e=this._longDateFormat[t],n=this._longDateFormat[t.toUpperCase()];return e||!n?e:(this._longDateFormat[t]=n.match(Gh).map((function(t){return"MMMM"===t||"MM"===t||"DD"===t||"dddd"===t?t.slice(1):t})).join(""),this._longDateFormat[t])}var oc="Invalid date";function ic(){return this._invalidDate}var rc="%d",sc=/\d{1,2}/;function ac(t){return this._ordinal.replace("%d",t)}var lc={future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",w:"a week",ww:"%d weeks",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function hc(t,e,n,o){var i=this._relativeTime[n];return Vh(i)?i(t,e,n,o):i.replace(/%d/i,t)}function cc(t,e){var n=this._relativeTime[t>0?"future":"past"];return Vh(n)?n(e):n.replace(/%s/i,e)}var uc={};function dc(t,e){var n=t.toLowerCase();uc[n]=uc[n+"s"]=uc[e]=t}function gc(t){return"string"==typeof t?uc[t]||uc[t.toLowerCase()]:void 0}function fc(t){var e,n,o={};for(n in t)wh(t,n)&&(e=gc(n),e&&(o[e]=t[n]));return o}var mc={};function pc(t,e){mc[t]=e}function wc(t){var e,n=[];for(e in t)wh(t,e)&&n.push({unit:e,priority:mc[e]});return n.sort((function(t,e){return t.priority-e.priority})),n}function Ac(t){return t%4===0&&t%100!==0||t%400===0}function vc(t){return t<0?Math.ceil(t)||0:Math.floor(t)}function yc(t){var e=+t,n=0;return 0!==e&&isFinite(e)&&(n=vc(e)),n}function Cc(t,e){return function(n){return null!=n?(Sc(this,t,n),gh.updateOffset(this,e),this):bc(this,t)}}function bc(t,e){return t.isValid()?t._d["get"+(t._isUTC?"UTC":"")+e]():NaN}function Sc(t,e,n){t.isValid()&&!isNaN(n)&&("FullYear"===e&&Ac(t.year())&&1===t.month()&&29===t.date()?(n=yc(n),t._d["set"+(t._isUTC?"UTC":"")+e](n,t.month(),hu(n,t.month()))):t._d["set"+(t._isUTC?"UTC":"")+e](n))}function Ec(t){return t=gc(t),Vh(this[t])?this[t]():this}function Rc(t,e){if("object"==typeof t){t=fc(t);var n,o=wc(t),i=o.length;for(n=0;n<i;n++)this[o[n].unit](t[o[n].unit])}else if(t=gc(t),Vh(this[t]))return this[t](e);return this}var Mc,Tc=/\d/,kc=/\d\d/,xc=/\d{3}/,Ic=/\d{4}/,Oc=/[+-]?\d{6}/,Hc=/\d\d?/,Dc=/\d\d\d\d?/,Nc=/\d\d\d\d\d\d?/,Pc=/\d{1,3}/,_c=/\d{1,4}/,Bc=/[+-]?\d{1,6}/,Lc=/\d+/,Vc=/[+-]?\d+/,Wc=/Z|[+-]\d\d:?\d\d/gi,Fc=/Z|[+-]\d\d(?::?\d\d)?/gi,jc=/[+-]?\d+(\.\d{1,3})?/,Uc=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i;function Yc(t,e,n){Mc[t]=Vh(e)?e:function(t,o){return t&&n?n:e}}function zc(t,e){return wh(Mc,t)?Mc[t](e._strict,e._locale):new RegExp(Gc(t))}function Gc(t){return Qc(t.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,(function(t,e,n,o,i){return e||n||o||i})))}function Qc(t){return t.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}Mc={};var Kc={};function Xc(t,e){var n,o,i=e;for("string"==typeof t&&(t=[t]),yh(e)&&(i=function(t,n){n[e]=yc(t)}),o=t.length,n=0;n<o;n++)Kc[t[n]]=i}function qc(t,e){Xc(t,(function(t,n,o,i){o._w=o._w||{},e(t,o._w,o,i)}))}function Zc(t,e,n){null!=e&&wh(Kc,t)&&Kc[t](e,n._a,n,t)}var Jc,$c=0,tu=1,eu=2,nu=3,ou=4,iu=5,ru=6,su=7,au=8;function lu(t,e){return(t%e+e)%e}function hu(t,e){if(isNaN(t)||isNaN(e))return NaN;var n=lu(e,12);return t+=(e-n)/12,1===n?Ac(t)?29:28:31-n%7%2}Jc=Array.prototype.indexOf?Array.prototype.indexOf:function(t){var e;for(e=0;e<this.length;++e)if(this[e]===t)return e;return-1},qh("M",["MM",2],"Mo",(function(){return this.month()+1})),qh("MMM",0,0,(function(t){return this.localeData().monthsShort(this,t)})),qh("MMMM",0,0,(function(t){return this.localeData().months(this,t)})),dc("month","M"),pc("month",8),Yc("M",Hc),Yc("MM",Hc,kc),Yc("MMM",(function(t,e){return e.monthsShortRegex(t)})),Yc("MMMM",(function(t,e){return e.monthsRegex(t)})),Xc(["M","MM"],(function(t,e){e[tu]=yc(t)-1})),Xc(["MMM","MMMM"],(function(t,e,n,o){var i=n._locale.monthsParse(t,o,n._strict);null!=i?e[tu]=i:Mh(n).invalidMonth=t}));var cu="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),uu="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),du=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,gu=Uc,fu=Uc;function mu(t,e){return t?mh(this._months)?this._months[t.month()]:this._months[(this._months.isFormat||du).test(e)?"format":"standalone"][t.month()]:mh(this._months)?this._months:this._months.standalone}function pu(t,e){return t?mh(this._monthsShort)?this._monthsShort[t.month()]:this._monthsShort[du.test(e)?"format":"standalone"][t.month()]:mh(this._monthsShort)?this._monthsShort:this._monthsShort.standalone}function wu(t,e,n){var o,i,r,s=t.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],o=0;o<12;++o)r=Eh([2e3,o]),this._shortMonthsParse[o]=this.monthsShort(r,"").toLocaleLowerCase(),this._longMonthsParse[o]=this.months(r,"").toLocaleLowerCase();return n?"MMM"===e?(i=Jc.call(this._shortMonthsParse,s),-1!==i?i:null):(i=Jc.call(this._longMonthsParse,s),-1!==i?i:null):"MMM"===e?(i=Jc.call(this._shortMonthsParse,s),-1!==i?i:(i=Jc.call(this._longMonthsParse,s),-1!==i?i:null)):(i=Jc.call(this._longMonthsParse,s),-1!==i?i:(i=Jc.call(this._shortMonthsParse,s),-1!==i?i:null))}function Au(t,e,n){var o,i,r;if(this._monthsParseExact)return wu.call(this,t,e,n);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),o=0;o<12;o++){if(i=Eh([2e3,o]),n&&!this._longMonthsParse[o]&&(this._longMonthsParse[o]=new RegExp("^"+this.months(i,"").replace(".","")+"$","i"),this._shortMonthsParse[o]=new RegExp("^"+this.monthsShort(i,"").replace(".","")+"$","i")),!n&&!this._monthsParse[o]&&(r="^"+this.months(i,"")+"|^"+this.monthsShort(i,""),this._monthsParse[o]=new RegExp(r.replace(".",""),"i")),n&&"MMMM"===e&&this._longMonthsParse[o].test(t))return o;if(n&&"MMM"===e&&this._shortMonthsParse[o].test(t))return o;if(!n&&this._monthsParse[o].test(t))return o}}function vu(t,e){var n;if(!t.isValid())return t;if("string"==typeof e)if(/^\d+$/.test(e))e=yc(e);else if(e=t.localeData().monthsParse(e),!yh(e))return t;return n=Math.min(t.date(),hu(t.year(),e)),t._d["set"+(t._isUTC?"UTC":"")+"Month"](e,n),t}function yu(t){return null!=t?(vu(this,t),gh.updateOffset(this,!0),this):bc(this,"Month")}function Cu(){return hu(this.year(),this.month())}function bu(t){return this._monthsParseExact?(wh(this,"_monthsRegex")||Eu.call(this),t?this._monthsShortStrictRegex:this._monthsShortRegex):(wh(this,"_monthsShortRegex")||(this._monthsShortRegex=gu),this._monthsShortStrictRegex&&t?this._monthsShortStrictRegex:this._monthsShortRegex)}function Su(t){return this._monthsParseExact?(wh(this,"_monthsRegex")||Eu.call(this),t?this._monthsStrictRegex:this._monthsRegex):(wh(this,"_monthsRegex")||(this._monthsRegex=fu),this._monthsStrictRegex&&t?this._monthsStrictRegex:this._monthsRegex)}function Eu(){function t(t,e){return e.length-t.length}var e,n,o=[],i=[],r=[];for(e=0;e<12;e++)n=Eh([2e3,e]),o.push(this.monthsShort(n,"")),i.push(this.months(n,"")),r.push(this.months(n,"")),r.push(this.monthsShort(n,""));for(o.sort(t),i.sort(t),r.sort(t),e=0;e<12;e++)o[e]=Qc(o[e]),i[e]=Qc(i[e]);for(e=0;e<24;e++)r[e]=Qc(r[e]);this._monthsRegex=new RegExp("^("+r.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+i.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+o.join("|")+")","i")}function Ru(t){return Ac(t)?366:365}qh("Y",0,0,(function(){var t=this.year();return t<=9999?zh(t,4):"+"+t})),qh(0,["YY",2],0,(function(){return this.year()%100})),qh(0,["YYYY",4],0,"year"),qh(0,["YYYYY",5],0,"year"),qh(0,["YYYYYY",6,!0],0,"year"),dc("year","y"),pc("year",1),Yc("Y",Vc),Yc("YY",Hc,kc),Yc("YYYY",_c,Ic),Yc("YYYYY",Bc,Oc),Yc("YYYYYY",Bc,Oc),Xc(["YYYYY","YYYYYY"],$c),Xc("YYYY",(function(t,e){e[$c]=2===t.length?gh.parseTwoDigitYear(t):yc(t)})),Xc("YY",(function(t,e){e[$c]=gh.parseTwoDigitYear(t)})),Xc("Y",(function(t,e){e[$c]=parseInt(t,10)})),gh.parseTwoDigitYear=function(t){return yc(t)+(yc(t)>68?1900:2e3)};var Mu=Cc("FullYear",!0);function Tu(){return Ac(this.year())}function ku(t,e,n,o,i,r,s){var a;return t<100&&t>=0?(a=new Date(t+400,e,n,o,i,r,s),isFinite(a.getFullYear())&&a.setFullYear(t)):a=new Date(t,e,n,o,i,r,s),a}function xu(t){var e,n;return t<100&&t>=0?(n=Array.prototype.slice.call(arguments),n[0]=t+400,e=new Date(Date.UTC.apply(null,n)),isFinite(e.getUTCFullYear())&&e.setUTCFullYear(t)):e=new Date(Date.UTC.apply(null,arguments)),e}function Iu(t,e,n){var o=7+e-n,i=(7+xu(t,0,o).getUTCDay()-e)%7;return-i+o-1}function Ou(t,e,n,o,i){var r,s,a=(7+n-o)%7,l=Iu(t,o,i),h=1+7*(e-1)+a+l;return h<=0?(r=t-1,s=Ru(r)+h):h>Ru(t)?(r=t+1,s=h-Ru(t)):(r=t,s=h),{year:r,dayOfYear:s}}function Hu(t,e,n){var o,i,r=Iu(t.year(),e,n),s=Math.floor((t.dayOfYear()-r-1)/7)+1;return s<1?(i=t.year()-1,o=s+Du(i,e,n)):s>Du(t.year(),e,n)?(o=s-Du(t.year(),e,n),i=t.year()+1):(i=t.year(),o=s),{week:o,year:i}}function Du(t,e,n){var o=Iu(t,e,n),i=Iu(t+1,e,n);return(Ru(t)-o+i)/7}function Nu(t){return Hu(t,this._week.dow,this._week.doy).week}qh("w",["ww",2],"wo","week"),qh("W",["WW",2],"Wo","isoWeek"),dc("week","w"),dc("isoWeek","W"),pc("week",5),pc("isoWeek",5),Yc("w",Hc),Yc("ww",Hc,kc),Yc("W",Hc),Yc("WW",Hc,kc),qc(["w","ww","W","WW"],(function(t,e,n,o){e[o.substr(0,1)]=yc(t)}));var Pu={dow:0,doy:6};function _u(){return this._week.dow}function Bu(){return this._week.doy}function Lu(t){var e=this.localeData().week(this);return null==t?e:this.add(7*(t-e),"d")}function Vu(t){var e=Hu(this,1,4).week;return null==t?e:this.add(7*(t-e),"d")}function Wu(t,e){return"string"!=typeof t?t:isNaN(t)?(t=e.weekdaysParse(t),"number"==typeof t?t:null):parseInt(t,10)}function Fu(t,e){return"string"==typeof t?e.weekdaysParse(t)%7||7:isNaN(t)?null:t}function ju(t,e){return t.slice(e,7).concat(t.slice(0,e))}qh("d",0,"do","day"),qh("dd",0,0,(function(t){return this.localeData().weekdaysMin(this,t)})),qh("ddd",0,0,(function(t){return this.localeData().weekdaysShort(this,t)})),qh("dddd",0,0,(function(t){return this.localeData().weekdays(this,t)})),qh("e",0,0,"weekday"),qh("E",0,0,"isoWeekday"),dc("day","d"),dc("weekday","e"),dc("isoWeekday","E"),pc("day",11),pc("weekday",11),pc("isoWeekday",11),Yc("d",Hc),Yc("e",Hc),Yc("E",Hc),Yc("dd",(function(t,e){return e.weekdaysMinRegex(t)})),Yc("ddd",(function(t,e){return e.weekdaysShortRegex(t)})),Yc("dddd",(function(t,e){return e.weekdaysRegex(t)})),qc(["dd","ddd","dddd"],(function(t,e,n,o){var i=n._locale.weekdaysParse(t,o,n._strict);null!=i?e.d=i:Mh(n).invalidWeekday=t})),qc(["d","e","E"],(function(t,e,n,o){e[o]=yc(t)}));var Uu="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),Yu="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),zu="Su_Mo_Tu_We_Th_Fr_Sa".split("_"),Gu=Uc,Qu=Uc,Ku=Uc;function Xu(t,e){var n=mh(this._weekdays)?this._weekdays:this._weekdays[t&&!0!==t&&this._weekdays.isFormat.test(e)?"format":"standalone"];return!0===t?ju(n,this._week.dow):t?n[t.day()]:n}function qu(t){return!0===t?ju(this._weekdaysShort,this._week.dow):t?this._weekdaysShort[t.day()]:this._weekdaysShort}function Zu(t){return!0===t?ju(this._weekdaysMin,this._week.dow):t?this._weekdaysMin[t.day()]:this._weekdaysMin}function Ju(t,e,n){var o,i,r,s=t.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],o=0;o<7;++o)r=Eh([2e3,1]).day(o),this._minWeekdaysParse[o]=this.weekdaysMin(r,"").toLocaleLowerCase(),this._shortWeekdaysParse[o]=this.weekdaysShort(r,"").toLocaleLowerCase(),this._weekdaysParse[o]=this.weekdays(r,"").toLocaleLowerCase();return n?"dddd"===e?(i=Jc.call(this._weekdaysParse,s),-1!==i?i:null):"ddd"===e?(i=Jc.call(this._shortWeekdaysParse,s),-1!==i?i:null):(i=Jc.call(this._minWeekdaysParse,s),-1!==i?i:null):"dddd"===e?(i=Jc.call(this._weekdaysParse,s),-1!==i||(i=Jc.call(this._shortWeekdaysParse,s),-1!==i)?i:(i=Jc.call(this._minWeekdaysParse,s),-1!==i?i:null)):"ddd"===e?(i=Jc.call(this._shortWeekdaysParse,s),-1!==i||(i=Jc.call(this._weekdaysParse,s),-1!==i)?i:(i=Jc.call(this._minWeekdaysParse,s),-1!==i?i:null)):(i=Jc.call(this._minWeekdaysParse,s),-1!==i||(i=Jc.call(this._weekdaysParse,s),-1!==i)?i:(i=Jc.call(this._shortWeekdaysParse,s),-1!==i?i:null))}function $u(t,e,n){var o,i,r;if(this._weekdaysParseExact)return Ju.call(this,t,e,n);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),o=0;o<7;o++){if(i=Eh([2e3,1]).day(o),n&&!this._fullWeekdaysParse[o]&&(this._fullWeekdaysParse[o]=new RegExp("^"+this.weekdays(i,"").replace(".","\\.?")+"$","i"),this._shortWeekdaysParse[o]=new RegExp("^"+this.weekdaysShort(i,"").replace(".","\\.?")+"$","i"),this._minWeekdaysParse[o]=new RegExp("^"+this.weekdaysMin(i,"").replace(".","\\.?")+"$","i")),this._weekdaysParse[o]||(r="^"+this.weekdays(i,"")+"|^"+this.weekdaysShort(i,"")+"|^"+this.weekdaysMin(i,""),this._weekdaysParse[o]=new RegExp(r.replace(".",""),"i")),n&&"dddd"===e&&this._fullWeekdaysParse[o].test(t))return o;if(n&&"ddd"===e&&this._shortWeekdaysParse[o].test(t))return o;if(n&&"dd"===e&&this._minWeekdaysParse[o].test(t))return o;if(!n&&this._weekdaysParse[o].test(t))return o}}function td(t){if(!this.isValid())return null!=t?this:NaN;var e=this._isUTC?this._d.getUTCDay():this._d.getDay();return null!=t?(t=Wu(t,this.localeData()),this.add(t-e,"d")):e}function ed(t){if(!this.isValid())return null!=t?this:NaN;var e=(this.day()+7-this.localeData()._week.dow)%7;return null==t?e:this.add(t-e,"d")}function nd(t){if(!this.isValid())return null!=t?this:NaN;if(null!=t){var e=Fu(t,this.localeData());return this.day(this.day()%7?e:e-7)}return this.day()||7}function od(t){return this._weekdaysParseExact?(wh(this,"_weekdaysRegex")||sd.call(this),t?this._weekdaysStrictRegex:this._weekdaysRegex):(wh(this,"_weekdaysRegex")||(this._weekdaysRegex=Gu),this._weekdaysStrictRegex&&t?this._weekdaysStrictRegex:this._weekdaysRegex)}function id(t){return this._weekdaysParseExact?(wh(this,"_weekdaysRegex")||sd.call(this),t?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(wh(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=Qu),this._weekdaysShortStrictRegex&&t?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)}function rd(t){return this._weekdaysParseExact?(wh(this,"_weekdaysRegex")||sd.call(this),t?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(wh(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=Ku),this._weekdaysMinStrictRegex&&t?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)}function sd(){function t(t,e){return e.length-t.length}var e,n,o,i,r,s=[],a=[],l=[],h=[];for(e=0;e<7;e++)n=Eh([2e3,1]).day(e),o=Qc(this.weekdaysMin(n,"")),i=Qc(this.weekdaysShort(n,"")),r=Qc(this.weekdays(n,"")),s.push(o),a.push(i),l.push(r),h.push(o),h.push(i),h.push(r);s.sort(t),a.sort(t),l.sort(t),h.sort(t),this._weekdaysRegex=new RegExp("^("+h.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+l.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+a.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+s.join("|")+")","i")}function ad(){return this.hours()%12||12}function ld(){return this.hours()||24}function hd(t,e){qh(t,0,0,(function(){return this.localeData().meridiem(this.hours(),this.minutes(),e)}))}function cd(t,e){return e._meridiemParse}function ud(t){return"p"===(t+"").toLowerCase().charAt(0)}qh("H",["HH",2],0,"hour"),qh("h",["hh",2],0,ad),qh("k",["kk",2],0,ld),qh("hmm",0,0,(function(){return""+ad.apply(this)+zh(this.minutes(),2)})),qh("hmmss",0,0,(function(){return""+ad.apply(this)+zh(this.minutes(),2)+zh(this.seconds(),2)})),qh("Hmm",0,0,(function(){return""+this.hours()+zh(this.minutes(),2)})),qh("Hmmss",0,0,(function(){return""+this.hours()+zh(this.minutes(),2)+zh(this.seconds(),2)})),hd("a",!0),hd("A",!1),dc("hour","h"),pc("hour",13),Yc("a",cd),Yc("A",cd),Yc("H",Hc),Yc("h",Hc),Yc("k",Hc),Yc("HH",Hc,kc),Yc("hh",Hc,kc),Yc("kk",Hc,kc),Yc("hmm",Dc),Yc("hmmss",Nc),Yc("Hmm",Dc),Yc("Hmmss",Nc),Xc(["H","HH"],nu),Xc(["k","kk"],(function(t,e,n){var o=yc(t);e[nu]=24===o?0:o})),Xc(["a","A"],(function(t,e,n){n._isPm=n._locale.isPM(t),n._meridiem=t})),Xc(["h","hh"],(function(t,e,n){e[nu]=yc(t),Mh(n).bigHour=!0})),Xc("hmm",(function(t,e,n){var o=t.length-2;e[nu]=yc(t.substr(0,o)),e[ou]=yc(t.substr(o)),Mh(n).bigHour=!0})),Xc("hmmss",(function(t,e,n){var o=t.length-4,i=t.length-2;e[nu]=yc(t.substr(0,o)),e[ou]=yc(t.substr(o,2)),e[iu]=yc(t.substr(i)),Mh(n).bigHour=!0})),Xc("Hmm",(function(t,e,n){var o=t.length-2;e[nu]=yc(t.substr(0,o)),e[ou]=yc(t.substr(o))})),Xc("Hmmss",(function(t,e,n){var o=t.length-4,i=t.length-2;e[nu]=yc(t.substr(0,o)),e[ou]=yc(t.substr(o,2)),e[iu]=yc(t.substr(i))}));var dd=/[ap]\.?m?\.?/i,gd=Cc("Hours",!0);function fd(t,e,n){return t>11?n?"pm":"PM":n?"am":"AM"}var md,pd={calendar:Uh,longDateFormat:ec,invalidDate:oc,ordinal:rc,dayOfMonthOrdinalParse:sc,relativeTime:lc,months:cu,monthsShort:uu,week:Pu,weekdays:Uu,weekdaysMin:zu,weekdaysShort:Yu,meridiemParse:dd},wd={},Ad={};function vd(t,e){var n,o=Math.min(t.length,e.length);for(n=0;n<o;n+=1)if(t[n]!==e[n])return n;return o}function yd(t){return t&&t.toLowerCase().replace("_","-")}function Cd(t){for(var e,n,o,i,r=0;r<t.length;){for(i=yd(t[r]).split("-"),e=i.length,n=yd(t[r+1]),n=n?n.split("-"):null;e>0;){if(o=Sd(i.slice(0,e).join("-")),o)return o;if(n&&n.length>=e&&vd(i,n)>=e-1)break;e--}r++}return md}function bd(t){return null!=t.match("^[^/\\\\]*$")}function Sd(e){var n=null;if(void 0===wd[e]&&t&&t.exports&&bd(e))try{n=md._abbr,void 0,Object(function(){var t=new Error("Cannot find module 'undefined'");throw t.code="MODULE_NOT_FOUND",t}()),Ed(n)}catch(o){wd[e]=null}return wd[e]}function Ed(t,e){var n;return t&&(n=vh(e)?Td(t):Rd(t,e),n?md=n:"undefined"!=typeof console&&console.warn&&console.warn("Locale "+t+" not found. Did you forget to load it?")),md._abbr}function Rd(t,e){if(null!==e){var n,o=pd;if(e.abbr=t,null!=wd[t])Lh("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),o=wd[t]._config;else if(null!=e.parentLocale)if(null!=wd[e.parentLocale])o=wd[e.parentLocale]._config;else{if(n=Sd(e.parentLocale),null==n)return Ad[e.parentLocale]||(Ad[e.parentLocale]=[]),Ad[e.parentLocale].push({name:t,config:e}),null;o=n._config}return wd[t]=new jh(Fh(o,e)),Ad[t]&&Ad[t].forEach((function(t){Rd(t.name,t.config)})),Ed(t),wd[t]}return delete wd[t],null}function Md(t,e){if(null!=e){var n,o,i=pd;null!=wd[t]&&null!=wd[t].parentLocale?wd[t].set(Fh(wd[t]._config,e)):(o=Sd(t),null!=o&&(i=o._config),e=Fh(i,e),null==o&&(e.abbr=t),n=new jh(e),n.parentLocale=wd[t],wd[t]=n),Ed(t)}else null!=wd[t]&&(null!=wd[t].parentLocale?(wd[t]=wd[t].parentLocale,t===Ed()&&Ed(t)):null!=wd[t]&&delete wd[t]);return wd[t]}function Td(t){var e;if(t&&t._locale&&t._locale._abbr&&(t=t._locale._abbr),!t)return md;if(!mh(t)){if(e=Sd(t),e)return e;t=[t]}return Cd(t)}function kd(){return _h(wd)}function xd(t){var e,n=t._a;return n&&-2===Mh(t).overflow&&(e=n[tu]<0||n[tu]>11?tu:n[eu]<1||n[eu]>hu(n[$c],n[tu])?eu:n[nu]<0||n[nu]>24||24===n[nu]&&(0!==n[ou]||0!==n[iu]||0!==n[ru])?nu:n[ou]<0||n[ou]>59?ou:n[iu]<0||n[iu]>59?iu:n[ru]<0||n[ru]>999?ru:-1,Mh(t)._overflowDayOfYear&&(e<$c||e>eu)&&(e=eu),Mh(t)._overflowWeeks&&-1===e&&(e=su),Mh(t)._overflowWeekday&&-1===e&&(e=au),Mh(t).overflow=e),t}var Id=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,Od=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d|))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,Hd=/Z|[+-]\d\d(?::?\d\d)?/,Dd=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/],["YYYYMM",/\d{6}/,!1],["YYYY",/\d{4}/,!1]],Nd=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],Pd=/^\/?Date\((-?\d+)/i,_d=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/,Bd={UT:0,GMT:0,EDT:-240,EST:-300,CDT:-300,CST:-360,MDT:-360,MST:-420,PDT:-420,PST:-480};function Ld(t){var e,n,o,i,r,s,a=t._i,l=Id.exec(a)||Od.exec(a),h=Dd.length,c=Nd.length;if(l){for(Mh(t).iso=!0,e=0,n=h;e<n;e++)if(Dd[e][1].exec(l[1])){i=Dd[e][0],o=!1!==Dd[e][2];break}if(null==i)return void(t._isValid=!1);if(l[3]){for(e=0,n=c;e<n;e++)if(Nd[e][1].exec(l[3])){r=(l[2]||" ")+Nd[e][0];break}if(null==r)return void(t._isValid=!1)}if(!o&&null!=r)return void(t._isValid=!1);if(l[4]){if(!Hd.exec(l[4]))return void(t._isValid=!1);s="Z"}t._f=i+(r||"")+(s||""),qd(t)}else t._isValid=!1}function Vd(t,e,n,o,i,r){var s=[Wd(t),uu.indexOf(e),parseInt(n,10),parseInt(o,10),parseInt(i,10)];return r&&s.push(parseInt(r,10)),s}function Wd(t){var e=parseInt(t,10);return e<=49?2e3+e:e<=999?1900+e:e}function Fd(t){return t.replace(/\([^()]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function jd(t,e,n){if(t){var o=Yu.indexOf(t),i=new Date(e[0],e[1],e[2]).getDay();if(o!==i)return Mh(n).weekdayMismatch=!0,n._isValid=!1,!1}return!0}function Ud(t,e,n){if(t)return Bd[t];if(e)return 0;var o=parseInt(n,10),i=o%100,r=(o-i)/100;return 60*r+i}function Yd(t){var e,n=_d.exec(Fd(t._i));if(n){if(e=Vd(n[4],n[3],n[2],n[5],n[6],n[7]),!jd(n[1],e,t))return;t._a=e,t._tzm=Ud(n[8],n[9],n[10]),t._d=xu.apply(null,t._a),t._d.setUTCMinutes(t._d.getUTCMinutes()-t._tzm),Mh(t).rfc2822=!0}else t._isValid=!1}function zd(t){var e=Pd.exec(t._i);null===e?(Ld(t),!1===t._isValid&&(delete t._isValid,Yd(t),!1===t._isValid&&(delete t._isValid,t._strict?t._isValid=!1:gh.createFromInputFallback(t)))):t._d=new Date(+e[1])}function Gd(t,e,n){return null!=t?t:null!=e?e:n}function Qd(t){var e=new Date(gh.now());return t._useUTC?[e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate()]:[e.getFullYear(),e.getMonth(),e.getDate()]}function Kd(t){var e,n,o,i,r,s=[];if(!t._d){for(o=Qd(t),t._w&&null==t._a[eu]&&null==t._a[tu]&&Xd(t),null!=t._dayOfYear&&(r=Gd(t._a[$c],o[$c]),(t._dayOfYear>Ru(r)||0===t._dayOfYear)&&(Mh(t)._overflowDayOfYear=!0),n=xu(r,0,t._dayOfYear),t._a[tu]=n.getUTCMonth(),t._a[eu]=n.getUTCDate()),e=0;e<3&&null==t._a[e];++e)t._a[e]=s[e]=o[e];for(;e<7;e++)t._a[e]=s[e]=null==t._a[e]?2===e?1:0:t._a[e];24===t._a[nu]&&0===t._a[ou]&&0===t._a[iu]&&0===t._a[ru]&&(t._nextDay=!0,t._a[nu]=0),t._d=(t._useUTC?xu:ku).apply(null,s),i=t._useUTC?t._d.getUTCDay():t._d.getDay(),null!=t._tzm&&t._d.setUTCMinutes(t._d.getUTCMinutes()-t._tzm),t._nextDay&&(t._a[nu]=24),t._w&&"undefined"!=typeof t._w.d&&t._w.d!==i&&(Mh(t).weekdayMismatch=!0)}}function Xd(t){var e,n,o,i,r,s,a,l,h;e=t._w,null!=e.GG||null!=e.W||null!=e.E?(r=1,s=4,n=Gd(e.GG,t._a[$c],Hu(ig(),1,4).year),o=Gd(e.W,1),i=Gd(e.E,1),(i<1||i>7)&&(l=!0)):(r=t._locale._week.dow,s=t._locale._week.doy,h=Hu(ig(),r,s),n=Gd(e.gg,t._a[$c],h.year),o=Gd(e.w,h.week),null!=e.d?(i=e.d,(i<0||i>6)&&(l=!0)):null!=e.e?(i=e.e+r,(e.e<0||e.e>6)&&(l=!0)):i=r),o<1||o>Du(n,r,s)?Mh(t)._overflowWeeks=!0:null!=l?Mh(t)._overflowWeekday=!0:(a=Ou(n,o,i,r,s),t._a[$c]=a.year,t._dayOfYear=a.dayOfYear)}function qd(t){if(t._f!==gh.ISO_8601)if(t._f!==gh.RFC_2822){t._a=[],Mh(t).empty=!0;var e,n,o,i,r,s,a,l=""+t._i,h=l.length,c=0;for(o=tc(t._f,t._locale).match(Gh)||[],a=o.length,e=0;e<a;e++)i=o[e],n=(l.match(zc(i,t))||[])[0],n&&(r=l.substr(0,l.indexOf(n)),r.length>0&&Mh(t).unusedInput.push(r),l=l.slice(l.indexOf(n)+n.length),c+=n.length),Xh[i]?(n?Mh(t).empty=!1:Mh(t).unusedTokens.push(i),Zc(i,n,t)):t._strict&&!n&&Mh(t).unusedTokens.push(i);Mh(t).charsLeftOver=h-c,l.length>0&&Mh(t).unusedInput.push(l),t._a[nu]<=12&&!0===Mh(t).bigHour&&t._a[nu]>0&&(Mh(t).bigHour=void 0),Mh(t).parsedDateParts=t._a.slice(0),Mh(t).meridiem=t._meridiem,t._a[nu]=Zd(t._locale,t._a[nu],t._meridiem),s=Mh(t).era,null!==s&&(t._a[$c]=t._locale.erasConvertYear(s,t._a[$c])),Kd(t),xd(t)}else Yd(t);else Ld(t)}function Zd(t,e,n){var o;return null==n?e:null!=t.meridiemHour?t.meridiemHour(e,n):(null!=t.isPM&&(o=t.isPM(n),o&&e<12&&(e+=12),!o&&12===e&&(e=0)),e)}function Jd(t){var e,n,o,i,r,s,a=!1,l=t._f.length;if(0===l)return Mh(t).invalidFormat=!0,void(t._d=new Date(NaN));for(i=0;i<l;i++)r=0,s=!1,e=Oh({},t),null!=t._useUTC&&(e._useUTC=t._useUTC),e._f=t._f[i],qd(e),Th(e)&&(s=!0),r+=Mh(e).charsLeftOver,r+=10*Mh(e).unusedTokens.length,Mh(e).score=r,a?r<o&&(o=r,n=e):(null==o||r<o||s)&&(o=r,n=e,s&&(a=!0));Sh(t,n||e)}function $d(t){if(!t._d){var e=fc(t._i),n=void 0===e.day?e.date:e.day;t._a=bh([e.year,e.month,n,e.hour,e.minute,e.second,e.millisecond],(function(t){return t&&parseInt(t,10)})),Kd(t)}}function tg(t){var e=new Hh(xd(eg(t)));return e._nextDay&&(e.add(1,"d"),e._nextDay=void 0),e}function eg(t){var e=t._i,n=t._f;return t._locale=t._locale||Td(t._l),null===e||void 0===n&&""===e?kh({nullInput:!0}):("string"==typeof e&&(t._i=e=t._locale.preparse(e)),Dh(e)?new Hh(xd(e)):(Ch(e)?t._d=e:mh(n)?Jd(t):n?qd(t):ng(t),Th(t)||(t._d=null),t))}function ng(t){var e=t._i;vh(e)?t._d=new Date(gh.now()):Ch(e)?t._d=new Date(e.valueOf()):"string"==typeof e?zd(t):mh(e)?(t._a=bh(e.slice(0),(function(t){return parseInt(t,10)})),Kd(t)):ph(e)?$d(t):yh(e)?t._d=new Date(e):gh.createFromInputFallback(t)}function og(t,e,n,o,i){var r={};return(!0===e||!1===e)&&(o=e,e=void 0),(!0===n||!1===n)&&(o=n,n=void 0),(ph(t)&&Ah(t)||mh(t)&&0===t.length)&&(t=void 0),r._isAMomentObject=!0,r._useUTC=r._isUTC=i,r._l=n,r._i=t,r._f=e,r._strict=o,tg(r)}function ig(t,e,n,o){return og(t,e,n,o,!1)}gh.createFromInputFallback=Ph("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",(function(t){t._d=new Date(t._i+(t._useUTC?" UTC":""))})),gh.ISO_8601=function(){},gh.RFC_2822=function(){};var rg=Ph("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",(function(){var t=ig.apply(null,arguments);return this.isValid()&&t.isValid()?t<this?this:t:kh()})),sg=Ph("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",(function(){var t=ig.apply(null,arguments);return this.isValid()&&t.isValid()?t>this?this:t:kh()}));function ag(t,e){var n,o;if(1===e.length&&mh(e[0])&&(e=e[0]),!e.length)return ig();for(n=e[0],o=1;o<e.length;++o)(!e[o].isValid()||e[o][t](n))&&(n=e[o]);return n}function lg(){var t=[].slice.call(arguments,0);return ag("isBefore",t)}function hg(){var t=[].slice.call(arguments,0);return ag("isAfter",t)}var cg=function(){return Date.now?Date.now():+new Date},ug=["year","quarter","month","week","day","hour","minute","second","millisecond"];function dg(t){var e,n,o=!1,i=ug.length;for(e in t)if(wh(t,e)&&(-1===Jc.call(ug,e)||null!=t[e]&&isNaN(t[e])))return!1;for(n=0;n<i;++n)if(t[ug[n]]){if(o)return!1;parseFloat(t[ug[n]])!==yc(t[ug[n]])&&(o=!0)}return!0}function gg(){return this._isValid}function fg(){return Bg(NaN)}function mg(t){var e=fc(t),n=e.year||0,o=e.quarter||0,i=e.month||0,r=e.week||e.isoWeek||0,s=e.day||0,a=e.hour||0,l=e.minute||0,h=e.second||0,c=e.millisecond||0;this._isValid=dg(e),this._milliseconds=+c+1e3*h+6e4*l+1e3*a*60*60,this._days=+s+7*r,this._months=+i+3*o+12*n,this._data={},this._locale=Td(),this._bubble()}function pg(t){return t instanceof mg}function wg(t){return t<0?-1*Math.round(-1*t):Math.round(t)}function Ag(t,e,n){var o,i=Math.min(t.length,e.length),r=Math.abs(t.length-e.length),s=0;for(o=0;o<i;o++)(n&&t[o]!==e[o]||!n&&yc(t[o])!==yc(e[o]))&&s++;return s+r}function vg(t,e){qh(t,0,0,(function(){var t=this.utcOffset(),n="+";return t<0&&(t=-t,n="-"),n+zh(~~(t/60),2)+e+zh(~~t%60,2)}))}vg("Z",":"),vg("ZZ",""),Yc("Z",Fc),Yc("ZZ",Fc),Xc(["Z","ZZ"],(function(t,e,n){n._useUTC=!0,n._tzm=Cg(Fc,t)}));var yg=/([\+\-]|\d\d)/gi;function Cg(t,e){var n,o,i,r=(e||"").match(t);return null===r?null:(n=r[r.length-1]||[],o=(n+"").match(yg)||["-",0,0],i=60*o[1]+yc(o[2]),0===i?0:"+"===o[0]?i:-i)}function bg(t,e){var n,o;return e._isUTC?(n=e.clone(),o=(Dh(t)||Ch(t)?t.valueOf():ig(t).valueOf())-n.valueOf(),n._d.setTime(n._d.valueOf()+o),gh.updateOffset(n,!1),n):ig(t).local()}function Sg(t){return-Math.round(t._d.getTimezoneOffset())}function Eg(t,e,n){var o,i=this._offset||0;if(!this.isValid())return null!=t?this:NaN;if(null!=t){if("string"==typeof t){if(t=Cg(Fc,t),null===t)return this}else Math.abs(t)<16&&!n&&(t*=60);return!this._isUTC&&e&&(o=Sg(this)),this._offset=t,this._isUTC=!0,null!=o&&this.add(o,"m"),i!==t&&(!e||this._changeInProgress?jg(this,Bg(t-i,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,gh.updateOffset(this,!0),this._changeInProgress=null)),this}return this._isUTC?i:Sg(this)}function Rg(t,e){return null!=t?("string"!=typeof t&&(t=-t),this.utcOffset(t,e),this):-this.utcOffset()}function Mg(t){return this.utcOffset(0,t)}function Tg(t){return this._isUTC&&(this.utcOffset(0,t),this._isUTC=!1,t&&this.subtract(Sg(this),"m")),this}function kg(){if(null!=this._tzm)this.utcOffset(this._tzm,!1,!0);else if("string"==typeof this._i){var t=Cg(Wc,this._i);null!=t?this.utcOffset(t):this.utcOffset(0,!0)}return this}function xg(t){return!!this.isValid()&&(t=t?ig(t).utcOffset():0,(this.utcOffset()-t)%60===0)}function Ig(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function Og(){if(!vh(this._isDSTShifted))return this._isDSTShifted;var t,e={};return Oh(e,this),e=eg(e),e._a?(t=e._isUTC?Eh(e._a):ig(e._a),this._isDSTShifted=this.isValid()&&Ag(e._a,t.toArray())>0):this._isDSTShifted=!1,this._isDSTShifted}function Hg(){return!!this.isValid()&&!this._isUTC}function Dg(){return!!this.isValid()&&this._isUTC}function Ng(){return!!this.isValid()&&(this._isUTC&&0===this._offset)}gh.updateOffset=function(){};var Pg=/^(-|\+)?(?:(\d*)[. ])?(\d+):(\d+)(?::(\d+)(\.\d*)?)?$/,_g=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function Bg(t,e){var n,o,i,r=t,s=null;return pg(t)?r={ms:t._milliseconds,d:t._days,M:t._months}:yh(t)||!isNaN(+t)?(r={},e?r[e]=+t:r.milliseconds=+t):(s=Pg.exec(t))?(n="-"===s[1]?-1:1,r={y:0,d:yc(s[eu])*n,h:yc(s[nu])*n,m:yc(s[ou])*n,s:yc(s[iu])*n,ms:yc(wg(1e3*s[ru]))*n}):(s=_g.exec(t))?(n="-"===s[1]?-1:1,r={y:Lg(s[2],n),M:Lg(s[3],n),w:Lg(s[4],n),d:Lg(s[5],n),h:Lg(s[6],n),m:Lg(s[7],n),s:Lg(s[8],n)}):null==r?r={}:"object"==typeof r&&("from"in r||"to"in r)&&(i=Wg(ig(r.from),ig(r.to)),r={},r.ms=i.milliseconds,r.M=i.months),o=new mg(r),pg(t)&&wh(t,"_locale")&&(o._locale=t._locale),pg(t)&&wh(t,"_isValid")&&(o._isValid=t._isValid),o}function Lg(t,e){var n=t&&parseFloat(t.replace(",","."));return(isNaN(n)?0:n)*e}function Vg(t,e){var n={};return n.months=e.month()-t.month()+12*(e.year()-t.year()),t.clone().add(n.months,"M").isAfter(e)&&--n.months,n.milliseconds=+e-+t.clone().add(n.months,"M"),n}function Wg(t,e){var n;return t.isValid()&&e.isValid()?(e=bg(e,t),t.isBefore(e)?n=Vg(t,e):(n=Vg(e,t),n.milliseconds=-n.milliseconds,n.months=-n.months),n):{milliseconds:0,months:0}}function Fg(t,e){return function(n,o){var i,r;return null!==o&&!isNaN(+o)&&(Lh(e,"moment()."+e+"(period, number) is deprecated. Please use moment()."+e+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),r=n,n=o,o=r),i=Bg(n,o),jg(this,i,t),this}}function jg(t,e,n,o){var i=e._milliseconds,r=wg(e._days),s=wg(e._months);t.isValid()&&(o=null==o||o,s&&vu(t,bc(t,"Month")+s*n),r&&Sc(t,"Date",bc(t,"Date")+r*n),i&&t._d.setTime(t._d.valueOf()+i*n),o&&gh.updateOffset(t,r||s))}Bg.fn=mg.prototype,Bg.invalid=fg;var Ug=Fg(1,"add"),Yg=Fg(-1,"subtract");function zg(t){return"string"==typeof t||t instanceof String}function Gg(t){return Dh(t)||Ch(t)||zg(t)||yh(t)||Kg(t)||Qg(t)||null===t||void 0===t}function Qg(t){var e,n,o=ph(t)&&!Ah(t),i=!1,r=["years","year","y","months","month","M","days","day","d","dates","date","D","hours","hour","h","minutes","minute","m","seconds","second","s","milliseconds","millisecond","ms"],s=r.length;for(e=0;e<s;e+=1)n=r[e],i=i||wh(t,n);return o&&i}function Kg(t){var e=mh(t),n=!1;return e&&(n=0===t.filter((function(e){return!yh(e)&&zg(t)})).length),e&&n}function Xg(t){var e,n,o=ph(t)&&!Ah(t),i=!1,r=["sameDay","nextDay","lastDay","nextWeek","lastWeek","sameElse"];for(e=0;e<r.length;e+=1)n=r[e],i=i||wh(t,n);return o&&i}function qg(t,e){var n=t.diff(e,"days",!0);return n<-6?"sameElse":n<-1?"lastWeek":n<0?"lastDay":n<1?"sameDay":n<2?"nextDay":n<7?"nextWeek":"sameElse"}function Zg(t,e){1===arguments.length&&(arguments[0]?Gg(arguments[0])?(t=arguments[0],e=void 0):Xg(arguments[0])&&(e=arguments[0],t=void 0):(t=void 0,e=void 0));var n=t||ig(),o=bg(n,this).startOf("day"),i=gh.calendarFormat(this,o)||"sameElse",r=e&&(Vh(e[i])?e[i].call(this,n):e[i]);return this.format(r||this.localeData().calendar(i,this,ig(n)))}function Jg(){return new Hh(this)}function $g(t,e){var n=Dh(t)?t:ig(t);return!(!this.isValid()||!n.isValid())&&(e=gc(e)||"millisecond","millisecond"===e?this.valueOf()>n.valueOf():n.valueOf()<this.clone().startOf(e).valueOf())}function tf(t,e){var n=Dh(t)?t:ig(t);return!(!this.isValid()||!n.isValid())&&(e=gc(e)||"millisecond","millisecond"===e?this.valueOf()<n.valueOf():this.clone().endOf(e).valueOf()<n.valueOf())}function ef(t,e,n,o){var i=Dh(t)?t:ig(t),r=Dh(e)?e:ig(e);return!!(this.isValid()&&i.isValid()&&r.isValid())&&(o=o||"()",("("===o[0]?this.isAfter(i,n):!this.isBefore(i,n))&&(")"===o[1]?this.isBefore(r,n):!this.isAfter(r,n)))}function nf(t,e){var n,o=Dh(t)?t:ig(t);return!(!this.isValid()||!o.isValid())&&(e=gc(e)||"millisecond","millisecond"===e?this.valueOf()===o.valueOf():(n=o.valueOf(),this.clone().startOf(e).valueOf()<=n&&n<=this.clone().endOf(e).valueOf()))}function of(t,e){return this.isSame(t,e)||this.isAfter(t,e)}function rf(t,e){return this.isSame(t,e)||this.isBefore(t,e)}function sf(t,e,n){var o,i,r;if(!this.isValid())return NaN;if(o=bg(t,this),!o.isValid())return NaN;switch(i=6e4*(o.utcOffset()-this.utcOffset()),e=gc(e),e){case"year":r=af(this,o)/12;break;case"month":r=af(this,o);break;case"quarter":r=af(this,o)/3;break;case"second":r=(this-o)/1e3;break;case"minute":r=(this-o)/6e4;break;case"hour":r=(this-o)/36e5;break;case"day":r=(this-o-i)/864e5;break;case"week":r=(this-o-i)/6048e5;break;default:r=this-o}return n?r:vc(r)}function af(t,e){if(t.date()<e.date())return-af(e,t);var n,o,i=12*(e.year()-t.year())+(e.month()-t.month()),r=t.clone().add(i,"months");return e-r<0?(n=t.clone().add(i-1,"months"),o=(e-r)/(r-n)):(n=t.clone().add(i+1,"months"),o=(e-r)/(n-r)),-(i+o)||0}function lf(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function hf(t){if(!this.isValid())return null;var e=!0!==t,n=e?this.clone().utc():this;return n.year()<0||n.year()>9999?$h(n,e?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ"):Vh(Date.prototype.toISOString)?e?this.toDate().toISOString():new Date(this.valueOf()+60*this.utcOffset()*1e3).toISOString().replace("Z",$h(n,"Z")):$h(n,e?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ")}function cf(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var t,e,n,o,i="moment",r="";return this.isLocal()||(i=0===this.utcOffset()?"moment.utc":"moment.parseZone",r="Z"),t="["+i+'("]',e=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY",n="-MM-DD[T]HH:mm:ss.SSS",o=r+'[")]',this.format(t+e+n+o)}function uf(t){t||(t=this.isUtc()?gh.defaultFormatUtc:gh.defaultFormat);var e=$h(this,t);return this.localeData().postformat(e)}function df(t,e){return this.isValid()&&(Dh(t)&&t.isValid()||ig(t).isValid())?Bg({to:this,from:t}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()}function gf(t){return this.from(ig(),t)}function ff(t,e){return this.isValid()&&(Dh(t)&&t.isValid()||ig(t).isValid())?Bg({from:this,to:t}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()}function mf(t){return this.to(ig(),t)}function pf(t){var e;return void 0===t?this._locale._abbr:(e=Td(t),null!=e&&(this._locale=e),this)}gh.defaultFormat="YYYY-MM-DDTHH:mm:ssZ",gh.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";var wf=Ph("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",(function(t){return void 0===t?this.localeData():this.locale(t)}));function Af(){return this._locale}var vf=1e3,yf=60*vf,Cf=60*yf,bf=3506328*Cf;function Sf(t,e){return(t%e+e)%e}function Ef(t,e,n){return t<100&&t>=0?new Date(t+400,e,n)-bf:new Date(t,e,n).valueOf()}function Rf(t,e,n){return t<100&&t>=0?Date.UTC(t+400,e,n)-bf:Date.UTC(t,e,n)}function Mf(t){var e,n;if(t=gc(t),void 0===t||"millisecond"===t||!this.isValid())return this;switch(n=this._isUTC?Rf:Ef,t){case"year":e=n(this.year(),0,1);break;case"quarter":e=n(this.year(),this.month()-this.month()%3,1);break;case"month":e=n(this.year(),this.month(),1);break;case"week":e=n(this.year(),this.month(),this.date()-this.weekday());break;case"isoWeek":e=n(this.year(),this.month(),this.date()-(this.isoWeekday()-1));break;case"day":case"date":e=n(this.year(),this.month(),this.date());break;case"hour":e=this._d.valueOf(),e-=Sf(e+(this._isUTC?0:this.utcOffset()*yf),Cf);break;case"minute":e=this._d.valueOf(),e-=Sf(e,yf);break;case"second":e=this._d.valueOf(),e-=Sf(e,vf);break}return this._d.setTime(e),gh.updateOffset(this,!0),this}function Tf(t){var e,n;if(t=gc(t),void 0===t||"millisecond"===t||!this.isValid())return this;switch(n=this._isUTC?Rf:Ef,t){case"year":e=n(this.year()+1,0,1)-1;break;case"quarter":e=n(this.year(),this.month()-this.month()%3+3,1)-1;break;case"month":e=n(this.year(),this.month()+1,1)-1;break;case"week":e=n(this.year(),this.month(),this.date()-this.weekday()+7)-1;break;case"isoWeek":e=n(this.year(),this.month(),this.date()-(this.isoWeekday()-1)+7)-1;break;case"day":case"date":e=n(this.year(),this.month(),this.date()+1)-1;break;case"hour":e=this._d.valueOf(),e+=Cf-Sf(e+(this._isUTC?0:this.utcOffset()*yf),Cf)-1;break;case"minute":e=this._d.valueOf(),e+=yf-Sf(e,yf)-1;break;case"second":e=this._d.valueOf(),e+=vf-Sf(e,vf)-1;break}return this._d.setTime(e),gh.updateOffset(this,!0),this}function kf(){return this._d.valueOf()-6e4*(this._offset||0)}function xf(){return Math.floor(this.valueOf()/1e3)}function If(){return new Date(this.valueOf())}function Of(){var t=this;return[t.year(),t.month(),t.date(),t.hour(),t.minute(),t.second(),t.millisecond()]}function Hf(){var t=this;return{years:t.year(),months:t.month(),date:t.date(),hours:t.hours(),minutes:t.minutes(),seconds:t.seconds(),milliseconds:t.milliseconds()}}function Df(){return this.isValid()?this.toISOString():null}function Nf(){return Th(this)}function Pf(){return Sh({},Mh(this))}function _f(){return Mh(this).overflow}function Bf(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}}function Lf(t,e){var n,o,i,r=this._eras||Td("en")._eras;for(n=0,o=r.length;n<o;++n){switch(typeof r[n].since){case"string":i=gh(r[n].since).startOf("day"),r[n].since=i.valueOf();break}switch(typeof r[n].until){case"undefined":r[n].until=1/0;break;case"string":i=gh(r[n].until).startOf("day").valueOf(),r[n].until=i.valueOf();break}}return r}function Vf(t,e,n){var o,i,r,s,a,l=this.eras();for(t=t.toUpperCase(),o=0,i=l.length;o<i;++o)if(r=l[o].name.toUpperCase(),s=l[o].abbr.toUpperCase(),a=l[o].narrow.toUpperCase(),n)switch(e){case"N":case"NN":case"NNN":if(s===t)return l[o];break;case"NNNN":if(r===t)return l[o];break;case"NNNNN":if(a===t)return l[o];break}else if([r,s,a].indexOf(t)>=0)return l[o]}function Wf(t,e){var n=t.since<=t.until?1:-1;return void 0===e?gh(t.since).year():gh(t.since).year()+(e-t.offset)*n}function Ff(){var t,e,n,o=this.localeData().eras();for(t=0,e=o.length;t<e;++t)if(n=this.clone().startOf("day").valueOf(),o[t].since<=n&&n<=o[t].until||o[t].until<=n&&n<=o[t].since)return o[t].name;return""}function jf(){var t,e,n,o=this.localeData().eras();for(t=0,e=o.length;t<e;++t)if(n=this.clone().startOf("day").valueOf(),o[t].since<=n&&n<=o[t].until||o[t].until<=n&&n<=o[t].since)return o[t].narrow;return""}function Uf(){var t,e,n,o=this.localeData().eras();for(t=0,e=o.length;t<e;++t)if(n=this.clone().startOf("day").valueOf(),o[t].since<=n&&n<=o[t].until||o[t].until<=n&&n<=o[t].since)return o[t].abbr;return""}function Yf(){var t,e,n,o,i=this.localeData().eras();for(t=0,e=i.length;t<e;++t)if(n=i[t].since<=i[t].until?1:-1,o=this.clone().startOf("day").valueOf(),i[t].since<=o&&o<=i[t].until||i[t].until<=o&&o<=i[t].since)return(this.year()-gh(i[t].since).year())*n+i[t].offset;return this.year()}function zf(t){return wh(this,"_erasNameRegex")||Jf.call(this),t?this._erasNameRegex:this._erasRegex}function Gf(t){return wh(this,"_erasAbbrRegex")||Jf.call(this),t?this._erasAbbrRegex:this._erasRegex}function Qf(t){return wh(this,"_erasNarrowRegex")||Jf.call(this),t?this._erasNarrowRegex:this._erasRegex}function Kf(t,e){return e.erasAbbrRegex(t)}function Xf(t,e){return e.erasNameRegex(t)}function qf(t,e){return e.erasNarrowRegex(t)}function Zf(t,e){return e._eraYearOrdinalRegex||Lc}function Jf(){var t,e,n=[],o=[],i=[],r=[],s=this.eras();for(t=0,e=s.length;t<e;++t)o.push(Qc(s[t].name)),n.push(Qc(s[t].abbr)),i.push(Qc(s[t].narrow)),r.push(Qc(s[t].name)),r.push(Qc(s[t].abbr)),r.push(Qc(s[t].narrow));this._erasRegex=new RegExp("^("+r.join("|")+")","i"),this._erasNameRegex=new RegExp("^("+o.join("|")+")","i"),this._erasAbbrRegex=new RegExp("^("+n.join("|")+")","i"),this._erasNarrowRegex=new RegExp("^("+i.join("|")+")","i")}function $f(t,e){qh(0,[t,t.length],0,e)}function tm(t){return sm.call(this,t,this.week(),this.weekday(),this.localeData()._week.dow,this.localeData()._week.doy)}function em(t){return sm.call(this,t,this.isoWeek(),this.isoWeekday(),1,4)}function nm(){return Du(this.year(),1,4)}function om(){return Du(this.isoWeekYear(),1,4)}function im(){var t=this.localeData()._week;return Du(this.year(),t.dow,t.doy)}function rm(){var t=this.localeData()._week;return Du(this.weekYear(),t.dow,t.doy)}function sm(t,e,n,o,i){var r;return null==t?Hu(this,o,i).year:(r=Du(t,o,i),e>r&&(e=r),am.call(this,t,e,n,o,i))}function am(t,e,n,o,i){var r=Ou(t,e,n,o,i),s=xu(r.year,0,r.dayOfYear);return this.year(s.getUTCFullYear()),this.month(s.getUTCMonth()),this.date(s.getUTCDate()),this}function lm(t){return null==t?Math.ceil((this.month()+1)/3):this.month(3*(t-1)+this.month()%3)}qh("N",0,0,"eraAbbr"),qh("NN",0,0,"eraAbbr"),qh("NNN",0,0,"eraAbbr"),qh("NNNN",0,0,"eraName"),qh("NNNNN",0,0,"eraNarrow"),qh("y",["y",1],"yo","eraYear"),qh("y",["yy",2],0,"eraYear"),qh("y",["yyy",3],0,"eraYear"),qh("y",["yyyy",4],0,"eraYear"),Yc("N",Kf),Yc("NN",Kf),Yc("NNN",Kf),Yc("NNNN",Xf),Yc("NNNNN",qf),Xc(["N","NN","NNN","NNNN","NNNNN"],(function(t,e,n,o){var i=n._locale.erasParse(t,o,n._strict);i?Mh(n).era=i:Mh(n).invalidEra=t})),Yc("y",Lc),Yc("yy",Lc),Yc("yyy",Lc),Yc("yyyy",Lc),Yc("yo",Zf),Xc(["y","yy","yyy","yyyy"],$c),Xc(["yo"],(function(t,e,n,o){var i;n._locale._eraYearOrdinalRegex&&(i=t.match(n._locale._eraYearOrdinalRegex)),n._locale.eraYearOrdinalParse?e[$c]=n._locale.eraYearOrdinalParse(t,i):e[$c]=parseInt(t,10)})),qh(0,["gg",2],0,(function(){return this.weekYear()%100})),qh(0,["GG",2],0,(function(){return this.isoWeekYear()%100})),$f("gggg","weekYear"),$f("ggggg","weekYear"),$f("GGGG","isoWeekYear"),$f("GGGGG","isoWeekYear"),dc("weekYear","gg"),dc("isoWeekYear","GG"),pc("weekYear",1),pc("isoWeekYear",1),Yc("G",Vc),Yc("g",Vc),Yc("GG",Hc,kc),Yc("gg",Hc,kc),Yc("GGGG",_c,Ic),Yc("gggg",_c,Ic),Yc("GGGGG",Bc,Oc),Yc("ggggg",Bc,Oc),qc(["gggg","ggggg","GGGG","GGGGG"],(function(t,e,n,o){e[o.substr(0,2)]=yc(t)})),qc(["gg","GG"],(function(t,e,n,o){e[o]=gh.parseTwoDigitYear(t)})),qh("Q",0,"Qo","quarter"),dc("quarter","Q"),pc("quarter",7),Yc("Q",Tc),Xc("Q",(function(t,e){e[tu]=3*(yc(t)-1)})),qh("D",["DD",2],"Do","date"),dc("date","D"),pc("date",9),Yc("D",Hc),Yc("DD",Hc,kc),Yc("Do",(function(t,e){return t?e._dayOfMonthOrdinalParse||e._ordinalParse:e._dayOfMonthOrdinalParseLenient})),Xc(["D","DD"],eu),Xc("Do",(function(t,e){e[eu]=yc(t.match(Hc)[0])}));var hm=Cc("Date",!0);function cm(t){var e=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return null==t?e:this.add(t-e,"d")}qh("DDD",["DDDD",3],"DDDo","dayOfYear"),dc("dayOfYear","DDD"),pc("dayOfYear",4),Yc("DDD",Pc),Yc("DDDD",xc),Xc(["DDD","DDDD"],(function(t,e,n){n._dayOfYear=yc(t)})),qh("m",["mm",2],0,"minute"),dc("minute","m"),pc("minute",14),Yc("m",Hc),Yc("mm",Hc,kc),Xc(["m","mm"],ou);var um=Cc("Minutes",!1);qh("s",["ss",2],0,"second"),dc("second","s"),pc("second",15),Yc("s",Hc),Yc("ss",Hc,kc),Xc(["s","ss"],iu);var dm,gm,fm=Cc("Seconds",!1);for(qh("S",0,0,(function(){return~~(this.millisecond()/100)})),qh(0,["SS",2],0,(function(){return~~(this.millisecond()/10)})),qh(0,["SSS",3],0,"millisecond"),qh(0,["SSSS",4],0,(function(){return 10*this.millisecond()})),qh(0,["SSSSS",5],0,(function(){return 100*this.millisecond()})),qh(0,["SSSSSS",6],0,(function(){return 1e3*this.millisecond()})),qh(0,["SSSSSSS",7],0,(function(){return 1e4*this.millisecond()})),qh(0,["SSSSSSSS",8],0,(function(){return 1e5*this.millisecond()})),qh(0,["SSSSSSSSS",9],0,(function(){return 1e6*this.millisecond()})),dc("millisecond","ms"),pc("millisecond",16),Yc("S",Pc,Tc),Yc("SS",Pc,kc),Yc("SSS",Pc,xc),dm="SSSS";dm.length<=9;dm+="S")Yc(dm,Lc);function mm(t,e){e[ru]=yc(1e3*("0."+t))}for(dm="S";dm.length<=9;dm+="S")Xc(dm,mm);function pm(){return this._isUTC?"UTC":""}function wm(){return this._isUTC?"Coordinated Universal Time":""}gm=Cc("Milliseconds",!1),qh("z",0,0,"zoneAbbr"),qh("zz",0,0,"zoneName");var Am=Hh.prototype;function vm(t){return ig(1e3*t)}function ym(){return ig.apply(null,arguments).parseZone()}function Cm(t){return t}Am.add=Ug,Am.calendar=Zg,Am.clone=Jg,Am.diff=sf,Am.endOf=Tf,Am.format=uf,Am.from=df,Am.fromNow=gf,Am.to=ff,Am.toNow=mf,Am.get=Ec,Am.invalidAt=_f,Am.isAfter=$g,Am.isBefore=tf,Am.isBetween=ef,Am.isSame=nf,Am.isSameOrAfter=of,Am.isSameOrBefore=rf,Am.isValid=Nf,Am.lang=wf,Am.locale=pf,Am.localeData=Af,Am.max=sg,Am.min=rg,Am.parsingFlags=Pf,Am.set=Rc,Am.startOf=Mf,Am.subtract=Yg,Am.toArray=Of,Am.toObject=Hf,Am.toDate=If,Am.toISOString=hf,Am.inspect=cf,"undefined"!=typeof Symbol&&null!=Symbol.for&&(Am[Symbol.for("nodejs.util.inspect.custom")]=function(){return"Moment<"+this.format()+">"}),Am.toJSON=Df,Am.toString=lf,Am.unix=xf,Am.valueOf=kf,Am.creationData=Bf,Am.eraName=Ff,Am.eraNarrow=jf,Am.eraAbbr=Uf,Am.eraYear=Yf,Am.year=Mu,Am.isLeapYear=Tu,Am.weekYear=tm,Am.isoWeekYear=em,Am.quarter=Am.quarters=lm,Am.month=yu,Am.daysInMonth=Cu,Am.week=Am.weeks=Lu,Am.isoWeek=Am.isoWeeks=Vu,Am.weeksInYear=im,Am.weeksInWeekYear=rm,Am.isoWeeksInYear=nm,Am.isoWeeksInISOWeekYear=om,Am.date=hm,Am.day=Am.days=td,Am.weekday=ed,Am.isoWeekday=nd,Am.dayOfYear=cm,Am.hour=Am.hours=gd,Am.minute=Am.minutes=um,Am.second=Am.seconds=fm,Am.millisecond=Am.milliseconds=gm,Am.utcOffset=Eg,Am.utc=Mg,Am.local=Tg,Am.parseZone=kg,Am.hasAlignedHourOffset=xg,Am.isDST=Ig,Am.isLocal=Hg,Am.isUtcOffset=Dg,Am.isUtc=Ng,Am.isUTC=Ng,Am.zoneAbbr=pm,Am.zoneName=wm,Am.dates=Ph("dates accessor is deprecated. Use date instead.",hm),Am.months=Ph("months accessor is deprecated. Use month instead",yu),Am.years=Ph("years accessor is deprecated. Use year instead",Mu),Am.zone=Ph("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",Rg),Am.isDSTShifted=Ph("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",Og);var bm=jh.prototype;function Sm(t,e,n,o){var i=Td(),r=Eh().set(o,e);return i[n](r,t)}function Em(t,e,n){if(yh(t)&&(e=t,t=void 0),t=t||"",null!=e)return Sm(t,e,n,"month");var o,i=[];for(o=0;o<12;o++)i[o]=Sm(t,o,n,"month");return i}function Rm(t,e,n,o){"boolean"==typeof t?(yh(e)&&(n=e,e=void 0),e=e||""):(e=t,n=e,t=!1,yh(e)&&(n=e,e=void 0),e=e||"");var i,r=Td(),s=t?r._week.dow:0,a=[];if(null!=n)return Sm(e,(n+s)%7,o,"day");for(i=0;i<7;i++)a[i]=Sm(e,(i+s)%7,o,"day");return a}function Mm(t,e){return Em(t,e,"months")}function Tm(t,e){return Em(t,e,"monthsShort")}function km(t,e,n){return Rm(t,e,n,"weekdays")}function xm(t,e,n){return Rm(t,e,n,"weekdaysShort")}function Im(t,e,n){return Rm(t,e,n,"weekdaysMin")}bm.calendar=Yh,bm.longDateFormat=nc,bm.invalidDate=ic,bm.ordinal=ac,bm.preparse=Cm,bm.postformat=Cm,bm.relativeTime=hc,bm.pastFuture=cc,bm.set=Wh,bm.eras=Lf,bm.erasParse=Vf,bm.erasConvertYear=Wf,bm.erasAbbrRegex=Gf,bm.erasNameRegex=zf,bm.erasNarrowRegex=Qf,bm.months=mu,bm.monthsShort=pu,bm.monthsParse=Au,bm.monthsRegex=Su,bm.monthsShortRegex=bu,bm.week=Nu,bm.firstDayOfYear=Bu,bm.firstDayOfWeek=_u,bm.weekdays=Xu,bm.weekdaysMin=Zu,bm.weekdaysShort=qu,bm.weekdaysParse=$u,bm.weekdaysRegex=od,bm.weekdaysShortRegex=id,bm.weekdaysMinRegex=rd,bm.isPM=ud,bm.meridiem=fd,Ed("en",{eras:[{since:"0001-01-01",until:1/0,offset:1,name:"Anno Domini",narrow:"AD",abbr:"AD"},{since:"0000-12-31",until:-1/0,offset:1,name:"Before Christ",narrow:"BC",abbr:"BC"}],dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(t){var e=t%10,n=1===yc(t%100/10)?"th":1===e?"st":2===e?"nd":3===e?"rd":"th";return t+n}}),gh.lang=Ph("moment.lang is deprecated. Use moment.locale instead.",Ed),gh.langData=Ph("moment.langData is deprecated. Use moment.localeData instead.",Td);var Om=Math.abs;function Hm(){var t=this._data;return this._milliseconds=Om(this._milliseconds),this._days=Om(this._days),this._months=Om(this._months),t.milliseconds=Om(t.milliseconds),t.seconds=Om(t.seconds),t.minutes=Om(t.minutes),t.hours=Om(t.hours),t.months=Om(t.months),t.years=Om(t.years),this}function Dm(t,e,n,o){var i=Bg(e,n);return t._milliseconds+=o*i._milliseconds,t._days+=o*i._days,t._months+=o*i._months,t._bubble()}function Nm(t,e){return Dm(this,t,e,1)}function Pm(t,e){return Dm(this,t,e,-1)}function _m(t){return t<0?Math.floor(t):Math.ceil(t)}function Bm(){var t,e,n,o,i,r=this._milliseconds,s=this._days,a=this._months,l=this._data;return r>=0&&s>=0&&a>=0||r<=0&&s<=0&&a<=0||(r+=864e5*_m(Vm(a)+s),s=0,a=0),l.milliseconds=r%1e3,t=vc(r/1e3),l.seconds=t%60,e=vc(t/60),l.minutes=e%60,n=vc(e/60),l.hours=n%24,s+=vc(n/24),i=vc(Lm(s)),a+=i,s-=_m(Vm(i)),o=vc(a/12),a%=12,l.days=s,l.months=a,l.years=o,this}function Lm(t){return 4800*t/146097}function Vm(t){return 146097*t/4800}function Wm(t){if(!this.isValid())return NaN;var e,n,o=this._milliseconds;if(t=gc(t),"month"===t||"quarter"===t||"year"===t)switch(e=this._days+o/864e5,n=this._months+Lm(e),t){case"month":return n;case"quarter":return n/3;case"year":return n/12}else switch(e=this._days+Math.round(Vm(this._months)),t){case"week":return e/7+o/6048e5;case"day":return e+o/864e5;case"hour":return 24*e+o/36e5;case"minute":return 1440*e+o/6e4;case"second":return 86400*e+o/1e3;case"millisecond":return Math.floor(864e5*e)+o;default:throw new Error("Unknown unit "+t)}}function Fm(){return this.isValid()?this._milliseconds+864e5*this._days+this._months%12*2592e6+31536e6*yc(this._months/12):NaN}function jm(t){return function(){return this.as(t)}}var Um=jm("ms"),Ym=jm("s"),zm=jm("m"),Gm=jm("h"),Qm=jm("d"),Km=jm("w"),Xm=jm("M"),qm=jm("Q"),Zm=jm("y");function Jm(){return Bg(this)}function $m(t){return t=gc(t),this.isValid()?this[t+"s"]():NaN}function tp(t){return function(){return this.isValid()?this._data[t]:NaN}}var ep=tp("milliseconds"),np=tp("seconds"),op=tp("minutes"),ip=tp("hours"),rp=tp("days"),sp=tp("months"),ap=tp("years");function lp(){return vc(this.days()/7)}var hp=Math.round,cp={ss:44,s:45,m:45,h:22,d:26,w:null,M:11};function up(t,e,n,o,i){return i.relativeTime(e||1,!!n,t,o)}function dp(t,e,n,o){var i=Bg(t).abs(),r=hp(i.as("s")),s=hp(i.as("m")),a=hp(i.as("h")),l=hp(i.as("d")),h=hp(i.as("M")),c=hp(i.as("w")),u=hp(i.as("y")),d=r<=n.ss&&["s",r]||r<n.s&&["ss",r]||s<=1&&["m"]||s<n.m&&["mm",s]||a<=1&&["h"]||a<n.h&&["hh",a]||l<=1&&["d"]||l<n.d&&["dd",l];return null!=n.w&&(d=d||c<=1&&["w"]||c<n.w&&["ww",c]),d=d||h<=1&&["M"]||h<n.M&&["MM",h]||u<=1&&["y"]||["yy",u],d[2]=e,d[3]=+t>0,d[4]=o,up.apply(null,d)}function gp(t){return void 0===t?hp:"function"==typeof t&&(hp=t,!0)}function fp(t,e){return void 0!==cp[t]&&(void 0===e?cp[t]:(cp[t]=e,"s"===t&&(cp.ss=e-1),!0))}function mp(t,e){if(!this.isValid())return this.localeData().invalidDate();var n,o,i=!1,r=cp;return"object"==typeof t&&(e=t,t=!1),"boolean"==typeof t&&(i=t),"object"==typeof e&&(r=Object.assign({},cp,e),null!=e.s&&null==e.ss&&(r.ss=e.s-1)),n=this.localeData(),o=dp(this,!i,r,n),i&&(o=n.pastFuture(+this,o)),n.postformat(o)}var pp=Math.abs;function wp(t){return(t>0)-(t<0)||+t}function Ap(){if(!this.isValid())return this.localeData().invalidDate();var t,e,n,o,i,r,s,a,l=pp(this._milliseconds)/1e3,h=pp(this._days),c=pp(this._months),u=this.asSeconds();return u?(t=vc(l/60),e=vc(t/60),l%=60,t%=60,n=vc(c/12),c%=12,o=l?l.toFixed(3).replace(/\.?0+$/,""):"",i=u<0?"-":"",r=wp(this._months)!==wp(u)?"-":"",s=wp(this._days)!==wp(u)?"-":"",a=wp(this._milliseconds)!==wp(u)?"-":"",i+"P"+(n?r+n+"Y":"")+(c?r+c+"M":"")+(h?s+h+"D":"")+(e||t||l?"T":"")+(e?a+e+"H":"")+(t?a+t+"M":"")+(l?a+o+"S":"")):"P0D"}var vp=mg.prototype;function yp(t){const e=t.length;let n=0;for(;n<e;)t[n]=[t[n]],n+=1}function Cp(t,e){const n=e.length;let o=0;for(;o<n;)t.push(e[o]),o+=1}function bp(t){const e=[];if(!t||0===t.length||!t[0]||0===t[0].length)return e;const n=t.length,o=t[0].length;for(let i=0;i<n;i++)for(let n=0;n<o;n++)e[n]||(e[n]=[]),e[n][i]=t[i][n];return e}function Sp(t,e,n,o){let i=-1,r=t,s=n;Array.isArray(t)||(r=Array.from(t));const a=r.length;for(o&&a&&(i+=1,s=r[i]),i+=1;i<a;)s=e(s,r[i],i,r),i+=1;return s}function Ep(t,e){let n=0,o=t;Array.isArray(t)||(o=Array.from(t));const i=o.length,r=[];let s=-1;for(;n<i;){const t=o[n];e(t,n,o)&&(s+=1,r[s]=t),n+=1}return r}function Rp(t,e){let n=0,o=t;Array.isArray(t)||(o=Array.from(t));const i=o.length,r=[];let s=-1;for(;n<i;){const t=o[n];s+=1,r[s]=e(t,n,o),n+=1}return r}function Mp(t,e){let n=0,o=t;Array.isArray(t)||(o=Array.from(t));const i=o.length;for(;n<i&&!1!==e(o[n],n,o);)n+=1;return t}function Tp(t){return Sp(t,((t,e)=>t+e),0)}function kp(t){return Sp(t,((t,e)=>t>e?t:e),Array.isArray(t)?t[0]:void 0)}function xp(t){return Sp(t,((t,e)=>t<e?t:e),Array.isArray(t)?t[0]:void 0)}function Ip(t){return t.length?Tp(t)/t.length:0}function Op(t){return Sp(t,((t,e)=>t.concat(Array.isArray(e)?Op(e):e)),[])}function Hp(t){const e=[];return Mp(t,(t=>{-1===e.indexOf(t)&&e.push(t)})),e}function Dp(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const[o,...i]=[...e];let r=o;return Mp(i,(t=>{r=r.filter((e=>!t.includes(e)))})),r}function Np(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const[o,...i]=[...e];let r=o;return Mp(i,(t=>{r=r.filter((e=>t.includes(e)))})),r}function Pp(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const[o,...i]=[...e],r=new Set(o);return Mp(i,(t=>{Mp(t,(t=>{r.has(t)||r.add(t)}))})),Array.from(r)}function _p(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:" ";return t.split(e)}vp.isValid=gg,vp.abs=Hm,vp.add=Nm,vp.subtract=Pm,vp.as=Wm,vp.asMilliseconds=Um,vp.asSeconds=Ym,vp.asMinutes=zm,vp.asHours=Gm,vp.asDays=Qm,vp.asWeeks=Km,vp.asMonths=Xm,vp.asQuarters=qm,vp.asYears=Zm,vp.valueOf=Fm,vp._bubble=Bm,vp.clone=Jm,vp.get=$m,vp.milliseconds=ep,vp.seconds=np,vp.minutes=op,vp.hours=ip,vp.days=rp,vp.weeks=lp,vp.months=sp,vp.years=ap,vp.humanize=mp,vp.toISOString=Ap,vp.toString=Ap,vp.toJSON=Ap,vp.locale=pf,vp.localeData=Af,vp.toIsoString=Ph("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",Ap),vp.lang=wf,qh("X",0,0,"unix"),qh("x",0,0,"valueOf"),Yc("x",Vc),Yc("X",jc),Xc("X",(function(t,e,n){n._d=new Date(1e3*parseFloat(t))})),Xc("x",(function(t,e,n){n._d=new Date(yc(t))})),//! moment.js
gh.version="2.29.4",fh(ig),gh.fn=Am,gh.min=lg,gh.max=hg,gh.now=cg,gh.utc=Eh,gh.unix=vm,gh.months=Mm,gh.isDate=Ch,gh.locale=Ed,gh.invalid=kh,gh.duration=Bg,gh.isMoment=Dh,gh.weekdays=km,gh.parseZone=ym,gh.localeData=Td,gh.isDuration=pg,gh.monthsShort=Tm,gh.weekdaysMin=Im,gh.defineLocale=Rd,gh.updateLocale=Md,gh.locales=kd,gh.weekdaysShort=xm,gh.normalizeUnits=gc,gh.relativeTimeRounding=gp,gh.relativeTimeThreshold=fp,gh.calendarFormat=qg,gh.prototype=Am,gh.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",TIME_MS:"HH:mm:ss.SSS",WEEK:"GGGG-[W]WW",MONTH:"YYYY-MM"};const Bp=Object.freeze(Object.defineProperty({__proto__:null,arrayAvg:Ip,arrayEach:Mp,arrayFilter:Ep,arrayFlatten:Op,arrayMap:Rp,arrayMax:kp,arrayMin:xp,arrayReduce:Sp,arraySum:Tp,arrayUnique:Hp,extendArray:Cp,getDifferenceOfArrays:Dp,getIntersectionOfArrays:Np,getUnionOfArrays:Pp,pivot:bp,stringToArray:_p,to2dArray:yp},Symbol.toStringTag,{value:"Module"}));function Lp(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),o=1;o<e;o++)n[o-1]=arguments[o];return Sp(t,((t,e,o)=>{const i=e.replace(/\r?\n\s*/g,""),r=n[o]?n[o]:"";return t+i+r}),"").trim()}function Vp(t){let e;switch(typeof t){case"string":case"number":e=`${t}`;break;case"object":e=null===t?"":t.toString();break;case"undefined":e="";break;default:e=t.toString();break}return e}function Wp(t){return"undefined"!=typeof t}function Fp(t){return"undefined"==typeof t}function jp(t){return null===t||""===t||Fp(t)}function Up(t){return"[object RegExp]"===Object.prototype.toString.call(t)}const Yp="length",zp=t=>parseInt(t,16),Gp=t=>parseInt(t,10),Qp=(t,e,n)=>t.substr(e,n),Kp=t=>t.codePointAt(0)-65,Xp=t=>`${t}`.replace(/\-/g,""),qp=t=>zp(Qp(Xp(t),zp("12"),Kp("F")))/(zp(Qp(Xp(t),Kp("B"),~~![][Yp]))||9),Zp=()=>"undefined"!=typeof location&&/^([a-z0-9\-]+\.)?\x68\x61\x6E\x64\x73\x6F\x6E\x74\x61\x62\x6C\x65\x2E\x63\x6F\x6D$/i.test(location.host);let Jp=!1;const $p={invalid:()=>Lp`
    The license key for Handsontable is invalid.\x20
    If you need any help, contact us at support@handsontable.com.`,expired:t=>{let{keyValidityDate:e,hotVersion:n}=t;return Lp`
    The license key for Handsontable expired on ${e}, and is not valid for the installed\x20
    version ${n}. Renew your license key at handsontable.com or downgrade to a version released prior\x20
    to ${e}. If you need any help, contact us at sales@handsontable.com.`},missing:()=>Lp`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'. If you need any help, contact\x20
    us at support@handsontable.com.`,non_commercial:()=>""},tw={invalid:()=>Lp`
    The license key for Handsontable is invalid.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> on how to\x20
    install it properly or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,expired:t=>{let{keyValidityDate:e,hotVersion:n}=t;return Lp`
    The license key for Handsontable expired on ${e}, and is not valid for the installed\x20
    version ${n}. <a href="https://handsontable.com/pricing" target="_blank">Renew</a> your\x20
    license key or downgrade to a version released prior to ${e}. If you need any\x20
    help, contact us at <a href="mailto:sales@handsontable.com">sales@handsontable.com</a>.`},missing:()=>Lp`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> about it in\x20
    the documentation or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,non_commercial:()=>""};function ew(t,e){const n=!jp(t),o="string"==typeof t&&"non-commercial-and-evaluation"===t.toLowerCase(),i="14.1.0";let r,s="invalid",a="invalid";t=Xp(t||"");const l=nw(t);if(n||o||l)if(l){const e=gh("16/01/2024","DD/MM/YYYY"),n=Math.floor(e.toDate().getTime()/864e5),o=qp(t);r=gh(864e5*(o+1),"x").format("MMMM DD, YYYY"),n>o?(s="expired",a="expired"):(s="valid",a="valid")}else o?(s="non_commercial",a="valid"):(s="invalid",a="invalid");else s="missing",a="missing";if(Zp()&&(s="valid",a="valid"),!Jp&&"valid"!==s&&($p[s]({keyValidityDate:r,hotVersion:i})&&console["non_commercial"===s?"info":"warn"]($p[s]({keyValidityDate:r,hotVersion:i})),Jp=!0),"valid"!==a&&e.parentNode&&tw[a]({keyValidityDate:r,hotVersion:i})){const t=document.createElement("div");t.className="hot-display-license-info",t.innerHTML=tw[a]({keyValidityDate:r,hotVersion:i}),e.parentNode.insertBefore(t,e.nextSibling)}}function nw(t){let e=[][Yp],n=e;if(t[Yp]!==Kp("Z"))return!1;for(let o="",i="B<H4P+".split(""),r=Kp(i.shift());r;r=Kp(i.shift()||"A"))--r<""[Yp]?n|=(Gp(`${Gp(zp(o)+(zp(Qp(t,Math.abs(r),2))+[]).padStart(2,"0"))}`)%97||2)>>1:o=Qp(t,r,r?1===i[Yp]?9:8:6);return n===e}const ow=Object.freeze(Object.defineProperty({__proto__:null,_injectProductInfo:ew,isDefined:Wp,isEmpty:jp,isRegExp:Up,isUndefined:Fp,stringify:Vp},Symbol.toStringTag,{value:"Module"}));function iw(t){return t[0].toUpperCase()+t.substr(1)}function rw(){const t=[];for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];let i=n.length;for(;i;){i-=1;const e=Vp(n[i]).toLowerCase();-1===t.indexOf(e)&&t.push(e)}return 1===t.length}function sw(){function t(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return t()+t()+t()+t()}function aw(t){return/^([0-9][0-9]?%$)|(^100%$)/.test(t)}function lw(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return`${t}`.replace(/(?:\\)?\[([^[\]]+)]/g,((t,n)=>"\\"===t.charAt(0)?t.substr(1,t.length-1):void 0===e[n]?"":e[n]))}function hw(t){return cw(`${t}`,{ALLOWED_TAGS:[]})}function cw(t,e){return dh.sanitize(t,e)}const uw=Object.freeze(Object.defineProperty({__proto__:null,equalsIgnoreCase:rw,isPercentValue:aw,randomString:sw,sanitize:cw,stripTags:hw,substitute:lw,toUpperCaseFirst:iw},Symbol.toStringTag,{value:"Module"})),dw=t=>["tabindex",t],gw=()=>["role","treegrid"],fw=()=>["role","presentation"],mw=()=>["role","gridcell"],pw=()=>["role","rowheader"],ww=()=>["role","rowgroup"],Aw=()=>["role","columnheader"],vw=()=>["role","row"],yw=()=>["role","menu"],Cw=()=>["role","menuitem"],bw=()=>["role","combobox"],Sw=()=>["role","listbox"],Ew=()=>["role","option"],Rw=()=>["role","checkbox"],Mw=()=>["scope","col"],Tw=()=>["scope","row"],kw=()=>["type","text"],xw=t=>["aria-label",t],Iw=()=>["aria-hidden","true"],Ow=()=>["aria-disabled","true"],Hw=()=>["aria-multiselectable","true"],Dw=t=>["aria-haspopup",t],Nw=t=>["aria-rowcount",t],Pw=t=>["aria-colcount",t],_w=t=>["aria-rowindex",t],Bw=t=>["aria-colindex",t],Lw=t=>["aria-expanded",t],Vw=t=>["aria-sort",t],Ww=()=>["aria-readonly","true"],Fw=()=>["aria-invalid","true"],jw=t=>["aria-checked",t],Uw=()=>["aria-selected","true"],Yw=()=>["aria-autocomplete","list"],zw=t=>["aria-controls",t],Gw=t=>["aria-activedescendant",t],Qw=t=>["aria-live",t],Kw=t=>["aria-relevant",t],Xw=t=>["aria-setsize",t],qw=t=>["aria-posinset",t];function Zw(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=-1,o=null,i=t;for(;null!==i;){if(n===e){o=i;break}i.host&&i.nodeType===Node.DOCUMENT_FRAGMENT_NODE?i=i.host:(n+=1,i=i.parentNode)}return o}function Jw(t,e){const n=t.closest(".handsontable");return!!n&&(n.parentNode===e||n===e)}function $w(t){return Object.getPrototypeOf(t.parent)&&t.frameElement}function tA(t){return $w(t)&&t.parent}function eA(t){return!!Object.getPrototypeOf(t.parent)}function nA(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0;const{ELEMENT_NODE:o,DOCUMENT_FRAGMENT_NODE:i}=Node;let r=t;for(;null!=r&&r!==n;){const{nodeType:t,nodeName:n}=r;if(t===o&&(e.includes(n)||e.includes(r)))return r;const{host:s}=r;r=s&&t===i?s:r.parentNode}return null}function oA(t,e,n){const o=[];let i=t;for(;i&&(i=nA(i,e,n),i&&(!n||n.contains(i)));)o.push(i),i=i.host&&i.nodeType===Node.DOCUMENT_FRAGMENT_NODE?i.host:i.parentNode;const r=o.length;return r?o[r-1]:null}function iA(t,e){let n=t.parentNode,o=[];for("string"==typeof e?o=t.defaultView?Array.prototype.slice.call(t.querySelectorAll(e),0):Array.prototype.slice.call(t.ownerDocument.querySelectorAll(e),0):o.push(e);null!==n;){if(o.indexOf(n)>-1)return!0;n=n.parentNode}return!1}function rA(t){let e=0,n=t;if(n.previousSibling)for(;n=n.previousSibling;)e+=1;return e}function sA(t,e,n){const o=n.parentElement.querySelector(`.ht_clone_${t}`);return o?o.contains(e):null}function aA(t){return t&&t.length?t.filter((t=>!!t)):[]}function lA(t,e){if(!t||!t.length)return e?{regexFree:[],regexes:[]}:[];const n=[],o=[];return o.push(...t.filter((t=>{const o=t instanceof RegExp;return o&&e&&n.push(t),!o}))),e?{regexFree:o,regexes:n}:o}function hA(t,e){return void 0!==t.classList&&"string"==typeof e&&""!==e&&t.classList.contains(e)}function cA(t,e){"string"==typeof e&&(e=e.split(" ")),e=aA(e),e.length>0&&t.classList.add(...e)}function uA(t,e){"string"==typeof e?e=e.split(" "):e instanceof RegExp&&(e=[e]);let{regexFree:n,regexes:o}=lA(e,!0);n=aA(n),n.length>0&&t.classList.remove(...n),o.forEach((e=>{t.classList.forEach((n=>{e.test(n)&&t.classList.remove(n)}))}))}function dA(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0;Array.isArray(e)||(e=[[e,n]]),e.forEach((e=>{Array.isArray(e)&&""!==e[0]&&t.setAttribute(...e)}))}function gA(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];"string"==typeof e?e=e.split(" "):e instanceof RegExp&&(e=[e]);const{regexFree:n,regexes:o}=lA(e,!0);n.forEach((e=>{""!==e&&t.removeAttribute(e)})),o.forEach((e=>{t.getAttributeNames().forEach((n=>{e.test(n)&&t.removeAttribute(n)}))}))}function fA(t){if(3===t.nodeType)t.parentNode.removeChild(t);else if(["TABLE","THEAD","TBODY","TFOOT","TR"].indexOf(t.nodeName)>-1){const e=t.childNodes;for(let t=e.length-1;t>=0;t--)fA(e[t])}}function mA(t){let e;for(;e=t.lastChild;)t.removeChild(e)}const pA=/(<(.*)>|&(.*);)/;function wA(t,e){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];pA.test(e)?t.innerHTML=n?cw(e):e:AA(t,e)}function AA(t,e){const n=t.firstChild;n&&3===n.nodeType&&null===n.nextSibling?n.textContent=e:(mA(t),t.appendChild(t.ownerDocument.createTextNode(e)))}function vA(t){const e=t.ownerDocument.documentElement;let n=t;for(;n!==e;){if(null===n)return!1;if(n.nodeType===Node.DOCUMENT_FRAGMENT_NODE){if(n.host){if(n.host.impl)return vA(n.host.impl);if(n.host)return vA(n.host);throw new Error("Lost in Web Components world")}return!1}if("none"===xA(n).display)return!1;n=n.parentNode}return!0}function yA(t){const e=t.ownerDocument,n=e.defaultView,o=e.documentElement;let i,r,s,a=t;for(i=a.offsetLeft,r=a.offsetTop,s=a;(a=a.offsetParent)&&a!==e.body&&"offsetLeft"in a;)i+=a.offsetLeft,r+=a.offsetTop,s=a;return s&&"fixed"===s.style.position&&(i+=n.pageXOffset||o.scrollLeft,r+=n.pageYOffset||o.scrollTop),{left:i,top:r}}function CA(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:window).scrollY}function bA(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:window).scrollX}function SA(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window;return t===e?CA(e):t.scrollTop}function EA(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window;return t===e?bA(e):t.scrollLeft}function RA(t){let e=t.ownerDocument,n=e?e.defaultView:void 0;e||(e=t.document?t.document:t,n=e.defaultView);const o=["auto","scroll"];let i=t.parentNode;for(;i&&i.style&&e.body!==i;){let{overflow:t,overflowX:e,overflowY:r}=i.style;if([t,e,r].includes("scroll"))return i;if(({overflow:t,overflowX:e,overflowY:r}=n.getComputedStyle(i)),o.includes(t)||o.includes(e)||o.includes(r)||i.clientHeight<=i.scrollHeight+1&&(o.includes(r)||o.includes(t))||i.clientWidth<=i.scrollWidth+1&&(o.includes(e)||o.includes(t)))return i;i=i.parentNode}return n}function MA(t){const e=t.ownerDocument,n=e.defaultView;let o=t.parentNode;for(;o&&o.style&&e.body!==o;){if("visible"!==o.style.overflow&&""!==o.style.overflow)return o;const t=xA(o,n),e=["scroll","hidden","auto"],i=t.getPropertyValue("overflow"),r=t.getPropertyValue("overflow-y"),s=t.getPropertyValue("overflow-x");if(e.includes(i)||e.includes(r)||e.includes(s))return o;o=o.parentNode}return n}function TA(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:window;if(!t)return;if(t===n)return"width"===e?`${n.innerWidth}px`:"height"===e?`${n.innerHeight}px`:void 0;const o=t.style[e];if(""!==o&&void 0!==o)return o;const i=xA(t,n);return""!==i[e]&&void 0!==i[e]?i[e]:void 0}function kA(t,e){const{selectorText:n}=e;let o=!1;return e.type===CSSRule.STYLE_RULE&&n&&(t.msMatchesSelector?o=t.msMatchesSelector(n):t.matches&&(o=t.matches(n))),o}function xA(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window;return t.currentStyle||e.getComputedStyle(t)}function IA(t){return t.offsetWidth}function OA(t){return t.offsetHeight}function HA(t){return t.clientHeight||t.innerHeight}function DA(t){return t.clientWidth||t.innerWidth}function NA(t,e,n){t.addEventListener(e,n,!1)}function PA(t,e,n){t.removeEventListener(e,n,!1)}function _A(t){return t.selectionStart?t.selectionStart:0}function BA(t){return t.selectionEnd?t.selectionEnd:0}function LA(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window;const e=t.document;let n="";return t.getSelection?n=t.getSelection().toString():e.selection&&"Control"!==e.selection.type&&(n=e.selection.createRange().text),n}function VA(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window;t.getSelection&&(t.getSelection().empty?t.getSelection().empty():t.getSelection().removeAllRanges&&t.getSelection().removeAllRanges())}function WA(t,e,n){if(void 0===n&&(n=e),t.setSelectionRange){t.focus();try{t.setSelectionRange(e,n)}catch(o){const i=t.parentNode,r=i.style.display;i.style.display="block",t.setSelectionRange(e,n),i.style.display=r}}}let FA;function jA(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document;const e=t.createElement("div");e.style.height="200px",e.style.width="100%";const n=t.createElement("div");n.style.boxSizing="content-box",n.style.height="150px",n.style.left="0px",n.style.overflow="hidden",n.style.position="absolute",n.style.top="0px",n.style.width="200px",n.style.visibility="hidden",n.appendChild(e),(t.body||t.documentElement).appendChild(n);const o=e.offsetWidth;n.style.overflow="scroll";let i=e.offsetWidth;return o===i&&(i=n.clientWidth),(t.body||t.documentElement).removeChild(n),o-i}function UA(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document;return void 0===FA&&(FA=jA(t)),FA}function YA(t){return t.offsetWidth!==t.clientWidth}function zA(t){return t.offsetHeight!==t.clientHeight}function GA(t,e,n){t.style.transform=`translate3d(${e},${n},0)`}function QA(t){let e;return t.style.transform&&""!==(e=t.style.transform)?["transform",e]:-1}function KA(t){t.style.transform&&""!==t.style.transform&&(t.style.transform="")}function XA(t){return t&&(["INPUT","SELECT","TEXTAREA"].indexOf(t.nodeName)>-1||"true"===t.contentEditable)}function qA(t){return XA(t)&&!1===t.hasAttribute("data-hot-input")}function ZA(t){const e=t.ownerDocument.activeElement;qA(e)||t.select()}function JA(t){return!t.parentNode}function $A(t,e){new IntersectionObserver(((n,o)=>{n.forEach((n=>{n.isIntersecting&&null!==t.offsetParent&&(e(),o.unobserve(t))}))}),{root:t.ownerDocument.body}).observe(t)}function tv(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const o=t.ownerDocument,i=o.createRange(),r=o.defaultView.getSelection();dA(t,"contenteditable",!0),n&&dA(t,...Iw()),e&&cA(t,"invisibleSelection"),i.selectNodeContents(t),r.removeAllRanges(),r.addRange(i)}function ev(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];const n=t.ownerDocument.defaultView.getSelection();t.hasAttribute("aria-hidden")&&t.removeAttribute("aria-hidden"),n.removeAllRanges(),e&&uA(t,"invisibleSelection"),t.removeAttribute("contenteditable")}function nv(t,e){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];tv(t,n),e(),ev(t,n)}const ov=Object.freeze(Object.defineProperty({__proto__:null,HTML_CHARACTERS:pA,addClass:cA,addEvent:NA,clearTextSelection:VA,closest:nA,closestDown:oA,empty:mA,fastInnerHTML:wA,fastInnerText:AA,getCaretPosition:_A,getComputedStyle:xA,getCssTransform:QA,getFrameElement:$w,getParent:Zw,getParentWindow:tA,getScrollLeft:EA,getScrollTop:SA,getScrollableElement:RA,getScrollbarWidth:UA,getSelectionEndPosition:BA,getSelectionText:LA,getStyle:TA,getTrimmingContainer:MA,getWindowScrollLeft:bA,getWindowScrollTop:CA,hasAccessToParentWindow:eA,hasClass:hA,hasHorizontalScrollbar:zA,hasVerticalScrollbar:YA,index:rA,innerHeight:HA,innerWidth:DA,isChildOf:iA,isDetached:JA,isInput:XA,isOutsideInput:qA,isThisHotChild:Jw,isVisible:vA,makeElementContentEditableAndSelectItsContent:tv,matchesCSSRules:kA,observeVisibilityChangeOnce:$A,offset:yA,outerHeight:OA,outerWidth:IA,overlayContainsElement:sA,removeAttribute:gA,removeClass:uA,removeContentEditableFromElementAndDeselect:ev,removeEvent:PA,removeTextNodes:fA,resetCssTransform:KA,runWithSelectedContendEditableElement:nv,selectElementIfAllowed:ZA,setAttribute:dA,setCaretPosition:WA,setOverlayPosition:GA},Symbol.toStringTag,{value:"Module"}));function iv(t){return"function"==typeof t}function rv(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:200,n=0;const o={lastCallThrottled:!0};let i=null;function r(){for(var r=arguments.length,s=new Array(r),a=0;a<r;a++)s[a]=arguments[a];const l=Date.now();let h=!1;o.lastCallThrottled=!0,n||(n=l,h=!0);const c=e-(l-n);return h?(o.lastCallThrottled=!1,t.apply(this,s)):(i&&clearTimeout(i),i=setTimeout((()=>{o.lastCallThrottled=!1,t.apply(this,s),n=0,i=void 0}),c)),o}return r}function sv(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:200,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10;const o=rv(t,e);let i=n;function r(){i=n}function s(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return i?(i-=1,t.apply(this,n)):o.apply(this,n)}return s.clearHits=r,s}function av(t){let e,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:200,o=null;function i(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return o&&clearTimeout(o),o=setTimeout((()=>{e=t.apply(this,r)}),n),e}return i}function lv(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const[o,...i]=e;return function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return Sp(i,((t,e)=>e(t)),o.apply(this,e))}}function hv(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),o=1;o<e;o++)n[o-1]=arguments[o];return function(){for(var e=arguments.length,o=new Array(e),i=0;i<e;i++)o[i]=arguments[i];return t.apply(this,n.concat(o))}}function cv(t){const e=t.length;function n(o){return function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];const a=o.concat(r);let l;return l=a.length>=e?t.apply(this,a):n(a),l}}return n([])}function uv(t){const e=t.length;function n(o){return function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];const a=o.concat(r.reverse());let l;return l=a.length>=e?t.apply(this,a):n(a),l}}return n([])}function dv(t,e,n,o,i,r,s,a){return Wp(a)?t.call(e,n,o,i,r,s,a):Wp(s)?t.call(e,n,o,i,r,s):Wp(r)?t.call(e,n,o,i,r):Wp(i)?t.call(e,n,o,i):Wp(o)?t.call(e,n,o):Wp(n)?t.call(e,n):t.call(e)}const gv=Object.freeze(Object.defineProperty({__proto__:null,curry:cv,curryRight:uv,debounce:av,fastCall:dv,isFunction:iv,partial:hv,pipe:lv,throttle:rv,throttleAfterHits:sv},Symbol.toStringTag,{value:"Module"}));var fv=F,mv=qi,pv=st,wv=z,Av=ts,vv=fv([].push),yv=function(t){if(pv(t))return t;if(mv(t)){for(var e=t.length,n=[],o=0;o<e;o++){var i=t[o];"string"==typeof i?vv(n,i):("number"==typeof i||"Number"===wv(i)||"String"===wv(i))&&vv(n,Av(i))}var r=n.length,s=!0;return function(t,e){if(s)return s=!1,e;if(mv(this))return e;for(var o=0;o<r;o++)if(n[o]===t)return e}}},Cv=Ki,bv=dt,Sv=vr,Ev=x,Rv=F,Mv=b,Tv=st,kv=Pt,xv=ia,Iv=yv,Ov=Tt,Hv=String,Dv=bv("JSON","stringify"),Nv=Rv(/./.exec),Pv=Rv("".charAt),_v=Rv("".charCodeAt),Bv=Rv("".replace),Lv=Rv(1..toString),Vv=/[\uD800-\uDFFF]/g,Wv=/^[\uD800-\uDBFF]$/,Fv=/^[\uDC00-\uDFFF]$/,jv=!Ov||Mv((function(){var t=bv("Symbol")("stringify detection");return"[null]"!==Dv([t])||"{}"!==Dv({a:t})||"{}"!==Dv(Object(t))})),Uv=Mv((function(){return'"\\udf06\\ud834"'!==Dv("\udf06\ud834")||'"\\udead"'!==Dv("\udead")})),Yv=function(t,e){var n=xv(arguments),o=Iv(e);if(Tv(o)||void 0!==t&&!kv(t))return n[1]=function(t,e){if(Tv(o)&&(e=Ev(o,this,Hv(t),e)),!kv(e))return e},Sv(Dv,null,n)},zv=function(t,e,n){var o=Pv(n,e-1),i=Pv(n,e+1);return Nv(Wv,t)&&!Nv(Fv,i)||Nv(Fv,t)&&!Nv(Wv,o)?"\\u"+Lv(_v(t,0),16):t};function Gv(t){let e;return Array.isArray(t)?e=t.length?new Array(t.length).fill(null):[]:(e={},ny(t,((t,n)=>{"__children"!==n&&(t&&"object"==typeof t&&!Array.isArray(t)?e[n]=Gv(t):Array.isArray(t)?t.length&&"object"==typeof t[0]&&!Array.isArray(t[0])?e[n]=[Gv(t[0])]:e[n]=[]:e[n]=null)}))),e}function Qv(t,e){return e.prototype.constructor=e,t.prototype=new e,t.prototype.constructor=t,t}function Kv(t,e,n){const o=Array.isArray(n);return ny(e,((e,i)=>{(!1===o||n.includes(i))&&(t[i]=e)})),t}function Xv(t,e){ny(e,((n,o)=>{e[o]&&"object"==typeof e[o]?(t[o]||(Array.isArray(e[o])?t[o]=[]:"[object Date]"===Object.prototype.toString.call(e[o])?t[o]=e[o]:t[o]={}),Xv(t[o],e[o])):t[o]=e[o]}))}function qv(t){return"object"==typeof t?JSON.parse(JSON.stringify(t)):t}function Zv(t){const e={};return ny(t,((t,n)=>{e[n]=t})),e}function Jv(t){t.MIXINS||(t.MIXINS=[]);for(var e=arguments.length,n=new Array(e>1?e-1:0),o=1;o<e;o++)n[o-1]=arguments[o];return Mp(n,(e=>{t.MIXINS.push(e.MIXIN_NAME),ny(e,((e,n)=>{if(void 0!==t.prototype[n])throw new Error(`Mixin conflict. Property '${n}' already exist and cannot be overwritten.`);if("function"==typeof e)t.prototype[n]=e;else{const o=function(t,e){const n=`_${t}`,o=t=>{let e=t;return(Array.isArray(e)||ty(e))&&(e=qv(e)),e};return function(){return void 0===this[n]&&(this[n]=o(e)),this[n]}},i=function(t){const e=`_${t}`;return function(t){this[e]=t}};Object.defineProperty(t.prototype,n,{get:o(n,e),set:i(n),configurable:!0})}}))})),t}function $v(t,e){return JSON.stringify(t)===JSON.stringify(e)}function ty(t){return"[object Object]"===Object.prototype.toString.call(t)}function ey(t,e,n,o){o.value=n,o.writable=!1!==o.writable,o.enumerable=!1!==o.enumerable,o.configurable=!1!==o.configurable,Object.defineProperty(t,e,o)}function ny(t,e){for(const n in t)if((!t.hasOwnProperty||t.hasOwnProperty&&Object.prototype.hasOwnProperty.call(t,n))&&!1===e(t[n],n,t))break;return t}function oy(t,e){const n=e.split(".");let o=t;return ny(n,(t=>{if(o=o[t],void 0===o)return o=void 0,!1})),o}function iy(t,e,n){const o=e.split(".");let i=t;o.forEach(((t,e)=>{e!==o.length-1?(ay(i,t)||(i[t]={}),i=i[t]):i[t]=n}))}function ry(t){if(!ty(t))return 0;const e=function(t){let n=0;return ty(t)?ny(t,((t,o)=>{"__children"!==o&&(n+=e(t))})):n+=1,n};return e(t)}function sy(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"value";const n=`_${e}`,o={_touched:!1,[n]:t,isTouched(){return this._touched}};return Object.defineProperty(o,e,{get(){return this[n]},set(t){this._touched=!0,this[n]=t},enumerable:!0,configurable:!0}),o}function ay(t,e){return Object.prototype.hasOwnProperty.call(t,e)}Dv&&Cv({target:"JSON",stat:!0,arity:3,forced:jv||Uv},{stringify:function(t,e,n){var o=xv(arguments),i=Sv(jv?Yv:Dv,null,o);return Uv&&"string"==typeof i?Bv(i,Vv,zv):i}});const ly=Object.freeze(Object.defineProperty({__proto__:null,clone:Zv,createObjectPropListener:sy,deepClone:qv,deepExtend:Xv,deepObjectSize:ry,defineGetter:ey,duckSchema:Gv,extend:Kv,getProperty:oy,hasOwnProperty:ay,inherit:Qv,isObject:ty,isObjectEqual:$v,mixin:Jv,objectEach:ny,setProperty:iy},Symbol.toStringTag,{value:"Module"}));function hy(t){return window.requestAnimationFrame(t)}function cy(t){window.cancelAnimationFrame(t)}function uy(){return"ontouchstart"in window}function dy(){return"undefined"!=typeof window}let gy;function fy(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return gy||(gy="object"==typeof Intl?new Intl.Collator(t,e).compare:"function"==typeof String.prototype.localeCompare?(t,e)=>`${t}`.localeCompare(e):(t,e)=>t===e?0:t>e?-1:1,gy)}const my=Object.freeze(Object.defineProperty({__proto__:null,cancelAnimationFrame:cy,getComparisonFunction:fy,isCSR:dy,isTouchSupported:uy,requestAnimationFrame:hy},Symbol.toStringTag,{value:"Module"})),py=t=>{const e={value:!1,test:(n,o)=>{e.value=t(n,o)}};return e},wy={chrome:py(((t,e)=>/Chrome/.test(t)&&/Google/.test(e))),chromeWebKit:py((t=>/CriOS/.test(t))),edge:py((t=>/Edge/.test(t))),edgeWebKit:py((t=>/EdgiOS/.test(t))),firefox:py((t=>/Firefox/.test(t))),firefoxWebKit:py((t=>/FxiOS/.test(t))),mobile:py((t=>/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(t))),safari:py(((t,e)=>/Safari/.test(t)&&/Apple Computer/.test(e)))},Ay={mac:py((t=>/^Mac/.test(t))),win:py((t=>/^Win/.test(t))),linux:py((t=>/^Linux/.test(t))),ios:py((t=>/iPhone|iPad|iPod/i.test(t)))};function vy(){let{userAgent:t=navigator.userAgent,vendor:e=navigator.vendor}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};ny(wy,(n=>{let{test:o}=n;o(t,e)}))}function yy(){let{platform:t=navigator.platform}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};ny(Ay,(e=>{let{test:n}=e;n(t)}))}function Cy(){return wy.chrome.value}function by(){return wy.chromeWebKit.value}function Sy(){return wy.firefox.value}function Ey(){return wy.firefoxWebKit.value}function Ry(){return wy.safari.value}function My(){return wy.edge.value}function Ty(){return wy.edgeWebKit.value}function ky(){return wy.mobile.value}function xy(){return Ay.ios.value}function Iy(){let{maxTouchPoints:t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:navigator;return t>2&&Ay.mac.value}function Oy(){return Ay.win.value}function Hy(){return Ay.mac.value}function Dy(){return Ay.linux.value}dy()&&(vy(),yy());const Ny=Object.freeze(Object.defineProperty({__proto__:null,isChrome:Cy,isChromeWebKit:by,isEdge:My,isEdgeWebKit:Ty,isFirefox:Sy,isFirefoxWebKit:Ey,isIOS:xy,isIpadOS:Iy,isLinuxOS:Dy,isMacOS:Hy,isMobileBrowser:ky,isSafari:Ry,isWindowsOS:Oy,setBrowserMeta:vy,setPlatformMeta:yy},Symbol.toStringTag,{value:"Module"})),Py={ALT:18,ARROW_DOWN:40,ARROW_LEFT:37,ARROW_RIGHT:39,ARROW_UP:38,AUDIO_DOWN:Sy()?182:174,AUDIO_MUTE:Sy()?181:173,AUDIO_UP:Sy()?183:175,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND_LEFT:91,COMMAND_RIGHT:93,COMMAND_FIREFOX:224,CONTROL:17,DELETE:46,END:35,ENTER:13,ESCAPE:27,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,F13:124,F14:125,F15:126,F16:127,F17:128,F18:129,F19:130,HOME:36,INSERT:45,MEDIA_NEXT:176,MEDIA_PLAY_PAUSE:179,MEDIA_PREV:177,MEDIA_STOP:178,NULL:0,NUM_LOCK:144,PAGE_DOWN:34,PAGE_UP:33,PAUSE:19,PERIOD:190,SCROLL_LOCK:145,SHIFT:16,SPACE:32,TAB:9,A:65,C:67,D:68,F:70,L:76,O:79,P:80,S:83,V:86,X:88,Y:89,Z:90},_y=[Py.ALT,Py.ARROW_DOWN,Py.ARROW_LEFT,Py.ARROW_RIGHT,Py.ARROW_UP,Py.AUDIO_DOWN,Py.AUDIO_MUTE,Py.AUDIO_UP,Py.BACKSPACE,Py.CAPS_LOCK,Py.DELETE,Py.END,Py.ENTER,Py.ESCAPE,Py.F1,Py.F2,Py.F3,Py.F4,Py.F5,Py.F6,Py.F7,Py.F8,Py.F9,Py.F10,Py.F11,Py.F12,Py.F13,Py.F14,Py.F15,Py.F16,Py.F17,Py.F18,Py.F19,Py.HOME,Py.INSERT,Py.MEDIA_NEXT,Py.MEDIA_PLAY_PAUSE,Py.MEDIA_PREV,Py.MEDIA_STOP,Py.NULL,Py.NUM_LOCK,Py.PAGE_DOWN,Py.PAGE_UP,Py.PAUSE,Py.SCROLL_LOCK,Py.SHIFT,Py.TAB];function By(t){return 32===t||t>=48&&t<=57||t>=96&&t<=111||t>=186&&t<=192||t>=219&&t<=222||t>=226||t>=65&&t<=90}function Ly(t){return _y.includes(t)}function Vy(t){const e=[];return Hy()?e.push(Py.COMMAND_LEFT,Py.COMMAND_RIGHT,Py.COMMAND_FIREFOX):e.push(Py.CONTROL),e.includes(t)}function Wy(t){return[Py.CONTROL,Py.COMMAND_LEFT,Py.COMMAND_RIGHT,Py.COMMAND_FIREFOX].includes(t)}function Fy(t,e){const n=e.split("|");let o=!1;return Mp(n,(e=>{if(t===Py[e])return o=!0,!1})),o}const jy=Object.freeze(Object.defineProperty({__proto__:null,KEY_CODES:Py,isCtrlKey:Vy,isCtrlMetaKey:Wy,isFunctionKey:Ly,isKey:Fy,isPrintableChar:By},Symbol.toStringTag,{value:"Module"}));function Uy(t){t.isImmediatePropagationEnabled=!1,t.cancelBubble=!0}function Yy(t){return!1===t.isImmediatePropagationEnabled}function zy(t){return 2===t.button}function Gy(t){return 0===t.button}function Qy(t,e){const n={x:t.offsetX,y:t.offsetY};let o=t.target;if(!(e instanceof HTMLElement)||o!==e&&o.contains(e))return n;for(;o!==e;)n.x+=o.offsetLeft,n.y+=o.offsetTop,o=o.offsetParent;return n}const Ky=Object.freeze(Object.defineProperty({__proto__:null,isImmediatePropagationStopped:Yy,isLeftClick:Gy,isRightClick:zy,offsetRelativeTo:Qy,stopImmediatePropagation:Uy},Symbol.toStringTag,{value:"Module"}));function Xy(){Wp(console)&&console.warn(...arguments)}function qy(){Wp(console)&&console.error(...arguments)}function Zy(t,e,n){return e=Jy(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Jy(t){var e=$y(t,"string");return"symbol"==typeof e?e:String(e)}function $y(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}const tC=["afterCellMetaReset","afterChange","afterContextMenuDefaultOptions","beforeContextMenuSetItems","afterDropdownMenuDefaultOptions","beforeDropdownMenuSetItems","afterContextMenuHide","beforeContextMenuShow","afterContextMenuShow","afterCopyLimit","beforeCreateCol","afterColumnSequenceChange","afterCreateCol","beforeCreateRow","afterCreateRow","afterDeselect","afterDestroy","afterDocumentKeyDown","afterDrawSelection","beforeRemoveCellClassNames","afterGetCellMeta","afterGetColHeader","afterGetRowHeader","afterInit","afterLoadData","afterUpdateData","afterMomentumScroll","afterOnCellCornerMouseDown","afterOnCellCornerDblClick","afterOnCellMouseDown","afterOnCellMouseUp","afterOnCellContextMenu","afterOnCellMouseOver","afterOnCellMouseOut","afterRemoveCol","afterRemoveRow","beforeRenderer","afterRenderer","afterRowSequenceChange","beforeViewportScrollVertically","beforeViewportScrollHorizontally","beforeViewportScroll","afterScrollHorizontally","afterScrollVertically","afterScroll","afterSelection","afterSelectionByProp","afterSelectionEnd","afterSelectionEndByProp","beforeSelectColumns","afterSelectColumns","beforeSelectRows","afterSelectRows","afterSetCellMeta","afterRemoveCellMeta","afterSetDataAtCell","afterSetDataAtRowProp","afterSetSourceDataAtCell","afterUpdateSettings","afterValidate","beforeLanguageChange","afterLanguageChange","beforeAutofill","afterAutofill","beforeCellAlignment","beforeChange","beforeChangeRender","beforeDrawBorders","beforeGetCellMeta","beforeRemoveCellMeta","beforeInit","beforeInitWalkontable","beforeLoadData","beforeUpdateData","beforeKeyDown","beforeOnCellMouseDown","beforeOnCellMouseUp","beforeOnCellContextMenu","beforeOnCellMouseOver","beforeOnCellMouseOut","beforeRemoveCol","beforeRemoveRow","beforeViewRender","afterViewRender","beforeRender","afterRender","beforeRowWrap","beforeColumnWrap","beforeSetCellMeta","beforeSetRangeStartOnly","beforeSetRangeStart","beforeSetRangeEnd","beforeSelectionHighlightSet","beforeTouchScroll","beforeValidate","beforeValueRender","construct","init","modifyColHeader","modifyColWidth","modifyFocusedElement","modifyRowHeader","modifyRowHeight","modifyData","modifySourceData","modifyRowData","modifyGetCellCoords","modifyFocusOnTabNavigation","beforeHighlightingRowHeader","beforeHighlightingColumnHeader","persistentStateLoad","persistentStateReset","persistentStateSave","beforeColumnSort","afterColumnSort","modifyAutofillRange","modifyCopyableRange","beforeCut","afterCut","beforeCopy","afterCopy","beforePaste","afterPaste","beforeColumnFreeze","afterColumnFreeze","beforeColumnMove","afterColumnMove","beforeColumnUnfreeze","afterColumnUnfreeze","beforeRowMove","afterRowMove","beforeColumnResize","afterColumnResize","beforeRowResize","afterRowResize","afterGetColumnHeaderRenderers","afterGetRowHeaderRenderers","beforeStretchingColumnWidth","beforeFilter","afterFilter","afterFormulasValuesUpdate","afterNamedExpressionAdded","afterNamedExpressionRemoved","afterSheetAdded","afterSheetRenamed","afterSheetRemoved","modifyColumnHeaderHeight","modifyColumnHeaderValue","beforeUndo","beforeUndoStackChange","afterUndo","afterUndoStackChange","beforeRedo","beforeRedoStackChange","afterRedo","afterRedoStackChange","modifyRowHeaderWidth","modifyTransformStart","modifyTransformEnd","afterModifyTransformStart","afterModifyTransformEnd","afterViewportRowCalculatorOverride","afterViewportColumnCalculatorOverride","afterPluginsInitialized","beforeHideRows","afterHideRows","beforeUnhideRows","afterUnhideRows","beforeHideColumns","afterHideColumns","beforeUnhideColumns","afterUnhideColumns","beforeTrimRow","afterTrimRow","beforeUntrimRow","afterUntrimRow","beforeDropdownMenuShow","afterDropdownMenuShow","afterDropdownMenuHide","beforeAddChild","afterAddChild","beforeDetachChild","afterDetachChild","afterBeginEditing","beforeMergeCells","afterMergeCells","beforeUnmergeCells","afterUnmergeCells","afterListen","afterUnlisten","afterRefreshDimensions","beforeRefreshDimensions","beforeColumnCollapse","afterColumnCollapse","beforeColumnExpand","afterColumnExpand","modifyAutoColumnSizeSeed"],eC=Lp`The plugin hook "[hookName]" was removed in Handsontable [removedInVersion].\x20
  Please consult release notes https://github.com/handsontable/handsontable/releases/tag/[removedInVersion] to\x20
  learn about the migration path.`,nC=new Map([["modifyRow","8.0.0"],["modifyCol","8.0.0"],["unmodifyRow","8.0.0"],["unmodifyCol","8.0.0"],["skipLengthCache","8.0.0"],["hiddenColumn","8.0.0"],["hiddenRow","8.0.0"]]),oC=new Map([[]]);class iC{static getSingleton(){return sC()}constructor(){Zy(this,"globalBucket",void 0),this.globalBucket=this.createEmptyBucket()}createEmptyBucket(){const t=Object.create(null);return Mp(tC,(e=>t[e]=[])),t}getBucket(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return t?(t.pluginHookBucket||(t.pluginHookBucket=this.createEmptyBucket()),t.pluginHookBucket):this.globalBucket}add(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(Array.isArray(e))Mp(e,(e=>this.add(t,e,n)));else{nC.has(t)&&Xy(lw(eC,{hookName:t,removedInVersion:nC.get(t)})),oC.has(t)&&Xy(oC.get(t));const o=this.getBucket(n);if("undefined"==typeof o[t]&&(this.register(t),o[t]=[]),e.skip=!1,-1===o[t].indexOf(e)){let n=!1;e.initialHook&&Mp(o[t],((i,r)=>{if(i.initialHook)return o[t][r]=e,n=!0,!1})),n||o[t].push(e)}}return this}once(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;Array.isArray(e)?Mp(e,(e=>this.once(t,e,n))):(e.runOnce=!0,this.add(t,e,n))}remove(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;const o=this.getBucket(n);return"undefined"!=typeof o[t]&&o[t].indexOf(e)>=0&&(e.skip=!0,!0)}has(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const n=this.getBucket(e);return!(void 0===n[t]||!n[t].length)}run(t,e,n,o,i,r,s,a){{const l=this.globalBucket[e],h=l?l.length:0;let c=0;if(h)for(;c<h;){if(!l[c]||l[c].skip){c+=1;continue}const h=dv(l[c],t,n,o,i,r,s,a);void 0!==h&&(n=h),l[c]&&l[c].runOnce&&this.remove(e,l[c]),c+=1}}{const l=this.getBucket(t)[e],h=l?l.length:0;let c=0;if(h)for(;c<h;){if(!l[c]||l[c].skip){c+=1;continue}const h=dv(l[c],t,n,o,i,r,s,a);void 0!==h&&(n=h),l[c]&&l[c].runOnce&&this.remove(e,l[c],t),c+=1}}return n}destroy(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;ny(this.getBucket(t),((t,e,n)=>n[e].length=0))}register(t){this.isRegistered(t)||tC.push(t)}deregister(t){this.isRegistered(t)&&tC.splice(tC.indexOf(t),1)}isDeprecated(t){return oC.has(t)||nC.has(t)}isRegistered(t){return tC.indexOf(t)>=0}getRegistered(){return tC}}const rC=new iC;function sC(){return rC}const aC=iC,lC=new Map;function hC(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"common";lC.has(t)||lC.set(t,new Map);const e=lC.get(t);function n(t,n){e.set(t,n)}function o(t){return e.get(t)}function i(t){return e.has(t)}function r(){return[...e.keys()]}function s(){return[...e.values()]}return{register:n,getItem:o,hasItem:i,getNames:r,getValues:s}}const cC=new WeakMap,{register:uC,getItem:dC,hasItem:gC,getNames:fC,getValues:mC}=hC("editors");function pC(t){const e={},n=t;this.getConstructor=function(){return t},this.getInstance=function(t){return t.guid in e||(e[t.guid]=new n(t)),e[t.guid]},aC.getSingleton().add("afterDestroy",(function(){e[this.guid]=null}))}function wC(t,e){let n;if("function"==typeof t)cC.get(t)||vC(null,t),n=cC.get(t);else{if("string"!=typeof t)throw Error('Only strings and functions can be passed as "editor" parameter');n=dC(t)}if(!n)throw Error(`No editor registered under name "${t}"`);return n.getInstance(e)}function AC(t){if("function"==typeof t)return t;if(!gC(t))throw Error(`No registered editor found under "${t}" name`);return dC(t).getConstructor()}function vC(t,e){t&&"string"!=typeof t&&(e=t,t=e.EDITOR_TYPE);const n=new pC(e);"string"==typeof t&&uC(t,n),cC.set(e,n)}function yC(t,e,n){return e=CC(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function CC(t){var e=bC(t,"string");return"symbol"==typeof e?e:String(e)}function bC(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}let SC=0;class EC{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;yC(this,"context",void 0),this.context=t||this,this.context.eventListeners||(this.context.eventListeners=[])}addEventListener(t,e,n){let o=arguments.length>3&&void 0!==arguments[3]&&arguments[3];function i(t){n.call(this,RC(t))}return this.context.eventListeners.push({element:t,event:e,callback:n,callbackProxy:i,options:o,eventManager:this}),t.addEventListener(e,i,o),SC+=1,()=>{this.removeEventListener(t,e,n)}}removeEventListener(t,e,n){let o,i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=this.context.eventListeners.length;for(;r;)if(r-=1,o=this.context.eventListeners[r],o.event===e&&o.element===t){if(n&&n!==o.callback||i&&o.eventManager!==this)continue;this.context.eventListeners.splice(r,1),o.element.removeEventListener(o.event,o.callbackProxy,o.options),SC-=1}}clearEvents(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!this.context)return;let e=this.context.eventListeners.length;for(;e;){e-=1;const n=this.context.eventListeners[e];t&&n.eventManager!==this||(this.context.eventListeners.splice(e,1),n.element.removeEventListener(n.event,n.callbackProxy,n.options),SC-=1)}}clear(){this.clearEvents()}destroy(){this.clearEvents(),this.context=null}destroyWithOwnEventsOnly(){this.clearEvents(!0),this.context=null}fireEvent(t,e){let n=t.document,o=t;n||(n=t.ownerDocument?t.ownerDocument:t,o=n.defaultView);const i={bubbles:!0,cancelable:"mousemove"!==e,view:o,detail:0,screenX:0,screenY:0,clientX:1,clientY:1,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0,relatedTarget:void 0};let r;n.createEvent?(r=n.createEvent("MouseEvents"),r.initMouseEvent(e,i.bubbles,i.cancelable,i.view,i.detail,i.screenX,i.screenY,i.clientX,i.clientY,i.ctrlKey,i.altKey,i.shiftKey,i.metaKey,i.button,n.body.parentNode)):r=n.createEventObject(),t.dispatchEvent?t.dispatchEvent(r):t.fireEvent(`on${e}`,r)}}function RC(t){const e=t.stopImmediatePropagation;return t.stopImmediatePropagation=function(){e.apply(this),Uy(this)},t}const MC=EC;function TC(){return SC}function kC(t,e){xC(t,e),e.add(t)}function xC(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function IC(t,e,n){return e=OC(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function OC(t){var e=HC(t,"string");return"symbol"==typeof e?e:String(e)}function HC(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function DC(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const NC="editorManager.navigation";var PC=new WeakSet,_C=new WeakSet;class BC{constructor(t,e,n){kC(this,_C),kC(this,PC),IC(this,"hot",void 0),IC(this,"tableMeta",void 0),IC(this,"selection",void 0),IC(this,"eventManager",void 0),IC(this,"destroyed",!1),IC(this,"lock",!1),IC(this,"activeEditor",void 0),IC(this,"cellProperties",void 0),this.hot=t,this.tableMeta=e,this.selection=n,this.eventManager=new MC(t),this.hot.addHook("afterDocumentKeyDown",(t=>DC(this,PC,LC).call(this,t))),this.eventManager.addEventListener(this.hot.rootDocument.documentElement,"compositionstart",(t=>{!this.destroyed&&this.hot.isListening()&&this.openEditor("",t)})),this.hot.view._wt.update("onCellDblClick",((t,e,n)=>DC(this,_C,VC).call(this,t,e,n)))}lockEditor(){this.lock=!0}unlockEditor(){this.lock=!1}destroyEditor(t){this.lock||this.closeEditor(t)}getActiveEditor(){return this.activeEditor}prepareEditor(){var t;if(this.lock)return;if(this.activeEditor&&this.activeEditor.isWaiting())return void this.closeEditor(!1,!1,(t=>{t&&this.prepareEditor()}));const e=null===(t=this.hot.getSelectedRangeLast())||void 0===t?void 0:t.highlight;if(!e||e.isHeader())return;const{row:n,col:o}=e,i=this.hot.runHooks("modifyGetCellCoords",n,o);let r=n,s=o;if(Array.isArray(i)&&([r,s]=i),this.cellProperties=this.hot.getCellMeta(r,s),!this.isCellEditable())return void this.clearActiveEditor();const a=this.hot.getCell(n,o,!0);if(a){const t=this.hot.getCellEditor(this.cellProperties),e=this.hot.colToProp(s),i=this.hot.getSourceDataAtCell(this.hot.toPhysicalRow(r),s);this.activeEditor=wC(t,this.hot),this.activeEditor.prepare(n,o,e,a,i,this.cellProperties)}}isEditorOpened(){return this.activeEditor&&this.activeEditor.isOpened()}openEditor(t,e){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.isCellEditable()?(this.activeEditor||(this.hot.scrollToFocusedCell(),this.prepareEditor()),this.activeEditor&&(n&&this.activeEditor.enableFullEditMode(),this.activeEditor.beginEditing(t,e))):this.clearActiveEditor()}closeEditor(t,e,n){this.activeEditor?this.activeEditor.finishEditing(t,e,n):n&&n(!1)}closeEditorAndSaveChanges(t){this.closeEditor(!1,t)}closeEditorAndRestoreOriginalValue(t){this.closeEditor(!0,t)}clearActiveEditor(){this.activeEditor=void 0}isCellEditable(){const t=this.hot.getSelectedRangeLast();if(!t)return!1;const e=this.hot.getCellEditor(this.cellProperties),{row:n,col:o}=t.highlight,{rowIndexMapper:i,columnIndexMapper:r}=this.hot,s=i.isHidden(this.hot.toPhysicalRow(n))||r.isHidden(this.hot.toPhysicalColumn(o));return!(this.cellProperties.readOnly||!e||s)}moveSelectionAfterEnter(t){const e="function"==typeof this.tableMeta.enterMoves?this.tableMeta.enterMoves(event):this.tableMeta.enterMoves;t?this.selection.transformStart(-e.row,-e.col):this.selection.transformStart(e.row,e.col,!0)}destroy(){this.destroyed=!0,this.eventManager.destroy()}}function LC(t){const e=this.hot.getSelectedRangeLast();if(!this.hot.isListening()||!e||e.highlight.isHeader()||Yy(t))return;const{keyCode:n}=t,o=(t.ctrlKey||t.metaKey)&&!t.altKey;if((!this.activeEditor||this.activeEditor&&!this.activeEditor.isWaiting())&&!Ly(n)&&!Wy(n)&&!o&&!this.isEditorOpened()){const e=this.hot.getShortcutManager().getContext("editor"),n={runOnlyIf:()=>Wp(this.hot.getSelected()),group:NC};e.addShortcuts([{keys:[["ArrowUp"]],callback:()=>{this.hot.selection.transformStart(-1,0)}},{keys:[["ArrowDown"]],callback:()=>{this.hot.selection.transformStart(1,0)}},{keys:[["ArrowLeft"]],callback:()=>{this.hot.selection.transformStart(0,-1*this.hot.getDirectionFactor())}},{keys:[["ArrowRight"]],callback:()=>{this.hot.selection.transformStart(0,this.hot.getDirectionFactor())}}],n),this.openEditor("",t)}}function VC(t,e,n){"TD"===n.nodeName&&this.openEditor(null,t,!0)}const WC=new WeakMap;BC.getInstance=function(t,e,n){let o=WC.get(t);return o||(o=new BC(t,e,n),WC.set(t,o)),o};const FC=BC;function jC(t,e){YC(t,e),e.add(t)}function UC(t,e,n){YC(t,e),e.set(t,n)}function YC(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function zC(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function GC(t,e){var n=XC(t,e,"get");return QC(t,n)}function QC(t,e){return e.get?e.get.call(t):e.value}function KC(t,e,n){var o=XC(t,e,"set");return qC(t,o,n),n}function XC(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function qC(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}const ZC=Object.freeze({CELL:"cell",MIXED:"mixed"});var JC=new WeakMap,$C=new WeakMap,tb=new WeakMap,eb=new WeakMap,nb=new WeakMap,ob=new WeakSet,ib=new WeakSet,rb=new WeakSet,sb=new WeakSet;class ab{constructor(t){var e=this;jC(this,sb),jC(this,rb),jC(this,ib),jC(this,ob),UC(this,JC,{writable:!0,value:void 0}),UC(this,$C,{writable:!0,value:void 0}),UC(this,tb,{writable:!0,value:50}),UC(this,eb,{writable:!0,value:null}),UC(this,nb,{writable:!0,value:new Map});const n=t.getSettings();KC(this,JC,t),KC(this,$C,n.imeFastEdit?ZC.MIXED:ZC.CELL),GC(this,JC).addHook("afterUpdateSettings",(function(){for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return zC(e,sb,ub).call(e,...n)})),GC(this,JC).addHook("afterSelection",(function(){for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return zC(e,ib,hb).call(e,...n)})),GC(this,JC).addHook("afterSelectionEnd",(function(){for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return zC(e,rb,cb).call(e,...n)}))}getFocusMode(){return GC(this,$C)}setFocusMode(t){Object.values(ZC).includes(t)?KC(this,$C,t):Xy(`"${t}" is not a valid focus mode.`)}getRefocusDelay(){return GC(this,tb)}setRefocusDelay(t){KC(this,tb,t)}setRefocusElementGetter(t){KC(this,eb,t)}getRefocusElement(){return"function"==typeof GC(this,eb)?GC(this,eb).call(this):null===(t=GC(this,JC).getActiveEditor())||void 0===t?void 0:t.TEXTAREA;var t}focusOnHighlightedCell(t){const e=t=>{var e,n;const o=null===(e=GC(this,JC).getSelectedRangeLast())||void 0===e?void 0:e.highlight;if(!o)return;let i=GC(this,JC).runHooks("modifyFocusedElement",o.row,o.col,t);i instanceof HTMLElement||(i=t),i&&(null===(n=GC(this,JC).getActiveEditor())||void 0===n||!n.isOpened())&&i.focus({preventScroll:!0})};t?e(t):zC(this,ob,lb).call(this,(t=>e(t)))}refocusToEditorTextarea(){var t;let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:GC(this,tb);const n=this.getRefocusElement();GC(this,JC).getSettings().imeFastEdit&&(null===(t=GC(this,JC).getActiveEditor())||void 0===t||!t.isOpened())&&n&&(GC(this,nb).has(e)||GC(this,nb).set(e,av((()=>{n.select()}),e)),GC(this,nb).get(e)())}}function lb(t){var e;const n=null===(e=GC(this,JC).getSelectedRangeLast())||void 0===e?void 0:e.highlight;if(!n||!GC(this,JC).selection.isCellVisible(n))return void t(null);const o=GC(this,JC).getCell(n.row,n.col,!0);null===o?GC(this,JC).addHookOnce("afterScroll",(()=>{t(GC(this,JC).getCell(n.row,n.col,!0))})):t(o)}function hb(){zC(this,ob,lb).call(this,(t=>{const{activeElement:e}=GC(this,JC).rootDocument;e&&qA(e)&&e.blur(),this.focusOnHighlightedCell(t)}))}function cb(){zC(this,ob,lb).call(this,(t=>{this.getFocusMode()===ZC.MIXED&&"TD"===t.nodeName&&this.refocusToEditorTextarea()}))}function ub(t){t.imeFastEdit&&this.getFocusMode()!==ZC.MIXED?this.setFocusMode(ZC.MIXED):!t.imeFastEdit&&this.getFocusMode()!==ZC.CELL&&this.setFocusMode(ZC.CELL)}const db={"&nbsp;":" ","&amp;":"&","&lt;":"<","&gt;":">"},gb=new RegExp(Object.keys(db).map((t=>`(${t})`)).join("|"),"gi");function fb(t){return"TABLE"===(t&&t.nodeName||"")}function mb(t){const e=t.hasColHeaders(),n=t.hasRowHeaders(),o=[e?-1:0,n?-1:0,t.countRows()-1,t.countCols()-1],i=t.getData(...o),r=i.length,s=r>0?i[0].length:0,a=["<table>","</table>"],l=e?["<thead>","</thead>"]:[],h=["<tbody>","</tbody>"],c=n?1:0,u=e?1:0;for(let d=0;d<r;d+=1){const o=e&&0===d,r=[];for(let e=0;e<s;e+=1){const s=!o&&n&&0===e;let a="";if(o)a=`<th>${t.getColHeader(e-c)}</th>`;else if(s)a=`<th>${t.getRowHeader(d-u)}</th>`;else{const n=i[d][e],{hidden:o,rowspan:r,colspan:s}=t.getCellMeta(d-u,e-c);if(!o){const t=[];if(r&&t.push(`rowspan="${r}"`),s&&t.push(`colspan="${s}"`),jp(n))a=`<td ${t.join(" ")}></td>`;else{const e=n.toString().replace("<","&lt;").replace(">","&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,"<br>\r\n").replace(/\x20/gi,"&nbsp;").replace(/\t/gi,"&#9;");a=`<td ${t.join(" ")}>${e}</td>`}}}r.push(a)}const a=["<tr>",...r,"</tr>"].join("");o?l.splice(1,0,a):h.splice(-1,0,a)}return a.splice(1,0,l.join(""),h.join("")),a.join("")}function pb(t){const e=t.length,n=["<table>"];for(let o=0;o<e;o+=1){const i=t[o],r=i.length,s=[];0===o&&n.push("<tbody>");for(let t=0;t<r;t+=1){const e=i[t],n=jp(e)?"":e.toString().replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,"<br>\r\n").replace(/\x20{2,}/gi,(t=>`<span style="mso-spacerun: yes">${"&nbsp;".repeat(t.length-1)} </span>`)).replace(/\t/gi,"&#9;");s.push(`<td>${n}</td>`)}n.push("<tr>",...s,"</tr>"),o+1===e&&n.push("</tbody>")}return n.push("</table>"),n.join("")}function wb(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:document;const n={},o=e.createDocumentFragment(),i=e.createElement("div");o.appendChild(i);let r=t;if("string"==typeof r){const t=r.replace(/<td\b[^>]*?>([\s\S]*?)<\/\s*td>/g,(t=>{const e=t.match(/<td\b[^>]*?>/g)[0],n=t.substring(e.length,t.lastIndexOf("<")).replace(/(<(?!br)([^>]+)>)/gi,"");return`${e}${n}</td>`}));i.insertAdjacentHTML("afterbegin",`${t}`),r=i.querySelector("table")}if(!r||!fb(r))return;const s=i.querySelector('meta[name$="enerator"]'),a=null!==r.querySelector("tbody th"),l=r.querySelector("tr"),h=l?Array.from(l.cells).reduce(((t,e)=>t+e.colSpan),0)-(a?1:0):0,c=r.tFoot&&Array.from(r.tFoot.rows)||[],u=[];let d=!1,g=0,f=0;if(r.tHead){const t=Array.from(r.tHead.rows).filter((t=>{const e=null!==t.querySelector("td");return e&&u.push(t),!e}));g=t.length,d=g>0,g>1?n.nestedHeaders=Array.from(t).reduce(((t,e)=>{const n=Array.from(e.cells).reduce(((t,e,n)=>{if(a&&0===n)return t;const{colSpan:o,innerHTML:i}=e,r=o>1?{label:i,colspan:o}:i;return t.push(r),t}),[]);return t.push(n),t}),[]):d&&(n.colHeaders=Array.from(t[0].children).reduce(((t,e,n)=>(a&&0===n||t.push(e.innerHTML),t)),[]))}u.length&&(n.fixedRowsTop=u.length),c.length&&(n.fixedRowsBottom=c.length);const m=[...u,...Array.from(r.tBodies).reduce(((t,e)=>(t.push(...Array.from(e.rows)),t)),[]),...c];f=m.length;const p=new Array(f);for(let v=0;v<f;v++)p[v]=new Array(h);const w=[],A=[];for(let v=0;v<f;v++){const t=m[v],e=Array.from(t.cells),n=e.length;for(let o=0;o<n;o++){const t=e[o],{nodeName:n,innerHTML:i,rowSpan:r,colSpan:a}=t,l=p[v].findIndex((t=>void 0===t));if("TD"===n){if(r>1||a>1){for(let t=v;t<v+r;t++)if(t<f)for(let e=l;e<l+a;e++)p[t][e]=null;const e=t.getAttribute("style");e&&e.includes("mso-ignore:colspan")||w.push({col:l,row:v,rowspan:r,colspan:a})}let e="";e=s&&/excel/gi.test(s.content)?i.replace(/[\r\n][\x20]{0,2}/g," ").replace(/<br(\s*|\/)>[\r\n]?[\x20]{0,3}/gim,"\r\n"):i.replace(/<br(\s*|\/)>[\r\n]?/gim,"\r\n"),p[v][l]=e.replace(gb,(t=>db[t]))}else A.push(i)}}return w.length&&(n.mergeCells=w),A.length&&(n.rowHeaders=A),p.length&&(n.data=p),n}const Ab=Object.freeze(Object.defineProperty({__proto__:null,_dataToHTML:pb,htmlToGridSettings:wb,instanceToHTML:mb},Symbol.toStringTag,{value:"Module"}));function vb(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];const n=typeof t;if("number"===n)return!isNaN(t)&&isFinite(t);if("string"===n){if(0===t.length)return!1;if(1===t.length)return/\d/.test(t);const n=Array.from(new Set([".",...e])).map((t=>`\\${t}`)).join("|");return new RegExp(`^[+-]?\\s*(((${n})?\\d+((${n})\\d+)?(e[+-]?\\d+)?)|(0x[a-f\\d]+))$`,"i").test(t.trim())}return"object"===n&&(!!t&&"number"==typeof t.valueOf()&&!(t instanceof Date))}function yb(t){return vb(t,[","])}function Cb(t,e,n){let o=-1;for("function"==typeof e?(n=e,e=t):o=t-1;++o<=e&&!1!==n(o););}function bb(t,e,n){let o=t+1;for("function"==typeof e&&(n=e,e=0);--o>=e&&!1!==n(o););}function Sb(t,e){return e=parseInt(e.toString().replace("%",""),10),e=isNaN(e)?0:e,parseInt(t*e/100,10)}function Eb(t,e,n){return Math.min(t,e)===t?e:Math.max(t,n)===t?n:t}const Rb=Object.freeze(Object.defineProperty({__proto__:null,clamp:Eb,isNumeric:vb,isNumericLike:yb,rangeEach:Cb,rangeEachReverse:bb,valueAccordingPercent:Sb},Symbol.toStringTag,{value:"Module"})),Mb="asc",Tb="desc",kb=new Map([[Mb,[-1,1]],[Tb,[1,-1]]]),xb=t=>`The priority '${t}' is already declared in a map.`,Ib=t=>`The priority '${t}' is not a number.`;function Ob(){let{errorPriorityExists:t,errorPriorityNaN:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const n=new Map;function o(o,i){if(!vb(o))throw new Error(e(o));if(n.has(o))throw new Error(t(o));n.set(o,i)}function i(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Mb;const[e,o]=kb.get(t)||kb.get(Mb);return[...n].sort(((t,n)=>t[0]<n[0]?e:o)).map((t=>t[1]))}return t=iv(t)?t:xb,e=iv(e)?e:Ib,{addItem:o,getItems:i}}const Hb=t=>`The id '${t}' is already declared in a map.`;function Db(){let{errorIdExists:t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const e=new Map;function n(n,o){if(l(n))throw new Error(t(n));e.set(n,o)}function o(t){return e.delete(t)}function i(){e.clear()}function r(t){const[e]=a().find((e=>{let[n,o]=e;return t===o&&n}))||[null];return e}function s(t){return e.get(t)}function a(){return[...e]}function l(t){return e.has(t)}return t=iv(t)?t:Hb,{addItem:n,clear:i,getId:r,getItem:s,getItems:a,hasItem:l,removeItem:o}}const Nb=t=>`'${t}' value is already declared in a unique set.`;function Pb(){let{errorItemExists:t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const e=new Set;function n(n){if(e.has(n))throw new Error(t(n));e.add(n)}function o(){return[...e]}function i(){e.clear()}return t=iv(t)?t:Nb,{addItem:n,clear:i,getItems:o}}const _b=t=>`There is already registered "${t}" plugin.`,Bb=t=>`There is already registered plugin on priority "${t}".`,Lb=t=>`The priority "${t}" is not a number.`,Vb=Ob({errorPriorityExists:Bb,errorPriorityNaN:Lb}),Wb=Pb({errorItemExists:_b}),Fb=Db({errorIdExists:_b});function jb(){return[...Vb.getItems(),...Wb.getItems()]}function Ub(t){const e=iw(t);return Fb.getItem(e)}function Yb(t){return!!Ub(t)}function zb(t,e,n){[t,e,n]=Qb(t,e,n),void 0===Ub(t)&&Gb(t,e,n)}function Gb(t,e,n){const o=iw(t);if(Fb.hasItem(o))throw new Error(_b(o));void 0===n?Wb.addItem(o):Vb.addItem(n,o),Fb.addItem(o,e)}function Qb(t,e,n){return"function"==typeof t&&(e=t,t=e.PLUGIN_KEY,n=e.PLUGIN_PRIORITY),[t,e,n]}const{register:Kb,getItem:Xb,hasItem:qb,getNames:Zb,getValues:Jb}=hC("renderers");function $b(t){if("function"==typeof t)return t;if(!qb(t))throw Error(`No registered renderer found under "${t}" name`);return Xb(t)}function tS(t,e){"string"!=typeof t&&(e=t,t=e.RENDERER_TYPE),Kb(t,e)}const{register:eS,getItem:nS,hasItem:oS,getNames:iS,getValues:rS}=hC("validators");function sS(t){if("function"==typeof t)return t;if(!oS(t))throw Error(`No registered validator found under "${t}" name`);return nS(t)}function aS(t,e){"string"!=typeof t&&(e=t,t=e.VALIDATOR_TYPE),eS(t,e)}function lS(t,e,n){return e=hS(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function hS(t){var e=cS(t,"string");return"symbol"==typeof e?e:String(e)}function cS(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class uS{constructor(t){lS(this,"count",0),lS(this,"startColumn",0),lS(this,"endColumn",0),lS(this,"startPosition",0),this.count=t.totalColumns,this.endColumn=this.count-1}}function dS(t,e,n){return e=gS(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function gS(t){var e=fS(t,"string");return"symbol"==typeof e?e:String(e)}function fS(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class mS{constructor(t){dS(this,"count",0),dS(this,"startRow",0),dS(this,"endRow",0),dS(this,"startPosition",0),this.count=t.totalRows,this.endRow=this.count-1}}var pS={},wS=fi,AS=mi,vS=Object.keys||function(t){return wS(t,AS)},yS=E,CS=hn,bS=sn,SS=gn,ES=it,RS=vS;pS.f=yS&&!CS?Object.defineProperties:function(t,e){SS(t);for(var n,o=ES(e),i=RS(e),r=i.length,s=0;r>s;)bS.f(t,n=i[s++],o[n]);return t};var MS,TS=gn,kS=pS,xS=mi,IS=to,OS=na,HS=ze,DS=$n,NS=">",PS="<",_S="prototype",BS="script",LS=DS("IE_PROTO"),VS=function(){},WS=function(t){return PS+BS+NS+t+PS+"/"+BS+NS},FS=function(t){t.write(WS("")),t.close();var e=t.parentWindow.Object;return t=null,e},jS=function(){var t,e=HS("iframe"),n="java"+BS+":";return e.style.display="none",OS.appendChild(e),e.src=String(n),t=e.contentWindow.document,t.open(),t.write(WS("document.F=Object")),t.close(),t.F},US=function(){try{MS=new ActiveXObject("htmlfile")}catch(e){}US="undefined"!=typeof document?document.domain&&MS?FS(MS):jS():FS(MS);for(var t=xS.length;t--;)delete US[_S][xS[t]];return US()};IS[LS]=!0;var YS=Object.create||function(t,e){var n;return null!==t?(VS[_S]=TS(t),n=new VS,VS[_S]=null,n[LS]=t):n=US(),void 0===e?n:kS.f(n,e)},zS=ke,GS=YS,QS=sn.f,KS=zS("unscopables"),XS=Array.prototype;void 0===XS[KS]&&QS(XS,KS,{configurable:!0,value:GS(null)});var qS=function(t){XS[KS][t]=!0},ZS=Ki,JS=he,$S=ni,tE=Qo,eE=qS;ZS({target:"Array",proto:!0},{at:function(t){var e=JS(this),n=$S(e),o=tE(t),i=o>=0?o:n+o;return i<0||i>=n?void 0:e[i]}}),eE("at");const nE=1,oE=2;function iE(t,e,n){rE(t,e),e.set(t,n)}function rE(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function sE(t,e,n){return e=aE(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function aE(t){var e=lE(t,"string");return"symbol"==typeof e?e:String(e)}function lE(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function hE(t,e){var n=dE(t,e,"get");return cE(t,n)}function cE(t,e){return e.get?e.get.call(t):e.value}function uE(t,e,n){var o=dE(t,e,"set");return gE(t,o,n),n}function dE(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function gE(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var fE=new WeakMap;class mE{static get DEFAULT_WIDTH(){return 50}constructor(t){sE(this,"count",0),sE(this,"startColumn",null),sE(this,"endColumn",null),sE(this,"startPosition",null),sE(this,"isVisibleInTrimmingContainer",!1),iE(this,fE,{writable:!0,value:void 0}),uE(this,fE,t),this.calculate()}calculate(){const{calculationType:t,overrideFn:e,scrollOffset:n,totalColumns:o,viewportWidth:i}=hE(this,fE),r=Math.max(hE(this,fE).scrollOffset,0),s=r>0?i+1:i;let a=0,l=!0;const h=[];let c,u=0,d=0;for(let p=0;p<o;p++)if(c=this._getColumnWidth(p),a<=r&&t!==oE&&(this.startColumn=p,u=c),a>=r&&a+(t===oE?c:0)<=r+s&&((null===this.startColumn||void 0===this.startColumn)&&(this.startColumn=p,u=c),this.endColumn=p),h.push(a),a+=c,d=c,t!==oE&&(this.endColumn=p),a>=r+i){l=!1;break}const g=n+i-s,f=t===oE?0:d,m=t===oE?u:0;if(g<-1*hE(this,fE).inlineStartOffset||n>h.at(-1)+f||-1*hE(this,fE).scrollOffset-hE(this,fE).viewportWidth>-1*m?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,this.endColumn===o-1&&l)for(this.startColumn=this.endColumn;this.startColumn>0;){const e=h[this.endColumn]+c-h[this.startColumn-1];if((e<=i||t!==oE)&&(this.startColumn-=1),e>i)break}t===nE&&null!==this.startColumn&&e&&e(this),this.startPosition=h[this.startColumn],void 0===this.startPosition&&(this.startPosition=null),o<this.endColumn&&(this.endColumn=o-1),null!==this.startColumn&&(this.count=this.endColumn-this.startColumn+1)}_getColumnWidth(t){let e=hE(this,fE).columnWidthFn(t);return isNaN(e)&&(e=mE.DEFAULT_WIDTH),e}}function pE(t,e,n){wE(t,e),e.set(t,n)}function wE(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function AE(t,e,n){return e=vE(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function vE(t){var e=yE(t,"string");return"symbol"==typeof e?e:String(e)}function yE(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function CE(t,e){var n=EE(t,e,"get");return bE(t,n)}function bE(t,e){return e.get?e.get.call(t):e.value}function SE(t,e,n){var o=EE(t,e,"set");return RE(t,o,n),n}function EE(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function RE(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var ME=new WeakMap;class TE{static get DEFAULT_HEIGHT(){return 23}constructor(t){AE(this,"count",0),AE(this,"startRow",null),AE(this,"endRow",null),AE(this,"startPosition",null),AE(this,"isVisibleInTrimmingContainer",!1),pE(this,ME,{writable:!0,value:void 0}),SE(this,ME,t),this.calculate()}calculate(){const{calculationType:t,overrideFn:e,rowHeightFn:n,scrollOffset:o,totalRows:i,viewportHeight:r}=CE(this,ME),s=Math.max(CE(this,ME).scrollOffset,0),a=CE(this,ME).horizontalScrollbarHeight||0;let l=0,h=!0;const c=[];let u,d=0,g=0;for(let w=0;w<i;w++)if(u=n(w),isNaN(u)&&(u=TE.DEFAULT_HEIGHT),l<=s&&t!==oE&&(this.startRow=w,d=u),l>=s&&l+(t===oE?u:0)<=s+r-a&&(null===this.startRow&&(this.startRow=w,d=u),this.endRow=w),c.push(l),l+=u,g=u,t!==oE&&(this.endRow=w),l>=s+r-a){h=!1;break}const f=o+r-a,m=t===oE?d:0,p=t===oE?0:g;if(f<m||o>c.at(-1)+p?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,this.endRow===i-1&&h)for(this.startRow=this.endRow;this.startRow>0;){const e=c[this.endRow]+u-c[this.startRow-1];if((e<=r-a||t!==oE)&&(this.startRow-=1),e>=r-a)break}t===nE&&null!==this.startRow&&e&&e(this),this.startPosition=c[this.startRow],void 0===this.startPosition&&(this.startPosition=null),i<this.endRow&&(this.endRow=i-1),null!==this.startRow&&(this.count=this.endRow-this.startRow+1)}}function kE(t,e,n){xE(t,e),e.set(t,n)}function xE(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function IE(t,e,n){return e=OE(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function OE(t){var e=HE(t,"string");return"symbol"==typeof e?e:String(e)}function HE(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function DE(t,e){var n=_E(t,e,"get");return NE(t,n)}function NE(t,e){return e.get?e.get.call(t):e.value}function PE(t,e,n){var o=_E(t,e,"set");return BE(t,o,n),n}function _E(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function BE(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var LE=new WeakMap;class VE{constructor(t,e){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];IE(this,"row",null),IE(this,"col",null),kE(this,LE,{writable:!0,value:!1}),PE(this,LE,n),"undefined"!=typeof t&&"undefined"!=typeof e&&(this.row=t,this.col=e)}isValid(t){const{countRows:e,countCols:n,countRowHeaders:o,countColHeaders:i}=p({countRows:0,countCols:0,countRowHeaders:0,countColHeaders:0},t);return!(!Number.isInteger(this.row)||!Number.isInteger(this.col)||this.row<-i||this.col<-o||this.row>=e||this.col>=n)}isEqual(t){return t===this||this.row===t.row&&this.col===t.col}isHeader(){return!this.isCell()}isCell(){return this.row>=0&&this.col>=0}isRtl(){return DE(this,LE)}isSouthEastOf(t){return this.row>=t.row&&(DE(this,LE)?this.col<=t.col:this.col>=t.col)}isNorthWestOf(t){return this.row<=t.row&&(DE(this,LE)?this.col>=t.col:this.col<=t.col)}isSouthWestOf(t){return this.row>=t.row&&(DE(this,LE)?this.col>=t.col:this.col<=t.col)}isNorthEastOf(t){return this.row<=t.row&&(DE(this,LE)?this.col<=t.col:this.col>=t.col)}normalize(){return this.row=null===this.row?this.row:Math.max(this.row,0),this.col=null===this.col?this.col:Math.max(this.col,0),this}assign(t){return Number.isInteger(null==t?void 0:t.row)&&(this.row=t.row),Number.isInteger(null==t?void 0:t.col)&&(this.col=t.col),t instanceof VE&&PE(this,LE,t.isRtl()),this}clone(){return new VE(this.row,this.col,DE(this,LE))}toObject(){return{row:this.row,col:this.col}}}const WE=VE;function FE(t,e,n){jE(t,e),e.set(t,n)}function jE(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function UE(t,e,n){return e=YE(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function YE(t){var e=zE(t,"string");return"symbol"==typeof e?e:String(e)}function zE(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function GE(t,e){var n=XE(t,e,"get");return QE(t,n)}function QE(t,e){return e.get?e.get.call(t):e.value}function KE(t,e,n){var o=XE(t,e,"set");return qE(t,o,n),n}function XE(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function qE(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var ZE=new WeakMap;class JE{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t,o=arguments.length>3&&void 0!==arguments[3]&&arguments[3];UE(this,"highlight",null),UE(this,"from",null),UE(this,"to",null),FE(this,ZE,{writable:!0,value:!1}),this.highlight=t.clone(),this.from=e.clone(),this.to=n.clone(),KE(this,ZE,o)}setHighlight(t){return this.highlight=t.clone(),this}setFrom(t){return this.from=t.clone(),this}setTo(t){return this.to=t.clone(),this}isValid(t){return this.from.isValid(t)&&this.to.isValid(t)}isSingle(){return this.isSingleCell()||this.isSingleHeader()}isSingleCell(){return this.from.row>=0&&this.from.row===this.to.row&&this.from.col>=0&&this.from.col===this.to.col}isSingleHeader(){return(this.from.row<0||this.from.col<0)&&this.from.row===this.to.row&&this.from.col===this.to.col}containsHeaders(){return this.from.isHeader()||this.to.isHeader()}getOuterHeight(){return Math.max(this.from.row,this.to.row)-Math.min(this.from.row,this.to.row)+1}getOuterWidth(){return Math.max(this.from.col,this.to.col)-Math.min(this.from.col,this.to.col)+1}getHeight(){if(this.from.row<0&&this.to.row<0)return 0;const t=Math.max(this.from.row,0),e=Math.max(this.to.row,0);return Math.max(t,e)-Math.min(t,e)+1}getWidth(){if(this.from.col<0&&this.to.col<0)return 0;const t=Math.max(this.from.col,0),e=Math.max(this.to.col,0);return Math.max(t,e)-Math.min(t,e)+1}getCellsCount(){return this.getWidth()*this.getHeight()}includes(t){const{row:e,col:n}=t,o=this.getOuterTopStartCorner(),i=this.getOuterBottomEndCorner();return o.row<=e&&i.row>=e&&o.col<=n&&i.col>=n}includesRange(t){return this.includes(t.getOuterTopStartCorner())&&this.includes(t.getOuterBottomEndCorner())}isEqual(t){return Math.min(this.from.row,this.to.row)===Math.min(t.from.row,t.to.row)&&Math.max(this.from.row,this.to.row)===Math.max(t.from.row,t.to.row)&&Math.min(this.from.col,this.to.col)===Math.min(t.from.col,t.to.col)&&Math.max(this.from.col,this.to.col)===Math.max(t.from.col,t.to.col)}overlaps(t){return t.isSouthEastOf(this.getOuterTopLeftCorner())&&t.isNorthWestOf(this.getOuterBottomRightCorner())}isSouthEastOf(t){return this.getOuterTopLeftCorner().isSouthEastOf(t)||this.getOuterBottomRightCorner().isSouthEastOf(t)}isNorthWestOf(t){return this.getOuterTopLeftCorner().isNorthWestOf(t)||this.getOuterBottomRightCorner().isNorthWestOf(t)}isOverlappingHorizontally(t){return this.getOuterTopEndCorner().col>=t.getOuterTopStartCorner().col&&this.getOuterTopEndCorner().col<=t.getOuterTopEndCorner().col||this.getOuterTopStartCorner().col<=t.getOuterTopEndCorner().col&&this.getOuterTopStartCorner().col>=t.getOuterTopStartCorner().col}isOverlappingVertically(t){return this.getOuterBottomStartCorner().row>=t.getOuterTopRightCorner().row&&this.getOuterBottomStartCorner().row<=t.getOuterBottomStartCorner().row||this.getOuterTopEndCorner().row<=t.getOuterBottomStartCorner().row&&this.getOuterTopEndCorner().row>=t.getOuterTopRightCorner().row}expand(t){const e=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner();return(t.row<e.row||t.col<e.col||t.row>n.row||t.col>n.col)&&(this.from=this._createCellCoords(Math.min(e.row,t.row),Math.min(e.col,t.col)),this.to=this._createCellCoords(Math.max(n.row,t.row),Math.max(n.col,t.col)),!0)}expandByRange(t){if(this.includesRange(t)||!this.overlaps(t))return!1;const e=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner(),o=this.getDirection(),i=t.getOuterTopStartCorner(),r=t.getOuterBottomEndCorner(),s=Math.min(e.row,i.row),a=Math.min(e.col,i.col),l=Math.max(n.row,r.row),h=Math.max(n.col,r.col),c=this._createCellCoords(s,a),u=this._createCellCoords(l,h);return this.from=c,this.to=u,this.setDirection(o),this.highlight.row===this.getOuterBottomRightCorner().row&&"N-S"===this.getVerticalDirection()&&this.flipDirectionVertically(),this.highlight.col===this.getOuterTopRightCorner().col&&"W-E"===this.getHorizontalDirection()&&this.flipDirectionHorizontally(),!0}getDirection(){return this.from.isNorthWestOf(this.to)?"NW-SE":this.from.isNorthEastOf(this.to)?"NE-SW":this.from.isSouthEastOf(this.to)?"SE-NW":this.from.isSouthWestOf(this.to)?"SW-NE":void 0}setDirection(t){switch(t){case"NW-SE":[this.from,this.to]=[this.getOuterTopLeftCorner(),this.getOuterBottomRightCorner()];break;case"NE-SW":[this.from,this.to]=[this.getOuterTopRightCorner(),this.getOuterBottomLeftCorner()];break;case"SE-NW":[this.from,this.to]=[this.getOuterBottomRightCorner(),this.getOuterTopLeftCorner()];break;case"SW-NE":[this.from,this.to]=[this.getOuterBottomLeftCorner(),this.getOuterTopRightCorner()];break}}getVerticalDirection(){return["NE-SW","NW-SE"].indexOf(this.getDirection())>-1?"N-S":"S-N"}getHorizontalDirection(){return["NW-SE","SW-NE"].indexOf(this.getDirection())>-1?"W-E":"E-W"}flipDirectionVertically(){switch(this.getDirection()){case"NW-SE":this.setDirection("SW-NE");break;case"NE-SW":this.setDirection("SE-NW");break;case"SE-NW":this.setDirection("NE-SW");break;case"SW-NE":this.setDirection("NW-SE");break}}flipDirectionHorizontally(){switch(this.getDirection()){case"NW-SE":this.setDirection("NE-SW");break;case"NE-SW":this.setDirection("NW-SE");break;case"SE-NW":this.setDirection("SW-NE");break;case"SW-NE":this.setDirection("SE-NW");break}}getTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getTopLeftCorner(){return GE(this,ZE)?this.getTopEndCorner():this.getTopStartCorner()}getBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getBottomRightCorner(){return GE(this,ZE)?this.getBottomStartCorner():this.getBottomEndCorner()}getTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getTopRightCorner(){return GE(this,ZE)?this.getTopStartCorner():this.getTopEndCorner()}getBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getBottomLeftCorner(){return GE(this,ZE)?this.getBottomEndCorner():this.getBottomStartCorner()}getOuterTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterTopLeftCorner(){return GE(this,ZE)?this.getOuterTopEndCorner():this.getOuterTopStartCorner()}getOuterBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterBottomRightCorner(){return GE(this,ZE)?this.getOuterBottomStartCorner():this.getOuterBottomEndCorner()}getOuterTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterTopRightCorner(){return GE(this,ZE)?this.getOuterTopStartCorner():this.getOuterTopEndCorner()}getOuterBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterBottomLeftCorner(){return GE(this,ZE)?this.getOuterBottomEndCorner():this.getOuterBottomStartCorner()}isCorner(t){return t.isEqual(this.getOuterTopLeftCorner())||t.isEqual(this.getOuterTopRightCorner())||t.isEqual(this.getOuterBottomLeftCorner())||t.isEqual(this.getOuterBottomRightCorner())}getOppositeCorner(t){return t instanceof WE&&(t.isEqual(this.getOuterBottomEndCorner())?this.getOuterTopStartCorner():t.isEqual(this.getOuterTopStartCorner())?this.getOuterBottomEndCorner():t.isEqual(this.getOuterTopEndCorner())?this.getOuterBottomStartCorner():t.isEqual(this.getOuterBottomStartCorner())?this.getOuterTopEndCorner():void 0)}getBordersSharedWith(t){if(!this.includesRange(t))return[];const e={top:Math.min(this.from.row,this.to.row),bottom:Math.max(this.from.row,this.to.row),left:Math.min(this.from.col,this.to.col),right:Math.max(this.from.col,this.to.col)},n={top:Math.min(t.from.row,t.to.row),bottom:Math.max(t.from.row,t.to.row),left:Math.min(t.from.col,t.to.col),right:Math.max(t.from.col,t.to.col)},o=[];return e.top===n.top&&o.push("top"),e.right===n.right&&o.push(GE(this,ZE)?"left":"right"),e.bottom===n.bottom&&o.push("bottom"),e.left===n.left&&o.push(GE(this,ZE)?"right":"left"),o}getInner(){const t=this.getOuterTopStartCorner(),e=this.getOuterBottomEndCorner(),n=[];for(let o=t.row;o<=e.row;o++)for(let i=t.col;i<=e.col;i++)(this.from.row!==o||this.from.col!==i)&&(this.to.row!==o||this.to.col!==i)&&n.push(this._createCellCoords(o,i));return n}getAll(){const t=this.getOuterTopStartCorner(),e=this.getOuterBottomEndCorner(),n=[];for(let o=t.row;o<=e.row;o++)for(let i=t.col;i<=e.col;i++)t.row===o&&t.col===i?n.push(t):e.row===o&&e.col===i?n.push(e):n.push(this._createCellCoords(o,i));return n}forAll(t){const e=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner();for(let o=e.row;o<=n.row;o++)for(let i=e.col;i<=n.col;i++)if(!1===t(o,i))return}clone(){return new JE(this.highlight,this.from,this.to,GE(this,ZE))}toObject(){return{from:this.from.toObject(),to:this.to.toObject()}}_createCellCoords(t,e){return new WE(t,e,GE(this,ZE))}}const $E=JE;function tR(t,e,n){eR(t,e),e.set(t,n)}function eR(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function nR(t,e){var n=rR(t,e,"get");return oR(t,n)}function oR(t,e){return e.get?e.get.call(t):e.value}function iR(t,e,n){var o=rR(t,e,"set");return sR(t,o,n),n}function rR(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function sR(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var aR=new WeakMap,lR=new WeakMap,hR=new WeakMap,cR=new WeakMap,uR=new WeakMap,dR=new WeakMap,gR=new WeakMap,fR=new WeakMap,mR=new WeakMap,pR=new WeakMap;let wR=class{constructor(t,e,n,o,i,r){let s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;tR(this,aR,{writable:!0,value:void 0}),tR(this,lR,{writable:!0,value:void 0}),tR(this,hR,{writable:!0,value:void 0}),tR(this,cR,{writable:!0,value:void 0}),tR(this,uR,{writable:!0,value:void 0}),tR(this,dR,{writable:!0,value:void 0}),tR(this,gR,{writable:!0,value:void 0}),tR(this,fR,{writable:!0,value:void 0}),tR(this,mR,{writable:!0,value:[null,null]}),tR(this,pR,{writable:!0,value:[null,null]}),iR(this,aR,n),iR(this,lR,e),iR(this,hR,i),iR(this,cR,r),iR(this,uR,s),iR(this,dR,o),iR(this,gR,t),this.registerEvents()}registerEvents(){nR(this,dR).addEventListener(nR(this,hR).holder,"contextmenu",(t=>this.onContextMenu(t))),nR(this,dR).addEventListener(nR(this,hR).TABLE,"mouseover",(t=>this.onMouseOver(t))),nR(this,dR).addEventListener(nR(this,hR).TABLE,"mouseout",(t=>this.onMouseOut(t)));const t=()=>{nR(this,dR).addEventListener(nR(this,hR).holder,"touchstart",(t=>this.onTouchStart(t))),nR(this,dR).addEventListener(nR(this,hR).holder,"touchend",(t=>this.onTouchEnd(t))),this.momentumScrolling||(this.momentumScrolling={}),nR(this,dR).addEventListener(nR(this,hR).holder,"scroll",(()=>{clearTimeout(this.momentumScrolling._timeout),this.momentumScrolling.ongoing||nR(this,aR).getSetting("onBeforeTouchScroll"),this.momentumScrolling.ongoing=!0,this.momentumScrolling._timeout=setTimeout((()=>{this.touchApplied||(this.momentumScrolling.ongoing=!1,nR(this,aR).getSetting("onAfterMomentumScroll"))}),200)}))},e=()=>{nR(this,dR).addEventListener(nR(this,hR).holder,"mouseup",(t=>this.onMouseUp(t))),nR(this,dR).addEventListener(nR(this,hR).holder,"mousedown",(t=>this.onMouseDown(t)))};ky()?t():(uy()&&t(),e())}selectedCellWasTouched(t){const e=this.parentCell(t).coords;if(nR(this,fR)&&e){const[t,n]=[e.row,nR(this,fR).from.row],[o,i]=[e.col,nR(this,fR).from.col];return t===n&&o===i}return!1}parentCell(t){const e={},n=nR(this,hR).TABLE,o=oA(t,["TD","TH"],n);return o?(e.coords=nR(this,hR).getCoords(o),e.TD=o):hA(t,"wtBorder")&&hA(t,"current")?(e.coords=nR(this,cR).getFocusSelection().cellRange.highlight,e.TD=nR(this,hR).getCell(e.coords)):hA(t,"wtBorder")&&hA(t,"area")&&nR(this,cR).getAreaSelection().cellRange&&(e.coords=nR(this,cR).getAreaSelection().cellRange.to,e.TD=nR(this,hR).getCell(e.coords)),e}onMouseDown(t){const e=nR(this,lR).rootDocument.activeElement,n=hv(Zw,t.target),o=t.target;if(!["TD","TH"].includes(e.nodeName)&&(o===e||n(0)===e||n(1)===e))return;const i=this.parentCell(o);hA(o,"corner")?nR(this,aR).getSetting("onCellCornerMouseDown",t,o):i.TD&&nR(this,aR).has("onCellMouseDown")&&this.callListener("onCellMouseDown",t,i.coords,i.TD),(0===t.button||this.touchApplied)&&i.TD&&(nR(this,pR)[0]=i.TD,clearTimeout(nR(this,mR)[0]),nR(this,mR)[0]=setTimeout((()=>{nR(this,pR)[0]=null}),1e3))}onContextMenu(t){if(nR(this,aR).has("onCellContextMenu")){const e=this.parentCell(t.target);e.TD&&this.callListener("onCellContextMenu",t,e.coords,e.TD)}}onMouseOver(t){if(!nR(this,aR).has("onCellMouseOver"))return;const e=nR(this,hR).TABLE,n=oA(t.target,["TD","TH"],e),o=nR(this,uR)||this;n&&n!==o.lastMouseOver&&iA(n,e)&&(o.lastMouseOver=n,this.callListener("onCellMouseOver",t,nR(this,hR).getCoords(n),n))}onMouseOut(t){if(!nR(this,aR).has("onCellMouseOut"))return;const e=nR(this,hR).TABLE,n=oA(t.target,["TD","TH"],e),o=oA(t.relatedTarget,["TD","TH"],e),i=nR(this,uR)||this;n&&n!==o&&iA(n,e)&&(this.callListener("onCellMouseOut",t,nR(this,hR).getCoords(n),n),null===o&&(i.lastMouseOver=null))}onMouseUp(t){const e=this.parentCell(t.target);e.TD&&nR(this,aR).has("onCellMouseUp")&&this.callListener("onCellMouseUp",t,e.coords,e.TD),(0===t.button||this.touchApplied)&&(e.TD===nR(this,pR)[0]&&e.TD===nR(this,pR)[1]?(hA(t.target,"corner")?this.callListener("onCellCornerDblClick",t,e.coords,e.TD):this.callListener("onCellDblClick",t,e.coords,e.TD),nR(this,pR)[0]=null,nR(this,pR)[1]=null):e.TD===nR(this,pR)[0]&&(nR(this,pR)[1]=e.TD,clearTimeout(nR(this,mR)[1]),nR(this,mR)[1]=setTimeout((()=>{nR(this,pR)[1]=null}),500)))}onTouchStart(t){iR(this,fR,nR(this,cR).getFocusSelection().cellRange),this.touchApplied=!0,this.onMouseDown(t)}onTouchEnd(t){var e;const n=t.target,o=null===(e=this.parentCell(n))||void 0===e?void 0:e.coords,i=Wp(o)&&o.row>=0&&o.col>=0;if(t.cancelable&&i&&nR(this,aR).getSetting("isDataViewInstance")){const e=["A","BUTTON","INPUT"];xy()&&(by()||Ey())&&this.selectedCellWasTouched(n)&&!e.includes(n.tagName)?t.preventDefault():this.selectedCellWasTouched(n)||t.preventDefault()}this.onMouseUp(t),this.touchApplied=!1}callListener(t,e,n,o){const i=nR(this,aR).getSettingPure(t);i&&i(e,n,o,nR(this,gR).call(this))}destroy(){clearTimeout(nR(this,mR)[0]),clearTimeout(nR(this,mR)[1]),nR(this,dR).destroy()}};const AR=wR;function vR(t,e,n){return e=yR(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function yR(t){var e=CR(t,"string");return"symbol"==typeof e?e:String(e)}function CR(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class bR{constructor(t,e,n){vR(this,"offset",void 0),vR(this,"total",void 0),vR(this,"countTH",void 0),this.offset=t,this.total=e,this.countTH=n}offsetted(t){return t+this.offset}unOffsetted(t){return t-this.offset}renderedToSource(t){return this.offsetted(t)}sourceToRendered(t){return this.unOffsetted(t)}offsettedTH(t){return t-this.countTH}unOffsettedTH(t){return t+this.countTH}visibleRowHeadedColumnToSourceColumn(t){return this.renderedToSource(this.offsettedTH(t))}sourceColumnToVisibleRowHeadedColumn(t){return this.unOffsettedTH(this.sourceToRendered(t))}}const SR=bR;function ER(t,e,n){return e=RR(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function RR(t){var e=MR(t,"string");return"symbol"==typeof e?e:String(e)}function MR(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class TR{constructor(t,e,n){ER(this,"offset",void 0),ER(this,"total",void 0),ER(this,"countTH",void 0),this.offset=t,this.total=e,this.countTH=n}offsetted(t){return t+this.offset}unOffsetted(t){return t-this.offset}renderedToSource(t){return this.offsetted(t)}sourceToRendered(t){return this.unOffsetted(t)}offsettedTH(t){return t-this.countTH}unOffsettedTH(t){return t+this.countTH}visibleColHeadedRowToSourceRow(t){return this.renderedToSource(this.offsettedTH(t))}sourceRowToVisibleColHeadedRow(t){return this.unOffsettedTH(this.sourceToRendered(t))}}const kR=TR,xR=0,IR=1,OR=2;function HR(t,e,n){return e=DR(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function DR(t){var e=NR(t,"string");return"symbol"==typeof e?e:String(e)}function NR(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class PR{constructor(){HR(this,"currentSize",0),HR(this,"nextSize",0),HR(this,"currentOffset",0),HR(this,"nextOffset",0)}setSize(t){this.currentSize=this.nextSize,this.nextSize=t}setOffset(t){this.currentOffset=this.nextOffset,this.nextOffset=t}}function _R(t,e,n){return e=BR(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function BR(t){var e=LR(t,"string");return"symbol"==typeof e?e:String(e)}function LR(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class VR{constructor(){_R(this,"size",new PR),_R(this,"workingSpace",xR),_R(this,"sharedSize",null)}setSize(t){this.size.setSize(t)}setOffset(t){this.size.setOffset(t)}getViewSize(){return this.size}isShared(){return this.sharedSize instanceof PR}isPlaceOn(t){return this.workingSpace===t}append(t){this.workingSpace=IR,t.workingSpace=OR,this.sharedSize=t.getViewSize()}prepend(t){this.workingSpace=OR,t.workingSpace=IR,this.sharedSize=t.getViewSize()}}function WR(t,e,n){return e=FR(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function FR(t){var e=jR(t,"string");return"symbol"==typeof e?e:String(e)}function jR(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class UR{constructor(t,e,n){WR(this,"rootNode",void 0),WR(this,"nodesPool",void 0),WR(this,"sizeSet",new VR),WR(this,"childNodeType",void 0),WR(this,"visualIndex",0),WR(this,"collectedNodes",[]),this.rootNode=t,this.nodesPool=e,this.childNodeType=n.toUpperCase()}setSize(t){return this.sizeSet.setSize(t),this}setOffset(t){return this.sizeSet.setOffset(t),this}isSharedViewSet(){return this.sizeSet.isShared()}getNode(t){return t<this.collectedNodes.length?this.collectedNodes[t]:null}getCurrentNode(){const t=this.collectedNodes.length;return t>0?this.collectedNodes[t-1]:null}getRenderedChildCount(){const{rootNode:t,sizeSet:e}=this;let n=0;if(this.isSharedViewSet()){let o=t.firstElementChild;for(;o;){if(o.tagName===this.childNodeType)n+=1;else if(e.isPlaceOn(IR))break;o=o.nextElementSibling}}else n=t.childElementCount;return n}start(){this.collectedNodes.length=0,this.visualIndex=0;const{rootNode:t,sizeSet:e}=this,n=this.isSharedViewSet(),{nextSize:o}=e.getViewSize();let i=this.getRenderedChildCount();for(;i<o;){const o=this.nodesPool();!n||n&&e.isPlaceOn(OR)?t.appendChild(o):t.insertBefore(o,t.firstChild),i+=1}const r=n&&e.isPlaceOn(IR);for(;i>o;)t.removeChild(r?t.firstChild:t.lastChild),i-=1}render(){const{rootNode:t,sizeSet:e}=this;let n=this.visualIndex;this.isSharedViewSet()&&e.isPlaceOn(OR)&&(n+=e.sharedSize.nextSize);let o=t.childNodes[n];if(o.tagName!==this.childNodeType){const e=this.nodesPool();t.replaceChild(e,o),o=e}this.collectedNodes.push(o),this.visualIndex+=1}end(){}}class YR extends UR{prependView(t){return this.sizeSet.prepend(t.sizeSet),t.sizeSet.append(this.sizeSet),this}appendView(t){return this.sizeSet.append(t.sizeSet),t.sizeSet.prepend(this.sizeSet),this}}function zR(t,e,n){return e=GR(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function GR(t){var e=QR(t,"string");return"symbol"==typeof e?e:String(e)}function QR(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class KR{constructor(t){zR(this,"nodeType",void 0),this.nodeType=t.toUpperCase()}setRootDocument(t){this.rootDocument=t}obtain(){return this.rootDocument.createElement(this.nodeType)}}function XR(t,e,n){return e=qR(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function qR(t){var e=ZR(t,"string");return"symbol"==typeof e?e:String(e)}function ZR(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class JR{constructor(t,e){XR(this,"nodesPool",null),XR(this,"nodeType",void 0),XR(this,"rootNode",void 0),XR(this,"table",null),XR(this,"renderedNodes",0),this.nodesPool="string"==typeof t?new KR(t):null,this.nodeType=t,this.rootNode=e}setTable(t){this.nodesPool&&this.nodesPool.setRootDocument(t.rootDocument),this.table=t}adjust(){}render(){}}function $R(t,e,n){return e=tM(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function tM(t){var e=eM(t,"string");return"symbol"==typeof e?e:String(e)}function eM(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class nM extends JR{constructor(){super("TH"),$R(this,"orderViews",new WeakMap),$R(this,"sourceRowIndex",0)}obtainOrderView(t){let e;return this.orderViews.has(t)?e=this.orderViews.get(t):(e=new YR(t,(t=>this.nodesPool.obtain(this.sourceRowIndex,t)),this.nodeType),this.orderViews.set(t,e)),e}render(){const{rowsToRender:t,rowHeaderFunctions:e,rowHeadersCount:n,rows:o,cells:i}=this.table;for(let r=0;r<t;r++){const t=this.table.renderedRowToSource(r),s=o.getRenderedNode(r);this.sourceRowIndex=t;const a=this.obtainOrderView(s),l=i.obtainOrderView(s);a.appendView(l).setSize(n).setOffset(this.table.renderedColumnToSource(0)).start();for(let o=0;o<n;o++){a.render();const n=a.getCurrentNode();n.className="",n.removeAttribute("style"),gA(n,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.isAriaEnabled()&&dA(n,[pw(),Tw(),Bw(o+1),dw(-1)]),e[o](t,n,o)}a.end()}}}class oM extends JR{constructor(t){super(null,t)}adjust(){const{columnHeadersCount:t,rowHeadersCount:e}=this.table;let n=this.rootNode.firstChild;if(t){const{columnsToRender:o}=this.table,i=o+e;for(let e=0,s=t;e<s;e++){for(n=this.rootNode.childNodes[e],n||(n=this.table.rootDocument.createElement("tr"),this.rootNode.appendChild(n)),this.renderedNodes=n.childNodes.length;this.renderedNodes<i;)n.appendChild(this.table.rootDocument.createElement("th")),this.renderedNodes+=1;for(;this.renderedNodes>i;)n.removeChild(n.lastChild),this.renderedNodes-=1}const r=this.rootNode.childNodes.length;if(r>t)for(let e=t;e<r;e++)this.rootNode.removeChild(this.rootNode.lastChild)}else n&&mA(n)}render(){const{columnHeadersCount:t}=this.table;this.table.isAriaEnabled()&&dA(this.rootNode,[ww()]);for(let e=0;e<t;e+=1){const{columnHeaderFunctions:t,columnsToRender:n,rowHeadersCount:o}=this.table,i=this.rootNode.childNodes[e];this.table.isAriaEnabled()&&dA(i,[vw(),_w(e+1)]);for(let r=-1*o;r<n;r+=1){const n=this.table.renderedColumnToSource(r),s=i.childNodes[r+o];s.className="",s.removeAttribute("style"),gA(s,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.isAriaEnabled()&&dA(s,[Bw(r+1+this.table.rowHeadersCount),dw(-1),Aw(),...r>=0?[Mw()]:[vw()]]),t[e](n,s,e)}}}}let iM=!1;class rM extends JR{constructor(t){super(null,t)}adjust(){const{columnsToRender:t,rowHeadersCount:e}=this.table,n=t+e;for(;this.renderedNodes<n;)this.rootNode.appendChild(this.table.rootDocument.createElement("col")),this.renderedNodes+=1;for(;this.renderedNodes>n;)this.rootNode.removeChild(this.rootNode.lastChild),this.renderedNodes-=1}render(){this.adjust();const{columnsToRender:t,rowHeadersCount:e}=this.table;!iM&&t>1e3&&(iM=!0,Xy(Lp`Performance tip: Handsontable rendered more than 1000 visible columns.\x20
        Consider limiting the number of rendered columns by specifying the table width and/or\x20
        turning off the "renderAllColumns" option.`));for(let o=0;o<e;o++){const t=this.table.renderedColumnToSource(o),e=this.table.columnUtils.getHeaderWidth(t);this.rootNode.childNodes[o].style.width=`${e}px`}for(let o=0;o<t;o++){const t=this.table.renderedColumnToSource(o),n=this.table.columnUtils.getStretchedColumnWidth(t);this.rootNode.childNodes[o+e].style.width=`${n}px`}const n=this.rootNode.firstChild;n&&cA(n,"rowHeader")}}function sM(t,e,n){return e=aM(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function aM(t){var e=lM(t,"string");return"symbol"==typeof e?e:String(e)}function lM(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}let hM=!1;class cM extends JR{constructor(t){super("TR",t),sM(this,"orderView",void 0),this.orderView=new UR(t,(t=>this.nodesPool.obtain(t)),this.nodeType)}getRenderedNode(t){return this.orderView.getNode(t)}render(){const{rowsToRender:t}=this.table;!hM&&t>1e3&&(hM=!0,Xy(Lp`Performance tip: Handsontable rendered more than 1000 visible rows.\x20
        Consider limiting the number of rendered rows by specifying the table height and/or\x20
        turning off the "renderAllRows" option.`)),this.table.isAriaEnabled()&&dA(this.rootNode,[ww()]),this.orderView.setSize(t).setOffset(this.table.renderedRowToSource(0)).start();for(let o=0;o<t;o++){this.orderView.render();const t=this.orderView.getCurrentNode(),i=this.table.renderedRowToSource(o);var e,n;if(this.table.isAriaEnabled())dA(t,[vw(),_w(i+(null!==(e=null===(n=this.table.rowUtils)||void 0===n||null===(n=n.dataAccessObject)||void 0===n?void 0:n.columnHeaders.length)&&void 0!==e?e:0)+1)])}this.orderView.end()}}function uM(t,e,n){return e=dM(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function dM(t){var e=gM(t,"string");return"symbol"==typeof e?e:String(e)}function gM(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class fM extends JR{constructor(){super("TD"),uM(this,"orderViews",new WeakMap),uM(this,"sourceRowIndex",0)}obtainOrderView(t){let e;return this.orderViews.has(t)?e=this.orderViews.get(t):(e=new YR(t,(t=>this.nodesPool.obtain(this.sourceRowIndex,t)),this.nodeType),this.orderViews.set(t,e)),e}render(){const{rowsToRender:t,columnsToRender:e,rows:n,rowHeaders:o}=this.table;for(let s=0;s<t;s++){const t=this.table.renderedRowToSource(s),a=n.getRenderedNode(s);this.sourceRowIndex=t;const l=this.obtainOrderView(a),h=o.obtainOrderView(a);l.prependView(h).setSize(e).setOffset(this.table.renderedColumnToSource(0)).start();for(let n=0;n<e;n++){l.render();const e=l.getCurrentNode(),o=this.table.renderedColumnToSource(n);var i,r;if(hA(e,"hide")||(e.className=""),e.removeAttribute("style"),e.removeAttribute("dir"),gA(e,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.cellRenderer(t,o,e),this.table.isAriaEnabled())dA(e,[...e.hasAttribute("role")?[]:[mw()],dw(-1),Bw(o+(null!==(i=null===(r=this.table.rowUtils)||void 0===r||null===(r=r.dataAccessObject)||void 0===r?void 0:r.rowHeaders.length)&&void 0!==i?i:0)+1)])}l.end()}}}function mM(t,e,n){return e=pM(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function pM(t){var e=wM(t,"string");return"symbol"==typeof e?e:String(e)}function wM(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class AM{constructor(t){let{cellRenderer:e}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};mM(this,"rootNode",void 0),mM(this,"rootDocument",void 0),mM(this,"rowHeaders",null),mM(this,"columnHeaders",null),mM(this,"colGroup",null),mM(this,"rows",null),mM(this,"cells",null),mM(this,"rowFilter",null),mM(this,"columnFilter",null),mM(this,"rowUtils",null),mM(this,"columnUtils",null),mM(this,"rowsToRender",0),mM(this,"columnsToRender",0),mM(this,"rowHeaderFunctions",[]),mM(this,"rowHeadersCount",0),mM(this,"columnHeaderFunctions",[]),mM(this,"columnHeadersCount",0),mM(this,"cellRenderer",void 0),this.rootNode=t,this.rootDocument=this.rootNode.ownerDocument,this.cellRenderer=e}setAxisUtils(t,e){this.rowUtils=t,this.columnUtils=e}setViewportSize(t,e){this.rowsToRender=t,this.columnsToRender=e}setFilters(t,e){this.rowFilter=t,this.columnFilter=e}setHeaderContentRenderers(t,e){this.rowHeaderFunctions=t,this.rowHeadersCount=t.length,this.columnHeaderFunctions=e,this.columnHeadersCount=e.length}setRenderers(){let{rowHeaders:t,columnHeaders:e,colGroup:n,rows:o,cells:i}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};t.setTable(this),e.setTable(this),n.setTable(this),o.setTable(this),i.setTable(this),this.rowHeaders=t,this.columnHeaders=e,this.colGroup=n,this.rows=o,this.cells=i}renderedRowToSource(t){return this.rowFilter.renderedToSource(t)}renderedColumnToSource(t){return this.columnFilter.renderedToSource(t)}isAriaEnabled(){return this.rowUtils.wtSettings.getSetting("ariaTags")}render(){this.colGroup.adjust(),this.columnHeaders.adjust(),this.rows.adjust(),this.rowHeaders.adjust(),this.columnHeaders.render(),this.rows.render(),this.rowHeaders.render(),this.cells.render(),this.columnUtils.calculateWidths(),this.colGroup.render();const{rowsToRender:t,rows:e}=this;for(let n=0;n<t;n++){const t=e.getRenderedNode(n);if(t.firstChild){const e=this.renderedRowToSource(n),o=this.rowUtils.getHeight(e);t.firstChild.style.height=o?o-1+"px":""}}}}class vM{constructor(){let{TABLE:t,THEAD:e,COLGROUP:n,TBODY:o,rowUtils:i,columnUtils:r,cellRenderer:s}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.renderer=new AM(t,{cellRenderer:s}),this.renderer.setRenderers({rowHeaders:new nM,columnHeaders:new oM(e),colGroup:new rM(n),rows:new cM(o),cells:new fM}),this.renderer.setAxisUtils(i,r)}setFilters(t,e){return this.renderer.setFilters(t,e),this}setViewportSize(t,e){return this.renderer.setViewportSize(t,e),this}setHeaderContentRenderers(t,e){return this.renderer.setHeaderContentRenderers(t,e),this}adjust(){this.renderer.adjust()}render(){this.renderer.render()}}function yM(t,e,n){CM(t,e),e.set(t,n)}function CM(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function bM(t,e,n){return e=SM(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function SM(t){var e=EM(t,"string");return"symbol"==typeof e?e:String(e)}function EM(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function RM(t,e){var n=kM(t,e,"get");return MM(t,n)}function MM(t,e){return e.get?e.get.call(t):e.value}function TM(t,e,n){var o=kM(t,e,"set");return xM(t,o,n),n}function kM(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function xM(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var IM=new WeakMap,OM=new WeakMap,HM=new WeakMap,DM=new WeakMap,NM=new WeakMap;class PM{static get DEFAULT_WIDTH(){return 50}constructor(t){let{totalColumns:e,stretchMode:n,stretchingColumnWidthFn:o,columnWidthFn:i}=t;bM(this,"stretchAllRatio",0),bM(this,"stretchLastWidth",0),bM(this,"stretchAllColumnsWidth",[]),yM(this,IM,{writable:!0,value:0}),bM(this,"needVerifyLastColumnWidth",!0),yM(this,OM,{writable:!0,value:()=>0}),yM(this,HM,{writable:!0,value:t=>t}),yM(this,DM,{writable:!0,value:t=>t}),yM(this,NM,{writable:!0,value:()=>"none"}),TM(this,OM,e),TM(this,NM,n),TM(this,HM,null!=o?o:RM(this,HM)),TM(this,DM,null!=i?i:RM(this,DM))}refreshStretching(t){if("none"===RM(this,NM).call(this))return;TM(this,IM,t);let e=0;for(let o=0;o<RM(this,OM).call(this);o++){const n=this._getColumnWidth(o),i=RM(this,HM).call(this,void 0,o);"number"==typeof i?t-=i:e+=n}const n=t-e;if("all"===RM(this,NM).call(this)&&n>0)this.stretchAllRatio=t/e,this.stretchAllColumnsWidth=[],this.needVerifyLastColumnWidth=!0;else if("last"===RM(this,NM).call(this)&&t!==1/0){const t=this._getColumnWidth(RM(this,OM).call(this)-1),e=n+t;this.stretchLastWidth=e>=0?e:t}}getStretchedColumnWidth(t,e){let n=null;return"all"===RM(this,NM).call(this)&&0!==this.stretchAllRatio?n=this._getStretchedAllColumnWidth(t,e):"last"===RM(this,NM).call(this)&&0!==this.stretchLastWidth&&(n=this._getStretchedLastColumnWidth(t)),n}_getStretchedAllColumnWidth(t,e){let n=0;if(!this.stretchAllColumnsWidth[t]){const n=Math.round(e*this.stretchAllRatio),o=RM(this,HM).call(this,n,t);this.stretchAllColumnsWidth[t]=void 0===o?n:isNaN(o)?this._getColumnWidth(t):o}if(this.stretchAllColumnsWidth.length===RM(this,OM).call(this)&&this.needVerifyLastColumnWidth){this.needVerifyLastColumnWidth=!1;for(let t=0;t<this.stretchAllColumnsWidth.length;t++)n+=this.stretchAllColumnsWidth[t];n!==RM(this,IM)&&(this.stretchAllColumnsWidth[this.stretchAllColumnsWidth.length-1]+=RM(this,IM)-n)}return this.stretchAllColumnsWidth[t]}_getStretchedLastColumnWidth(t){return t===RM(this,OM).call(this)-1?this.stretchLastWidth:null}_getColumnWidth(t){let e=RM(this,DM).call(this,t);return isNaN(e)&&(e=PM.DEFAULT_WIDTH),e}}function _M(t,e,n){return e=BM(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function BM(t){var e=LM(t,"string");return"symbol"==typeof e?e:String(e)}function LM(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class VM{constructor(t,e){_M(this,"dataAccessObject",void 0),_M(this,"wtSettings",void 0),_M(this,"headerWidths",new Map),_M(this,"stretching",void 0),this.dataAccessObject=t,this.wtSettings=e,this.stretching=new PM({totalColumns:()=>this.wtSettings.getSetting("totalColumns"),stretchMode:()=>this.wtSettings.getSetting("stretchH"),stretchingColumnWidthFn:(t,e)=>this.wtSettings.getSetting("onBeforeStretchingColumnWidth",t,e),columnWidthFn:t=>this.dataAccessObject.wtTable.getColumnWidth(t)})}getWidth(t){return this.wtSettings.getSetting("columnWidth",t)||this.wtSettings.getSetting("defaultColumnWidth")}getStretchedColumnWidth(t){let e=this.getWidth(t);const n=this.stretching.getStretchedColumnWidth(t,e);return n&&(e=n),e}getHeaderHeight(t){let e=this.wtSettings.getSetting("defaultRowHeight");const n=this.dataAccessObject.wtViewport.oversizedColumnHeaders[t];return void 0!==n&&(e=e?Math.max(e,n):n),e}getHeaderWidth(t){return this.headerWidths.get(this.dataAccessObject.wtTable.columnFilter.sourceToRendered(t))}refreshStretching(){const{wtTable:t,wtViewport:e,cloneSource:n}=this.dataAccessObject,o=n?n.wtTable.holder:t.holder,i=o.offsetHeight<o.scrollHeight?UA():0;this.stretching.refreshStretching(e.getViewportWidth()-i)}calculateWidths(){const{wtSettings:t}=this;let e=t.getSetting("rowHeaderWidth");if(this.refreshStretching(),e=t.getSetting("onModifyRowHeaderWidth",e),null!=e){const n=t.getSetting("rowHeaders").length,o=t.getSetting("defaultColumnWidth");for(let t=0;t<n;t++){let n=Array.isArray(e)?e[t]:e;n=null==n?o:n,this.headerWidths.set(t,n)}}}}function WM(t,e,n){return e=FM(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function FM(t){var e=jM(t,"string");return"symbol"==typeof e?e:String(e)}function jM(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class UM{constructor(t,e){WM(this,"dataAccessObject",void 0),WM(this,"wtSettings",void 0),this.dataAccessObject=t,this.wtSettings=e}getHeight(t){let e=this.wtSettings.getSetting("rowHeight",t);const n=this.dataAccessObject.wtViewport.oversizedRows[t];return void 0!==n&&(e=void 0===e?n:Math.max(e,n)),e}}function YM(t,e,n){return e=zM(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function zM(t){var e=GM(t,"string");return"symbol"==typeof e?e:String(e)}function GM(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class QM{constructor(t,e,n,o,i){YM(this,"wtSettings",null),YM(this,"domBindings",void 0),YM(this,"TBODY",null),YM(this,"THEAD",null),YM(this,"COLGROUP",null),YM(this,"hasTableHeight",!0),YM(this,"hasTableWidth",!0),YM(this,"isTableVisible",!1),YM(this,"tableOffset",0),YM(this,"holderOffset",0),this.domBindings=n,this.isMaster="master"===i,this.name=i,this.dataAccessObject=t,this.facadeGetter=e,this.wtSettings=o,this.instance=this.dataAccessObject.wot,this.wot=this.dataAccessObject.wot,this.TABLE=n.rootTable,fA(this.TABLE),this.spreader=this.createSpreader(this.TABLE),this.hider=this.createHider(this.spreader),this.holder=this.createHolder(this.hider),this.wtRootElement=this.holder.parentNode,this.isMaster&&this.alignOverlaysWithTrimmingContainer(),this.fixTableDomTree(),this.rowFilter=null,this.columnFilter=null,this.correctHeaderWidth=!1;const r=this.wtSettings.getSettingPure("rowHeaderWidth");this.wtSettings.update("rowHeaderWidth",(()=>this._modifyRowHeaderWidth(r))),this.rowUtils=new UM(this.dataAccessObject,this.wtSettings),this.columnUtils=new VM(this.dataAccessObject,this.wtSettings),this.tableRenderer=new vM({TABLE:this.TABLE,THEAD:this.THEAD,COLGROUP:this.COLGROUP,TBODY:this.TBODY,rowUtils:this.rowUtils,columnUtils:this.columnUtils,cellRenderer:this.wtSettings.getSettingPure("cellRenderer")})}is(t){return this.name===t}fixTableDomTree(){const t=this.domBindings.rootDocument;this.TBODY=this.TABLE.querySelector("tbody"),this.TBODY||(this.TBODY=t.createElement("tbody"),this.TABLE.appendChild(this.TBODY)),this.THEAD=this.TABLE.querySelector("thead"),this.THEAD||(this.THEAD=t.createElement("thead"),this.TABLE.insertBefore(this.THEAD,this.TBODY)),this.COLGROUP=this.TABLE.querySelector("colgroup"),this.COLGROUP||(this.COLGROUP=t.createElement("colgroup"),this.TABLE.insertBefore(this.COLGROUP,this.THEAD))}createSpreader(t){const e=t.parentNode;let n;return(!e||e.nodeType!==Node.ELEMENT_NODE||!hA(e,"wtHolder"))&&(n=this.domBindings.rootDocument.createElement("div"),n.className="wtSpreader",e&&e.insertBefore(n,t),n.appendChild(t)),n.style.position="relative",this.wtSettings.getSetting("ariaTags")&&dA(n,[fw()]),n}createHider(t){const e=t.parentNode;let n;return(!e||e.nodeType!==Node.ELEMENT_NODE||!hA(e,"wtHolder"))&&(n=this.domBindings.rootDocument.createElement("div"),n.className="wtHider",e&&e.insertBefore(n,t),n.appendChild(t)),this.wtSettings.getSetting("ariaTags")&&dA(n,[fw()]),n}createHolder(t){const e=t.parentNode;let n;return(!e||e.nodeType!==Node.ELEMENT_NODE||!hA(e,"wtHolder"))&&(n=this.domBindings.rootDocument.createElement("div"),n.style.position="relative",n.className="wtHolder",e&&e.insertBefore(n,t),this.isMaster&&(n.parentNode.className+="ht_master handsontable",n.parentNode.setAttribute("dir",this.wtSettings.getSettingPure("rtlMode")?"rtl":"ltr"),this.wtSettings.getSetting("ariaTags")&&dA(n.parentNode,[fw()])),n.appendChild(t)),this.wtSettings.getSetting("ariaTags")&&dA(n,[fw()]),n}draw(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const{wtSettings:e}=this,{wtOverlays:n,wtViewport:o}=this.dataAccessObject,i=e.getSetting("totalRows"),r=e.getSetting("totalColumns"),s=e.getSetting("rowHeaders"),a=s.length,l=e.getSetting("columnHeaders"),h=l.length;let c=!1,u=t;if(this.isMaster&&(this.holderOffset=yA(this.holder),u=o.createRenderCalculators(u),a&&!e.getSetting("fixedColumnsStart"))){const t=n.inlineStartOverlay.getScrollPosition(),e=this.correctHeaderWidth;this.correctHeaderWidth=0!==t,e!==this.correctHeaderWidth&&(u=!1)}if(this.isMaster&&(c=n.updateStateOfRendering()),u)this.isMaster&&o.createVisibleCalculators(),n&&n.refresh(!0);else{this.isMaster?this.tableOffset=yA(this.TABLE):this.tableOffset=this.dataAccessObject.parentTableOffset;const t=i>0?this.getFirstRenderedRow():0,e=r>0?this.getFirstRenderedColumn():0;this.rowFilter=new kR(t,i,h),this.columnFilter=new SR(e,r,a);let n=!0;if(this.isMaster){this.alignOverlaysWithTrimmingContainer();const t={};this.wtSettings.getSetting("beforeDraw",!0,t),n=!0!==t.skipRender}if(n){let t;if(this.tableRenderer.setHeaderContentRenderers(s,l),(this.is(iT)||this.is(aT))&&this.tableRenderer.setHeaderContentRenderers(s,[]),this.resetOversizedRows(),this.tableRenderer.setViewportSize(this.getRenderedRowsCount(),this.getRenderedColumnsCount()).setFilters(this.rowFilter,this.columnFilter).render(),this.isMaster&&(t=this.dataAccessObject.workspaceWidth,this.dataAccessObject.wtViewport.containerWidth=null,this.markOversizedColumnHeaders()),this.adjustColumnHeaderHeights(),(this.isMaster||this.is(iT))&&this.markOversizedRows(),this.isMaster){this.dataAccessObject.wtViewport.createVisibleCalculators(),this.dataAccessObject.wtOverlays.refresh(!1),this.dataAccessObject.wtOverlays.applyToDOM();const e=IA(this.hider),n=IA(this.TABLE);0!==e&&n!==e&&(this.columnUtils.calculateWidths(),this.tableRenderer.renderer.colGroup.render()),t!==this.dataAccessObject.wtViewport.getWorkspaceWidth()&&(this.dataAccessObject.wtViewport.containerWidth=null,this.columnUtils.calculateWidths(),this.tableRenderer.renderer.colGroup.render()),this.wtSettings.getSetting("onDraw",!0)}else this.is(iT)&&this.dataAccessObject.cloneSource.wtOverlays.adjustElementsSize()}}let d=!1;return this.isMaster&&(d=n.topOverlay.resetFixedPosition(),n.bottomOverlay.clone&&(d=n.bottomOverlay.resetFixedPosition()||d),d=n.inlineStartOverlay.resetFixedPosition()||d,n.topInlineStartCornerOverlay&&n.topInlineStartCornerOverlay.resetFixedPosition(),n.bottomInlineStartCornerOverlay&&n.bottomInlineStartCornerOverlay.clone&&n.bottomInlineStartCornerOverlay.resetFixedPosition()),d?(n.refreshAll(),n.adjustElementsSize()):this.dataAccessObject.selectionManager.setActiveOverlay(this.facadeGetter()).render(u),c&&n.syncScrollWithMaster(),this.dataAccessObject.drawn=!0,this}markIfOversizedColumnHeader(t){const e=this.columnFilter.renderedToSource(t);let n=this.wtSettings.getSetting("columnHeaders").length;const o=this.wtSettings.getSetting("defaultRowHeight");let i,r,s;const a=this.wtSettings.getSetting("columnHeaderHeight")||[];for(;n;)n-=1,i=this.getColumnHeaderHeight(n),r=this.getColumnHeader(e,n),r&&(s=HA(r),(!i&&o<s||i<s)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[n]=s),Array.isArray(a)?null!==a[n]&&void 0!==a[n]&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[n]=a[n]):isNaN(a)||(this.dataAccessObject.wtViewport.oversizedColumnHeaders[n]=a),this.dataAccessObject.wtViewport.oversizedColumnHeaders[n]<(a[n]||a)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[n]=a[n]||a))}adjustColumnHeaderHeights(){const{wtSettings:t}=this,e=this.THEAD.childNodes,n=this.dataAccessObject.wtViewport.oversizedColumnHeaders,o=t.getSetting("columnHeaders");for(let i=0,r=o.length;i<r;i++)if(n[i]){if(!e[i]||0===e[i].childNodes.length)return;e[i].childNodes[0].style.height=`${n[i]}px`}}resetOversizedRows(){const{wtSettings:t}=this,{wtViewport:e}=this.dataAccessObject;if((this.isMaster||this.is(iT))&&!t.getSetting("externalRowCalculator")){const t=this.getRenderedRowsCount();for(let n=0;n<t;n++){const t=this.rowFilter.renderedToSource(n);e.oversizedRows&&e.oversizedRows[t]&&(e.oversizedRows[t]=void 0)}}}getCell(t){let e=t.row,n=t.col;const o=this.wtSettings.getSetting("onModifyGetCellCoords",e,n);if(o&&Array.isArray(o)&&([e,n]=o),this.isRowBeforeRenderedRows(e))return-1;if(this.isRowAfterRenderedRows(e))return-2;if(this.isColumnBeforeRenderedColumns(n))return-3;if(this.isColumnAfterRenderedColumns(n))return-4;const i=this.getRow(e);if(!i&&e>=0)throw new Error("TR was expected to be rendered but is not");const r=i.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(n)];if(!r&&n>=0)throw new Error("TD or TH was expected to be rendered but is not");return r}getRow(t){let e=null,n=null;var o,i;t<0?(e=null===(o=this.rowFilter)||void 0===o?void 0:o.sourceRowToVisibleColHeadedRow(t),n=this.THEAD):(e=null===(i=this.rowFilter)||void 0===i?void 0:i.sourceToRendered(t),n=this.TBODY);return void 0!==e&&void 0!==n&&(!(n.childNodes.length<e+1)&&n.childNodes[e])}getColumnHeader(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n=this.THEAD.childNodes[e];return null==n?void 0:n.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(t)]}getColumnHeaders(t){const e=[],n=this.columnFilter.sourceColumnToVisibleRowHeadedColumn(t);return this.THEAD.childNodes.forEach((t=>{const o=t.childNodes[n];o&&e.push(o)})),e}getRowHeader(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n=this.wtSettings.getSetting("rowHeaders").length;if(e>=n)return;const o=this.rowFilter.sourceToRendered(t),i=o<0?this.rowFilter.sourceRowToVisibleColHeadedRow(t):o,r=(o<0?this.THEAD:this.TBODY).childNodes[i];return null==r?void 0:r.childNodes[e]}getRowHeaders(t){const e=[],n=this.wtSettings.getSetting("rowHeaders").length;for(let o=0;o<n;o++){const n=this.TBODY.childNodes[this.rowFilter.sourceToRendered(t)],i=null==n?void 0:n.childNodes[o];i&&e.push(i)}return e}getCoords(t){let e=t;if("TD"!==e.nodeName&&"TH"!==e.nodeName&&(e=nA(e,["TD","TH"])),null===e)return null;const n=e.parentNode,o=n.parentNode;let i=rA(n),r=e.cellIndex;return sA(sT,e,this.wtRootElement)||sA(oT,e,this.wtRootElement)?"THEAD"===o.nodeName&&(i-=o.childNodes.length):i=sA(aT,e,this.wtRootElement)||sA(iT,e,this.wtRootElement)?this.wtSettings.getSetting("totalRows")-o.childNodes.length+i:o===this.THEAD?this.rowFilter.visibleColHeadedRowToSourceRow(i):this.rowFilter.renderedToSource(i),r=sA(sT,e,this.wtRootElement)||sA(rT,e,this.wtRootElement)||sA(aT,e,this.wtRootElement)?this.columnFilter.offsettedTH(r):this.columnFilter.visibleRowHeadedColumnToSourceColumn(r),this.wot.createCellCoords(i,r)}markOversizedRows(){if(this.wtSettings.getSetting("externalRowCalculator"))return;let t=this.TBODY.childNodes.length;const e=t*this.wtSettings.getSetting("defaultRowHeight"),n=HA(this.TBODY)-1;let o,i,r,s,a;if(e!==n||this.wtSettings.getSetting("fixedRowsBottom"))for(;t;)t-=1,r=this.rowFilter.renderedToSource(t),o=this.getRowHeight(r),s=this.getTrForRow(r),a=s.querySelector("th"),i=a?HA(a):HA(s)-1,(!o&&this.wtSettings.getSetting("defaultRowHeight")<i||o<i)&&(i+=1,this.dataAccessObject.wtViewport.oversizedRows[r]=i)}getTrForRow(t){return this.TBODY.childNodes[this.rowFilter.sourceToRendered(t)]}isColumnHeaderRendered(t){if(t>=0)return!1;const e=this.wtSettings.getSetting("rowHeaders").length;return Math.abs(t)<=e}isRowHeaderRendered(t){if(t>=0)return!1;const e=this.wtSettings.getSetting("columnHeaders").length;return Math.abs(t)<=e}isRowBeforeRenderedRows(t){const e=this.getFirstRenderedRow();return t<0&&e<=0?!this.isRowHeaderRendered(t):t<e}isRowAfterRenderedRows(t){return t>this.getLastRenderedRow()}isColumnBeforeRenderedColumns(t){const e=this.getFirstRenderedColumn();return t<0&&e<=0?!this.isColumnHeaderRendered(t):t<e}isColumnAfterRenderedColumns(t){return this.columnFilter&&t>this.getLastRenderedColumn()}isColumnAfterViewport(t){return this.columnFilter&&t>this.getLastVisibleColumn()}isRowAfterViewport(t){return this.rowFilter&&t>this.getLastVisibleRow()}isColumnBeforeViewport(t){return this.columnFilter&&this.columnFilter.sourceToRendered(t)<0&&t>=0}isLastRowFullyVisible(){return this.getLastVisibleRow()===this.getLastRenderedRow()}isLastColumnFullyVisible(){return this.getLastVisibleColumn()===this.getLastRenderedColumn()}allRowsInViewport(){return this.wtSettings.getSetting("totalRows")===this.getVisibleRowsCount()}allColumnsInViewport(){return this.wtSettings.getSetting("totalColumns")===this.getVisibleColumnsCount()}getRowHeight(t){return this.rowUtils.getHeight(t)}getColumnHeaderHeight(t){return this.columnUtils.getHeaderHeight(t)}getColumnWidth(t){return this.columnUtils.getWidth(t)}getStretchedColumnWidth(t){return this.columnUtils.getStretchedColumnWidth(t)}hasDefinedSize(){return this.hasTableHeight&&this.hasTableWidth}getWidth(){return IA(this.TABLE)}getHeight(){return OA(this.TABLE)}getTotalWidth(){const t=IA(this.hider);return 0!==t?t:this.getWidth()}getTotalHeight(){const t=OA(this.hider);return 0!==t?t:this.getHeight()}isVisible(){return vA(this.TABLE)}_modifyRowHeaderWidth(t){let e=iv(t)?t():null;return Array.isArray(e)?(e=[...e],e[e.length-1]=this._correctRowHeaderWidth(e[e.length-1])):e=this._correctRowHeaderWidth(e),e}_correctRowHeaderWidth(t){let e=t;return"number"!=typeof t&&(e=this.wtSettings.getSetting("defaultColumnWidth")),this.correctHeaderWidth&&(e+=1),e}}const KM=QM,XM="stickyRowsBottom",qM={getFirstRenderedRow(){const t=this.wtSettings.getSetting("totalRows"),e=this.wtSettings.getSetting("fixedRowsBottom"),n=t-e;return 0===t||0===e?-1:n<0?0:n},getFirstVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.wtSettings.getSetting("totalRows")-1},getLastVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){const t=this.wtSettings.getSetting("totalRows");return Math.min(this.wtSettings.getSetting("fixedRowsBottom"),t)},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount(){return 0}};ey(qM,"MIXIN_NAME",XM,{writable:!1,enumerable:!1});const ZM=qM,JM="stickyColumnsStart",$M={getFirstRenderedColumn(){return 0===this.wtSettings.getSetting("totalColumns")?-1:0},getFirstVisibleColumn(){return this.getFirstRenderedColumn()},getLastRenderedColumn(){return this.getRenderedColumnsCount()-1},getLastVisibleColumn(){return this.getLastRenderedColumn()},getRenderedColumnsCount(){const t=this.wtSettings.getSetting("totalColumns");return Math.min(this.wtSettings.getSetting("fixedColumnsStart"),t)},getVisibleColumnsCount(){return this.getRenderedColumnsCount()},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};ey($M,"MIXIN_NAME",JM,{writable:!1,enumerable:!1});const tT=$M;class eT extends KM{constructor(t,e,n,o){super(t,e,n,o,aT)}}Jv(eT,ZM),Jv(eT,tT);const nT=eT,oT="top",iT="bottom",rT="inline_start",sT="top_inline_start_corner",aT="bottom_inline_start_corner",lT=[oT,iT,rT,sT,aT],hT=new Map([[oT,`ht_clone_${oT}`],[iT,`ht_clone_${iT}`],[rT,`ht_clone_${rT} ht_clone_left`],[sT,`ht_clone_${sT} ht_clone_top_left_corner`],[aT,`ht_clone_${aT} ht_clone_bottom_left_corner`]]);function cT(t,e,n){return e=uT(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function uT(t){var e=dT(t,"string");return"symbol"==typeof e?e:String(e)}function dT(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class gT{constructor(t){cT(this,"dataAccessObject",void 0),cT(this,"lastScrolledColumnPos",-1),cT(this,"lastScrolledRowPos",-1),this.dataAccessObject=t}scrollViewport(t,e,n,o,i){const r=this.scrollViewportHorizontally(t.col,n,i),s=this.scrollViewportVertically(t.row,e,o);return r||s}scrollViewportHorizontally(t,e,n){const{drawn:o,totalColumns:i}=this.dataAccessObject;if(!o||!Number.isInteger(t)||t<0||t>i)return!1;const r=this.getFirstVisibleColumn(),s=this.getLastVisibleColumn(),a=void 0===e&&void 0===n,{fixedColumnsStart:l,inlineStartOverlay:h}=this.dataAccessObject;if(a&&t<l)return!1;let c=!1;return t=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollHorizontally",t),-1===r?c=h.scrollTo(t,a?t>this.lastScrolledColumnPos:e):(a&&(t<r||t>s)||!a)&&(c=h.scrollTo(t,a?t>s:e)),c&&(this.lastScrolledColumnPos=t),c}scrollViewportVertically(t,e,n){const{drawn:o,totalRows:i}=this.dataAccessObject;if(!o||!Number.isInteger(t)||t<0||t>i)return!1;const r=this.getFirstVisibleRow(),s=this.getLastVisibleRow(),a=void 0===e&&void 0===n,{fixedRowsBottom:l,fixedRowsTop:h,topOverlay:c}=this.dataAccessObject;if(a&&(t<h||t>i-l-1))return!1;let u=!1;return t=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollVertically",t),-1===r?u=c.scrollTo(t,a?t>this.lastScrolledRowPos:n):(a&&(t<r||t>s)||!a)&&(u=c.scrollTo(t,a?t>s:n)),u&&(this.lastScrolledRowPos=t),u}getFirstVisibleRow(){return this.dataAccessObject.wtTable.getFirstVisibleRow()}getLastVisibleRow(){const{topOverlay:t,wtTable:e,wtViewport:n,totalRows:o,rootWindow:i}=this.dataAccessObject;let r=e.getLastVisibleRow();if(t.mainTableScrollableElement===i){const s=yA(e.wtRootElement),a=SA(i,i);if(s.top>a){const e=HA(i);let l=n.getColumnHeaderHeight();for(let n=1;n<=o;n++)if(l+=t.sumCellSizes(n-1,n),s.top+l-a>=e){r=n-2;break}}}return r}getFirstVisibleColumn(){return this.dataAccessObject.wtTable.getFirstVisibleColumn()}getLastVisibleColumn(){const{wtSettings:t,inlineStartOverlay:e,wtTable:n,wtViewport:o,totalColumns:i,rootWindow:r}=this.dataAccessObject;let s=n.getLastVisibleColumn();if(e.mainTableScrollableElement===r){const a=t.getSetting("rtlMode");let l=null;if(a){const t=n.TABLE.getBoundingClientRect(),e=this.dataAccessObject.rootWindow.document.documentElement.offsetWidth;l=Math.abs(t.right-e)}else l=yA(n.wtRootElement).left;const h=Math.abs(EA(r,r));if(l>h){const t=DA(r);let n=o.getRowHeaderWidth();for(let o=1;o<=i;o++)if(n+=e.sumCellSizes(o-1,o),l+n-h>=t){s=o-2;break}}}return s}}const fT=gT;function mT(t,e,n){return e=pT(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function pT(t){var e=wT(t,"string");return"symbol"==typeof e?e:String(e)}function wT(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class AT{get eventManager(){return new MC(this)}constructor(t,e){mT(this,"wtTable",void 0),mT(this,"wtScroll",void 0),mT(this,"wtViewport",void 0),mT(this,"wtOverlays",void 0),mT(this,"selectionManager",void 0),mT(this,"wtEvent",void 0),mT(this,"guid",`wt_${sw()}`),mT(this,"drawInterrupted",!1),mT(this,"drawn",!1),mT(this,"domBindings",void 0),mT(this,"wtSettings",void 0),this.domBindings={rootTable:t,rootDocument:t.ownerDocument,rootWindow:t.ownerDocument.defaultView},this.wtSettings=e,this.wtScroll=new fT(this.createScrollDao())}findOriginalHeaders(){const t=[];if(this.wtTable.THEAD.childNodes.length&&this.wtTable.THEAD.childNodes[0].childNodes.length){for(let e=0,n=this.wtTable.THEAD.childNodes[0].childNodes.length;e<n;e++)t.push(this.wtTable.THEAD.childNodes[0].childNodes[e].innerHTML);this.wtSettings.getSetting("columnHeaders").length||this.wtSettings.update("columnHeaders",[function(e,n){AA(n,t[e])}])}}createCellCoords(t,e){return new WE(t,e,this.wtSettings.getSetting("rtlMode"))}createCellRange(t,e,n){return new $E(t,e,n,this.wtSettings.getSetting("rtlMode"))}draw(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this.drawInterrupted=!1,t||this.wtTable.isVisible()?this.wtTable.draw(t):this.drawInterrupted=!0,this}getCell(t){if(!(arguments.length>1&&void 0!==arguments[1]&&arguments[1]))return this.wtTable.getCell(t);const e=this.wtSettings.getSetting("totalRows"),n=this.wtSettings.getSetting("fixedRowsTop"),o=this.wtSettings.getSetting("fixedRowsBottom"),i=this.wtSettings.getSetting("fixedColumnsStart");if(t.row<n&&t.col<i)return this.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.getCell(t);if(t.row<n)return this.wtOverlays.topOverlay.clone.wtTable.getCell(t);if(t.col<i&&t.row>=e-o){if(this.wtOverlays.bottomInlineStartCornerOverlay&&this.wtOverlays.bottomInlineStartCornerOverlay.clone)return this.wtOverlays.bottomInlineStartCornerOverlay.clone.wtTable.getCell(t)}else{if(t.col<i)return this.wtOverlays.inlineStartOverlay.clone.wtTable.getCell(t);if(t.row<e&&t.row>=e-o&&this.wtOverlays.bottomOverlay&&this.wtOverlays.bottomOverlay.clone)return this.wtOverlays.bottomOverlay.clone.wtTable.getCell(t)}return this.wtTable.getCell(t)}scrollViewport(t,e,n,o,i){return!(t.col<0||t.row<0)&&this.wtScroll.scrollViewport(t,e,n,o,i)}scrollViewportHorizontally(t,e,n){return!(t<0)&&this.wtScroll.scrollViewportHorizontally(t,e,n)}scrollViewportVertically(t,e,n){return!(t<0)&&this.wtScroll.scrollViewportVertically(t,e,n)}getViewport(){return[this.wtTable.getFirstVisibleRow(),this.wtTable.getFirstVisibleColumn(),this.wtTable.getLastVisibleRow(),this.wtTable.getLastVisibleColumn()]}destroy(){this.wtOverlays.destroy(),this.wtEvent.destroy()}createScrollDao(){const t=this;return{get drawn(){return t.drawn},get topOverlay(){return t.wtOverlays.topOverlay},get inlineStartOverlay(){return t.wtOverlays.inlineStartOverlay},get wtTable(){return t.wtTable},get wtViewport(){return t.wtViewport},get wtSettings(){return t.wtSettings},get rootWindow(){return t.domBindings.rootWindow},get totalRows(){return t.wtSettings.getSetting("totalRows")},get totalColumns(){return t.wtSettings.getSetting("totalColumns")},get fixedRowsTop(){return t.wtSettings.getSetting("fixedRowsTop")},get fixedRowsBottom(){return t.wtSettings.getSetting("fixedRowsBottom")},get fixedColumnsStart(){return t.wtSettings.getSetting("fixedColumnsStart")}}}getTableDao(){const t=this;return{get wot(){return t},get parentTableOffset(){return t.cloneSource.wtTable.tableOffset},get cloneSource(){return t.cloneSource},get workspaceWidth(){return t.wtViewport.getWorkspaceWidth()},get wtViewport(){return t.wtViewport},get wtOverlays(){return t.wtOverlays},get selectionManager(){return t.selectionManager},get drawn(){return t.drawn},set drawn(e){t.drawn=e},get wtTable(){return t.wtTable},get startColumnRendered(){return t.wtViewport.columnsRenderCalculator.startColumn},get startColumnVisible(){return t.wtViewport.columnsVisibleCalculator.startColumn},get endColumnRendered(){return t.wtViewport.columnsRenderCalculator.endColumn},get endColumnVisible(){return t.wtViewport.columnsVisibleCalculator.endColumn},get countColumnsRendered(){return t.wtViewport.columnsRenderCalculator.count},get countColumnsVisible(){return t.wtViewport.columnsVisibleCalculator.count},get startRowRendered(){return t.wtViewport.rowsRenderCalculator.startRow},get startRowVisible(){return t.wtViewport.rowsVisibleCalculator.startRow},get endRowRendered(){return t.wtViewport.rowsRenderCalculator.endRow},get endRowVisible(){return t.wtViewport.rowsVisibleCalculator.endRow},get countRowsRendered(){return t.wtViewport.rowsRenderCalculator.count},get countRowsVisible(){return t.wtViewport.rowsVisibleCalculator.count},get columnHeaders(){return t.wtSettings.getSetting("columnHeaders")},get rowHeaders(){return t.wtSettings.getSetting("rowHeaders")}}}}function vT(t,e,n){return e=yT(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function yT(t){var e=CT(t,"string");return"symbol"==typeof e?e:String(e)}function CT(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class bT extends AT{constructor(t,e,n){super(t,e),vT(this,"cloneSource",void 0),vT(this,"cloneOverlay",void 0);const o=this.wtSettings.getSetting("facade",this);this.cloneSource=n.source,this.cloneOverlay=n.overlay,this.wtTable=this.cloneOverlay.createTable(this.getTableDao(),o,this.domBindings,this.wtSettings),this.wtViewport=n.viewport,this.selectionManager=n.selectionManager,this.wtEvent=new AR(o,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager,n.event),this.findOriginalHeaders()}}function ST(t,e,n){return e=ET(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ET(t){var e=RT(t,"string");return"symbol"==typeof e?e:String(e)}function RT(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class MT{constructor(t,e,n,o,i){ST(this,"wtSettings",null),ey(this,"wot",t,{writable:!1}),this.domBindings=i,this.facadeGetter=e,this.wtSettings=o;const{TABLE:r,hider:s,spreader:a,holder:l,wtRootElement:h}=this.wot.wtTable;this.instance=this.wot,this.type=n,this.mainTableScrollableElement=null,this.TABLE=r,this.hider=s,this.spreader=a,this.holder=l,this.wtRootElement=h,this.trimmingContainer=MA(this.hider.parentNode.parentNode),this.updateStateOfRendering(),this.clone=this.makeClone()}updateStateOfRendering(){const t=this.needFullRender;this.needFullRender=this.shouldBeRendered();const e=t!==this.needFullRender;return e&&!this.needFullRender&&this.reset(),e}shouldBeRendered(){return!0}updateTrimmingContainer(){this.trimmingContainer=MA(this.hider.parentNode.parentNode)}updateMainScrollableElement(){const{wtTable:t}=this.wot,{rootWindow:e}=this.domBindings;"hidden"===e.getComputedStyle(t.wtRootElement.parentNode).getPropertyValue("overflow")?this.mainTableScrollableElement=this.wot.wtTable.holder:this.mainTableScrollableElement=RA(t.TABLE)}getRelativeCellPosition(t,e,n){if(!1===this.clone.wtTable.holder.contains(t))return void Xy(`The provided element is not a child of the ${this.type} overlay`);const o=this.mainTableScrollableElement===this.domBindings.rootWindow,i=n<this.wtSettings.getSetting("fixedColumnsStart"),r=e<this.wtSettings.getSetting("fixedRowsTop"),s=e>=this.wtSettings.getSetting("totalRows")-this.wtSettings.getSetting("fixedRowsBottom"),a=this.clone.wtTable.spreader,l={start:this.getRelativeStartPosition(a),top:a.offsetTop},h={start:this.getRelativeStartPosition(t),top:t.offsetTop};let c=null;return c=o?this.getRelativeCellPositionWithinWindow(r,i,h,l):this.getRelativeCellPositionWithinHolder(r,s,i,h,l),c}getRelativeStartPosition(t){return this.isRtl()?t.offsetParent.offsetWidth-t.offsetLeft-t.offsetWidth:t.offsetLeft}getRelativeCellPositionWithinWindow(t,e,n,o){const i=this.wot.wtTable.wtRootElement.getBoundingClientRect();let r=0,s=0;if(e){let t=i.left;this.isRtl()&&(t=this.domBindings.rootWindow.innerWidth-(i.left+i.width+UA())),r=t<=0?-1*t:0}else r=o.start;return s=t?this.clone.wtTable.TABLE.getBoundingClientRect().top-i.top:o.top,{start:n.start+r,top:n.top+s}}getRelativeCellPositionWithinHolder(t,e,n,o,i){const r={horizontal:this.wot.wtOverlays.inlineStartOverlay.getScrollPosition(),vertical:this.wot.wtOverlays.topOverlay.getScrollPosition()};let s=0,a=0;if(n||(s=r.horizontal-i.start),e){const t=this.wot.wtTable.wtRootElement.getBoundingClientRect();a=-1*this.clone.wtTable.TABLE.getBoundingClientRect().top+t.top}else t||(a=r.vertical-i.top);return{start:o.start-s,top:o.top-a}}makeClone(){if(-1===lT.indexOf(this.type))throw new Error(`Clone type "${this.type}" is not supported.`);const{wtTable:t,wtSettings:e}=this.wot,{rootDocument:n,rootWindow:o}=this.domBindings,i=n.createElement("div"),r=n.createElement("table"),s=t.wtRootElement.parentNode;i.className=`${hT.get(this.type)} handsontable`,i.setAttribute("dir",this.isRtl()?"rtl":"ltr"),i.style.position="absolute",i.style.top=0,i.style.overflow="visible",this.isRtl()?i.style.right=0:i.style.left=0,e.getSetting("ariaTags")&&dA(i,[fw()]),r.className=t.TABLE.className,t.TABLE.getAttribute("role")&&r.setAttribute("role",t.TABLE.getAttribute("role")),i.appendChild(r),s.appendChild(i);const a=this.wtSettings.getSetting("preventOverflow");return!0===a||"horizontal"===a&&this.type===oT||"vertical"===a&&this.type===rT?this.mainTableScrollableElement=o:"hidden"===o.getComputedStyle(s).getPropertyValue("overflow")?this.mainTableScrollableElement=t.holder:this.mainTableScrollableElement=RA(t.TABLE),new bT(r,this.wtSettings,{source:this.wot,overlay:this,viewport:this.wot.wtViewport,event:this.wot.wtEvent,selectionManager:this.wot.selectionManager})}refresh(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const e=this.shouldBeRendered();this.clone&&(this.needFullRender||e)&&this.clone.draw(t),this.needFullRender=e}reset(){if(!this.clone)return;const t=this.clone.wtTable.holder,e=this.clone.wtTable.hider,n=t.style,o=e.style,i=t.parentNode.style;Mp([n,o,i],(t=>{t.width="",t.height=""}))}isRtl(){return this.wtSettings.getSetting("rtlMode")}destroy(){this.clone.eventManager.destroy()}}class TT extends MT{constructor(t,e,n,o,i,r){super(t,e,aT,n,o),this.bottomOverlay=i,this.inlineStartOverlay=r}createTable(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return new nT(...e)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){const{wot:t}=this;if(this.updateTrimmingContainer(),!t.wtTable.holder.parentNode)return!1;const e=this.clone.wtTable.holder.parentNode;if(e.style.top="",this.trimmingContainer===this.domBindings.rootWindow){const t=this.inlineStartOverlay.getOverlayOffset(),n=this.bottomOverlay.getOverlayOffset();e.style[this.isRtl()?"right":"left"]=`${t}px`,e.style.bottom=`${n}px`}else KA(e),this.repositionOverlay();let n=OA(this.clone.wtTable.TABLE);const o=IA(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(n=0),e.style.height=`${n}px`,e.style.width=`${o}px`,!1}repositionOverlay(){const{wtTable:t,wtViewport:e}=this.wot,{rootDocument:n}=this.domBindings,o=this.clone.wtTable.holder.parentNode;let i=0;e.hasVerticalScroll()||(i+=e.getWorkspaceHeight()-t.getTotalHeight()),e.hasVerticalScroll()&&e.hasHorizontalScroll()&&(i+=UA(n)),o.style.bottom=`${i}px`}}const kT="calculatedColumns",xT={getFirstRenderedColumn(){const t=this.dataAccessObject.startColumnRendered;return null===t?-1:t},getFirstVisibleColumn(){const t=this.dataAccessObject.startColumnVisible;return null===t?-1:t},getLastRenderedColumn(){const t=this.dataAccessObject.endColumnRendered;return null===t?-1:t},getLastVisibleColumn(){const t=this.dataAccessObject.endColumnVisible;return null===t?-1:t},getRenderedColumnsCount(){return this.dataAccessObject.countColumnsRendered},getVisibleColumnsCount(){return this.dataAccessObject.countColumnsVisible},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};ey(xT,"MIXIN_NAME",kT,{writable:!1,enumerable:!1});const IT=xT;class OT extends KM{constructor(t,e,n,o){super(t,e,n,o,iT)}}Jv(OT,ZM),Jv(OT,IT);const HT=OT;function DT(t,e,n){return e=NT(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function NT(t){var e=PT(t,"string");return"symbol"==typeof e?e:String(e)}function PT(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class _T extends MT{constructor(t,e,n,o){super(t,e,iT,n,o),DT(this,"cachedFixedRowsBottom",-1),this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom")}createTable(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return new HT(...e)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.wot.wtTable.holder.parentNode)return!1;const{rootWindow:t}=this.domBindings,e=this.clone.wtTable.holder.parentNode;e.style.top="";let n=0;const o=this.wtSettings.getSetting("preventOverflow");this.trimmingContainer!==t||o&&"vertical"===o?(n=this.getScrollPosition(),this.repositionOverlay()):(n=this.getOverlayOffset(),e.style.bottom=`${n}px`);const i=this.adjustHeaderBordersPosition(n);return this.adjustElementsSize(),i}repositionOverlay(){const{wtTable:t,wtViewport:e}=this.wot,{rootDocument:n}=this.domBindings,o=this.clone.wtTable.holder.parentNode;let i=0;e.hasVerticalScroll()||(i+=e.getWorkspaceHeight()-t.getTotalHeight()),e.hasVerticalScroll()&&e.hasHorizontalScroll()&&(i+=UA(n)),o.style.bottom=`${i}px`}setScrollPosition(t){const{rootWindow:e}=this.domBindings;let n=!1;return this.mainTableScrollableElement===e?(e.scrollTo(bA(e),t),n=!0):this.mainTableScrollableElement.scrollTop!==t&&(this.mainTableScrollableElement.scrollTop=t,n=!0),n}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(t,e){const{wtTable:n,wtSettings:o}=this.wot,i=o.getSetting("defaultRowHeight");let r=t,s=0;for(;r<e;){const t=n.getRowHeight(r);s+=void 0===t?i:t,r+=1}return s}adjustElementsSize(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.updateTrimmingContainer(),(this.needFullRender||t)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:t,wtViewport:e}=this.wot,{rootDocument:n,rootWindow:o}=this.domBindings,i=UA(n),r=this.clone.wtTable.holder.parentNode.style,s=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==o||"horizontal"===s){let n=e.getWorkspaceWidth();this.wot.wtOverlays.hasScrollbarRight&&(n-=i),n=Math.min(n,t.wtRootElement.scrollWidth),r.width=`${n}px`}else r.width="";this.clone.wtTable.holder.style.width=r.width;let a=OA(this.clone.wtTable.TABLE);this.wot.wtTable.hasDefinedSize()||(a=0),r.height=`${a}px`}adjustRootChildrenSize(){const{holder:t}=this.clone.wtTable;this.clone.wtTable.hider.style.width=this.hider.style.width,t.style.width=t.parentNode.style.width,t.style.height=t.parentNode.style.height}applyToDOM(){const t=this.wtSettings.getSetting("totalRows");if("number"==typeof this.wot.wtViewport.rowsRenderCalculator.startPosition)this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else{if(0!==t)throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.top="0"}this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){const t=this.isRtl()?"right":"left",{spreader:e}=this.clone.wtTable;"number"==typeof this.wot.wtViewport.columnsRenderCalculator.startPosition?e.style[t]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:e.style[t]=""}scrollTo(t,e){let n=this.getTableParentOffset();const o=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder;let i=0;e&&o.offsetHeight!==o.clientHeight&&(i=UA(this.domBindings.rootDocument)),e?(n+=this.sumCellSizes(0,t+1),n-=this.wot.wtViewport.getViewportHeight(),n+=1):n+=this.sumCellSizes(this.wtSettings.getSetting("fixedRowsBottom"),t),n+=i,this.setScrollPosition(n)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return SA(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){const{rootWindow:t}=this.domBindings,e=this.wtSettings.getSetting("preventOverflow");let n=0;if(this.trimmingContainer===t&&(!e||"vertical"!==e)){const t=this.wot.wtTable.getTotalHeight(),e=this.clone.wtTable.getTotalHeight(),o=t-e,i=this.domBindings.rootDocument.documentElement.clientHeight;n=Math.max(this.getTableParentOffset()-this.getScrollPosition()-i+t,0),n>o&&(n=0)}return n}adjustHeaderBordersPosition(t){const e=this.wtSettings.getSetting("fixedRowsBottom"),n=this.cachedFixedRowsBottom!==e,o=this.wtSettings.getSetting("columnHeaders");let i=!1;if((n||0===e)&&o.length>0){const e=this.wot.wtTable.holder.parentNode,n=hA(e,"innerBorderBottom");this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom"),t||0===this.wtSettings.getSetting("totalRows")?(cA(e,"innerBorderBottom"),i=!n):(uA(e,"innerBorderBottom"),i=n)}return i}}const BT="calculatedRows",LT={getFirstRenderedRow(){const t=this.dataAccessObject.startRowRendered;return null===t?-1:t},getFirstVisibleRow(){const t=this.dataAccessObject.startRowVisible;return null===t?-1:t},getLastRenderedRow(){const t=this.dataAccessObject.endRowRendered;return null===t?-1:t},getLastVisibleRow(){const t=this.dataAccessObject.endRowVisible;return null===t?-1:t},getRenderedRowsCount(){return this.dataAccessObject.countRowsRendered},getVisibleRowsCount(){return this.dataAccessObject.countRowsVisible},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};ey(LT,"MIXIN_NAME",BT,{writable:!1,enumerable:!1});const VT=LT;class WT extends KM{constructor(t,e,n,o){super(t,e,n,o,rT)}}Jv(WT,VT),Jv(WT,tT);const FT=WT,jT="localHooks",UT={_localHooks:Object.create(null),addLocalHook(t,e){return this._localHooks[t]||(this._localHooks[t]=[]),this._localHooks[t].push(e),this},runLocalHooks(t,e,n,o,i,r,s){if(this._localHooks[t]){const a=this._localHooks[t].length;for(let l=0;l<a;l++)dv(this._localHooks[t][l],this,e,n,o,i,r,s)}},clearLocalHooks(){return this._localHooks={},this}};ey(UT,"MIXIN_NAME",jT,{writable:!1,enumerable:!1});const YT=UT;let zT=class{constructor(t,e){this.settings=t,this.cellRange=e||null}isEmpty(){return null===this.cellRange}add(t){return this.isEmpty()?this.cellRange=this.settings.createCellRange(t):this.cellRange.expand(t),this}replace(t,e){if(!this.isEmpty()){if(this.cellRange.from.isEqual(t))return this.cellRange.from=e,!0;if(this.cellRange.to.isEqual(t))return this.cellRange.to=e,!0}return!1}clear(){return this.cellRange=null,this}getCorners(){const t=this.cellRange.getOuterTopStartCorner(),e=this.cellRange.getOuterBottomEndCorner();return[t.row,t.col,e.row,e.col]}destroy(){this.runLocalHooks("destroy")}};Jv(zT,YT);const GT=zT,QT="active-header",KT="header",XT="area",qT="focus",ZT="fill",JT="row",$T="column",tk="custom-selection",ek=Object.freeze({width:"6px",height:"6px",borderWidth:"1px",borderStyle:"solid",borderColor:"#FFF"});var nk=qS;function ok(t,e){rk(t,e),e.add(t)}function ik(t,e,n){rk(t,e),e.set(t,n)}function rk(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function sk(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function ak(t,e){var n=ck(t,e,"get");return lk(t,n)}function lk(t,e){return e.get?e.get.call(t):e.value}function hk(t,e,n){var o=ck(t,e,"set");return uk(t,o,n),n}function ck(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function uk(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}nk("flat");var dk=new WeakMap,gk=new WeakMap,fk=new WeakSet;class mk{constructor(){ok(this,fk),ik(this,dk,{writable:!0,value:void 0}),ik(this,gk,{writable:!0,value:void 0})}setActiveOverlay(t){return hk(this,gk,t),this}setActiveSelection(t){return hk(this,dk,t),this}scan(){const t=ak(this,dk).settings.selectionType,e=new Set;return"active-header"===t?(this.scanColumnsInHeadersRange((t=>e.add(t))),this.scanRowsInHeadersRange((t=>e.add(t)))):"area"===t?this.scanCellsRange((t=>e.add(t))):"focus"===t?(this.scanColumnsInHeadersRange((t=>e.add(t))),this.scanRowsInHeadersRange((t=>e.add(t))),this.scanCellsRange((t=>e.add(t)))):"fill"===t?this.scanCellsRange((t=>e.add(t))):"header"===t?(this.scanColumnsInHeadersRange((t=>e.add(t))),this.scanRowsInHeadersRange((t=>e.add(t)))):"row"===t?(this.scanRowsInHeadersRange((t=>e.add(t))),this.scanRowsInCellsRange((t=>e.add(t)))):"column"===t&&(this.scanColumnsInHeadersRange((t=>e.add(t))),this.scanColumnsInCellsRange((t=>e.add(t)))),e}scanColumnsInHeadersRange(t){const[e,n,o,i]=ak(this,dk).getCorners(),{wtTable:r}=ak(this,gk),s=r.getRenderedColumnsCount(),a=r.getColumnHeadersCount();let l=0;for(let h=-r.getRowHeadersCount();h<s;h++){const s=r.columnFilter.renderedToSource(h);if(!(s<n||s>i)){for(let h=-a;h<0;h++){if(h<e||h>o)continue;const c=h+a;let u=r.getColumnHeader(s,c);const d=ak(this,gk).getSetting("onBeforeHighlightingColumnHeader",s,c,{selectionType:ak(this,dk).settings.selectionType,columnCursor:l,selectionWidth:i-n+1});null!==d&&(d!==s&&(u=r.getColumnHeader(d,c)),t(u))}l+=1}}}scanRowsInHeadersRange(t){const[e,n,o,i]=ak(this,dk).getCorners(),{wtTable:r}=ak(this,gk),s=r.getRenderedRowsCount(),a=r.getRowHeadersCount();let l=0;for(let h=-r.getColumnHeadersCount();h<s;h++){const s=r.rowFilter.renderedToSource(h);if(!(s<e||s>o)){for(let h=-a;h<0;h++){if(h<n||h>i)continue;const c=h+a;let u=r.getRowHeader(s,c);const d=ak(this,gk).getSetting("onBeforeHighlightingRowHeader",s,c,{selectionType:ak(this,dk).settings.selectionType,rowCursor:l,selectionHeight:o-e+1});null!==d&&(d!==s&&(u=r.getRowHeader(d,c)),t(u))}l+=1}}}scanCellsRange(t){const[e,n,o,i]=ak(this,dk).getCorners(),{wtTable:r}=ak(this,gk);sk(this,fk,pk).call(this,((s,a)=>{if(s>=e&&s<=o&&a>=n&&a<=i){const e=r.getCell(ak(this,gk).createCellCoords(s,a)),n=ak(this,gk).getSetting("onAfterDrawSelection",s,a,ak(this,dk).settings.layerLevel);"string"==typeof n&&cA(e,n),t(e)}}))}scanRowsInCellsRange(t){const[e,,n]=ak(this,dk).getCorners(),{wtTable:o}=ak(this,gk);sk(this,fk,pk).call(this,((i,r)=>{if(i>=e&&i<=n){const e=o.getCell(ak(this,gk).createCellCoords(i,r));t(e)}}))}scanColumnsInCellsRange(t){const[,e,,n]=ak(this,dk).getCorners(),{wtTable:o}=ak(this,gk);sk(this,fk,pk).call(this,((i,r)=>{if(r>=e&&r<=n){const e=o.getCell(ak(this,gk).createCellCoords(i,r));t(e)}}))}}function pk(t){const{wtTable:e}=ak(this,gk),n=e.getRenderedRowsCount(),o=e.getRenderedColumnsCount();for(let i=0;i<n;i+=1){const n=e.rowFilter.renderedToSource(i);for(let i=0;i<o;i+=1)t(n,e.columnFilter.renderedToSource(i))}}class wk{constructor(t,e){e&&(this.eventManager=t.eventManager,this.instance=t,this.wot=t,this.settings=e,this.mouseDown=!1,this.main=null,this.top=null,this.bottom=null,this.start=null,this.end=null,this.topStyle=null,this.bottomStyle=null,this.startStyle=null,this.endStyle=null,this.cornerDefaultStyle=ek,this.cornerCenterPointOffset=-parseInt(this.cornerDefaultStyle.width,10)/2,this.corner=null,this.cornerStyle=null,this.createBorders(e),this.registerListeners())}registerListeners(){const t=this.wot.rootDocument.body;this.eventManager.addEventListener(t,"mousedown",(()=>this.onMouseDown())),this.eventManager.addEventListener(t,"mouseup",(()=>this.onMouseUp()));for(let e=0,n=this.main.childNodes.length;e<n;e++){const t=this.main.childNodes[e];this.eventManager.addEventListener(t,"mouseenter",(t=>this.onMouseEnter(t,this.main.childNodes[e])))}}onMouseDown(){this.mouseDown=!0}onMouseUp(){this.mouseDown=!1}onMouseEnter(t,e){if(!this.mouseDown||!this.wot.getSetting("hideBorderOnMouseDownOver"))return;t.preventDefault(),Uy(t);const n=this,o=this.wot.rootDocument.body,i=e.getBoundingClientRect();function r(t){if(t.clientY<Math.floor(i.top)||t.clientY>Math.ceil(i.top+i.height)||t.clientX<Math.floor(i.left)||t.clientX>Math.ceil(i.left+i.width))return!0}function s(t){r(t)&&(n.eventManager.removeEventListener(o,"mousemove",s),e.style.display="block")}e.style.display="none",this.eventManager.addEventListener(o,"mousemove",s)}createBorders(t){const{rootDocument:e}=this.wot;this.main=e.createElement("div");const n=["top","start","bottom","end","corner"];let o=this.main.style;o.position="absolute",o.top=0,o.left=0;for(let s=0;s<5;s++){const i=n[s],r=e.createElement("div");r.className=`wtBorder ${this.settings.className||""}`,this.settings[i]&&this.settings[i].hide&&(r.className+=" hidden"),o=r.style,o.backgroundColor=this.settings[i]&&this.settings[i].color?this.settings[i].color:t.border.color,o.height=this.settings[i]&&this.settings[i].width?`${this.settings[i].width}px`:`${t.border.width}px`,o.width=this.settings[i]&&this.settings[i].width?`${this.settings[i].width}px`:`${t.border.width}px`,this.main.appendChild(r)}this.top=this.main.childNodes[0],this.start=this.main.childNodes[1],this.bottom=this.main.childNodes[2],this.end=this.main.childNodes[3],this.topStyle=this.top.style,this.startStyle=this.start.style,this.bottomStyle=this.bottom.style,this.endStyle=this.end.style,this.corner=this.main.childNodes[4],this.corner.className+=" corner",this.cornerStyle=this.corner.style,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.height=this.cornerDefaultStyle.height,this.cornerStyle.border=[this.cornerDefaultStyle.borderWidth,this.cornerDefaultStyle.borderStyle,this.cornerDefaultStyle.borderColor].join(" "),ky()&&this.createMultipleSelectorHandles(),this.disappear();const{wtTable:i}=this.wot;let r=i.bordersHolder;r||(r=e.createElement("div"),r.className="htBorders",i.bordersHolder=r,i.spreader.appendChild(r)),r.appendChild(this.main)}createMultipleSelectorHandles(){const{rootDocument:t}=this.wot;this.selectionHandles={top:t.createElement("DIV"),topHitArea:t.createElement("DIV"),bottom:t.createElement("DIV"),bottomHitArea:t.createElement("DIV")};const e=10,n=40;this.selectionHandles.top.className="topSelectionHandle topLeftSelectionHandle",this.selectionHandles.topHitArea.className="topSelectionHandle-HitArea topLeftSelectionHandle-HitArea",this.selectionHandles.bottom.className="bottomSelectionHandle bottomRightSelectionHandle",this.selectionHandles.bottomHitArea.className="bottomSelectionHandle-HitArea bottomRightSelectionHandle-HitArea",this.selectionHandles.styles={top:this.selectionHandles.top.style,topHitArea:this.selectionHandles.topHitArea.style,bottom:this.selectionHandles.bottom.style,bottomHitArea:this.selectionHandles.bottomHitArea.style};const o={position:"absolute",height:`${n}px`,width:`${n}px`,"border-radius":`${parseInt(n/1.5,10)}px`};ny(o,((t,e)=>{this.selectionHandles.styles.bottomHitArea[e]=t,this.selectionHandles.styles.topHitArea[e]=t}));const i={position:"absolute",height:`${e}px`,width:`${e}px`,"border-radius":`${parseInt(e/1.5,10)}px`,background:"#F5F5FF",border:"1px solid #4285c8"};ny(i,((t,e)=>{this.selectionHandles.styles.bottom[e]=t,this.selectionHandles.styles.top[e]=t})),this.main.appendChild(this.selectionHandles.top),this.main.appendChild(this.selectionHandles.bottom),this.main.appendChild(this.selectionHandles.topHitArea),this.main.appendChild(this.selectionHandles.bottomHitArea)}isPartRange(t,e){const n=this.wot.selectionManager.getAreaSelection();return!(!n.cellRange||t===n.cellRange.to.row&&e===n.cellRange.to.col)}updateMultipleSelectionHandlesPosition(t,e,n,o,i,r){const s=this.wot.wtSettings.getSetting("rtlMode")?"right":"left",{top:a,topHitArea:l,bottom:h,bottomHitArea:c}=this.selectionHandles.styles,u=parseInt(a.borderWidth,10),d=parseInt(a.width,10),g=parseInt(l.width,10),f=this.wot.wtTable.getWidth(),m=this.wot.wtTable.getHeight();a.top=`${parseInt(n-d-1,10)}px`,a[s]=`${parseInt(o-d-1,10)}px`,l.top=`${parseInt(n-g/4*3,10)}px`,l[s]=`${parseInt(o-g/4*3,10)}px`;const p=Math.min(parseInt(o+i,10),f-d-2*u),w=Math.min(parseInt(o+i-g/4,10),f-g-2*u);h[s]=`${p}px`,c[s]=`${w}px`;const A=Math.min(parseInt(n+r,10),m-d-2*u),v=Math.min(parseInt(n+r-g/4,10),m-g-2*u);h.top=`${A}px`,c.top=`${v}px`,this.settings.border.cornerVisible&&this.settings.border.cornerVisible()?(a.display="block",l.display="block",this.isPartRange(t,e)?(h.display="none",c.display="none"):(h.display="block",c.display="block")):(a.display="none",h.display="none",l.display="none",c.display="none"),t===this.wot.wtSettings.getSetting("fixedRowsTop")||e===this.wot.wtSettings.getSetting("fixedColumnsStart")?(a.zIndex="9999",l.zIndex="9999"):(a.zIndex="",l.zIndex="")}appear(t){if(this.disabled)return;const{wtTable:e,rootDocument:n,rootWindow:o}=this.wot;let i,r,s,a,l,h;const c=e.getRenderedRowsCount();for(let D=0;D<c;D+=1){const n=e.rowFilter.renderedToSource(D);if(n>=t[0]&&n<=t[2]){i=n,l=t[0];break}}for(let D=c-1;D>=0;D-=1){const n=e.rowFilter.renderedToSource(D);if(n>=t[0]&&n<=t[2]){r=n;break}}const u=e.getRenderedColumnsCount();for(let D=0;D<u;D+=1){const n=e.columnFilter.renderedToSource(D);if(n>=t[1]&&n<=t[3]){s=n,h=t[1];break}}for(let D=u-1;D>=0;D-=1){const n=e.columnFilter.renderedToSource(D);if(n>=t[1]&&n<=t[3]){a=n;break}}if(void 0===i||void 0===s)return void this.disappear();let d=e.getCell(this.wot.createCellCoords(i,s));const g=i!==r||s!==a,f=g?e.getCell(this.wot.createCellCoords(r,a)):d,m=yA(d),p=g?yA(f):m,w=yA(e.TABLE),A=IA(e.TABLE),v=m.top,y=m.left,C=this.wot.wtSettings.getSetting("rtlMode");let b=0,S=0;if(C){const t=IA(d),e=o.innerWidth-w.left-A;S=y+t-p.left,b=o.innerWidth-y-t-e-1}else S=p.left+IA(f)-y,b=y-w.left-1;if(this.isEntireColumnSelected(i,r)){const t=this.getDimensionsFromHeader("columns",s,a,l,w);let e=null;t&&([e,b,S]=t),e&&(d=e)}let E=v-w.top-1,R=p.top+OA(f)-v;if(this.isEntireRowSelected(s,a)){const t=this.getDimensionsFromHeader("rows",i,r,h,w);let e=null;t&&([e,E,R]=t),e&&(d=e)}const M=xA(d,o);parseInt(M.borderTopWidth,10)>0&&(E+=1,R=R>0?R-1:0),parseInt(M[C?"borderRightWidth":"borderLeftWidth"],10)>0&&(b+=1,S=S>0?S-1:0);const T=C?"right":"left";this.topStyle.top=`${E}px`,this.topStyle[T]=`${b}px`,this.topStyle.width=`${S}px`,this.topStyle.display="block",this.startStyle.top=`${E}px`,this.startStyle[T]=`${b}px`,this.startStyle.height=`${R}px`,this.startStyle.display="block";const k=Math.floor(this.settings.border.width/2);this.bottomStyle.top=E+R-k+"px",this.bottomStyle[T]=`${b}px`,this.bottomStyle.width=`${S}px`,this.bottomStyle.display="block",this.endStyle.top=`${E}px`,this.endStyle[T]=b+S-k+"px",this.endStyle.height=`${R+1}px`,this.endStyle.display="block";let x=this.settings.border.cornerVisible;x="function"==typeof x?x(this.settings.layerLevel):x;const I=this.wot.getSetting("onModifyGetCellCoords",r,a);let[O,H]=[r,a];if(I&&Array.isArray(I)&&([,,O,H]=I),ky()||!x||this.isPartRange(O,H))this.cornerStyle.display="none";else{this.cornerStyle.top=E+R+this.cornerCenterPointOffset-1+"px",this.cornerStyle[T]=b+S+this.cornerCenterPointOffset-1+"px",this.cornerStyle.borderRightWidth=this.cornerDefaultStyle.borderWidth,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.display="none";let t=MA(e.TABLE);const i=t===o;i&&(t=n.documentElement);const s=parseInt(this.cornerDefaultStyle.width,10)/2,l=parseInt(this.cornerDefaultStyle.height,10)/2;if(a===this.wot.getSetting("totalColumns")-1){const e=i?f.getBoundingClientRect().left:f.offsetLeft;let n=!1,o=0;C?(o=e-parseInt(this.cornerDefaultStyle.width,10)/2,n=o<0):(o=e+IA(f)+parseInt(this.cornerDefaultStyle.width,10)/2,n=o>=DA(t)),n&&(this.cornerStyle[T]=`${Math.floor(b+S+this.cornerCenterPointOffset-s)}px`,this.cornerStyle[C?"borderLeftWidth":"borderRightWidth"]=0)}r===this.wot.getSetting("totalRows")-1&&(i?f.getBoundingClientRect().top:f.offsetTop)+OA(f)+parseInt(this.cornerDefaultStyle.height,10)/2>=HA(t)&&(this.cornerStyle.top=`${Math.floor(E+R+this.cornerCenterPointOffset-l)}px`,this.cornerStyle.borderBottomWidth=0),this.cornerStyle.display="block"}ky()&&this.updateMultipleSelectionHandlesPosition(r,a,E,b,S,R)}isEntireColumnSelected(t,e){return t===this.wot.wtTable.getFirstRenderedRow()&&e===this.wot.wtTable.getLastRenderedRow()}isEntireRowSelected(t,e){return t===this.wot.wtTable.getFirstRenderedColumn()&&e===this.wot.wtTable.getLastRenderedColumn()}getDimensionsFromHeader(t,e,n,o,i){const{wtTable:r}=this.wot,s=r.wtRootElement.parentNode;let a=null,l=null,h=null,c=null,u=null,d=null,g=null,f=null;switch(t){case"rows":a=function(){return r.getRowHeader(...arguments)},l=function(){return OA(...arguments)},h="ht__selection--rows",d="top";break;case"columns":a=function(){return r.getColumnHeader(...arguments)},l=function(){return IA(...arguments)},h="ht__selection--columns",d="left";break}if(s.classList.contains(h)){const t=this.wot.getSetting("columnHeaders").length;if(g=a(e,t-o),f=a(n,t-o),!g||!f)return!1;const r=yA(g),s=yA(f);return g&&f&&(c=r[d]-i[d]-1,u=s[d]+l(f)-r[d]),[g,c,u]}return!1}changeBorderStyle(t,e){const n=this[t].style,o=e[t];!o||o.hide?cA(this[t],"hidden"):(hA(this[t],"hidden")&&uA(this[t],"hidden"),n.backgroundColor=o.color,("top"===t||"bottom"===t)&&(n.height=`${o.width}px`),("start"===t||"end"===t)&&(n.width=`${o.width}px`))}changeBorderToDefaultStyle(t){const e={width:1,color:"#000"},n=this[t].style;n.backgroundColor=e.color,n.width=`${e.width}px`,n.height=`${e.width}px`}toggleHiddenClass(t,e){this.changeBorderToDefaultStyle(t),e?cA(this[t],"hidden"):uA(this[t],"hidden")}disappear(){this.topStyle.display="none",this.bottomStyle.display="none",this.startStyle.display="none",this.endStyle.display="none",this.cornerStyle.display="none",ky()&&(this.selectionHandles.styles.top.display="none",this.selectionHandles.styles.topHitArea.display="none",this.selectionHandles.styles.bottom.display="none",this.selectionHandles.styles.bottomHitArea.display="none")}destroy(){this.eventManager.destroyWithOwnEventsOnly(),this.main.parentNode.removeChild(this.main)}}const Ak=wk;function vk(t,e){Ck(t,e),e.add(t)}function yk(t,e,n){Ck(t,e),e.set(t,n)}function Ck(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function bk(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function Sk(t,e){var n=Mk(t,e,"get");return Ek(t,n)}function Ek(t,e){return e.get?e.get.call(t):e.value}function Rk(t,e,n){var o=Mk(t,e,"set");return Tk(t,o,n),n}function Mk(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function Tk(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var kk=new WeakMap,xk=new WeakMap,Ik=new WeakMap,Ok=new WeakMap,Hk=new WeakMap,Dk=new WeakMap,Nk=new WeakSet;class Pk{constructor(t){vk(this,Nk),yk(this,kk,{writable:!0,value:void 0}),yk(this,xk,{writable:!0,value:void 0}),yk(this,Ik,{writable:!0,value:new mk}),yk(this,Ok,{writable:!0,value:new WeakMap}),yk(this,Hk,{writable:!0,value:new WeakSet}),yk(this,Dk,{writable:!0,value:new Map}),Rk(this,xk,t)}setActiveOverlay(t){return Rk(this,kk,t),Sk(this,Ik).setActiveOverlay(Sk(this,kk)),Sk(this,Ok).has(Sk(this,kk))||Sk(this,Ok).set(Sk(this,kk),new Set),this}getFocusSelection(){return null!==Sk(this,xk)?Sk(this,xk).getFocus():null}getAreaSelection(){return null!==Sk(this,xk)?Sk(this,xk).createLayeredArea():null}getBorderInstance(t){if(!t.settings.border)return null;if(Sk(this,Dk).has(t)){const e=Sk(this,Dk).get(t);if(e.has(Sk(this,kk)))return e.get(Sk(this,kk));const n=new Ak(Sk(this,kk),t.settings);return e.set(Sk(this,kk),n),n}const e=new Ak(Sk(this,kk),t.settings);return Sk(this,Dk).set(t,new Map([[Sk(this,kk),e]])),e}getBorderInstances(t){var e,n;return Array.from(null!==(e=null===(n=Sk(this,Dk).get(t))||void 0===n?void 0:n.values())&&void 0!==e?e:[])}destroyBorders(t){Sk(this,Dk).get(t).forEach((t=>t.destroy())),Sk(this,Dk).delete(t)}render(t){if(null===Sk(this,xk))return;t&&bk(this,Nk,_k).call(this);const e=Array.from(Sk(this,xk)),n=new Map,o=new Map;for(let i=0;i<e.length;i++){const t=e[i],{className:r,headerAttributes:s,createLayers:a,selectionType:l}=t.settings;Sk(this,Hk).has(t)||(Sk(this,Hk).add(t),t.addLocalHook("destroy",(()=>this.destroyBorders(t))));const h=this.getBorderInstance(t);if(t.isEmpty()){null==h||h.disappear();continue}r&&Sk(this,Ik).setActiveSelection(t).scan().forEach((t=>{if(n.has(t)){const e=n.get(t);e.has(r)&&!0===a?e.set(r,e.get(r)+1):e.set(r,1)}else n.set(t,new Map([[r,1]]));s&&(o.has(t)||o.set(t,[]),"TH"===t.nodeName&&o.get(t).push(...s))}));const c=t.getCorners();Sk(this,kk).getSetting("onBeforeDrawBorders",c,l),null==h||h.appear(c)}n.forEach(((t,e)=>{var n;const o=Array.from(t).map((t=>{let[e,n]=t;return 1===n?e:[e,...Array.from({length:n-1},((t,n)=>`${e}-${n+1}`))]})).flat();o.forEach((t=>Sk(this,Ok).get(Sk(this,kk)).add(t))),cA(e,o),"TD"===e.nodeName&&Array.isArray(null===(n=Sk(this,xk).options)||void 0===n?void 0:n.cellAttributes)&&dA(e,Sk(this,xk).options.cellAttributes)})),Array.from(o.keys()).forEach((t=>{dA(t,[...o.get(t)])}))}}function _k(){const t=Sk(this,Ok).get(Sk(this,kk)),e=Sk(this,kk).wtSettings.getSetting("onBeforeRemoveCellClassNames");if(Array.isArray(e))for(let n=0;n<e.length;n++)t.add(e[n]);t.forEach((t=>{var e,n;const o=Sk(this,kk).wtTable.TABLE.querySelectorAll(`.${t}`);let i=[];Array.isArray(null===(e=Sk(this,xk).options)||void 0===e?void 0:e.cellAttributes)&&(i=Sk(this,xk).options.cellAttributes.map((t=>t[0]))),Array.isArray(null===(n=Sk(this,xk).options)||void 0===n?void 0:n.headerAttributes)&&(i=[...i,...Sk(this,xk).options.headerAttributes.map((t=>t[0]))]);for(let r=0,s=o.length;r<s;r++)uA(o[r],t),gA(o[r],i)})),t.clear()}class Bk extends MT{constructor(t,e,n,o){super(t,e,rT,n,o)}createTable(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return new FT(...e)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){const{wtTable:t}=this.wot;if(!this.needFullRender||!t.holder.parentNode)return!1;const{rootWindow:e}=this.domBindings,n=this.clone.wtTable.holder.parentNode,o=this.wtSettings.getSetting("preventOverflow");let i=0;this.trimmingContainer!==e||o&&"horizontal"===o?(i=this.getScrollPosition(),KA(n)):(i=this.getOverlayOffset()*(this.isRtl()?-1:1),GA(n,`${i}px`,"0px"));const r=this.adjustHeaderBordersPosition(i);return this.adjustElementsSize(),r}setScrollPosition(t){const{rootWindow:e}=this.domBindings;let n=!1;return this.isRtl()&&(t=-t),this.mainTableScrollableElement===e&&e.scrollX!==t?(e.scrollTo(t,CA(e)),n=!0):this.mainTableScrollableElement.scrollLeft!==t&&(this.mainTableScrollableElement.scrollLeft=t,n=!0),n}onScroll(){this.wtSettings.getSetting("onScrollVertically")}sumCellSizes(t,e){const n=this.wtSettings.getSetting("defaultColumnWidth");let o=t,i=0;for(;o<e;)i+=this.wot.wtTable.getStretchedColumnWidth(o)||n,o+=1;return i}adjustElementsSize(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.updateTrimmingContainer(),(this.needFullRender||t)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:t}=this.wot,{rootDocument:e,rootWindow:n}=this.domBindings,o=UA(e),i=this.clone.wtTable.holder.parentNode.style,r=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==n||"vertical"===r){let e=this.wot.wtViewport.getWorkspaceHeight();this.wot.wtOverlays.hasScrollbarBottom&&(e-=o),e=Math.min(e,t.wtRootElement.scrollHeight),i.height=`${e}px`}else i.height="";this.clone.wtTable.holder.style.height=i.height;const s=IA(this.clone.wtTable.TABLE);i.width=`${s}px`}adjustRootChildrenSize(){const{holder:t}=this.clone.wtTable,e=this.wot.selectionManager.getFocusSelection()?parseInt(ek.width,10)/2:0;this.clone.wtTable.hider.style.height=this.hider.style.height,t.style.height=t.parentNode.style.height,t.style.width=`${parseInt(t.parentNode.style.width,10)+e}px`}applyToDOM(){const t=this.wtSettings.getSetting("totalColumns"),e=this.isRtl()?"right":"left";if("number"==typeof this.wot.wtViewport.columnsRenderCalculator.startPosition)this.spreader.style[e]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`;else{if(0!==t)throw new Error("Incorrect value of the columnsRenderCalculator");this.spreader.style[e]="0"}this.isRtl()?this.spreader.style.left="":this.spreader.style.right="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){"number"==typeof this.wot.wtViewport.rowsRenderCalculator.startPosition?this.clone.wtTable.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`:this.clone.wtTable.spreader.style.top=""}scrollTo(t,e){let n=this.getTableParentOffset();const o=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder;let i=0;if(e){const n=this.wot.wtTable.getColumnWidth(t),o=this.wot.wtViewport.getViewportWidth();n>o&&(e=!1)}return e&&o.offsetWidth!==o.clientWidth&&(i=UA(this.domBindings.rootDocument)),e?(n+=this.sumCellSizes(0,t+1),n-=this.wot.wtViewport.getViewportWidth()):n+=this.sumCellSizes(this.wtSettings.getSetting("fixedColumnsStart"),t),n+=i,this.setScrollPosition(n)}getTableParentOffset(){const t=this.wtSettings.getSetting("preventOverflow");let e=0;return!t&&this.trimmingContainer===this.domBindings.rootWindow&&(e=this.wot.wtTable.holderOffset.left),e}getScrollPosition(){return Math.abs(EA(this.mainTableScrollableElement,this.domBindings.rootWindow))}getOverlayOffset(){const{rootWindow:t}=this.domBindings,e=this.wtSettings.getSetting("preventOverflow");let n=0;if(this.trimmingContainer===t&&(!e||"horizontal"!==e)){n=this.isRtl()?Math.abs(Math.min(this.getTableParentOffset()-this.getScrollPosition(),0)):Math.max(this.getScrollPosition()-this.getTableParentOffset(),0);const t=this.wot.wtTable.getTotalWidth(),e=this.clone.wtTable.getTotalWidth(),o=t-e;n>o&&(n=0)}return n}adjustHeaderBordersPosition(t){const e=this.wot.wtTable.holder.parentNode,n=this.wtSettings.getSetting("rowHeaders"),o=this.wtSettings.getSetting("fixedColumnsStart");this.wtSettings.getSetting("totalRows")?uA(e,"emptyRows"):cA(e,"emptyRows");let i=!1;if(o&&!n.length)cA(e,"innerBorderLeft innerBorderInlineStart");else if(!o&&n.length){const n=hA(e,"innerBorderInlineStart");t?(cA(e,"innerBorderLeft innerBorderInlineStart"),i=!n):(uA(e,"innerBorderLeft innerBorderInlineStart"),i=n)}return i}}const Lk="stickyRowsTop",Vk={getFirstRenderedRow(){return 0===this.wtSettings.getSetting("totalRows")?-1:0},getFirstVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.getRenderedRowsCount()-1},getLastVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){const t=this.wtSettings.getSetting("totalRows");return Math.min(this.wtSettings.getSetting("fixedRowsTop"),t)},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};ey(Vk,"MIXIN_NAME",Lk,{writable:!1,enumerable:!1});const Wk=Vk;class Fk extends KM{constructor(t,e,n,o){super(t,e,n,o,sT)}}Jv(Fk,Wk),Jv(Fk,tT);const jk=Fk;function Uk(t,e,n){return e=Yk(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Yk(t){var e=zk(t,"string");return"symbol"==typeof e?e:String(e)}function zk(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class Gk extends MT{constructor(t,e,n,o,i,r){super(t,e,sT,n,o),Uk(this,"topOverlay",void 0),Uk(this,"inlineStartOverlay",void 0),this.topOverlay=i,this.inlineStartOverlay=r}createTable(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return new jk(...e)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){if(this.updateTrimmingContainer(),!this.wot.wtTable.holder.parentNode)return!1;const t=this.clone.wtTable.holder.parentNode;if(this.trimmingContainer===this.domBindings.rootWindow){const e=this.inlineStartOverlay.getOverlayOffset()*(this.isRtl()?-1:1),n=this.topOverlay.getOverlayOffset();GA(t,`${e}px`,`${n}px`)}else KA(t);let e=OA(this.clone.wtTable.TABLE);const n=IA(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(e=0),t.style.height=`${e}px`,t.style.width=`${n}px`,!1}}class Qk extends KM{constructor(t,e,n,o){super(t,e,n,o,oT)}}Jv(Qk,Wk),Jv(Qk,IT);const Kk=Qk;function Xk(t,e,n){return e=qk(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function qk(t){var e=Zk(t,"string");return"symbol"==typeof e?e:String(e)}function Zk(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class Jk extends MT{constructor(t,e,n,o){super(t,e,oT,n,o),Xk(this,"cachedFixedRowsTop",-1),this.cachedFixedRowsTop=this.wtSettings.getSetting("fixedRowsTop")}createTable(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return new Kk(...e)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.wot.wtTable.holder.parentNode)return!1;const t=this.clone.wtTable.holder.parentNode,{rootWindow:e}=this.domBindings,n=this.wtSettings.getSetting("preventOverflow");let o=0,i=!1;if(this.trimmingContainer!==e||n&&"vertical"===n)o=this.getScrollPosition(),KA(t);else{const{wtTable:e}=this.wot,n=e.hider.getBoundingClientRect(),r=Math.ceil(n.bottom),s=t.offsetHeight;i=r===s,o=this.getOverlayOffset(),GA(t,"0px",`${o}px`)}const r=this.adjustHeaderBordersPosition(o,i);return this.adjustElementsSize(),r}setScrollPosition(t){const e=this.domBindings.rootWindow;let n=!1;return this.mainTableScrollableElement===e&&e.scrollY!==t?(e.scrollTo(bA(e),t),n=!0):this.mainTableScrollableElement.scrollTop!==t&&(this.mainTableScrollableElement.scrollTop=t,n=!0),n}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(t,e){const n=this.wtSettings.getSetting("defaultRowHeight");let o=t,i=0;for(;o<e;){const t=this.wot.wtTable.getRowHeight(o);i+=void 0===t?n:t,o+=1}return i}adjustElementsSize(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.updateTrimmingContainer(),(this.needFullRender||t)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:t}=this.wot,{rootDocument:e,rootWindow:n}=this.domBindings,o=UA(e),i=this.clone.wtTable.holder.parentNode.style,r=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==n||"horizontal"===r){let e=this.wot.wtViewport.getWorkspaceWidth();this.wot.wtOverlays.hasScrollbarRight&&(e-=o),e=Math.min(e,t.wtRootElement.scrollWidth),i.width=`${e}px`}else i.width="";this.clone.wtTable.holder.style.width=i.width;let s=OA(this.clone.wtTable.TABLE);this.wot.wtTable.hasDefinedSize()||(s=0),i.height=`${s}px`}adjustRootChildrenSize(){const{holder:t}=this.clone.wtTable,e=this.wot.selectionManager.getFocusSelection()?parseInt(ek.height,10)/2:0;this.clone.wtTable.hider.style.width=this.hider.style.width,t.style.width=t.parentNode.style.width,t.style.height=`${parseInt(t.parentNode.style.height,10)+e}px`}applyToDOM(){const t=this.wtSettings.getSetting("totalRows");if("number"==typeof this.wot.wtViewport.rowsRenderCalculator.startPosition)this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else{if(0!==t)throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.top="0"}this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){const t=this.isRtl()?"right":"left",{spreader:e}=this.clone.wtTable;"number"==typeof this.wot.wtViewport.columnsRenderCalculator.startPosition?e.style[t]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:e.style[t]=""}scrollTo(t,e){const{wot:n,wtSettings:o}=this,i=(n.cloneSource?n.cloneSource:n).wtTable.holder;let r=this.getTableParentOffset(),s=0;if(e){const n=this.wot.wtTable.getRowHeight(t),o=this.wot.wtViewport.getViewportHeight();n>o&&(e=!1)}if(e&&i.offsetHeight!==i.clientHeight&&(s=UA(this.domBindings.rootDocument)),e){const e=o.getSetting("fixedRowsBottom"),i=o.getSetting("totalRows");r+=this.sumCellSizes(0,t+1),r-=n.wtViewport.getViewportHeight()-this.sumCellSizes(i-e,i),r+=1}else r+=this.sumCellSizes(o.getSetting("fixedRowsTop"),t);return r+=s,this.setScrollPosition(r)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return SA(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){const{rootWindow:t}=this.domBindings,e=this.wtSettings.getSetting("preventOverflow");let n=0;if(this.trimmingContainer===t&&(!e||"vertical"!==e)){const t=this.wot.wtTable.getTotalHeight(),e=this.clone.wtTable.getTotalHeight(),o=t-e;n=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0),n>o&&(n=0)}return n}adjustHeaderBordersPosition(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=this.wot.wtTable.holder.parentNode;this.wtSettings.getSetting("totalColumns")?uA(n,"emptyColumns"):cA(n,"emptyColumns");let o=!1;if(!e){const e=this.wtSettings.getSetting("fixedRowsTop"),i=this.cachedFixedRowsTop!==e,r=this.wtSettings.getSetting("columnHeaders");if((i||0===e)&&r.length>0){const e=hA(n,"innerBorderTop");this.cachedFixedRowsTop=this.wtSettings.getSetting("fixedRowsTop"),t||0===this.wtSettings.getSetting("totalRows")?(cA(n,"innerBorderTop"),o=!e):(uA(n,"innerBorderTop"),o=e)}}return o}}function $k(t,e,n){return e=tx(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function tx(t){var e=ex(t,"string");return"symbol"==typeof e?e:String(e)}function ex(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class nx{constructor(t,e,n,o,i,r){$k(this,"wot",null),$k(this,"topOverlay",null),$k(this,"bottomOverlay",null),$k(this,"inlineStartOverlay",null),$k(this,"topInlineStartCornerOverlay",null),$k(this,"bottomInlineStartCornerOverlay",null),$k(this,"browserLineHeight",void 0),$k(this,"wtSettings",null),$k(this,"resizeObserver",new ResizeObserver((t=>{hy((()=>{!Array.isArray(t)||!t.length||this.wtSettings.getSetting("onContainerElementResize")}))}))),this.wot=t,this.wtSettings=o,this.domBindings=n,this.facadeGetter=e,this.wtTable=r;const{rootDocument:s,rootWindow:a}=this.domBindings;this.instance=this.wot,this.eventManager=i,this.scrollbarSize=UA(s);const l="hidden"===a.getComputedStyle(r.wtRootElement.parentNode).getPropertyValue("overflow");this.scrollableElement=l?r.holder:RA(r.TABLE),this.initOverlays(),this.hasScrollbarBottom=!1,this.hasScrollbarRight=!1,this.destroyed=!1,this.keyPressed=!1,this.spreaderLastSize={width:null,height:null},this.verticalScrolling=!1,this.horizontalScrolling=!1,this.initBrowserLineHeight(),this.registerListeners(),this.lastScrollX=a.scrollX,this.lastScrollY=a.scrollY}getOverlays(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const e=[this.topOverlay,this.topInlineStartCornerOverlay,this.inlineStartOverlay,this.bottomOverlay,this.bottomInlineStartCornerOverlay];return t&&e.push(this.wtTable),e}initBrowserLineHeight(){const{rootWindow:t,rootDocument:e}=this.domBindings,n=t.getComputedStyle(e.body),o=parseInt(n.lineHeight,10),i=1.2*parseInt(n.fontSize,10);this.browserLineHeight=o||i}initOverlays(){const t=[this.wot,this.facadeGetter,this.wtSettings,this.domBindings];this.topOverlay=new Jk(...t),this.bottomOverlay=new _T(...t),this.inlineStartOverlay=new Bk(...t),this.topInlineStartCornerOverlay=new Gk(...t,this.topOverlay,this.inlineStartOverlay),this.bottomInlineStartCornerOverlay=new TT(...t,this.bottomOverlay,this.inlineStartOverlay)}updateStateOfRendering(){let t=this.topOverlay.updateStateOfRendering();return t=this.bottomOverlay.updateStateOfRendering()||t,t=this.inlineStartOverlay.updateStateOfRendering()||t,this.inlineStartOverlay.needFullRender&&(this.topOverlay.needFullRender&&(t=this.topInlineStartCornerOverlay.updateStateOfRendering()||t),this.bottomOverlay.needFullRender&&(t=this.bottomInlineStartCornerOverlay.updateStateOfRendering()||t)),t}refreshAll(){if(this.wot.drawn){if(!this.wtTable.holder.parentNode)return void this.destroy();this.wot.draw(!0),this.verticalScrolling&&this.inlineStartOverlay.onScroll(),this.horizontalScrolling&&this.topOverlay.onScroll(),this.verticalScrolling=!1,this.horizontalScrolling=!1}}registerListeners(){const{rootDocument:t,rootWindow:e}=this.domBindings,{mainTableScrollableElement:n}=this.topOverlay,{mainTableScrollableElement:o}=this.inlineStartOverlay;this.eventManager.addEventListener(t.documentElement,"keydown",(t=>this.onKeyDown(t))),this.eventManager.addEventListener(t.documentElement,"keyup",(()=>this.onKeyUp())),this.eventManager.addEventListener(t,"visibilitychange",(()=>this.onKeyUp())),this.eventManager.addEventListener(n,"scroll",(t=>this.onTableScroll(t)),{passive:!0}),n!==o&&this.eventManager.addEventListener(o,"scroll",(t=>this.onTableScroll(t)),{passive:!0});const i=e.devicePixelRatio&&e.devicePixelRatio>1,r=this.scrollableElement===e,s=this.wtSettings.getSetting("preventWheel"),a={passive:r};let l;(s||i||!Cy())&&this.eventManager.addEventListener(this.wtTable.wtRootElement,"wheel",(t=>this.onCloneWheel(t,s)),a),[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay].forEach((t=>{if(t&&t.needFullRender){const{holder:e}=t.clone.wtTable;this.eventManager.addEventListener(e,"wheel",(t=>this.onCloneWheel(t,s)),a)}})),this.eventManager.addEventListener(e,"resize",(()=>{clearTimeout(l),l=setTimeout((()=>{this.wtSettings.getSetting("onWindowResize")}),200)})),r||this.resizeObserver.observe(this.wtTable.wtRootElement.parentElement)}deregisterListeners(){this.eventManager.clearEvents(!0)}onTableScroll(t){const e=this.domBindings.rootWindow,n=this.inlineStartOverlay.mainTableScrollableElement,o=this.topOverlay.mainTableScrollableElement,i=t.target;this.keyPressed&&(o!==e&&i!==e&&!t.target.contains(o)||n!==e&&i!==e&&!t.target.contains(n))||this.syncScrollPositions(t)}onCloneWheel(t,e){const{rootWindow:n}=this.domBindings,o=this.inlineStartOverlay.mainTableScrollableElement,i=this.topOverlay.mainTableScrollableElement,r=t.target,s=i!==n&&r!==n&&!r.contains(i),a=o!==n&&r!==n&&!r.contains(o);if(this.keyPressed&&(s||a))return;const l=this.translateMouseWheelToScroll(t);(e||this.scrollableElement!==n&&l)&&t.preventDefault()}onKeyDown(t){this.keyPressed=Fy(t.keyCode,"ARROW_UP|ARROW_RIGHT|ARROW_DOWN|ARROW_LEFT")}onKeyUp(){this.keyPressed=!1}translateMouseWheelToScroll(t){let e=isNaN(t.deltaY)?-1*t.wheelDeltaY:t.deltaY,n=isNaN(t.deltaX)?-1*t.wheelDeltaX:t.deltaX;1===t.deltaMode&&(n+=n*this.browserLineHeight,e+=e*this.browserLineHeight);const o=this.scrollVertically(e),i=this.scrollHorizontally(n);return o||i}scrollVertically(t){const e=this.scrollableElement.scrollTop;return this.scrollableElement.scrollTop+=t,e!==this.scrollableElement.scrollTop}scrollHorizontally(t){const e=this.scrollableElement.scrollLeft;return this.scrollableElement.scrollLeft+=t,e!==this.scrollableElement.scrollLeft}syncScrollPositions(){if(this.destroyed)return;const{rootWindow:t}=this.domBindings,e=this.topOverlay.clone.wtTable.holder,n=this.inlineStartOverlay.clone.wtTable.holder,[o,i]=[this.scrollableElement.scrollLeft,this.scrollableElement.scrollTop];if(this.horizontalScrolling=e.scrollLeft!==o||this.lastScrollX!==t.scrollX,this.verticalScrolling=n.scrollTop!==i||this.lastScrollY!==t.scrollY,this.lastScrollX=t.scrollX,this.lastScrollY=t.scrollY,this.horizontalScrolling){e.scrollLeft=o;const t=this.bottomOverlay.needFullRender?this.bottomOverlay.clone.wtTable.holder:null;t&&(t.scrollLeft=o)}this.verticalScrolling&&(n.scrollTop=i),this.refreshAll()}syncScrollWithMaster(){const t=this.topOverlay.mainTableScrollableElement,{scrollLeft:e,scrollTop:n}=t;this.topOverlay.needFullRender&&(this.topOverlay.clone.wtTable.holder.scrollLeft=e),this.bottomOverlay.needFullRender&&(this.bottomOverlay.clone.wtTable.holder.scrollLeft=e),this.inlineStartOverlay.needFullRender&&(this.inlineStartOverlay.clone.wtTable.holder.scrollTop=n)}updateMainScrollableElements(){this.deregisterListeners(),this.inlineStartOverlay.updateMainScrollableElement(),this.topOverlay.updateMainScrollableElement(),this.bottomOverlay.needFullRender&&this.bottomOverlay.updateMainScrollableElement();const{wtTable:t}=this,{rootWindow:e}=this.domBindings;"hidden"===e.getComputedStyle(t.wtRootElement.parentNode).getPropertyValue("overflow")?this.scrollableElement=t.holder:this.scrollableElement=RA(t.TABLE),this.registerListeners()}destroy(){this.resizeObserver.disconnect(),this.eventManager.destroy(),this.topOverlay.destroy(),this.bottomOverlay.clone&&this.bottomOverlay.destroy(),this.inlineStartOverlay.destroy(),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.destroy(),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.destroy(),this.destroyed=!0}refresh(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.updateLastSpreaderSize()&&this.adjustElementsSize(),this.bottomOverlay.clone&&this.bottomOverlay.refresh(t),this.inlineStartOverlay.refresh(t),this.topOverlay.refresh(t),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.refresh(t),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.refresh(t)}updateLastSpreaderSize(){const t=this.wtTable.spreader,e=t.clientWidth,n=t.clientHeight,o=e!==this.spreaderLastSize.width||n!==this.spreaderLastSize.height;return o&&(this.spreaderLastSize.width=e,this.spreaderLastSize.height=n),o}adjustElementsSize(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const{wtViewport:e}=this.wot,{wtTable:n}=this,o=this.wtSettings.getSetting("totalColumns"),i=this.wtSettings.getSetting("totalRows"),r=e.getRowHeaderWidth(),s=e.getColumnHeaderHeight(),a=n.hider.style;if(a.width=`${r+this.inlineStartOverlay.sumCellSizes(0,o)}px`,a.height=`${s+this.topOverlay.sumCellSizes(0,i)+1}px`,this.scrollbarSize>0){const{scrollHeight:t,scrollWidth:e}=n.wtRootElement,{scrollHeight:o,scrollWidth:i}=n.holder;this.hasScrollbarRight=t<o,this.hasScrollbarBottom=e<i,this.hasScrollbarRight&&n.hider.scrollWidth+this.scrollbarSize>e?this.hasScrollbarBottom=!0:this.hasScrollbarBottom&&n.hider.scrollHeight+this.scrollbarSize>t&&(this.hasScrollbarRight=!0)}this.topOverlay.adjustElementsSize(t),this.inlineStartOverlay.adjustElementsSize(t),this.bottomOverlay.adjustElementsSize(t)}applyToDOM(){this.wtTable.isVisible()&&(this.topOverlay.applyToDOM(),this.bottomOverlay.clone&&this.bottomOverlay.applyToDOM(),this.inlineStartOverlay.applyToDOM())}getParentOverlay(t){if(!t)return null;const e=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];let n=null;return Mp(e,(e=>{e&&e.clone&&e.clone.wtTable.TABLE.contains(t)&&(n=e.clone)})),n}syncOverlayTableClassNames(){const t=this.wtTable.TABLE,e=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];Mp(e,(e=>{e&&(e.clone.wtTable.TABLE.className=t.className)}))}}const ox=nx;function ix(t,e,n){return e=rx(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function rx(t){var e=sx(t,"string");return"symbol"==typeof e?e:String(e)}function sx(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class ax{constructor(t){ix(this,"settings",{}),ix(this,"defaults",Object.freeze(this.getDefaults())),ny(this.defaults,((e,n)=>{if(void 0!==t[n])this.settings[n]=t[n];else{if(void 0===e)throw new Error(`A required setting "${n}" was not provided`);this.settings[n]=e}}))}getDefaults(){return{facade:void 0,table:void 0,isDataViewInstance:!0,externalRowCalculator:!1,stretchH:"none",currentRowClassName:null,currentColumnClassName:null,preventOverflow(){return!1},preventWheel:!1,data:void 0,freezeOverlays:!1,fixedColumnsStart:0,fixedRowsTop:0,fixedRowsBottom:0,shouldRenderInlineStartOverlay:()=>this.getSetting("fixedColumnsStart")>0||this.getSetting("rowHeaders").length>0,shouldRenderTopOverlay:()=>this.getSetting("fixedRowsTop")>0||this.getSetting("columnHeaders").length>0,shouldRenderBottomOverlay:()=>this.getSetting("fixedRowsBottom")>0,minSpareRows:0,rowHeaders(){return[]},columnHeaders(){return[]},totalRows:void 0,totalColumns:void 0,cellRenderer:(t,e,n)=>{const o=this.getSetting("data",t,e);AA(n,null==o?"":o)},columnWidth(){},rowHeight(){},defaultRowHeight:23,defaultColumnWidth:50,selections:null,hideBorderOnMouseDownOver:!1,viewportRowCalculatorOverride:null,viewportColumnCalculatorOverride:null,onCellMouseDown:null,onCellContextMenu:null,onCellMouseOver:null,onCellMouseOut:null,onCellMouseUp:null,onCellDblClick:null,onCellCornerMouseDown:null,onCellCornerDblClick:null,beforeDraw:null,onDraw:null,onBeforeRemoveCellClassNames:null,onAfterDrawSelection:null,onBeforeDrawBorders:null,onBeforeViewportScrollHorizontally:t=>t,onBeforeViewportScrollVertically:t=>t,onScrollHorizontally:null,onScrollVertically:null,onBeforeTouchScroll:null,onAfterMomentumScroll:null,onBeforeStretchingColumnWidth:t=>t,onModifyRowHeaderWidth:null,onModifyGetCellCoords:null,onBeforeHighlightingRowHeader:t=>t,onBeforeHighlightingColumnHeader:t=>t,onWindowResize:null,onContainerElementResize:null,renderAllColumns:!1,renderAllRows:!1,groups:!1,rowHeaderWidth:null,columnHeaderHeight:null,headerClassName:null,rtlMode:!1,ariaTags:!0}}update(t,e){return void 0===e?ny(t,((t,e)=>{this.settings[e]=t})):this.settings[t]=e,this}getSetting(t,e,n,o,i){return"function"==typeof this.settings[t]?this.settings[t](e,n,o,i):void 0!==e&&Array.isArray(this.settings[t])?this.settings[t][e]:this.settings[t]}getSettingPure(t){return this.settings[t]}has(t){return!!this.settings[t]}}class lx extends KM{constructor(t,e,n,o){super(t,e,n,o,"master")}alignOverlaysWithTrimmingContainer(){const t=MA(this.wtRootElement),{rootWindow:e}=this.domBindings;if(t===e)this.wtSettings.getSetting("preventOverflow")||(this.holder.style.overflow="visible",this.wtRootElement.style.overflow="visible");else{const n=t.parentElement,o=TA(t,"height",e),i=TA(t,"overflow",e),r=this.holder.style,{scrollWidth:s,scrollHeight:a}=t;let l=t.offsetWidth,h=t.offsetHeight;if(n&&["auto","hidden","scroll"].includes(i)){const o=t.cloneNode(!1);o.style.overflow="auto",o.style.position="absolute",t.nextElementSibling?n.insertBefore(o,t.nextElementSibling):n.appendChild(o);const i=parseInt(xA(o,e).height,10);n.removeChild(o),0===i&&(h=0)}h=Math.min(h,a),r.height="auto"===o?"auto":`${h}px`,l=Math.min(l,s),r.width=`${l}px`,r.overflow="",this.hasTableHeight="auto"===r.height||h>0,this.hasTableWidth=l>0}this.isTableVisible=vA(this.TABLE)}markOversizedColumnHeaders(){const{wtSettings:t}=this,{wtViewport:e}=this.dataAccessObject,n="master",o=t.getSetting("columnHeaders").length;if(o&&!e.hasOversizedColumnHeadersMarked[n]){const i=t.getSetting("rowHeaders").length,r=this.getRenderedColumnsCount();for(let t=0;t<o;t++)for(let e=-1*i;e<r;e++)this.markIfOversizedColumnHeader(e);e.hasOversizedColumnHeadersMarked[n]=!0}}}Jv(lx,VT),Jv(lx,IT);const hx=lx;class cx{constructor(t,e,n,o,i){this.dataAccessObject=t,this.wot=t.wot,this.instance=this.wot,this.domBindings=e,this.wtSettings=n,this.wtTable=i,this.oversizedRows=[],this.oversizedColumnHeaders=[],this.hasOversizedColumnHeadersMarked={},this.clientHeight=0,this.containerWidth=NaN,this.rowHeaderWidth=NaN,this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,this.eventManager=o,this.eventManager.addEventListener(this.domBindings.rootWindow,"resize",(()=>{this.clientHeight=this.getWorkspaceHeight()}))}getWorkspaceHeight(){const t=this.domBindings.rootDocument,e=this.dataAccessObject.topOverlayTrimmingContainer;let n=0;return n=e===this.domBindings.rootWindow?t.documentElement.clientHeight:OA(e)>0&&e.clientHeight>0?e.clientHeight:1/0,n}getWorkspaceWidth(){const{wtSettings:t}=this,{rootDocument:e,rootWindow:n}=this.domBindings,o=this.dataAccessObject.inlineStartOverlayTrimmingContainer,i=e.documentElement.offsetWidth,r=t.getSetting("totalColumns"),s=t.getSetting("preventOverflow"),a=t.getSetting("rtlMode"),l=this.wtTable.TABLE.getBoundingClientRect(),h=a?l.right-i:l.left,c=i-h;let u,d;if(s)return IA(this.wtTable.wtRootElement);if(u=t.getSetting("freezeOverlays")?Math.min(c,i):Math.min(this.getContainerFillWidth(),c,i),o===n&&r>0&&this.sumColumnWidths(0,r-1)>u)return e.documentElement.clientWidth;if(o!==n&&(d=TA(this.dataAccessObject.inlineStartOverlayTrimmingContainer,"overflow",n),"scroll"===d||"hidden"===d||"auto"===d))return Math.max(u,o.clientWidth);const g=t.getSetting("stretchH");return"none"!==g&&g?u:Math.max(u,IA(this.wtTable.TABLE))}hasVerticalScroll(){return this.wtTable.hider.offsetHeight>this.getWorkspaceHeight()}hasHorizontalScroll(){return this.wtTable.hider.offsetWidth>this.getWorkspaceWidth()}sumColumnWidths(t,e){let n=0,o=t;for(;o<e;)n+=this.wtTable.getColumnWidth(o),o+=1;return n}getContainerFillWidth(){if(this.containerWidth)return this.containerWidth;const t=this.wtTable.holder,e=this.domBindings.rootDocument.createElement("div");e.style.width="100%",e.style.height="1px",t.appendChild(e);const n=e.offsetWidth;return this.containerWidth=n,t.removeChild(e),n}getWorkspaceOffset(){return yA(this.wtTable.TABLE)}getColumnHeaderHeight(){return this.wtSettings.getSetting("columnHeaders").length?isNaN(this.columnHeaderHeight)&&(this.columnHeaderHeight=OA(this.wtTable.THEAD)):this.columnHeaderHeight=0,this.columnHeaderHeight}getViewportHeight(){let t=this.getWorkspaceHeight();if(t===1/0)return t;const e=this.getColumnHeaderHeight();return e>0&&(t-=e),t}getRowHeaderWidth(){const t=this.wtSettings.getSetting("rowHeaderWidth"),e=this.wtSettings.getSetting("rowHeaders");if(t){this.rowHeaderWidth=0;for(let n=0,o=e.length;n<o;n++)this.rowHeaderWidth+=t[n]||t}if(isNaN(this.rowHeaderWidth))if(e.length){let t=this.wtTable.TABLE.querySelector("TH");this.rowHeaderWidth=0;for(let n=0,o=e.length;n<o;n++)t?(this.rowHeaderWidth+=IA(t),t=t.nextSibling):this.rowHeaderWidth+=50}else this.rowHeaderWidth=0;return this.rowHeaderWidth=this.wtSettings.getSetting("onModifyRowHeaderWidth",this.rowHeaderWidth)||this.rowHeaderWidth,this.rowHeaderWidth}getViewportWidth(){const t=this.getWorkspaceWidth();if(t===1/0)return t;const e=this.getRowHeaderWidth();return e>0?t-e:t}createRowsCalculator(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:nE;const{wtSettings:e,wtTable:n}=this;if(e.getSetting("renderAllRows")&&t===nE)return new mS({totalRows:e.getSetting("totalRows")});let o,i,r=this.getViewportHeight();this.rowHeaderWidth=NaN;let s=this.dataAccessObject.topScrollPosition-this.dataAccessObject.topParentOffset;const a=e.getSetting("fixedRowsTop"),l=e.getSetting("fixedRowsBottom"),h=e.getSetting("totalRows");return a&&s>=0&&(i=this.dataAccessObject.topOverlay.sumCellSizes(0,a),s+=i,r-=i),l&&this.dataAccessObject.bottomOverlay.clone&&(i=this.dataAccessObject.bottomOverlay.sumCellSizes(h-l,h),r-=i),o=n.holder.clientHeight===n.holder.offsetHeight?0:UA(this.domBindings.rootDocument),new TE({viewportHeight:r,scrollOffset:s,totalRows:e.getSetting("totalRows"),rowHeightFn:t=>n.getRowHeight(t),overrideFn:e.getSettingPure("viewportRowCalculatorOverride"),calculationType:t,horizontalScrollbarHeight:o})}createColumnsCalculator(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:nE;const{wtSettings:e,wtTable:n}=this;if(e.getSetting("renderAllColumns")&&t===nE)return new uS({totalColumns:e.getSetting("totalColumns")});let o=this.getViewportWidth(),i=Math.abs(this.dataAccessObject.inlineStartScrollPosition)-this.dataAccessObject.inlineStartParentOffset;this.columnHeaderHeight=NaN;const r=e.getSetting("fixedColumnsStart");if(r&&i>=0){const t=this.dataAccessObject.inlineStartOverlay.sumCellSizes(0,r);i+=t,o-=t}return n.holder.clientWidth!==n.holder.offsetWidth&&(o-=UA(this.domBindings.rootDocument)),new mE({viewportWidth:o,scrollOffset:i,totalColumns:e.getSetting("totalColumns"),columnWidthFn:t=>n.getColumnWidth(t),overrideFn:e.getSettingPure("viewportColumnCalculatorOverride"),calculationType:t,inlineStartOffset:this.dataAccessObject.inlineStartParentOffset})}createRenderCalculators(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const{wtSettings:e}=this;if(t&&!e.getSetting("renderAllRows")){const e=this.createRowsCalculator(oE);t=this.areAllProposedVisibleRowsAlreadyRendered(e)}if(t&&!e.getSetting("renderAllColumns")){const e=this.createColumnsCalculator(oE);t=this.areAllProposedVisibleColumnsAlreadyRendered(e)}return t||(this.rowsRenderCalculator=this.createRowsCalculator(nE),this.columnsRenderCalculator=this.createColumnsCalculator(nE)),this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,t}createVisibleCalculators(){this.rowsVisibleCalculator=this.createRowsCalculator(oE),this.columnsVisibleCalculator=this.createColumnsCalculator(oE)}areAllProposedVisibleRowsAlreadyRendered(t){if(!this.rowsVisibleCalculator)return!1;const{startRow:e,endRow:n,isVisibleInTrimmingContainer:o}=t;if(null===e&&null===n)return!o;const{startRow:i,endRow:r}=this.rowsRenderCalculator;return!(e<i||e===i&&e>0)&&!(n>r||n===r&&n<this.wtSettings.getSetting("totalRows")-1)}areAllProposedVisibleColumnsAlreadyRendered(t){if(!this.columnsVisibleCalculator)return!1;const{startColumn:e,endColumn:n,isVisibleInTrimmingContainer:o}=t;if(null===e&&null===n)return!o;const{startColumn:i,endColumn:r}=this.columnsRenderCalculator;return!(e<i||e===i&&e>0)&&!(n>r||n===r&&n<this.wtSettings.getSetting("totalColumns")-1)}resetHasOversizedColumnHeadersMarked(){ny(this.hasOversizedColumnHeadersMarked,((t,e,n)=>{n[e]=void 0}))}}const ux=cx;class dx extends AT{constructor(t,e){super(t,new ax(e));const n=this.wtSettings.getSetting("facade",this);this.wtTable=new hx(this.getTableDao(),n,this.domBindings,this.wtSettings),this.wtViewport=new ux(this.getViewportDao(),this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.selectionManager=new Pk(this.wtSettings.getSetting("selections")),this.wtEvent=new AR(n,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager),this.wtOverlays=new ox(this,n,this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.exportSettingsAsClassNames(),this.findOriginalHeaders()}exportSettingsAsClassNames(){const t={rowHeaders:"htRowHeaders",columnHeaders:"htColumnHeaders"},e=[],n=[];ny(t,((t,o)=>{this.wtSettings.getSetting(o).length&&n.push(t),e.push(t)})),uA(this.wtTable.wtRootElement.parentNode,e),cA(this.wtTable.wtRootElement.parentNode,n)}getViewportDao(){const t=this;return{get wot(){return t},get topOverlayTrimmingContainer(){return t.wtOverlays.topOverlay.trimmingContainer},get inlineStartOverlayTrimmingContainer(){return t.wtOverlays.inlineStartOverlay.trimmingContainer},get topScrollPosition(){return t.wtOverlays.topOverlay.getScrollPosition()},get topParentOffset(){return t.wtOverlays.topOverlay.getTableParentOffset()},get inlineStartScrollPosition(){return t.wtOverlays.inlineStartOverlay.getScrollPosition()},get inlineStartParentOffset(){return t.wtOverlays.inlineStartOverlay.getTableParentOffset()},get topOverlay(){return t.wtOverlays.topOverlay},get inlineStartOverlay(){return t.wtOverlays.inlineStartOverlay},get bottomOverlay(){return t.wtOverlays.bottomOverlay}}}}class gx{constructor(t){t instanceof AT?this._wot=t:this._initFromSettings(t)}_initFromSettings(t){t.facade=t=>{const e=new gx(t);return()=>e},this._wot=new dx(t.table,t)}get guid(){return this._wot.guid}get rootDocument(){return this._wot.domBindings.rootDocument}get rootWindow(){return this._wot.domBindings.rootWindow}get wtSettings(){return this._wot.wtSettings}get cloneSource(){return this._wot.cloneSource}get cloneOverlay(){return this._wot.cloneOverlay}get selectionManager(){return this._wot.selectionManager}get wtViewport(){return this._wot.wtViewport}get wtOverlays(){return this._wot.wtOverlays}get wtTable(){return this._wot.wtTable}get wtEvent(){return this._wot.wtEvent}get wtScroll(){return this._wot.wtScroll}get drawn(){return this._wot.drawn}set drawn(t){this._wot.drawn=t}get drawInterrupted(){return this._wot.drawInterrupted}set drawInterrupted(t){this._wot.drawInterrupted=t}get lastMouseOver(){return this._wot.lastMouseOver}set lastMouseOver(t){this._wot.lastMouseOver=t}get momentumScrolling(){return this._wot.momentumScrolling}set momentumScrolling(t){this._wot.momentumScrolling=t}get touchApplied(){return this._wot.touchApplied}set touchApplied(t){this._wot.touchApplied=t}get domBindings(){return this._wot.domBindings}get eventListeners(){return this._wot.eventListeners}set eventListeners(t){this._wot.eventListeners=t}get eventManager(){return this._wot.eventManager}createCellCoords(t,e){return this._wot.createCellCoords(t,e)}createCellRange(t,e,n){return this._wot.createCellRange(t,e,n)}draw(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this._wot.draw(t),this}getCell(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this._wot.getCell(t,e)}scrollViewport(t,e,n,o,i){return this._wot.scrollViewport(t,e,n,o,i)}scrollViewportHorizontally(t,e,n){return this._wot.scrollViewportHorizontally(t,e,n)}scrollViewportVertically(t,e,n){return this._wot.scrollViewportVertically(t,e,n)}getViewport(){return this._wot.getViewport()}getOverlayName(){return this._wot.cloneOverlay?this._wot.cloneOverlay.type:"master"}exportSettingsAsClassNames(){return this._wot.exportSettingsAsClassNames()}update(t,e){return this._wot.wtSettings.update(t,e),this}getSetting(t,e,n,o,i){return this._wot.wtSettings.getSetting(t,e,n,o,i)}hasSetting(t){return this._wot.wtSettings.hasSetting(t)}destroy(){this._wot.destroy()}}function fx(t){let{isShiftKey:e,isLeftClick:n,isRightClick:o,coords:i,selection:r,controller:s,cellCoordsFactory:a}=t;const l=r.isSelected()?r.getSelectedRange().current():null,h=r.isSelectedByCorner(),c=r.isSelectedByRowHeader();if(e&&l)i.row>=0&&i.col>=0&&!s.cell?r.setRangeEnd(i):(h||c)&&i.row>=0&&i.col>=0&&!s.cell?r.setRangeEnd(a(i.row,i.col)):h&&i.row<0&&!s.column?r.setRangeEnd(a(l.to.row,i.col)):c&&i.col<0&&!s.row?r.setRangeEnd(a(i.row,l.to.col)):(!h&&!c&&i.col<0||h&&i.col<0)&&!s.row?r.selectRows(Math.max(l.from.row,0),i.row,i.col):(!h&&!c&&i.row<0||c&&i.row<0)&&!s.column&&r.selectColumns(Math.max(l.from.col,0),i.col,i.row);else{const t=!r.inInSelection(i),e=n||o&&t;i.row<0&&i.col>=0&&!s.column?e&&r.selectColumns(i.col,i.col,i.row):i.col<0&&i.row>=0&&!s.row?e&&r.selectRows(i.row,i.row,i.col):i.col>=0&&i.row>=0&&!s.cell?e&&r.setRangeStart(i):i.col<0&&i.row<0&&r.selectAll(!0,!0,{disableHeadersHighlight:!0,focusPosition:{row:0,col:0}})}}function mx(t){let{isLeftClick:e,coords:n,selection:o,controller:i,cellCoordsFactory:r}=t;if(!e)return;const s=o.isSelectedByRowHeader(),a=o.isSelectedByColumnHeader(),l=o.tableProps.countCols(),h=o.tableProps.countRows();a&&!i.column?o.setRangeEnd(r(h-1,n.col)):s&&!i.row?o.setRangeEnd(r(n.row,l-1)):i.cell||o.setRangeEnd(n)}const px=new Map([["mousedown",fx],["mouseover",mx],["touchstart",fx]]);function wx(t,e){let{coords:n,selection:o,controller:i,cellCoordsFactory:r}=e;px.get(t.type)({coords:n,selection:o,controller:i,cellCoordsFactory:r,isShiftKey:t.shiftKey,isLeftClick:Gy(t)||"touchstart"===t.type,isRightClick:zy(t)})}const Ax=new WeakMap,vx=Symbol("rootInstance");function yx(t){Ax.set(t,!0)}function Cx(t){return t===vx}function bx(t){return Ax.has(t)}function Sx(t,e){Rx(t,e),e.add(t)}function Ex(t,e,n){Rx(t,e),e.set(t,n)}function Rx(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Mx(t,e,n){return e=Tx(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Tx(t){var e=kx(t,"string");return"symbol"==typeof e?e:String(e)}function kx(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function xx(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function Ix(t,e){var n=Dx(t,e,"get");return Ox(t,n)}function Ox(t,e){return e.get?e.get.call(t):e.value}function Hx(t,e,n){var o=Dx(t,e,"set");return Nx(t,o,n),n}function Dx(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function Nx(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var Px=new WeakMap,_x=new WeakMap,Bx=new WeakMap,Lx=new WeakMap,Vx=new WeakMap,Wx=new WeakMap,Fx=new WeakMap,jx=new WeakSet,Ux=new WeakSet;class Yx{constructor(t){Sx(this,Ux),Sx(this,jx),Mx(this,"hot",void 0),Mx(this,"eventManager",void 0),Mx(this,"settings",void 0),Mx(this,"THEAD",void 0),Mx(this,"TBODY",void 0),Mx(this,"_wt",void 0),Mx(this,"activeWt",void 0),Ex(this,Px,{writable:!0,value:0}),Ex(this,_x,{writable:!0,value:0}),Mx(this,"postponedAdjustElementsSize",!1),Ex(this,Bx,{writable:!0,value:!1}),Ex(this,Lx,{writable:!0,value:void 0}),Ex(this,Vx,{writable:!0,value:void 0}),Ex(this,Wx,{writable:!0,value:0}),Ex(this,Fx,{writable:!0,value:0}),this.hot=t,this.eventManager=new MC(this.hot),this.settings=this.hot.getSettings(),this.createElements(),this.registerEvents(),this.initializeWalkontable()}render(){this.hot.isRenderSuspended()||(this.hot.runHooks("beforeRender",this.hot.forceFullRender),this.postponedAdjustElementsSize&&(this.postponedAdjustElementsSize=!1,this.adjustElementsSize(!0)),this._wt.draw(!this.hot.forceFullRender),this.hot.runHooks("afterRender",this.hot.forceFullRender),this.hot.forceFullRender=!1,this.hot.renderCall=!1)}adjustElementsSize(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.hot.isRenderSuspended()?this.postponedAdjustElementsSize=!0:this._wt.wtOverlays.adjustElementsSize(t)}getCellAtCoords(t,e){const n=this._wt.getCell(t,e);return n<0?null:n}scrollViewport(t,e,n,o,i){return this._wt.scrollViewport(t,e,n,o,i)}scrollViewportHorizontally(t,e,n){return this._wt.scrollViewportHorizontally(t,e,n)}scrollViewportVertically(t,e,n){return this._wt.scrollViewportVertically(t,e,n)}createElements(){const{rootElement:t,rootDocument:e}=this.hot,n=t.getAttribute("style");n&&t.setAttribute("data-originalstyle",n),cA(t,"handsontable"),Hx(this,Vx,e.createElement("TABLE")),cA(Ix(this,Vx),"htCore"),this.hot.getSettings().tableClassName&&cA(Ix(this,Vx),this.hot.getSettings().tableClassName),this.settings.ariaTags&&(dA(Ix(this,Vx),[fw()]),dA(t,[gw(),Nw(-1),Pw(this.hot.countCols()),Hw()])),this.THEAD=e.createElement("THEAD"),Ix(this,Vx).appendChild(this.THEAD),this.TBODY=e.createElement("TBODY"),Ix(this,Vx).appendChild(this.TBODY),this.hot.table=Ix(this,Vx),this.hot.container.insertBefore(Ix(this,Vx),this.hot.container.firstChild)}registerEvents(){const{rootElement:t,rootDocument:e,selection:n}=this.hot,o=e.documentElement;this.eventManager.addEventListener(t,"mousedown",(t=>{if(Hx(this,Bx,!0),!this.isTextSelectionAllowed(t.target)){const{rootWindow:e}=this.hot;VA(e),t.preventDefault(),e.focus()}})),this.eventManager.addEventListener(t,"mouseup",(()=>{Hx(this,Bx,!1)})),this.eventManager.addEventListener(t,"mousemove",(t=>{Ix(this,Bx)&&!this.isTextSelectionAllowed(t.target)&&(this.settings.fragmentSelection&&VA(this.hot.rootWindow),t.preventDefault())})),this.eventManager.addEventListener(o,"keyup",(t=>{n.isInProgress()&&!t.shiftKey&&n.finish()})),this.eventManager.addEventListener(o,"mouseup",(o=>{n.isInProgress()&&Gy(o)&&n.finish(),Hx(this,Lx,!1);const i=qA(e.activeElement);XA(e.activeElement)&&!i||(i||!n.isSelected()&&!n.isSelectedByAnyHeader()&&!t.contains(o.target)&&!zy(o))&&this.hot.unlisten()})),this.eventManager.addEventListener(o,"contextmenu",(t=>{n.isInProgress()&&zy(t)&&(n.finish(),Hx(this,Lx,!1))})),this.eventManager.addEventListener(o,"touchend",(()=>{n.isInProgress()&&n.finish(),Hx(this,Lx,!1)})),this.eventManager.addEventListener(o,"mousedown",(n=>{const i=n.target,r=n.x||n.clientX,s=n.y||n.clientY;let a=n.target;if(Ix(this,Lx)||!t||!this.hot.view)return;const{holder:l}=this.hot.view._wt.wtTable;if(a===l){const t=UA(e);if(e.elementFromPoint(r+t,s)!==l||e.elementFromPoint(r,s+t)!==l)return}else for(;a!==o;){if(null===a){if(n.isTargetWebComponent)break;return}if(a===t)return;a=a.parentNode}("function"==typeof this.settings.outsideClickDeselects?this.settings.outsideClickDeselects(i):this.settings.outsideClickDeselects)?this.hot.deselectCell():this.hot.destroyEditor(!1,!1)})),this.eventManager.addEventListener(Ix(this,Vx),"selectstart",(t=>{this.settings.fragmentSelection||XA(t.target)||t.preventDefault()}))}translateFromRenderableToVisualCoords(t){let{row:e,col:n}=t;return this.hot._createCellCoords(...this.translateFromRenderableToVisualIndex(e,n))}translateFromRenderableToVisualIndex(t,e){let n=t>=0?this.hot.rowIndexMapper.getVisualFromRenderableIndex(t):t,o=e>=0?this.hot.columnIndexMapper.getVisualFromRenderableIndex(e):e;return null===n&&(n=t),null===o&&(o=e),[n,o]}countRenderableIndexes(t,e){const n=Math.min(t.getNotTrimmedIndexesLength(),e),o=t.getNearestNotHiddenIndex(n-1,-1);return null===o?0:t.getRenderableFromVisualIndex(o)+1}countRenderableColumns(){return this.countRenderableIndexes(this.hot.columnIndexMapper,this.settings.maxCols)}countRenderableRows(){return this.countRenderableIndexes(this.hot.rowIndexMapper,this.settings.maxRows)}countNotHiddenRowIndexes(t,e){return this.countNotHiddenIndexes(t,e,this.hot.rowIndexMapper,this.countRenderableRows())}countNotHiddenColumnIndexes(t,e){return this.countNotHiddenIndexes(t,e,this.hot.columnIndexMapper,this.countRenderableColumns())}countNotHiddenIndexes(t,e,n,o){if(isNaN(t)||t<0)return 0;const i=n.getNearestNotHiddenIndex(t,e),r=n.getRenderableFromVisualIndex(i);if(!Number.isInteger(r))return 0;let s=0;return e<0?s=r+1:e>0&&(s=o-r),s}countNotHiddenFixedColumnsStart(){const t=this.hot.countCols(),e=Math.min(parseInt(this.settings.fixedColumnsStart,10),t)-1;return this.countNotHiddenColumnIndexes(e,-1)}countNotHiddenFixedRowsTop(){const t=this.hot.countRows(),e=Math.min(parseInt(this.settings.fixedRowsTop,10),t)-1;return this.countNotHiddenRowIndexes(e,-1)}countNotHiddenFixedRowsBottom(){const t=this.hot.countRows(),e=Math.max(t-parseInt(this.settings.fixedRowsBottom,10),0);return this.countNotHiddenRowIndexes(e,1)}countRenderableColumnsInRange(t,e){let n=0;for(let o=t;o<=e;o++)null!==this.hot.columnIndexMapper.getRenderableFromVisualIndex(o)&&(n+=1);return n}countRenderableRowsInRange(t,e){let n=0;for(let o=t;o<=e;o++)null!==this.hot.rowIndexMapper.getRenderableFromVisualIndex(o)&&(n+=1);return n}isMainTableNotFullyCoveredByOverlays(){const t=this.countNotHiddenFixedRowsTop()+this.countNotHiddenFixedRowsBottom(),e=this.countNotHiddenFixedColumnsStart();return this.hot.countRenderedRows()>t&&this.hot.countRenderedCols()>e}initializeWalkontable(){const t={ariaTags:this.settings.ariaTags,rtlMode:this.hot.isRtl(),externalRowCalculator:this.hot.getPlugin("autoRowSize")&&this.hot.getPlugin("autoRowSize").isEnabled(),table:Ix(this,Vx),isDataViewInstance:()=>bx(this.hot),preventOverflow:()=>this.settings.preventOverflow,preventWheel:()=>this.settings.preventWheel,stretchH:()=>this.settings.stretchH,data:(t,e)=>this.hot.getDataAtCell(...this.translateFromRenderableToVisualIndex(t,e)),totalRows:()=>this.countRenderableRows(),totalColumns:()=>this.countRenderableColumns(),fixedColumnsStart:()=>this.countNotHiddenFixedColumnsStart(),fixedRowsTop:()=>this.countNotHiddenFixedRowsTop(),fixedRowsBottom:()=>this.countNotHiddenFixedRowsBottom(),shouldRenderInlineStartOverlay:()=>this.settings.fixedColumnsStart>0||t.rowHeaders().length>0,shouldRenderTopOverlay:()=>this.settings.fixedRowsTop>0||t.columnHeaders().length>0,shouldRenderBottomOverlay:()=>this.settings.fixedRowsBottom>0,minSpareRows:()=>this.settings.minSpareRows,renderAllRows:this.settings.renderAllRows,renderAllColumns:this.settings.renderAllColumns,rowHeaders:()=>{const t=[];return this.hot.hasRowHeaders()&&t.push(((t,e)=>{const n=t>=0?this.hot.rowIndexMapper.getVisualFromRenderableIndex(t):t;this.appendRowHeader(n,e)})),this.hot.runHooks("afterGetRowHeaderRenderers",t),Hx(this,_x,t.length),this.hot.getSettings().ariaTags&&xx(this,jx,zx).call(this)===this.hot.countCols()&&xx(this,Ux,Gx).call(this,Ix(this,_x)),t},columnHeaders:()=>{const t=[];return this.hot.hasColHeaders()&&t.push(((t,e)=>{const n=t>=0?this.hot.columnIndexMapper.getVisualFromRenderableIndex(t):t;this.appendColHeader(n,e)})),this.hot.runHooks("afterGetColumnHeaderRenderers",t),Hx(this,Px,t.length),t},columnWidth:t=>{const e=this.hot.columnIndexMapper.getVisualFromRenderableIndex(t);return this.hot.getColWidth(null===e?t:e)},rowHeight:t=>{const e=this.hot.rowIndexMapper.getVisualFromRenderableIndex(t);return this.hot.getRowHeight(null===e?t:e)},cellRenderer:(t,e,n)=>{const[o,i]=this.translateFromRenderableToVisualIndex(t,e),r=this.hot.runHooks("modifyGetCellCoords",o,i);let s=o,a=i;Array.isArray(r)&&([s,a]=r);const l=this.hot.getCellMeta(s,a),h=this.hot.colToProp(a);let c=this.hot.getDataAtRowProp(s,h);this.hot.hasHook("beforeValueRender")&&(c=this.hot.runHooks("beforeValueRender",c,l)),this.hot.runHooks("beforeRenderer",n,o,i,h,c,l),this.hot.getCellRenderer(l)(this.hot,n,o,i,h,c,l),this.hot.runHooks("afterRenderer",n,o,i,h,c,l)},selections:this.hot.selection.highlight,hideBorderOnMouseDownOver:()=>this.settings.fragmentSelection,onWindowResize:()=>{this.hot&&!this.hot.isDestroyed&&this.hot.refreshDimensions()},onContainerElementResize:()=>{this.hot&&!this.hot.isDestroyed&&vA(this.hot.rootElement)&&this.hot.refreshDimensions()},onCellMouseDown:(t,e,n,o)=>{const i=this.translateFromRenderableToVisualCoords(e),r={row:!1,column:!1,cell:!1};this.hot.listen(),this.activeWt=o,Hx(this,Lx,!0),this.hot.runHooks("beforeOnCellMouseDown",t,i,n,r),!Yy(t)&&(wx(t,{coords:i,selection:this.hot.selection,controller:r,cellCoordsFactory:(t,e)=>this.hot._createCellCoords(t,e)}),this.hot.runHooks("afterOnCellMouseDown",t,i,n),this.activeWt=this._wt)},onCellContextMenu:(t,e,n,o)=>{const i=this.translateFromRenderableToVisualCoords(e);this.activeWt=o,Hx(this,Lx,!1),this.hot.selection.isInProgress()&&this.hot.selection.finish(),this.hot.runHooks("beforeOnCellContextMenu",t,i,n),!Yy(t)&&(this.hot.runHooks("afterOnCellContextMenu",t,i,n),this.activeWt=this._wt)},onCellMouseOut:(t,e,n,o)=>{const i=this.translateFromRenderableToVisualCoords(e);this.activeWt=o,this.hot.runHooks("beforeOnCellMouseOut",t,i,n),!Yy(t)&&(this.hot.runHooks("afterOnCellMouseOut",t,i,n),this.activeWt=this._wt)},onCellMouseOver:(t,e,n,o)=>{const i=this.translateFromRenderableToVisualCoords(e),r={row:!1,column:!1,cell:!1};this.activeWt=o,this.hot.runHooks("beforeOnCellMouseOver",t,i,n,r),!Yy(t)&&(Ix(this,Lx)&&wx(t,{coords:i,selection:this.hot.selection,controller:r,cellCoordsFactory:(t,e)=>this.hot._createCellCoords(t,e)}),this.hot.runHooks("afterOnCellMouseOver",t,i,n),this.activeWt=this._wt)},onCellMouseUp:(t,e,n,o)=>{const i=this.translateFromRenderableToVisualCoords(e);this.activeWt=o,this.hot.runHooks("beforeOnCellMouseUp",t,i,n),!Yy(t)&&!this.hot.isDestroyed&&(this.hot.runHooks("afterOnCellMouseUp",t,i,n),this.activeWt=this._wt)},onCellCornerMouseDown:t=>{t.preventDefault(),this.hot.runHooks("afterOnCellCornerMouseDown",t)},onCellCornerDblClick:t=>{t.preventDefault(),this.hot.runHooks("afterOnCellCornerDblClick",t)},beforeDraw:(t,e)=>this.beforeRender(t,e),onDraw:t=>this.afterRender(t),onBeforeViewportScrollVertically:t=>{const e=this.hot.rowIndexMapper,n=t<0;let o=t;return n||(o=e.getVisualFromRenderableIndex(t),null!==o)?(o=this.hot.runHooks("beforeViewportScrollVertically",o),this.hot.runHooks("beforeViewportScroll"),n?o:e.getRenderableFromVisualIndex(o)):t},onBeforeViewportScrollHorizontally:t=>{const e=this.hot.columnIndexMapper,n=t<0;let o=t;return n||(o=e.getVisualFromRenderableIndex(t),null!==o)?(o=this.hot.runHooks("beforeViewportScrollHorizontally",o),this.hot.runHooks("beforeViewportScroll"),n?o:e.getRenderableFromVisualIndex(o)):t},onScrollVertically:()=>{this.hot.runHooks("afterScrollVertically"),this.hot.runHooks("afterScroll")},onScrollHorizontally:()=>{this.hot.runHooks("afterScrollHorizontally"),this.hot.runHooks("afterScroll")},onBeforeRemoveCellClassNames:()=>this.hot.runHooks("beforeRemoveCellClassNames"),onBeforeHighlightingRowHeader:(t,e,n)=>{const o=this.hot.rowIndexMapper,i=t<0;let r=t;i||(r=o.getVisualFromRenderableIndex(t));const s=this.hot.runHooks("beforeHighlightingRowHeader",r,e,n);return i?s:o.getRenderableFromVisualIndex(o.getNearestNotHiddenIndex(s,1))},onBeforeHighlightingColumnHeader:(t,e,n)=>{const o=this.hot.columnIndexMapper,i=t<0;let r=t;i||(r=o.getVisualFromRenderableIndex(t));const s=this.hot.runHooks("beforeHighlightingColumnHeader",r,e,n);return i?s:o.getRenderableFromVisualIndex(o.getNearestNotHiddenIndex(s,1))},onAfterDrawSelection:(t,e,n)=>{let o;const[i,r]=this.translateFromRenderableToVisualIndex(t,e),s=this.hot.selection.getSelectedRange();if(s.size()>0){const t=s.peekByIndex(null!=n?n:0);o=[t.from.row,t.from.col,t.to.row,t.to.col]}return this.hot.runHooks("afterDrawSelection",i,r,o,n)},onBeforeDrawBorders:(t,e)=>{const[n,o,i,r]=t,s=[this.hot.rowIndexMapper.getVisualFromRenderableIndex(n),this.hot.columnIndexMapper.getVisualFromRenderableIndex(o),this.hot.rowIndexMapper.getVisualFromRenderableIndex(i),this.hot.columnIndexMapper.getVisualFromRenderableIndex(r)];return this.hot.runHooks("beforeDrawBorders",s,e)},onBeforeTouchScroll:()=>this.hot.runHooks("beforeTouchScroll"),onAfterMomentumScroll:()=>this.hot.runHooks("afterMomentumScroll"),onBeforeStretchingColumnWidth:(t,e)=>{const n=this.hot.columnIndexMapper.getVisualFromRenderableIndex(e);return this.hot.runHooks("beforeStretchingColumnWidth",t,n)},onModifyRowHeaderWidth:t=>this.hot.runHooks("modifyRowHeaderWidth",t),onModifyGetCellCoords:(t,e,n)=>{const o=this.hot.rowIndexMapper,i=this.hot.columnIndexMapper,r=e>=0?i.getVisualFromRenderableIndex(e):e,s=t>=0?o.getVisualFromRenderableIndex(t):t,a=this.hot.runHooks("modifyGetCellCoords",s,r,n);if(Array.isArray(a)){const[t,e,n,r]=a;return[t>=0?o.getRenderableFromVisualIndex(o.getNearestNotHiddenIndex(t,1)):t,e>=0?i.getRenderableFromVisualIndex(i.getNearestNotHiddenIndex(e,1)):e,n>=0?o.getRenderableFromVisualIndex(o.getNearestNotHiddenIndex(n,-1)):n,r>=0?i.getRenderableFromVisualIndex(i.getNearestNotHiddenIndex(r,-1)):r]}},viewportRowCalculatorOverride:t=>{let e=this.settings.viewportRowRenderingOffset;if("auto"===e&&this.settings.fixedRowsTop&&(e=10),e>0||"auto"===e){const n=this.countRenderableRows(),o=t.startRow,i=t.endRow;if("number"==typeof e)t.startRow=Math.max(o-e,0),t.endRow=Math.min(i+e,n-1);else if("auto"===e){const e=Math.ceil(i/n*12);t.startRow=Math.max(o-e,0),t.endRow=Math.min(i+e,n-1)}}this.hot.runHooks("afterViewportRowCalculatorOverride",t)},viewportColumnCalculatorOverride:t=>{let e=this.settings.viewportColumnRenderingOffset;if("auto"===e&&this.settings.fixedColumnsStart&&(e=10),e>0||"auto"===e){const n=this.countRenderableColumns(),o=t.startColumn,i=t.endColumn;if("number"==typeof e&&(t.startColumn=Math.max(o-e,0),t.endColumn=Math.min(i+e,n-1)),"auto"===e){const e=Math.ceil(i/n*6);t.startColumn=Math.max(o-e,0),t.endColumn=Math.min(i+e,n-1)}}this.hot.runHooks("afterViewportColumnCalculatorOverride",t)},rowHeaderWidth:()=>this.settings.rowHeaderWidth,columnHeaderHeight:()=>{const t=this.hot.runHooks("modifyColumnHeaderHeight");return this.settings.columnHeaderHeight||t}};this.hot.runHooks("beforeInitWalkontable",t),this._wt=new gx(t),this.activeWt=this._wt;const e=this._wt.wtTable.spreader,{width:n,height:o}=this.hot.rootElement.getBoundingClientRect();this.setLastSize(n,o),this.eventManager.addEventListener(e,"mousedown",(t=>{t.target===e&&3===t.which&&t.stopPropagation()})),this.eventManager.addEventListener(e,"contextmenu",(t=>{t.target===e&&3===t.which&&t.stopPropagation()})),this.eventManager.addEventListener(this.hot.rootDocument.documentElement,"click",(()=>{this.settings.observeDOMVisibility&&this._wt.drawInterrupted&&(this.hot.forceFullRender=!0,this.render())}))}isTextSelectionAllowed(t){if(XA(t))return!0;const e=iA(t,this.hot.view._wt.wtTable.spreader);return!!(!0===this.settings.fragmentSelection&&e||"cell"===this.settings.fragmentSelection&&this.isSelectedOnlyCell()&&e||!this.settings.fragmentSelection&&this.isCellEdited()&&this.isSelectedOnlyCell())}isMouseDown(){return Ix(this,Lx)}isSelectedOnlyCell(){var t,e;return null!==(t=null===(e=this.hot.getSelectedRangeLast())||void 0===e?void 0:e.isSingleCell())&&void 0!==t&&t}isCellEdited(){const t=this.hot.getActiveEditor();return t&&t.isOpened()}beforeRender(t,e){t&&this.hot.runHooks("beforeViewRender",this.hot.forceFullRender,e)}afterRender(t){t&&this.hot.runHooks("afterViewRender",this.hot.forceFullRender)}appendRowHeader(t,e){if(e.firstChild){const n=e.firstChild;if(!hA(n,"relative"))return mA(e),void this.appendRowHeader(t,e);this.updateCellHeader(n.querySelector(".rowHeader"),t,this.hot.getRowHeader)}else{const{rootDocument:n,getRowHeader:o}=this.hot,i=n.createElement("div"),r=n.createElement("span");i.className="relative",r.className="rowHeader",this.updateCellHeader(r,t,o),i.appendChild(r),e.appendChild(i)}this.hot.runHooks("afterGetRowHeader",t,e)}appendColHeader(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.hot.getColHeader,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;if(e.firstChild){const i=e.firstChild;hA(i,"relative")?this.updateCellHeader(i.querySelector(".colHeader"),t,n,o):(mA(e),this.appendColHeader(t,e,n,o))}else{const{rootDocument:i}=this.hot,r=i.createElement("div"),s=i.createElement("span");r.className="relative",s.className="colHeader",this.settings.ariaTags&&(dA(r,...fw()),dA(s,...fw())),this.updateCellHeader(s,t,n,o),r.appendChild(s),e.appendChild(r)}this.hot.runHooks("afterGetColHeader",t,e,o)}updateCellHeader(t,e,n){let o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=e;const r=this._wt.wtOverlays.getParentOverlay(t)||this._wt;t.parentNode&&(hA(t,"colHeader")?i=r.wtTable.columnFilter.sourceToRendered(e):hA(t,"rowHeader")&&(i=r.wtTable.rowFilter.sourceToRendered(e))),i>-1?wA(t,n(e,o)):(AA(t,String.fromCharCode(160)),cA(t,"cornerHeader"))}maximumVisibleElementWidth(t){const e=this._wt.wtViewport.getWorkspaceWidth()-t;return e>0?e:0}maximumVisibleElementHeight(t){const e=this._wt.wtViewport.getWorkspaceHeight()-t;return e>0?e:0}setLastSize(t,e){Hx(this,Wx,t),Hx(this,Fx,e)}getLastSize(){return{width:Ix(this,Wx),height:Ix(this,Fx)}}getFirstFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this.hot.view._wt.wtScroll.getFirstVisibleRow())}getLastFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this.hot.view._wt.wtScroll.getLastVisibleRow())}getFirstFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this.hot.view._wt.wtScroll.getFirstVisibleColumn())}getLastFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this.hot.view._wt.wtScroll.getLastVisibleColumn())}getColumnHeadersCount(){return Ix(this,Px)}getRowHeadersCount(){return Ix(this,_x)}destroy(){this._wt.destroy(),this.eventManager.destroy()}}function zx(){return parseInt(this.hot.rootElement.getAttribute(Pw()[0]),10)}function Gx(t){const e=xx(this,jx,zx).call(this)+t;dA(this.hot.rootElement,...Pw(e))}const Qx=Yx,Kx="ABCDEFGHIJKLMNOPQRSTUVWXYZ",Xx=Kx.length;function qx(t){let e,n=t+1,o="";for(;n>0;)e=(n-1)%Xx,o=String.fromCharCode(65+e)+o,n=parseInt((n-e)/Xx,10);return o}function Zx(t){let e=0;if(t)for(let n=0,o=t.length-1;n<t.length;n+=1,o-=1)e+=f(Xx,o)*(Kx.indexOf(t[n])+1);return e-=1,e}function Jx(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4;const n=[];let o,i;for(o=0;o<t;o++){const t=[];for(i=0;i<e;i++)t.push(qx(i)+(o+1));n.push(t)}return n}function $x(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4;const n=[];let o,i;for(o=0;o<t;o++){const t={};for(i=0;i<e;i++)t[`prop${i}`]=qx(i)+(o+1);n.push(t)}return n}function tI(t,e){const n=[];let o;for(let i=0;i<t;i++){o=[];for(let t=0;t<e;t++)o.push("");n.push(o)}return n}function eI(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=t;const o=[];return(!Array.isArray(t)||!Array.isArray(t[0]))&&(n=[t]),n.forEach(((t,n)=>{Array.isArray(t)?t.forEach(((t,i)=>{o.push([n+e,i,t])})):Object.keys(t).forEach((i=>{o.push([n+e,i,t[i]])}))})),o}function nI(t){let e=0;return Array.isArray(t)&&(t[0]&&Array.isArray(t[0])?e=t[0].length:t[0]&&ty(t[0])&&(e=ry(t[0]))),e}function oI(t){return!!(Array.isArray(t)&&t.length&&t.every((t=>Array.isArray(t))))}function iI(t){return!!(Array.isArray(t)&&t.length&&t.every((t=>"object"==typeof t&&!Array.isArray(t)&&null!==t)))}const rI=Object.freeze(Object.defineProperty({__proto__:null,countFirstRowKeys:nI,createEmptySpreadsheetData:tI,createSpreadsheetData:Jx,createSpreadsheetObjectData:$x,dataRowToChangesArray:eI,isArrayOfArrays:oI,isArrayOfObjects:iI,spreadsheetColumnIndex:Zx,spreadsheetColumnLabel:qx},Symbol.toStringTag,{value:"Module"}));function sI(t,e,n){return e=aI(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function aI(t){var e=lI(t,"string");return"symbol"==typeof e?e:String(e)}function lI(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class hI{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];sI(this,"hot",void 0),sI(this,"data",void 0),sI(this,"dataType","array"),sI(this,"colToProp",(()=>{})),sI(this,"propToCol",(()=>{})),this.hot=t,this.data=e}modifyRowData(t){let e;return this.hot.hasHook("modifyRowData")&&(e=this.hot.runHooks("modifyRowData",t)),void 0===e||Number.isInteger(e)?this.data[t]:e}getData(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this.data&&0!==this.data.length?this.getByRange(null,null,t):this.data}setData(t){this.data=t}getAtColumn(t){const e=[];return Mp(this.data,((n,o)=>{const i=this.getAtCell(o,t);e.push(i)})),e}getAtRow(t,e,n){let o=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const i=void 0===e&&void 0===n;let r=null,s=null;if(r=this.modifyRowData(t),Array.isArray(r))s=[],i?r.forEach(((e,n)=>{s[n]=this.getAtPhysicalCell(t,n,r)})):Cb(e,n,(n=>{s[n-e]=this.getAtPhysicalCell(t,n,r)}));else if(ty(r)||iv(r))if(s=o?[]:{},!i||o){const i=this.countFirstRowKeys()-1;Cb(0,i,(a=>{const l=this.colToProp(a);if(a>=(e||0)&&a<=(n||i)&&!Number.isInteger(l)){const e=this.getAtPhysicalCell(t,l,r);o?s.push(e):iy(s,l,e)}}))}else ny(r,((e,n)=>{iy(s,n,this.getAtPhysicalCell(t,n,r))}));return s}setAtCell(t,e,n){if(!(t>=this.countRows()||e>=this.countFirstRowKeys())){if(this.hot.hasHook("modifySourceData")){const o=sy(n);this.hot.runHooks("modifySourceData",t,e,o,"set"),o.isTouched()&&(n=o.value)}Number.isInteger(e)?this.data[t][e]=n:iy(this.data[t],e,n)}}getAtPhysicalCell(t,e,n){let o=null;if(n&&(o="string"==typeof e?oy(n,e):"function"==typeof e?e(n):n[e]),this.hot.hasHook("modifySourceData")){const n=sy(o);this.hot.runHooks("modifySourceData",t,e,n,"get"),n.isTouched()&&(o=n.value)}return o}getAtCell(t,e){const n=this.modifyRowData(t);return this.getAtPhysicalCell(t,this.colToProp(e),n)}getByRange(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=!1,i=null,r=null,s=null,a=null;null===t||null===e?(o=!0,i=0,s=this.countRows()-1):(i=Math.min(t.row,e.row),r=Math.min(t.col,e.col),s=Math.max(t.row,e.row),a=Math.max(t.col,e.col));const l=[];return Cb(i,s,(t=>{l.push(o?this.getAtRow(t,void 0,void 0,n):this.getAtRow(t,r,a,n))})),l}countRows(){if(this.hot.hasHook("modifySourceLength")){const t=this.hot.runHooks("modifySourceLength");if(Number.isInteger(t))return t}return this.data.length}countFirstRowKeys(){return nI(this.data)}destroy(){this.data=null,this.hot=null}}const cI=hI;function uI(t,e,n){return e=dI(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function dI(t){var e=gI(t,"string");return"symbol"==typeof e?e:String(e)}function gI(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class fI{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;uI(this,"indexedValues",[]),uI(this,"initValueOrFn",void 0),this.initValueOrFn=t}getValues(){return this.indexedValues}getValueAtIndex(t){const e=this.indexedValues;if(t<e.length)return e[t]}setValues(t){this.indexedValues=t.slice(),this.runLocalHooks("change")}setValueAtIndex(t,e){return t<this.indexedValues.length&&(this.indexedValues[t]=e,this.runLocalHooks("change"),!0)}clear(){this.setDefaultValues()}getLength(){return this.getValues().length}setDefaultValues(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.indexedValues.length;this.indexedValues.length=0,iv(this.initValueOrFn)?Cb(t-1,(t=>this.indexedValues.push(this.initValueOrFn(t)))):Cb(t-1,(()=>this.indexedValues.push(this.initValueOrFn))),this.runLocalHooks("change")}init(t){return this.setDefaultValues(t),this.runLocalHooks("init"),this}insert(){this.runLocalHooks("change")}remove(){this.runLocalHooks("change")}destroy(){this.clearLocalHooks(),this.indexedValues=null,this.initValueOrFn=null}}function mI(t,e,n,o){const i=n.length?n[0]:void 0;return[...t.slice(0,i),...n.map(((t,e)=>iv(o)?o(t,e):o)),...void 0===i?[]:t.slice(i)]}function pI(t,e){return Ep(t,((t,n)=>!1===e.includes(n)))}Jv(fI,YT);class wI extends fI{insert(t,e){this.indexedValues=mI(this.indexedValues,t,e,this.initValueOrFn),super.insert(t,e)}remove(t){this.indexedValues=pI(this.indexedValues,t),super.remove(t)}}class AI extends wI{constructor(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];super(t)}getHiddenIndexes(){return Sp(this.getValues(),((t,e,n)=>(e&&t.push(n),t)),[])}}function vI(t,e,n){return[...t.slice(0,e),...n,...t.slice(e)]}function yI(t,e){return Ep(t,(t=>!1===e.includes(t)))}function CI(t,e){return Rp(t,(t=>t-e.filter((e=>e<t)).length))}function bI(t,e){const n=e[0],o=e.length;return Rp(t,(t=>t>=n?t+o:t))}function SI(t,e,n){return e=EI(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function EI(t){var e=RI(t,"string");return"symbol"==typeof e?e:String(e)}function RI(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class MI extends fI{constructor(){super(...arguments),SI(this,"orderOfIndexes",[])}getValues(){return this.orderOfIndexes.map((t=>this.indexedValues[t]))}setValues(t){this.orderOfIndexes=[...Array(t.length).keys()],super.setValues(t)}setValueAtIndex(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.orderOfIndexes.length;return t<this.indexedValues.length&&(this.indexedValues[t]=e,!1===this.orderOfIndexes.includes(t)&&this.orderOfIndexes.splice(n,0,t),this.runLocalHooks("change"),!0)}clearValue(t){this.orderOfIndexes=yI(this.orderOfIndexes,[t]),iv(this.initValueOrFn)?super.setValueAtIndex(t,this.initValueOrFn(t)):super.setValueAtIndex(t,this.initValueOrFn)}getLength(){return this.orderOfIndexes.length}setDefaultValues(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.indexedValues.length;this.orderOfIndexes.length=0,super.setDefaultValues(t)}insert(t,e){this.indexedValues=mI(this.indexedValues,t,e,this.initValueOrFn),this.orderOfIndexes=bI(this.orderOfIndexes,e),super.insert(t,e)}remove(t){this.indexedValues=pI(this.indexedValues,t),this.orderOfIndexes=yI(this.orderOfIndexes,t),this.orderOfIndexes=CI(this.orderOfIndexes,t),super.remove(t)}getEntries(){return this.orderOfIndexes.map((t=>[t,this.getValueAtIndex(t)]))}}class TI extends wI{constructor(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];super(t)}getTrimmedIndexes(){return Sp(this.getValues(),((t,e,n)=>(e&&t.push(n),t)),[])}}const kI=new Map([["indexesSequence",{getListWithInsertedItems:vI,getListWithRemovedItems:yI}],["physicallyIndexed",{getListWithInsertedItems:mI,getListWithRemovedItems:pI}]]),xI=t=>{if(!1===kI.has(t))throw new Error(`Alter strategy with ID '${t}' does not exist.`);return kI.get(t)};class II extends fI{constructor(){super((t=>t))}insert(t,e){const n=bI(this.indexedValues,e);this.indexedValues=vI(n,t,e),super.insert(t,e)}remove(t){const e=yI(this.indexedValues,t);this.indexedValues=CI(e,t),super.remove(t)}}const OI=new Map([["hiding",AI],["index",fI],["linkedPhysicalIndexToValue",MI],["physicalIndexToValue",wI],["trimming",TI]]);function HI(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!OI.has(t))throw new Error(`The provided map type ("${t}") does not exist.`);return new(OI.get(t))(e)}function DI(t,e,n){return e=NI(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function NI(t){var e=PI(t,"string");return"symbol"==typeof e?e:String(e)}function PI(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}let _I=0;class BI{constructor(){DI(this,"collection",new Map)}register(t,e){!1===this.collection.has(t)&&(this.collection.set(t,e),e.addLocalHook("change",(()=>this.runLocalHooks("change",e))),_I+=1)}unregister(t){const e=this.collection.get(t);Wp(e)&&(e.destroy(),this.collection.delete(t),this.runLocalHooks("change",e),_I-=1)}unregisterAll(){this.collection.forEach(((t,e)=>this.unregister(e))),this.collection.clear()}get(t){return Fp(t)?Array.from(this.collection.values()):this.collection.get(t)}getLength(){return this.collection.size}removeFromEvery(t){this.collection.forEach((e=>{e.remove(t)}))}insertToEvery(t,e){this.collection.forEach((n=>{n.insert(t,e)}))}initEvery(t){this.collection.forEach((e=>{e.init(t)}))}}function LI(){return _I}function VI(t,e,n){return e=WI(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function WI(t){var e=FI(t,"string");return"symbol"==typeof e?e:String(e)}function FI(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}Jv(BI,YT);class jI extends BI{constructor(t,e){super(),VI(this,"mergedValuesCache",[]),VI(this,"aggregationFunction",void 0),VI(this,"fallbackValue",void 0),this.aggregationFunction=t,this.fallbackValue=e}getMergedValues(){if(!0===(!(arguments.length>0&&void 0!==arguments[0])||arguments[0]))return this.mergedValuesCache;if(0===this.getLength())return[];const t=Rp(this.get(),(t=>t.getValues())),e=[],n=Wp(t[0])&&t[0].length||0;for(let o=0;o<n;o+=1){const n=[];for(let e=0;e<this.getLength();e+=1)n.push(t[e][o]);e.push(n)}return Rp(e,this.aggregationFunction)}getMergedValueAtIndex(t,e){const n=this.getMergedValues(e)[t];return Wp(n)?n:this.fallbackValue}updateCache(){this.mergedValuesCache=this.getMergedValues(!1)}}function UI(t,e,n){YI(t,e),e.set(t,n)}function YI(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function zI(t,e,n){var o=KI(t,e,"set");return GI(t,o,n),n}function GI(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function QI(t,e){var n=KI(t,e,"get");return XI(t,n)}function KI(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function XI(t,e){return e.get?e.get.call(t):e.value}var qI=new WeakMap;class ZI{constructor(){UI(this,qI,{writable:!0,value:[]})}subscribe(t){return this.addLocalHook("change",t),this._write(QI(this,qI)),this}unsubscribe(){return this.runLocalHooks("unsubscribe"),this.clearLocalHooks(),this}_write(t){return t.length>0&&this.runLocalHooks("change",t),this}_writeInitialChanges(t){zI(this,qI,t)}}function JI(t,e){const n=[];let o=0,i=0;for(;o<t.length&&i<e.length;o++,i++)t[o]!==e[i]&&n.push({op:"replace",index:i,oldValue:t[o],newValue:e[i]});for(;o<e.length;o++)n.push({op:"insert",index:o,oldValue:void 0,newValue:e[o]});for(;i<t.length;i++)n.push({op:"remove",index:i,oldValue:t[i],newValue:void 0});return n}function $I(t,e,n){tO(t,e),e.set(t,n)}function tO(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function eO(t,e){var n=iO(t,e,"get");return nO(t,n)}function nO(t,e){return e.get?e.get.call(t):e.value}function oO(t,e,n){var o=iO(t,e,"set");return rO(t,o,n),n}function iO(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function rO(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}Jv(ZI,YT);var sO=new WeakMap,aO=new WeakMap,lO=new WeakMap,hO=new WeakMap,cO=new WeakMap;class uO{constructor(){let{initialIndexValue:t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};$I(this,sO,{writable:!0,value:new Set}),$I(this,aO,{writable:!0,value:[]}),$I(this,lO,{writable:!0,value:[]}),$I(this,hO,{writable:!0,value:!1}),$I(this,cO,{writable:!0,value:!1}),oO(this,cO,null!=t&&t)}createObserver(){const t=new ZI;return eO(this,sO).add(t),t.addLocalHook("unsubscribe",(()=>{eO(this,sO).delete(t)})),t._writeInitialChanges(JI(eO(this,aO),eO(this,lO))),t}emit(t){let e=eO(this,lO);(!eO(this,hO)||eO(this,aO).length!==t.length)&&(0===t.length?t=new Array(e.length).fill(eO(this,cO)):oO(this,aO,new Array(t.length).fill(eO(this,cO))),eO(this,hO)||(oO(this,hO,!0),e=eO(this,aO)));const n=JI(e,t);eO(this,sO).forEach((t=>t._write(n))),oO(this,lO,t)}}function dO(t,e,n){return e=gO(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function gO(t){var e=fO(t,"string");return"symbol"==typeof e?e:String(e)}function fO(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class mO{constructor(){dO(this,"indexesSequence",new II),dO(this,"trimmingMapsCollection",new jI((t=>t.some((t=>!0===t))),!1)),dO(this,"hidingMapsCollection",new jI((t=>t.some((t=>!0===t))),!1)),dO(this,"variousMapsCollection",new BI),dO(this,"hidingChangesObservable",new uO({initialIndexValue:!1})),dO(this,"notTrimmedIndexesCache",[]),dO(this,"notHiddenIndexesCache",[]),dO(this,"isBatched",!1),dO(this,"indexesSequenceChanged",!1),dO(this,"indexesChangeSource",void 0),dO(this,"trimmedIndexesChanged",!1),dO(this,"hiddenIndexesChanged",!1),dO(this,"renderablePhysicalIndexesCache",[]),dO(this,"fromPhysicalToVisualIndexesCache",new Map),dO(this,"fromVisualToRenderableIndexesCache",new Map),this.indexesSequence.addLocalHook("change",(()=>{this.indexesSequenceChanged=!0,this.updateCache(),this.runLocalHooks("indexesSequenceChange",this.indexesChangeSource),this.runLocalHooks("change",this.indexesSequence,null)})),this.trimmingMapsCollection.addLocalHook("change",(t=>{this.trimmedIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",t,this.trimmingMapsCollection)})),this.hidingMapsCollection.addLocalHook("change",(t=>{this.hiddenIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",t,this.hidingMapsCollection)})),this.variousMapsCollection.addLocalHook("change",(t=>{this.runLocalHooks("change",t,this.variousMapsCollection)}))}suspendOperations(){this.isBatched=!0}resumeOperations(){this.isBatched=!1,this.updateCache()}createChangesObserver(t){if("hiding"!==t)throw new Error(`Unsupported index map type "${t}".`);return this.hidingChangesObservable.createObserver()}createAndRegisterIndexMap(t,e,n){return this.registerMap(t,HI(e,n))}registerMap(t,e){if(this.trimmingMapsCollection.get(t)||this.hidingMapsCollection.get(t)||this.variousMapsCollection.get(t))throw Error(`Map with name "${t}" has been already registered.`);e instanceof TI?this.trimmingMapsCollection.register(t,e):e instanceof AI?this.hidingMapsCollection.register(t,e):this.variousMapsCollection.register(t,e);const n=this.getNumberOfIndexes();return n>0&&e.init(n),e}unregisterMap(t){this.trimmingMapsCollection.unregister(t),this.hidingMapsCollection.unregister(t),this.variousMapsCollection.unregister(t)}unregisterAll(){this.trimmingMapsCollection.unregisterAll(),this.hidingMapsCollection.unregisterAll(),this.variousMapsCollection.unregisterAll()}getPhysicalFromVisualIndex(t){const e=this.notTrimmedIndexesCache[t];return Wp(e)?e:null}getPhysicalFromRenderableIndex(t){const e=this.renderablePhysicalIndexesCache[t];return Wp(e)?e:null}getVisualFromPhysicalIndex(t){const e=this.fromPhysicalToVisualIndexesCache.get(t);return Wp(e)?e:null}getVisualFromRenderableIndex(t){return this.getVisualFromPhysicalIndex(this.getPhysicalFromRenderableIndex(t))}getRenderableFromVisualIndex(t){const e=this.fromVisualToRenderableIndexesCache.get(t);return Wp(e)?e:null}getNearestNotHiddenIndex(t,e){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(null===this.getPhysicalFromVisualIndex(t))return null;if(this.fromVisualToRenderableIndexesCache.has(t))return t;const o=Array.from(this.fromVisualToRenderableIndexesCache.keys());let i=-1;return i=e>0?o.findIndex((e=>e>t)):o.reverse().findIndex((e=>e<t)),-1===i?n?this.getNearestNotHiddenIndex(t,-e,!1):null:o[i]}initToLength(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getNumberOfIndexes();this.notTrimmedIndexesCache=[...new Array(t).keys()],this.notHiddenIndexesCache=[...new Array(t).keys()],this.suspendOperations(),this.indexesChangeSource="init",this.indexesSequence.init(t),this.indexesChangeSource=void 0,this.trimmingMapsCollection.initEvery(t),this.resumeOperations(),this.suspendOperations(),this.hidingMapsCollection.initEvery(t),this.variousMapsCollection.initEvery(t),this.resumeOperations(),this.runLocalHooks("init")}fitToLength(t){const e=this.getNumberOfIndexes();if(t<e){const e=[...Array(this.getNumberOfIndexes()-t).keys()].map((e=>e+t));this.removeIndexes(e)}else this.insertIndexes(e,t-e)}getIndexesSequence(){return this.indexesSequence.getValues()}setIndexesSequence(t){void 0===this.indexesChangeSource&&(this.indexesChangeSource="update"),this.indexesSequence.setValues(t),"update"===this.indexesChangeSource&&(this.indexesChangeSource=void 0)}getNotTrimmedIndexes(){return!0===(!(arguments.length>0&&void 0!==arguments[0])||arguments[0])?this.notTrimmedIndexesCache:this.getIndexesSequence().filter((t=>!1===this.isTrimmed(t)))}getNotTrimmedIndexesLength(){return this.getNotTrimmedIndexes().length}getNotHiddenIndexes(){return!0===(!(arguments.length>0&&void 0!==arguments[0])||arguments[0])?this.notHiddenIndexesCache:this.getIndexesSequence().filter((t=>!1===this.isHidden(t)))}getNotHiddenIndexesLength(){return this.getNotHiddenIndexes().length}getRenderableIndexes(){return!0===(!(arguments.length>0&&void 0!==arguments[0])||arguments[0])?this.renderablePhysicalIndexesCache:this.getNotTrimmedIndexes().filter((t=>!1===this.isHidden(t)))}getRenderableIndexesLength(){return this.getRenderableIndexes().length}getNumberOfIndexes(){return this.getIndexesSequence().length}moveIndexes(t,e){"number"==typeof t&&(t=[t]);const n=Rp(t,(t=>this.getPhysicalFromVisualIndex(t))),o=this.getNotTrimmedIndexesLength(),i=t.length,r=yI(this.getIndexesSequence(),n),s=r.filter((t=>!1===this.isTrimmed(t)));let a=r.indexOf(s[s.length-1])+1;if(e+i<o){const t=s[e];a=r.indexOf(t)}this.indexesChangeSource="move",this.setIndexesSequence(vI(r,a,n)),this.indexesChangeSource=void 0}isTrimmed(t){return this.trimmingMapsCollection.getMergedValueAtIndex(t)}isHidden(t){return this.hidingMapsCollection.getMergedValueAtIndex(t)}insertIndexes(t,e){const n=this.getNotTrimmedIndexes()[t],o=Wp(n)?n:this.getNumberOfIndexes(),i=this.getIndexesSequence().includes(n)?this.getIndexesSequence().indexOf(n):this.getNumberOfIndexes(),r=Rp(new Array(e).fill(o),((t,e)=>t+e));this.suspendOperations(),this.indexesChangeSource="insert",this.indexesSequence.insert(i,r),this.indexesChangeSource=void 0,this.trimmingMapsCollection.insertToEvery(i,r),this.hidingMapsCollection.insertToEvery(i,r),this.variousMapsCollection.insertToEvery(i,r),this.resumeOperations()}removeIndexes(t){this.suspendOperations(),this.indexesChangeSource="remove",this.indexesSequence.remove(t),this.indexesChangeSource=void 0,this.trimmingMapsCollection.removeFromEvery(t),this.hidingMapsCollection.removeFromEvery(t),this.variousMapsCollection.removeFromEvery(t),this.resumeOperations()}updateCache(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const e=this.indexesSequenceChanged||this.trimmedIndexesChanged||this.hiddenIndexesChanged;(!0===t||!1===this.isBatched&&!0===e)&&(this.trimmingMapsCollection.updateCache(),this.hidingMapsCollection.updateCache(),this.notTrimmedIndexesCache=this.getNotTrimmedIndexes(!1),this.notHiddenIndexesCache=this.getNotHiddenIndexes(!1),this.renderablePhysicalIndexesCache=this.getRenderableIndexes(!1),this.cacheFromPhysicalToVisualIndexes(),this.cacheFromVisualToRenderableIndexes(),this.hiddenIndexesChanged&&this.hidingChangesObservable.emit(this.hidingMapsCollection.getMergedValues()),this.runLocalHooks("cacheUpdated",{indexesSequenceChanged:this.indexesSequenceChanged,trimmedIndexesChanged:this.trimmedIndexesChanged,hiddenIndexesChanged:this.hiddenIndexesChanged}),this.indexesSequenceChanged=!1,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1)}cacheFromPhysicalToVisualIndexes(){const t=this.getNotTrimmedIndexesLength();this.fromPhysicalToVisualIndexesCache.clear();for(let e=0;e<t;e+=1){const t=this.getPhysicalFromVisualIndex(e);this.fromPhysicalToVisualIndexesCache.set(t,e)}}cacheFromVisualToRenderableIndexes(){const t=this.getRenderableIndexesLength();this.fromVisualToRenderableIndexesCache.clear();for(let e=0;e<t;e+=1){const t=this.getPhysicalFromRenderableIndex(e),n=this.getVisualFromPhysicalIndex(t);this.fromVisualToRenderableIndexesCache.set(n,e)}}}function pO(t,e){return ny(e,((e,n)=>{Fp(t[n])&&(t[n]=e)})),t}function wO(t){const e=/^([a-zA-Z]{2})-([a-zA-Z]{2})$/.exec(t);return e?`${e[1].toLowerCase()}-${e[2].toUpperCase()}`:t}function AO(t){Wp(t)&&qy(Lp`Language with code "${t}" was not found. You should register particular language\x20
    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.`)}function vO(t,e){return Array.isArray(t)&&Number.isInteger(e)?t[e]:t}Jv(mO,YT);const{register:yO,getValues:CO}=hC("phraseFormatters");function bO(t,e){yO(t,e)}function SO(){return CO()}bO("pluralize",vO);const EO="ContextMenu:items",RO=EO,MO=`${RO}.noItems`,TO=`${RO}.insertRowAbove`,kO=`${RO}.insertRowBelow`,xO=`${RO}.insertColumnOnTheLeft`,IO=`${RO}.insertColumnOnTheRight`,OO=`${RO}.removeRow`,HO=`${RO}.removeColumn`,DO=`${RO}.undo`,NO=`${RO}.redo`,PO=`${RO}.readOnly`,_O=`${RO}.clearColumn`,BO=`${RO}.copy`,LO=`${RO}.copyWithHeaders`,VO=`${RO}.copyWithGroupHeaders`,WO=`${RO}.copyHeadersOnly`,FO=`${RO}.cut`,jO=`${RO}.freezeColumn`,UO=`${RO}.unfreezeColumn`,YO=`${RO}.mergeCells`,zO=`${RO}.unmergeCells`,GO=`${RO}.addComment`,QO=`${RO}.editComment`,KO=`${RO}.removeComment`,XO=`${RO}.readOnlyComment`,qO=`${RO}.align`,ZO=`${RO}.align.left`,JO=`${RO}.align.center`,$O=`${RO}.align.right`,tH=`${RO}.align.justify`,eH=`${RO}.align.top`,nH=`${RO}.align.middle`,oH=`${RO}.align.bottom`,iH=`${RO}.borders`,rH=`${RO}.borders.top`,sH=`${RO}.borders.right`,aH=`${RO}.borders.bottom`,lH=`${RO}.borders.left`,hH=`${RO}.borders.remove`,cH=`${RO}.nestedHeaders.insertChildRow`,uH=`${RO}.nestedHeaders.detachFromParent`,dH=`${RO}.hideColumn`,gH=`${RO}.showColumn`,fH=`${RO}.hideRow`,mH=`${RO}.showRow`,pH="Filters:",wH=`${pH}conditions`,AH=`${wH}.none`,vH=`${wH}.isEmpty`,yH=`${wH}.isNotEmpty`,CH=`${wH}.isEqualTo`,bH=`${wH}.isNotEqualTo`,SH=`${wH}.beginsWith`,EH=`${wH}.endsWith`,RH=`${wH}.contains`,MH=`${wH}.doesNotContain`,TH=`${wH}.byValue`,kH=`${wH}.greaterThan`,xH=`${wH}.greaterThanOrEqualTo`,IH=`${wH}.lessThan`,OH=`${wH}.lessThanOrEqualTo`,HH=`${wH}.isBetween`,DH=`${wH}.isNotBetween`,NH=`${wH}.after`,PH=`${wH}.before`,_H=`${wH}.today`,BH=`${wH}.tomorrow`,LH=`${wH}.yesterday`,VH=`${pH}labels.filterByCondition`,WH=`${pH}labels.filterByValue`,FH=`${pH}labels.conjunction`,jH=`${pH}labels.disjunction`,UH=`${pH}values.blankCells`,YH=`${pH}buttons.selectAll`,zH=`${pH}buttons.clear`,GH=`${pH}buttons.ok`,QH=`${pH}buttons.cancel`,KH=`${pH}buttons.placeholder.search`,XH=`${pH}buttons.placeholder.value`,qH=`${pH}buttons.placeholder.secondValue`,ZH="CheckboxRenderer:",JH=`${ZH}checked`,$H=`${ZH}unchecked`,tD=Object.freeze(Object.defineProperty({__proto__:null,CHECKBOX_CHECKED:JH,CHECKBOX_RENDERER_NAMESPACE:ZH,CHECKBOX_UNCHECKED:$H,CONTEXTMENU_ITEMS_ADD_COMMENT:GO,CONTEXTMENU_ITEMS_ALIGNMENT:qO,CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM:oH,CONTEXTMENU_ITEMS_ALIGNMENT_CENTER:JO,CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY:tH,CONTEXTMENU_ITEMS_ALIGNMENT_LEFT:ZO,CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE:nH,CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT:$O,CONTEXTMENU_ITEMS_ALIGNMENT_TOP:eH,CONTEXTMENU_ITEMS_BORDERS:iH,CONTEXTMENU_ITEMS_BORDERS_BOTTOM:aH,CONTEXTMENU_ITEMS_BORDERS_LEFT:lH,CONTEXTMENU_ITEMS_BORDERS_RIGHT:sH,CONTEXTMENU_ITEMS_BORDERS_TOP:rH,CONTEXTMENU_ITEMS_CLEAR_COLUMN:_O,CONTEXTMENU_ITEMS_COPY:BO,CONTEXTMENU_ITEMS_COPY_COLUMN_HEADERS_ONLY:WO,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_GROUP_HEADERS:VO,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_HEADERS:LO,CONTEXTMENU_ITEMS_CUT:FO,CONTEXTMENU_ITEMS_EDIT_COMMENT:QO,CONTEXTMENU_ITEMS_FREEZE_COLUMN:jO,CONTEXTMENU_ITEMS_HIDE_COLUMN:dH,CONTEXTMENU_ITEMS_HIDE_ROW:fH,CONTEXTMENU_ITEMS_INSERT_LEFT:xO,CONTEXTMENU_ITEMS_INSERT_RIGHT:IO,CONTEXTMENU_ITEMS_MERGE_CELLS:YO,CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD:uH,CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD:cH,CONTEXTMENU_ITEMS_NO_ITEMS:MO,CONTEXTMENU_ITEMS_READ_ONLY:PO,CONTEXTMENU_ITEMS_READ_ONLY_COMMENT:XO,CONTEXTMENU_ITEMS_REDO:NO,CONTEXTMENU_ITEMS_REMOVE_BORDERS:hH,CONTEXTMENU_ITEMS_REMOVE_COLUMN:HO,CONTEXTMENU_ITEMS_REMOVE_COMMENT:KO,CONTEXTMENU_ITEMS_REMOVE_ROW:OO,CONTEXTMENU_ITEMS_ROW_ABOVE:TO,CONTEXTMENU_ITEMS_ROW_BELOW:kO,CONTEXTMENU_ITEMS_SHOW_COLUMN:gH,CONTEXTMENU_ITEMS_SHOW_ROW:mH,CONTEXTMENU_ITEMS_UNDO:DO,CONTEXTMENU_ITEMS_UNFREEZE_COLUMN:UO,CONTEXTMENU_ITEMS_UNMERGE_CELLS:zO,CONTEXT_MENU_ITEMS_NAMESPACE:EO,FILTERS_BUTTONS_CANCEL:QH,FILTERS_BUTTONS_CLEAR:zH,FILTERS_BUTTONS_OK:GH,FILTERS_BUTTONS_PLACEHOLDER_SEARCH:KH,FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE:qH,FILTERS_BUTTONS_PLACEHOLDER_VALUE:XH,FILTERS_BUTTONS_SELECT_ALL:YH,FILTERS_CONDITIONS_AFTER:NH,FILTERS_CONDITIONS_BEFORE:PH,FILTERS_CONDITIONS_BEGINS_WITH:SH,FILTERS_CONDITIONS_BETWEEN:HH,FILTERS_CONDITIONS_BY_VALUE:TH,FILTERS_CONDITIONS_CONTAINS:RH,FILTERS_CONDITIONS_EMPTY:vH,FILTERS_CONDITIONS_ENDS_WITH:EH,FILTERS_CONDITIONS_EQUAL:CH,FILTERS_CONDITIONS_GREATER_THAN:kH,FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL:xH,FILTERS_CONDITIONS_LESS_THAN:IH,FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL:OH,FILTERS_CONDITIONS_NAMESPACE:wH,FILTERS_CONDITIONS_NONE:AH,FILTERS_CONDITIONS_NOT_BETWEEN:DH,FILTERS_CONDITIONS_NOT_CONTAIN:MH,FILTERS_CONDITIONS_NOT_EMPTY:yH,FILTERS_CONDITIONS_NOT_EQUAL:bH,FILTERS_CONDITIONS_TODAY:_H,FILTERS_CONDITIONS_TOMORROW:BH,FILTERS_CONDITIONS_YESTERDAY:LH,FILTERS_DIVS_FILTER_BY_CONDITION:VH,FILTERS_DIVS_FILTER_BY_VALUE:WH,FILTERS_LABELS_CONJUNCTION:FH,FILTERS_LABELS_DISJUNCTION:jH,FILTERS_NAMESPACE:pH,FILTERS_VALUES_BLANK_CELLS:UH},Symbol.toStringTag,{value:"Module"})),eD={languageCode:"en-US",[MO]:"No available options",[TO]:"Insert row above",[kO]:"Insert row below",[xO]:"Insert column left",[IO]:"Insert column right",[OO]:["Remove row","Remove rows"],[HO]:["Remove column","Remove columns"],[DO]:"Undo",[NO]:"Redo",[PO]:"Read only",[_O]:"Clear column",[qO]:"Alignment",[ZO]:"Left",[JO]:"Center",[$O]:"Right",[tH]:"Justify",[eH]:"Top",[nH]:"Middle",[oH]:"Bottom",[jO]:"Freeze column",[UO]:"Unfreeze column",[iH]:"Borders",[rH]:"Top",[sH]:"Right",[aH]:"Bottom",[lH]:"Left",[hH]:"Remove border(s)",[GO]:"Add comment",[QO]:"Edit comment",[KO]:"Delete comment",[XO]:"Read-only comment",[YO]:"Merge cells",[zO]:"Unmerge cells",[BO]:"Copy",[LO]:["Copy with header","Copy with headers"],[VO]:["Copy with group header","Copy with group headers"],[WO]:["Copy header only","Copy headers only"],[FO]:"Cut",[cH]:"Insert child row",[uH]:"Detach from parent",[dH]:["Hide column","Hide columns"],[gH]:["Show column","Show columns"],[fH]:["Hide row","Hide rows"],[mH]:["Show row","Show rows"],[AH]:"None",[vH]:"Is empty",[yH]:"Is not empty",[CH]:"Is equal to",[bH]:"Is not equal to",[SH]:"Begins with",[EH]:"Ends with",[RH]:"Contains",[MH]:"Does not contain",[kH]:"Greater than",[xH]:"Greater than or equal to",[IH]:"Less than",[OH]:"Less than or equal to",[HH]:"Is between",[DH]:"Is not between",[NH]:"After",[PH]:"Before",[_H]:"Today",[BH]:"Tomorrow",[LH]:"Yesterday",[UH]:"Blank cells",[VH]:"Filter by condition",[WH]:"Filter by value",[FH]:"And",[jH]:"Or",[YH]:"Select all",[zH]:"Clear",[GH]:"OK",[QH]:"Cancel",[KH]:"Search",[XH]:"Value",[qH]:"Second value",[JH]:"Checked",[$H]:"Unchecked"},nD=eD,oD=tD,iD=nD.languageCode,{register:rD,getItem:sD,hasItem:aD,getValues:lD}=hC("languagesDictionaries");
/**
 * @preserve
 * Authors: Handsoncode
 * Last updated: Nov 15, 2017
 *
 * Description: Definition file for English - United States language-country.
 */function hD(t,e){let n=t,o=e;return ty(t)&&(o=t,n=o.languageCode),cD(n,o),rD(n,qv(o)),qv(o)}function cD(t,e){t!==iD&&pO(e,sD(iD))}function uD(t){return dD(t)?qv(sD(t)):null}function dD(t){return aD(t)}function gD(){return lD()}function fD(t,e,n){const o=uD(t);if(null===o)return null;const i=o[e];if(Fp(i))return null;const r=mD(i,n);return Array.isArray(r)?r[0]:r}function mD(t,e){let n=t;return Mp(SO(),(o=>{n=o(t,e)})),n}function pD(t){let e=wO(t);return dD(e)||(e=iD,AO(t)),e}function wD(t,e,n){return e=AD(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function AD(t){var e=vD(t,"string");return"symbol"==typeof e?e:String(e)}function vD(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}hD(nD);class yD extends GT{constructor(t,e){super(t,null),wD(this,"visualCellRange",null),this.visualCellRange=e||null,this.commit()}add(t){return null===this.visualCellRange?this.visualCellRange=this.settings.createCellRange(t):this.visualCellRange.expand(t),this}clear(){return this.visualCellRange=null,super.clear()}trimToVisibleCellsRangeOnly(t){let{from:e,to:n}=t,o=this.getNearestNotHiddenCoords(e,1),i=this.getNearestNotHiddenCoords(n,-1);return null===o||null===i?null:((o.row>i.row||o.col>i.col)&&(o=e,i=n),this.settings.createCellRange(o,o,i))}getNearestNotHiddenCoords(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e;const o=this.getNearestNotHiddenIndex(this.settings.rowIndexMapper,t.row,e);if(null===o)return null;const i=this.getNearestNotHiddenIndex(this.settings.columnIndexMapper,t.col,n);return null===i?null:this.settings.createCellCoords(o,i)}getNearestNotHiddenIndex(t,e,n){return e<0?e:t.getNearestNotHiddenIndex(e,n)}commit(){if(null===this.visualCellRange)return this;const t=this.trimToVisibleCellsRangeOnly(this.visualCellRange);return this.cellRange=null===t?null:this.createRenderableCellRange(t.from,t.to),this}syncWith(t){const e=t.from.clone().normalize(),n="N-S"===t.getVerticalDirection()?1:-1,o="W-E"===t.getHorizontalDirection()?1:-1,i=this.settings.visualToRenderableCoords(this.visualCellRange.highlight);let r=null;if((null===i||null===i.col||null===i.row)&&(r=this.getNearestNotHiddenCoords(e,n,o)),null!==r&&t.overlaps(r)){const e=t.highlight.clone();if(e.row>=0&&(e.row=r.row),e.col>=0&&(e.col=r.col),null===this.cellRange){const t=this.settings.visualToRenderableCoords(e);this.cellRange=this.settings.createCellRange(t)}t.setHighlight(e)}return"focus"===this.settings.selectionType&&null!==i&&null===r&&t.setHighlight(this.visualCellRange.highlight),this}getCorners(){const{from:t,to:e}=this.cellRange;return[Math.min(t.row,e.row),Math.min(t.col,e.col),Math.max(t.row,e.row),Math.max(t.col,e.col)]}getVisualCorners(){const t=this.settings.renderableToVisualCoords(this.cellRange.getTopStartCorner()),e=this.settings.renderableToVisualCoords(this.cellRange.getBottomEndCorner());return[t.row,t.col,e.row,e.col]}createRenderableCellRange(t,e){const n=this.settings.visualToRenderableCoords(t),o=this.settings.visualToRenderableCoords(e);return null===n.row||null===n.col||null===o.row||null===o.col?null:this.settings.createCellRange(n,n,o)}}const CD=yD;function bD(t){let e=t,{activeHeaderClassName:n}=e,o=A(e,["activeHeaderClassName"]);return new CD(w(p({className:n},o),{selectionType:QT}))}function SD(t){let e=t,{areaCornerVisible:n}=e,o=A(e,["areaCornerVisible"]);return new CD(w(p({className:"area",createLayers:!0,border:{width:1,color:"#4b89ff",cornerVisible:n}},o),{selectionType:XT}))}function ED(t){let e=A(t,[]);return new CD(w(p({className:"highlight"},e),{selectionType:XT}))}function RD(t){let e=t,{columnClassName:n}=e,o=A(e,["columnClassName"]);return new CD(w(p({className:n},o),{selectionType:$T}))}function MD(t){let e=t,{cellCornerVisible:n}=e,o=A(e,["cellCornerVisible"]);return new CD(w(p({className:"current",headerAttributes:[Uw()],border:{width:2,color:"#4b89ff",cornerVisible:n}},o),{selectionType:qT}))}function TD(t){let e=t,{border:n,visualCellRange:o}=e,i=A(e,["border","visualCellRange"]);return new CD(w(p(p({},n),i),{selectionType:tk}),o)}function kD(t){let e=A(t,[]);return new CD(w(p({className:"fill",border:{width:1,color:"#ff0000"}},e),{selectionType:ZT}))}function xD(t){let e=t,{headerClassName:n}=e,o=A(e,["headerClassName"]);return new CD(w(p({className:n},o),{selectionType:KT}))}function ID(t){let e=t,{rowClassName:n}=e,o=A(e,["rowClassName"]);return new CD(w(p({className:n},o),{selectionType:JT}))}let OD;function HD(t,e){DD(t,e),e.add(t)}function DD(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ND(t,e,n){return e=PD(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function PD(t){var e=_D(t,"string");return"symbol"==typeof e?e:String(e)}function _D(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function BD(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}var LD=new WeakSet;OD=Symbol.iterator;class VD{constructor(t){HD(this,LD),ND(this,"options",void 0),ND(this,"layerLevel",0),ND(this,"focus",void 0),ND(this,"fill",void 0),ND(this,"layeredAreas",new Map),ND(this,"areas",new Map),ND(this,"rowHeaders",new Map),ND(this,"columnHeaders",new Map),ND(this,"activeRowHeaders",new Map),ND(this,"activeColumnHeaders",new Map),ND(this,"activeCornerHeaders",new Map),ND(this,"rowHighlights",new Map),ND(this,"columnHighlights",new Map),ND(this,"customSelections",[]),this.options=t,this.focus=MD(t),this.fill=kD(t)}isEnabledFor(t,e){let n=t;t===qT&&(n="current");let o=this.options.disabledCellSelection(e.row,e.col);return"string"==typeof o&&(o=[o]),!1===o||Array.isArray(o)&&!o.includes(n)}useLayerLevel(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return this.layerLevel=t,this}getFocus(){return this.focus}getFill(){return this.fill}createLayeredArea(){return BD(this,LD,WD).call(this,this.layeredAreas,SD)}getLayeredAreas(){return[...this.layeredAreas.values()]}createArea(){return BD(this,LD,WD).call(this,this.areas,ED)}getAreas(){return[...this.areas.values()]}createRowHeader(){return BD(this,LD,WD).call(this,this.rowHeaders,xD)}getRowHeaders(){return[...this.rowHeaders.values()]}createColumnHeader(){return BD(this,LD,WD).call(this,this.columnHeaders,xD)}getColumnHeaders(){return[...this.columnHeaders.values()]}createActiveRowHeader(){return BD(this,LD,WD).call(this,this.activeRowHeaders,bD)}getActiveRowHeaders(){return[...this.activeRowHeaders.values()]}createActiveColumnHeader(){return BD(this,LD,WD).call(this,this.activeColumnHeaders,bD)}getActiveColumnHeaders(){return[...this.activeColumnHeaders.values()]}createActiveCornerHeader(){return BD(this,LD,WD).call(this,this.activeCornerHeaders,bD)}getActiveCornerHeaders(){return[...this.activeCornerHeaders.values()]}createRowHighlight(){return BD(this,LD,WD).call(this,this.rowHighlights,ID)}getRowHighlights(){return[...this.rowHighlights.values()]}createColumnHighlight(){return BD(this,LD,WD).call(this,this.columnHighlights,RD)}getColumnHighlights(){return[...this.columnHighlights.values()]}getCustomSelections(){return[...this.customSelections.values()]}addCustomSelection(t){this.customSelections.push(TD(p(p({},this.options),t)))}clear(){this.focus.clear(),this.fill.clear(),Mp(this.areas.values(),(t=>{t.clear()})),Mp(this.layeredAreas.values(),(t=>{t.clear()})),Mp(this.rowHeaders.values(),(t=>{t.clear()})),Mp(this.columnHeaders.values(),(t=>{t.clear()})),Mp(this.activeRowHeaders.values(),(t=>{t.clear()})),Mp(this.activeColumnHeaders.values(),(t=>{t.clear()})),Mp(this.activeCornerHeaders.values(),(t=>{t.clear()})),Mp(this.rowHighlights.values(),(t=>{t.clear()})),Mp(this.columnHighlights.values(),(t=>{t.clear()}))}[OD](){return[this.focus,this.fill,...this.areas.values(),...this.layeredAreas.values(),...this.rowHeaders.values(),...this.columnHeaders.values(),...this.activeRowHeaders.values(),...this.activeColumnHeaders.values(),...this.activeCornerHeaders.values(),...this.rowHighlights.values(),...this.columnHighlights.values(),...this.customSelections][Symbol.iterator]()}}function WD(t,e){const n=this.layerLevel;if(t.has(n))return t.get(n);const o=e(p({layerLevel:n},this.options));return t.set(n,o),o}const FD=VD;let jD;function UD(t,e,n){return e=YD(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function YD(t){var e=zD(t,"string");return"symbol"==typeof e?e:String(e)}function zD(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}jD=Symbol.iterator;class GD{constructor(t){UD(this,"ranges",[]),UD(this,"createCellRange",void 0),this.createCellRange=t}isEmpty(){return 0===this.size()}set(t){return this.clear(),this.ranges.push(this.createCellRange(t)),this}add(t){return this.ranges.push(this.createCellRange(t)),this}pop(){return this.ranges.pop(),this}current(){return this.peekByIndex(this.size()-1)}previous(){return this.peekByIndex(this.size()-2)}includes(t){return this.ranges.some((e=>e.includes(t)))}clear(){return this.ranges.length=0,this}size(){return this.ranges.length}peekByIndex(){let t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return e>=0&&e<this.size()&&(t=this.ranges[e]),t}[jD](){return this.ranges[Symbol.iterator]()}}const QD=GD;function KD(t,e){qD(t,e),e.add(t)}function XD(t,e,n){qD(t,e),e.set(t,n)}function qD(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ZD(t,e){var n=eN(t,e,"get");return JD(t,n)}function JD(t,e){return e.get?e.get.call(t):e.value}function $D(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function tN(t,e,n){var o=eN(t,e,"set");return nN(t,o,n),n}function eN(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function nN(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var oN=new WeakMap,iN=new WeakMap,rN=new WeakMap,sN=new WeakSet,aN=new WeakSet,lN=new WeakSet,hN=new WeakSet,cN=new WeakSet;class uN{constructor(t,e){KD(this,cN),KD(this,hN),KD(this,lN),KD(this,aN),KD(this,sN),XD(this,oN,{writable:!0,value:void 0}),XD(this,iN,{writable:!0,value:void 0}),XD(this,rN,{writable:!0,value:{x:0,y:0}}),tN(this,oN,t),tN(this,iN,e)}transformStart(t,e){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];$D(this,sN,dN).call(this,{x:ZD(this,iN).navigableHeaders()?ZD(this,iN).countRowHeaders():0,y:ZD(this,iN).navigableHeaders()?ZD(this,iN).countColHeaders():0});const o=ZD(this,iN).createCellCoords(t,e);let i=ZD(this,oN).current().highlight;const r=ZD(this,iN).visualToRenderableCoords(i);let s=0,a=0;if(this.runLocalHooks("beforeTransformStart",o),null!==r.row&&null!==r.col){const{width:t,height:e}=$D(this,lN,fN).call(this),{row:r,col:l}=$D(this,hN,mN).call(this,i),h=ZD(this,iN).fixedRowsBottom(),c=ZD(this,iN).minSpareRows(),u=ZD(this,iN).minSpareCols(),d=ZD(this,iN).autoWrapRow(),g=ZD(this,iN).autoWrapCol(),f=ZD(this,iN).createCellCoords(r+o.row,l+o.col);if(f.row>=e){const o=sy(n&&c>0&&0===h),i=f.col+1,r=ZD(this,iN).createCellCoords(f.row-e,i>=t?i-t:i);this.runLocalHooks("beforeColumnWrap",o,$D(this,cN,pN).call(this,r),i>=t),o.value?this.runLocalHooks("insertRowRequire",ZD(this,iN).countRenderableRows()):g&&f.assign(r)}else if(f.row<0){const n=sy(g),o=f.col-1,i=ZD(this,iN).createCellCoords(e+f.row,o<0?t+o:o);this.runLocalHooks("beforeColumnWrap",n,$D(this,cN,pN).call(this,i),o<0),g&&f.assign(i)}if(f.col>=t){const o=sy(n&&u>0),i=f.row+1,r=ZD(this,iN).createCellCoords(i>=e?i-e:i,f.col-t);this.runLocalHooks("beforeRowWrap",o,$D(this,cN,pN).call(this,r),i>=e),o.value?this.runLocalHooks("insertColRequire",ZD(this,iN).countRenderableColumns()):d&&f.assign(r)}else if(f.col<0){const n=sy(d),o=f.row-1,i=ZD(this,iN).createCellCoords(o<0?e+o:o,t+f.col);this.runLocalHooks("beforeRowWrap",n,$D(this,cN,pN).call(this,i),o<0),d&&f.assign(i)}const{rowDir:m,colDir:p}=$D(this,aN,gN).call(this,f);s=m,a=p,i=$D(this,cN,pN).call(this,f)}return this.runLocalHooks("afterTransformStart",i,s,a),i}transformEnd(t,e){$D(this,sN,dN).call(this,{x:ZD(this,iN).navigableHeaders()?ZD(this,iN).countRowHeaders():0,y:ZD(this,iN).navigableHeaders()?ZD(this,iN).countColHeaders():0});const n=ZD(this,iN).createCellCoords(t,e),o=ZD(this,oN).current(),i=ZD(this,iN).visualToRenderableCoords(o.highlight),r=o.to.clone();let s=0,a=0;if(this.runLocalHooks("beforeTransformEnd",n),null!==i.row&&null!==i.col){const{row:t,col:e}=$D(this,hN,mN).call(this,o.to),i=ZD(this,iN).createCellCoords(t+n.row,e+n.col),{rowDir:l,colDir:h}=$D(this,aN,gN).call(this,i);s=l,a=h;const c=$D(this,cN,pN).call(this,i);0===n.row&&0!==n.col?r.col=c.col:0!==n.row&&0===n.col?r.row=c.row:(r.row=c.row,r.col=c.col)}return this.runLocalHooks("afterTransformEnd",r,s,a),r}}function dN(t){let{x:e,y:n}=t;tN(this,rN,{x:e,y:n})}function gN(t){const{width:e,height:n}=$D(this,lN,fN).call(this);let o=0,i=0;return t.row<0?(o=-1,t.row=0):t.row>0&&t.row>=n&&(o=1,t.row=n-1),t.col<0?(i=-1,t.col=0):t.col>0&&t.col>=e&&(i=1,t.col=e-1),{rowDir:o,colDir:i}}function fN(){return{width:ZD(this,rN).x+ZD(this,iN).countRenderableColumns(),height:ZD(this,rN).y+ZD(this,iN).countRenderableRows()}}function mN(t){const{row:e,col:n}=ZD(this,iN).visualToRenderableCoords(t);return ZD(this,iN).createCellCoords(ZD(this,rN).y+e,ZD(this,rN).x+n)}function pN(t){const e=t.clone();return e.col=t.col-ZD(this,rN).x,e.row=t.row-ZD(this,rN).y,ZD(this,iN).renderableToVisualCoords(e)}Jv(uN,YT);const wN=uN,AN=0,vN=1,yN=2,CN=3,bN=[CN,yN],SN=[["number"],["number","string"],["number","undefined"],["number","string","undefined"]],EN=Symbol("root"),RN=Symbol("child");function MN(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:EN;if(e!==EN&&e!==RN)throw new Error("The second argument is used internally only and cannot be overwritten.");const n=Array.isArray(t),o=e===EN;let i=AN;if(n){const e=t[0];0===t.length?i=vN:o&&e instanceof $E?i=CN:o&&Array.isArray(e)?i=MN(e,RN):t.length>=2&&t.length<=4&&!t.some(((t,e)=>!SN[e].includes(typeof t)))&&(i=yN)}return i}function TN(t){let{createCellCoords:e,createCellRange:n,keepDirection:o=!1,propToCol:i}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!bN.includes(t))throw new Error("Unsupported selection ranges schema type was provided.");return function(r){const s=t===CN;let a=s?r.from.row:r[0],l=s?r.from.col:r[1],h=s?r.to.row:r[2],c=s?r.to.col:r[3];if("function"==typeof i&&("string"==typeof l&&(l=i(l)),"string"==typeof c&&(c=i(c))),Fp(h)&&(h=a),Fp(c)&&(c=l),!o){const t=a,e=l,n=h,o=c;a=Math.min(t,n),l=Math.min(e,o),h=Math.max(t,n),c=Math.max(e,o)}const u=e(a,l),d=e(h,c);return n(u,u,d)}}function kN(t){const e=MN(t.getSelected());if(e===AN||e===vN)return[];const n=TN(e,{createCellCoords:t._createCellCoords.bind(t),createCellRange:t._createCellRange.bind(t)}),o=new Set;Mp(t.getSelected(),(t=>{const{from:e,to:i}=n(t),r=Math.max(e.col,0),s=i.col-r+1;Mp(Array.from(new Array(s),((t,e)=>r+e)),(t=>{o.has(t)||o.add(t)}))}));const i=Array.from(o).sort(((t,e)=>t-e));return Sp(i,((t,e,n,o)=>(0!==n&&e===o[n-1]+1?t[t.length-1][1]+=1:t.push([e,1]),t)),[])}function xN(t){const e=MN(t.getSelected());if(e===AN||e===vN)return[];const n=TN(e,{createCellCoords:t._createCellCoords.bind(t),createCellRange:t._createCellRange.bind(t)}),o=new Set;Mp(t.getSelected(),(t=>{const{from:e,to:i}=n(t),r=Math.max(e.row,0),s=i.row-r+1;Mp(Array.from(new Array(s),((t,e)=>r+e)),(t=>{o.has(t)||o.add(t)}))}));const i=Array.from(o).sort(((t,e)=>t-e));return Sp(i,((t,e,n,o)=>(0!==n&&e===o[n-1]+1?t[t.length-1][1]+=1:t.push([e,1]),t)),[])}function IN(t,e,n){ON(t,e),e.set(t,n)}function ON(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function HN(t,e,n){return e=DN(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function DN(t){var e=NN(t,"string");return"symbol"==typeof e?e:String(e)}function NN(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function PN(t,e,n){var o=LN(t,e,"set");return _N(t,o,n),n}function _N(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function BN(t,e){var n=LN(t,e,"get");return VN(t,n)}function LN(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function VN(t,e){return e.get?e.get.call(t):e.value}var WN=new WeakMap;class FN{constructor(t,e){var n=this;HN(this,"settings",void 0),HN(this,"tableProps",void 0),HN(this,"inProgress",!1),HN(this,"selectedRange",new QD(((t,e,n)=>this.tableProps.createCellRange(t,e,n)))),HN(this,"highlight",void 0),HN(this,"transformation",void 0),HN(this,"selectedByRowHeader",new Set),HN(this,"selectedByColumnHeader",new Set),IN(this,WN,{writable:!0,value:!1}),this.settings=t,this.tableProps=e,this.highlight=new FD({headerClassName:t.currentHeaderClassName,activeHeaderClassName:t.activeHeaderClassName,rowClassName:t.currentRowClassName,columnClassName:t.currentColClassName,cellAttributes:[Uw()],rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,disabledCellSelection:(t,e)=>this.tableProps.isDisabledCellSelection(t,e),cellCornerVisible:function(){return n.isCellCornerVisible(...arguments)},areaCornerVisible:function(){return n.isAreaCornerVisible(...arguments)},visualToRenderableCoords:t=>this.tableProps.visualToRenderableCoords(t),renderableToVisualCoords:t=>this.tableProps.renderableToVisualCoords(t),createCellCoords:(t,e)=>this.tableProps.createCellCoords(t,e),createCellRange:(t,e,n)=>this.tableProps.createCellRange(t,e,n)}),this.transformation=new wN(this.selectedRange,{rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,countRenderableRows:()=>this.tableProps.countRenderableRows(),countRenderableColumns:()=>this.tableProps.countRenderableColumns(),countRowHeaders:()=>this.tableProps.countRowHeaders(),countColHeaders:()=>this.tableProps.countColHeaders(),visualToRenderableCoords:t=>this.tableProps.visualToRenderableCoords(t),renderableToVisualCoords:t=>this.tableProps.renderableToVisualCoords(t),createCellCoords:(t,e)=>this.tableProps.createCellCoords(t,e),navigableHeaders:()=>t.navigableHeaders,fixedRowsBottom:()=>t.fixedRowsBottom,minSpareRows:()=>t.minSpareRows,minSpareCols:()=>t.minSpareCols,autoWrapRow:()=>t.autoWrapRow,autoWrapCol:()=>t.autoWrapCol}),this.transformation.addLocalHook("beforeTransformStart",(function(){for(var t=arguments.length,e=new Array(t),o=0;o<t;o++)e[o]=arguments[o];return n.runLocalHooks("beforeModifyTransformStart",...e)})),this.transformation.addLocalHook("afterTransformStart",(function(){for(var t=arguments.length,e=new Array(t),o=0;o<t;o++)e[o]=arguments[o];return n.runLocalHooks("afterModifyTransformStart",...e)})),this.transformation.addLocalHook("beforeTransformEnd",(function(){for(var t=arguments.length,e=new Array(t),o=0;o<t;o++)e[o]=arguments[o];return n.runLocalHooks("beforeModifyTransformEnd",...e)})),this.transformation.addLocalHook("afterTransformEnd",(function(){for(var t=arguments.length,e=new Array(t),o=0;o<t;o++)e[o]=arguments[o];return n.runLocalHooks("afterModifyTransformEnd",...e)})),this.transformation.addLocalHook("insertRowRequire",(function(){for(var t=arguments.length,e=new Array(t),o=0;o<t;o++)e[o]=arguments[o];return n.runLocalHooks("insertRowRequire",...e)})),this.transformation.addLocalHook("insertColRequire",(function(){for(var t=arguments.length,e=new Array(t),o=0;o<t;o++)e[o]=arguments[o];return n.runLocalHooks("insertColRequire",...e)})),this.transformation.addLocalHook("beforeRowWrap",(function(){for(var t=arguments.length,e=new Array(t),o=0;o<t;o++)e[o]=arguments[o];return n.runLocalHooks("beforeRowWrap",...e)})),this.transformation.addLocalHook("beforeColumnWrap",(function(){for(var t=arguments.length,e=new Array(t),o=0;o<t;o++)e[o]=arguments[o];return n.runLocalHooks("beforeColumnWrap",...e)}))}getSelectedRange(){return this.selectedRange}begin(){this.inProgress=!0}finish(){this.runLocalHooks("afterSelectionFinished",Array.from(this.selectedRange)),this.inProgress=!1}isInProgress(){return this.inProgress}setRangeStart(t,e){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:t;const i="multiple"===this.settings.selectionMode,r=Fp(e)?this.tableProps.getShortcutManager().isCtrlPressed():e,s=t.clone();this.runLocalHooks("beforeSetRangeStart"+(n?"Only":""),s),(!i||i&&!r&&Fp(e))&&this.selectedRange.clear(),this.selectedRange.add(s).current().setHighlight(o.clone()),0===this.getLayerLevel()&&(this.selectedByRowHeader.clear(),this.selectedByColumnHeader.clear()),n||this.setRangeEnd(t)}setRangeStartOnly(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t;this.setRangeStart(t,e,!0,n)}setRangeEnd(t){if(this.selectedRange.isEmpty())return;const e=t.clone(),n=this.tableProps.countRows(),o=this.tableProps.countCols(),i=this.selectedRange.current().clone().setTo(t).isSingleHeader();if((n>0||o>0)&&(0===n&&e.col<0&&!i||0===o&&e.row<0&&!i))return;this.runLocalHooks("beforeSetRangeEnd",e),this.begin();const r=this.selectedRange.current();this.settings.navigableHeaders||r.highlight.normalize(),"single"===this.settings.selectionMode?(r.setFrom(r.highlight),r.setTo(r.highlight)):r.setTo(e),n>0&&o>0&&(!this.settings.navigableHeaders||this.settings.navigableHeaders&&!r.isSingleHeader())&&r.to.normalize(),this.runLocalHooks("beforeHighlightSet");const s=this.highlight.getFocus();s.clear(),this.highlight.isEnabledFor(qT,r.highlight)&&s.add(this.selectedRange.current().highlight).commit().syncWith(r);const a=this.getLayerLevel();a<this.highlight.layerLevel&&(Mp(this.highlight.getAreas(),(t=>{t.clear()})),Mp(this.highlight.getLayeredAreas(),(t=>{t.clear()})),Mp(this.highlight.getRowHeaders(),(t=>{t.clear()})),Mp(this.highlight.getColumnHeaders(),(t=>{t.clear()})),Mp(this.highlight.getActiveRowHeaders(),(t=>{t.clear()})),Mp(this.highlight.getActiveColumnHeaders(),(t=>{t.clear()})),Mp(this.highlight.getActiveCornerHeaders(),(t=>{t.clear()})),Mp(this.highlight.getRowHighlights(),(t=>{t.clear()})),Mp(this.highlight.getColumnHighlights(),(t=>{t.clear()}))),this.highlight.useLayerLevel(a);const l=this.highlight.createArea(),h=this.highlight.createLayeredArea(),c=this.highlight.createRowHeader(),u=this.highlight.createColumnHeader(),d=this.highlight.createActiveRowHeader(),g=this.highlight.createActiveColumnHeader(),f=this.highlight.createActiveCornerHeader(),m=this.highlight.createRowHighlight(),p=this.highlight.createColumnHighlight();if(l.clear(),h.clear(),c.clear(),u.clear(),d.clear(),g.clear(),f.clear(),m.clear(),p.clear(),this.highlight.isEnabledFor(XT,r.highlight)&&(this.isMultiple()||a>=1)&&(l.add(r.from).add(r.to).commit(),h.add(r.from).add(r.to).commit(),1===a)){const t=this.selectedRange.previous();this.highlight.useLayerLevel(a-1),this.highlight.createArea().add(t.from).commit().syncWith(t),this.highlight.createLayeredArea().add(t.from).commit().syncWith(t),this.highlight.useLayerLevel(a)}if(this.highlight.isEnabledFor(KT,r.highlight)){if(!r.isSingleHeader()){const t=this.tableProps.createCellCoords(Math.max(r.from.row,0),-1),e=this.tableProps.createCellCoords(r.to.row,-1),n=this.tableProps.createCellCoords(-1,Math.max(r.from.col,0)),o=this.tableProps.createCellCoords(-1,r.to.col);"single"===this.settings.selectionMode?(c.add(t).commit(),u.add(n).commit(),m.add(t).commit(),p.add(n).commit()):(c.add(t).add(e).commit(),u.add(n).add(o).commit(),m.add(t).add(e).commit(),p.add(n).add(o).commit())}const t=!BN(this,WN)&&this.isEntireRowSelected()&&(o>0&&o===r.getWidth()||0===o&&this.isSelectedByRowHeader()),e=!BN(this,WN)&&this.isEntireColumnSelected()&&(n>0&&n===r.getHeight()||0===n&&this.isSelectedByColumnHeader());t&&d.add(this.tableProps.createCellCoords(Math.max(r.from.row,0),Math.min(-this.tableProps.countRowHeaders(),-1))).add(this.tableProps.createCellCoords(Math.max(r.to.row,0),-1)).commit(),e&&g.add(this.tableProps.createCellCoords(Math.min(-this.tableProps.countColHeaders(),-1),Math.max(r.from.col,0))).add(this.tableProps.createCellCoords(-1,Math.max(r.to.col,0))).commit(),t&&e&&f.add(this.tableProps.createCellCoords(-this.tableProps.countColHeaders(),-this.tableProps.countRowHeaders())).add(this.tableProps.createCellCoords(-1,-1)).commit()}this.runLocalHooks("afterSetRangeEnd",t)}isMultiple(){const t=sy(!this.selectedRange.current().isSingle());return this.runLocalHooks("afterIsMultipleSelection",t),t.value}transformStart(t,e){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.setRangeStart(this.transformation.transformStart(t,e,n))}transformEnd(t,e){this.setRangeEnd(this.transformation.transformEnd(t,e))}getLayerLevel(){return this.selectedRange.size()-1}isSelected(){return!this.selectedRange.isEmpty()}isSelectedByRowHeader(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner(t)&&(-1===t?this.selectedByRowHeader.size>0:this.selectedByRowHeader.has(t))}isEntireRowSelected(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getLayerLevel();const e=t=>{const{col:e}=t.getOuterTopStartCorner(),n=this.tableProps.countRowHeaders(),o=this.tableProps.countCols();return(n>0&&e<0||0===n)&&t.getWidth()===o};if(-1===t)return Array.from(this.selectedRange).some((t=>e(t)));const n=this.selectedRange.peekByIndex(t);return!!n&&e(n)}isSelectedByColumnHeader(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner()&&(-1===t?this.selectedByColumnHeader.size>0:this.selectedByColumnHeader.has(t))}isEntireColumnSelected(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getLayerLevel();const e=t=>{const{row:e}=t.getOuterTopStartCorner(),n=this.tableProps.countColHeaders(),o=this.tableProps.countRows();return(n>0&&e<0||0===n)&&t.getHeight()===o};if(-1===t)return Array.from(this.selectedRange).some((t=>e(t)));const n=this.selectedRange.peekByIndex(t);return!!n&&e(n)}isSelectedByAnyHeader(){return this.isSelectedByRowHeader(-1)||this.isSelectedByColumnHeader(-1)||this.isSelectedByCorner()}isSelectedByCorner(){return this.selectedByColumnHeader.has(this.getLayerLevel())&&this.selectedByRowHeader.has(this.getLayerLevel())}inInSelection(t){return this.selectedRange.includes(t)}isCellCornerVisible(){return this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&!this.isMultiple()}isCellVisible(t){const e=this.tableProps.visualToRenderableCoords(t);return null!==e.row&&null!==e.col}isAreaCornerVisible(t){return(!Number.isInteger(t)||t===this.getLayerLevel())&&(this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&this.isMultiple())}clear(){this.selectedRange.clear(),this.highlight.clear()}deselect(){this.isSelected()&&(this.inProgress=!1,this.clear(),this.runLocalHooks("afterDeselect"))}selectAll(){var t;let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{focusPosition:!1,disableHeadersHighlight:!1};const i=this.tableProps.countRows(),r=this.tableProps.countCols(),s=this.tableProps.countRowHeaders(),a=this.tableProps.countColHeaders(),l=n?-a:0,h=e?-s:0;if(0===l&&0===h&&(0===i||0===r))return;let c=null===(t=this.getSelectedRange().current())||void 0===t?void 0:t.highlight;const{focusPosition:u,disableHeadersHighlight:d}=o;PN(this,WN,d),u&&Number.isInteger(null==u?void 0:u.row)&&Number.isInteger(null==u?void 0:u.col)&&(c=this.tableProps.createCellCoords(Eb(u.row,l,i-1),Eb(u.col,h,r-1)));const g=this.tableProps.createCellCoords(l,h),f=this.tableProps.createCellCoords(i-1,r-1);this.clear(),this.setRangeStartOnly(g,void 0,c),h<0&&this.selectedByRowHeader.add(this.getLayerLevel()),l<0&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(f),this.finish(),PN(this,WN,!1)}selectCells(t){var e=this;const n=MN(t);if(n===vN)return!1;if(n===AN)throw new Error(Lp`Unsupported format of the selection ranges was passed. To select cells pass\x20
        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd,\x20
        columnEnd/columnPropEnd]]) or as an array of CellRange objects.`);const o=TN(n,{createCellCoords:function(){return e.tableProps.createCellCoords(...arguments)},createCellRange:function(){return e.tableProps.createCellRange(...arguments)},propToCol:t=>this.tableProps.propToCol(t),keepDirection:!0}),i=this.settings.navigableHeaders,r={countRows:this.tableProps.countRows(),countCols:this.tableProps.countCols(),countRowHeaders:i?this.tableProps.countRowHeaders():0,countColHeaders:i?this.tableProps.countColHeaders():0},s=!t.some((t=>{const e=o(t),n=e.isValid(r);return!(n&&!e.containsHeaders()||n&&e.containsHeaders()&&e.isSingleHeader())}));return s&&(this.clear(),Mp(t,(t=>{const{from:e,to:n}=o(t);this.setRangeStartOnly(e.clone(),!1),this.setRangeEnd(n.clone()),this.finish()}))),s}selectColumns(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const o="string"==typeof t?this.tableProps.propToCol(t):t,i="string"==typeof e?this.tableProps.propToCol(e):e,r=this.tableProps.countRows(),s=this.tableProps.countCols(),a=this.tableProps.countColHeaders(),l=0===a?0:-a,h=this.tableProps.createCellCoords(l,o),c=this.tableProps.createCellCoords(r-1,i),u=this.tableProps.createCellRange(h,h,c).isValid({countRows:r,countCols:s,countRowHeaders:0,countColHeaders:a});if(u){const t=0===a?0:Eb(n,l,-1),e=r-1,s=this.tableProps.createCellCoords(t,o),h=this.tableProps.createCellCoords(e,i),c=this.tableProps.createCellCoords(Eb(n,l,r-1),o);this.runLocalHooks("beforeSelectColumns",s,h,c),s.row=t,h.row=e,this.setRangeStartOnly(s,void 0,c),this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(h),this.runLocalHooks("afterSelectColumns",s,h,c),this.finish()}return u}selectRows(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const o=this.tableProps.countRows(),i=this.tableProps.countCols(),r=this.tableProps.countRowHeaders(),s=0===r?0:-r,a=this.tableProps.createCellCoords(t,s),l=this.tableProps.createCellCoords(e,i-1),h=this.tableProps.createCellRange(a,a,l).isValid({countRows:o,countCols:i,countRowHeaders:r,countColHeaders:0});if(h){const o=0===r?0:Eb(n,s,-1),a=i-1,l=this.tableProps.createCellCoords(t,o),h=this.tableProps.createCellCoords(e,a),c=this.tableProps.createCellCoords(t,Eb(n,s,i-1));this.runLocalHooks("beforeSelectRows",l,h,c),l.col=o,h.col=a,this.setRangeStartOnly(l,void 0,c),this.selectedByRowHeader.add(this.getLayerLevel()),this.setRangeEnd(h),this.runLocalHooks("afterSelectRows",l,h,c),this.finish()}return h}refresh(){if(this.highlight.getCustomSelections().forEach((t=>{t.commit()})),!this.isSelected())return;const t=this.highlight.getFocus(),e=this.getLayerLevel();t.commit().syncWith(this.selectedRange.current());for(let n=0;n<this.selectedRange.size();n+=1){this.highlight.useLayerLevel(n);const t=this.highlight.createArea(),e=this.highlight.createLayeredArea(),o=this.highlight.createRowHeader(),i=this.highlight.createColumnHeader(),r=this.highlight.createActiveRowHeader(),s=this.highlight.createActiveColumnHeader(),a=this.highlight.createActiveCornerHeader(),l=this.highlight.createRowHighlight(),h=this.highlight.createColumnHighlight();t.commit(),e.commit(),o.commit(),i.commit(),r.commit(),s.commit(),a.commit(),l.commit(),h.commit()}this.highlight.useLayerLevel(e)}}Jv(FN,YT);const jN=FN,UN=/^(\r\n|\n\r|\r|\n)/,YN=/^[^\t\r\n]+/,zN=/^\t/;function GN(t){const e=[[""]];if(0===t.length)return e;let n,o=0,i=0;for(;t.length>0&&n!==t.length;)if(n=t.length,t.match(zN))t=t.replace(zN,""),o+=1,e[i][o]="";else if(t.match(UN))t=t.replace(UN,""),o=0,i+=1,e[i]=[""];else{let n="";if(t.startsWith('"')){let e=0,o=!0;for(;o;){const i=t.slice(0,1);'"'===i&&(e+=1),n+=i,t=t.slice(1),(0===t.length||t.match(/^[\t\r\n]/)&&e%2===0)&&(o=!1)}n=n.replace(/^"/,"").replace(/"$/,"").replace(/["]*/g,(t=>new Array(Math.floor(t.length/2)).fill('"').join("")))}else{const e=t.match(YN);n=e?e[0]:"",t=t.slice(n.length)}e[i][o]=n}return e}function QN(t){let e,n,o,i,r,s="";for(e=0,n=t.length;e<n;e+=1){for(i=t[e].length,o=0;o<i;o+=1)o>0&&(s+="\t"),r=t[e][o],"string"==typeof r?r.indexOf("\n")>-1?s+=`"${r.replace(/"/g,'""')}"`:s+=r:s+=null==r?"":r;e!==n-1&&(s+="\n")}return s}function KN(t,e,n){return e=XN(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function XN(t){var e=qN(t,"string");return"symbol"==typeof e?e:String(e)}function qN(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class ZN{static get DESTINATION_RENDERER(){return 1}static get DESTINATION_CLIPBOARD_GENERATOR(){return 2}constructor(t,e,n){KN(this,"hot",void 0),KN(this,"metaManager",void 0),KN(this,"tableMeta",void 0),KN(this,"dataSource",void 0),KN(this,"duckSchema",void 0),KN(this,"colToPropCache",void 0),KN(this,"propToColCache",void 0),this.hot=t,this.metaManager=n,this.tableMeta=n.getTableMeta(),this.dataSource=e,this.duckSchema=this.createDuckSchema(),this.createMap()}createMap(){const t=this.getSchema();if("undefined"==typeof t)throw new Error("trying to create `columns` definition but you didn't provide `schema` nor `data`");const e=this.tableMeta.columns;let n;if(this.colToPropCache=[],this.propToColCache=new Map,e){let o=0,i=0,r=!1;if("function"==typeof e){const e=ry(t);o=e>0?e:this.countFirstRowKeys(),r=!0}else{const t=this.tableMeta.maxCols;o=Math.min(t,e.length)}for(n=0;n<o;n++){const t=r?e(n):e[n];if(ty(t)){if("undefined"!=typeof t.data){const e=r?i:n;this.colToPropCache[e]=t.data,this.propToColCache.set(t.data,e)}i+=1}}}else this.recursiveDuckColumns(t)}countFirstRowKeys(){return nI(this.dataSource)}recursiveDuckColumns(t,e,n){let o,i=e,r=n;return"undefined"==typeof i&&(i=0,r=""),"object"==typeof t&&!Array.isArray(t)&&ny(t,((t,e)=>{null===t?(o=r+e,this.colToPropCache.push(o),this.propToColCache.set(o,i),i+=1):i=this.recursiveDuckColumns(t,i,`${e}.`)})),i}colToProp(t){if(!1===Number.isInteger(t))return t;const e=this.hot.toPhysicalColumn(t);return null===e?t:this.colToPropCache&&Wp(this.colToPropCache[e])?this.colToPropCache[e]:e}propToCol(t){const e=this.propToColCache.get(t);if(Wp(e))return this.hot.toVisualColumn(e);const n=this.hot.toVisualColumn(t);return null===n?t:n}getSchema(){const t=this.tableMeta.dataSchema;return t?"function"==typeof t?t():t:this.duckSchema}createDuckSchema(){return this.dataSource&&this.dataSource[0]?Gv(this.dataSource[0]):{}}refreshDuckSchema(){this.duckSchema=this.createDuckSchema()}createRow(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,{source:n,mode:o="above"}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const i=this.hot.countSourceRows();let r=i,s=0,a=t;if(("number"!=typeof a||a>=i)&&(a=i),a<this.hot.countRows()&&(r=this.hot.toPhysicalRow(a)),!1===this.hot.runHooks("beforeCreateRow",a,e,n)||null===r)return{delta:0};const l=this.tableMeta.maxRows,h=this.getSchema().length,c=[];for(;s<e&&i+s<l;){let t=null;"array"===this.hot.dataType?this.tableMeta.dataSchema?t=qv(this.getSchema()):(t=[],Cb(h-1,(()=>t.push(null)))):"function"===this.hot.dataType?t=this.tableMeta.dataSchema(a+s):(t={},Xv(t,this.getSchema())),c.push(t),s+=1}this.hot.rowIndexMapper.insertIndexes(a,s),"below"===o&&(r=Math.min(r+1,i)),this.spliceData(r,0,c);const u=this.hot.toVisualRow(r);return this.hot.countSourceRows()===c.length&&this.hot.columnIndexMapper.initToLength(this.hot.getInitialColumnCount()),s>0&&(null==t?this.metaManager.createRow(null,s):"auto"!==n&&this.metaManager.createRow(r,e)),this.hot.runHooks("afterCreateRow",u,s,n),this.hot.forceFullRender=!0,{delta:s,startPhysicalIndex:r}}createCol(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,{source:n,mode:o="start"}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!this.hot.isColumnModificationAllowed())throw new Error("Cannot create new column. When data source in an object, you can only have as much columns as defined in first data row, data schema or in the 'columns' setting.If you want to be able to add new columns, you have to use array datasource.");const i=this.dataSource,r=this.tableMeta.maxCols,s=this.hot.countSourceCols();let a=t;if(("number"!=typeof a||a>=s)&&(a=s),!1===this.hot.runHooks("beforeCreateCol",a,e,n))return{delta:0};let l=s;a<this.hot.countCols()&&(l=this.hot.toPhysicalColumn(a));const h=this.hot.countSourceRows();let c=this.hot.countCols(),u=0,d=l;"end"===o&&(d=Math.min(d+1,s));const g=d;for(;u<e&&c<r;){if("number"!=typeof a||a>=c)if(h>0)for(let t=0;t<h;t+=1)"undefined"==typeof i[t]&&(i[t]=[]),i[t].push(null);else i.push([null]);else for(let t=0;t<h;t++)i[t].splice(d,0,null);u+=1,d+=1,c+=1}this.hot.columnIndexMapper.insertIndexes(a,u),u>0&&(null==t?this.metaManager.createColumn(null,u):"auto"!==n&&this.metaManager.createColumn(g,e));const f=this.hot.toVisualColumn(g);return this.hot.runHooks("afterCreateCol",f,u,n),this.hot.forceFullRender=!0,this.refreshDuckSchema(),{delta:u,startPhysicalIndex:g}}removeRow(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2?arguments[2]:void 0,o=Number.isInteger(t)?t:-e;const i=this.visualRowsToPhysical(o,e),r=this.hot.countSourceRows();if(o=(r+o)%r,!1===this.hot.runHooks("beforeRemoveRow",o,i.length,i,n))return!1;const s=i.length;if(this.filterData(o,s,i),o<this.hot.countRows()){this.hot.rowIndexMapper.removeIndexes(i);const t=Wp(this.tableMeta.columns)||Wp(this.tableMeta.dataSchema);0===this.hot.rowIndexMapper.getNotTrimmedIndexesLength()&&!1===t&&this.hot.columnIndexMapper.setIndexesSequence([])}return i.slice(0).sort(((t,e)=>e-t)).forEach((t=>{this.metaManager.removeRow(t,1)})),this.hot.runHooks("afterRemoveRow",o,s,i,n),this.hot.forceFullRender=!0,!0}removeCol(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2?arguments[2]:void 0;if("object"===this.hot.dataType||this.tableMeta.columns)throw new Error("cannot remove column with object data source or columns option specified");let o="number"!=typeof t?-e:t;o=(this.hot.countCols()+o)%this.hot.countCols();const i=this.visualColumnsToPhysical(o,e),r=i.slice(0).sort(((t,e)=>e-t));if(!1===this.hot.runHooks("beforeRemoveCol",o,e,i,n))return!1;let s=!0;const a=r.length,l=this.dataSource;for(let h=0;h<a;h++)s&&i[0]!==i[h]-h&&(s=!1);if(s)for(let h=0,c=this.hot.countSourceRows();h<c;h++)l[h].splice(i[0],e),0===h&&this.metaManager.removeColumn(i[0],e);else for(let h=0,c=this.hot.countSourceRows();h<c;h++)for(let t=0;t<a;t++)l[h].splice(r[t],1),0===h&&this.metaManager.removeColumn(r[t],1);return o<this.hot.countCols()&&(this.hot.columnIndexMapper.removeIndexes(i),0===this.hot.columnIndexMapper.getNotTrimmedIndexesLength()&&this.hot.rowIndexMapper.setIndexesSequence([])),this.hot.runHooks("afterRemoveCol",o,e,i,n),this.hot.forceFullRender=!0,this.refreshDuckSchema(),!0}spliceCol(t,e,n){const o=this.hot.getDataAtCol(t),i=o.slice(e,e+n),r=o.slice(e+n);for(var s=arguments.length,a=new Array(s>3?s-3:0),l=3;l<s;l++)a[l-3]=arguments[l];Cp(a,r);let h=0;for(;h<n;)a.push(null),h+=1;return yp(a),this.hot.populateFromArray(e,t,a,null,null,"spliceCol"),i}spliceRow(t,e,n){const o=this.hot.getSourceDataAtRow(t),i=o.slice(e,e+n),r=o.slice(e+n);for(var s=arguments.length,a=new Array(s>3?s-3:0),l=3;l<s;l++)a[l-3]=arguments[l];Cp(a,r);let h=0;for(;h<n;)a.push(null),h+=1;return this.hot.populateFromArray(t,e,[a],null,null,"spliceRow"),i}spliceData(t,e,n){if(!1!==this.hot.runHooks("beforeDataSplice",t,e,n)){const e=[...this.dataSource.slice(0,t),...n,...this.dataSource.slice(t)];this.dataSource.length=0,e.forEach((t=>this.dataSource.push(t)))}}filterData(t,e,n){let o=this.hot.runHooks("filterData",t,e,n);!1===Array.isArray(o)&&(o=this.dataSource.filter(((t,e)=>-1===n.indexOf(e)))),this.dataSource.length=0,Array.prototype.push.apply(this.dataSource,o)}get(t,e){const n=this.hot.toPhysicalRow(t);let o=this.dataSource[n];const i=this.hot.runHooks("modifyRowData",n);o=isNaN(i)?i:o;let r=null;if(o&&o.hasOwnProperty&&ay(o,e))r=o[e];else if("string"==typeof e&&e.indexOf(".")>-1){const t=e.split(".");let n=o;if(!n)return null;for(let e=0,o=t.length;e<o;e++)if(n=n[t[e]],"undefined"==typeof n)return null;r=n}else"function"==typeof e&&(r=e(this.dataSource.slice(n,n+1)[0]));if(this.hot.hasHook("modifyData")){const t=sy(r);this.hot.runHooks("modifyData",n,this.propToCol(e),t,"get"),t.isTouched()&&(r=t.value)}return r}getCopyable(t,e){return this.hot.getCellMeta(t,this.propToCol(e)).copyable?this.get(t,e):""}set(t,e,n){const o=this.hot.toPhysicalRow(t);let i=n,r=this.dataSource[o];const s=this.hot.runHooks("modifyRowData",o);if(r=isNaN(s)?s:r,this.hot.hasHook("modifyData")){const t=sy(i);this.hot.runHooks("modifyData",o,this.propToCol(e),t,"set"),t.isTouched()&&(i=t.value)}if(r&&r.hasOwnProperty&&ay(r,e))r[e]=i;else if("string"==typeof e&&e.indexOf(".")>-1){const t=e.split(".");let n,o=r,s=0;for(s=0,n=t.length-1;s<n;s++)"undefined"==typeof o[t[s]]&&(o[t[s]]={}),o=o[t[s]];o[t[s]]=i}else"function"==typeof e?e(this.dataSource.slice(o,o+1)[0],i):r[e]=i}visualRowsToPhysical(t,e){const n=this.hot.countSourceRows(),o=[];let i,r=(n+t)%n,s=e;for(;r<n&&s;)i=this.hot.toPhysicalRow(r),o.push(i),s-=1,r+=1;return o}visualColumnsToPhysical(t,e){const n=this.hot.countCols(),o=[];let i=(n+t)%n,r=e;for(;i<n&&r;){const t=this.hot.toPhysicalColumn(i);o.push(t),r-=1,i+=1}return o}clear(){for(let t=0;t<this.hot.countSourceRows();t++)for(let e=0;e<this.hot.countCols();e++)this.set(t,this.colToProp(e),"")}getLength(){const t=this.tableMeta.maxRows;let e;e=t<0||0===t?0:t||1/0;const n=this.hot.rowIndexMapper.getNotTrimmedIndexesLength();return Math.min(n,e)}getAll(){const t={row:0,col:0},e={row:Math.max(this.hot.countRows()-1,0),col:Math.max(this.hot.countCols()-1,0)};return t.row-e.row!==0||this.hot.countSourceRows()?this.getRange(t,e,ZN.DESTINATION_RENDERER):[]}countCachedColumns(){return this.colToPropCache.length}getRange(t,e,n){const o=[];let i,r,s;const a=this.tableMeta.maxRows,l=this.tableMeta.maxCols;if(0===a||0===l)return[];const h=n===ZN.DESTINATION_CLIPBOARD_GENERATOR?this.getCopyable:this.get,c=Math.min(Math.max(a-1,0),Math.max(t.row,e.row)),u=Math.min(Math.max(l-1,0),Math.max(t.col,e.col));for(i=Math.min(t.row,e.row);i<=c;i++){s=[];const n=i>=0?this.hot.toPhysicalRow(i):i;for(r=Math.min(t.col,e.col);r<=u&&null!==n;r++)s.push(h.call(this,i,this.colToProp(r)));null!==n&&o.push(s)}return o}getText(t,e){return QN(this.getRange(t,e,ZN.DESTINATION_RENDERER))}getCopyableText(t,e){return QN(this.getRange(t,e,ZN.DESTINATION_CLIPBOARD_GENERATOR))}destroy(){this.hot=null,this.metaManager=null,this.dataSource=null,this.duckSchema=null,this.colToPropCache.length=0,this.propToColCache.clear(),this.propToColCache=void 0}}const JN=ZN,{register:$N,getItem:tP,hasItem:eP,getNames:nP,getValues:oP}=hC("cellTypes");function iP(t){if(!eP(t))throw Error(`You declared cell type "${t}" as a string that is not mapped to a known object.\n                 Cell type must be an object or a string mapped to an object registered by\n                 "Handsontable.cellTypes.registerCellType" method`);return tP(t)}function rP(t,e){"string"!=typeof t&&(e=t,t=e.CELL_TYPE);const{editor:n,renderer:o,validator:i}=e;n&&vC(t,n),o&&tS(t,o),i&&aS(t,i),$N(t,e)}function sP(t,e){var n;return"CELL_TYPE"!==t&&((null===(n=e._automaticallyAssignedMetaProps)||void 0===n?void 0:n.has(t))||!ay(e,t))}function aP(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t;const o="string"==typeof e.type?iP(e.type):e.type;if(t._automaticallyAssignedMetaProps&&ny(e,((e,n)=>{t._automaticallyAssignedMetaProps.delete(n)})),!ty(o))return;n===t&&!t._automaticallyAssignedMetaProps&&(t._automaticallyAssignedMetaProps=new Set);const i={};ny(o,((e,o)=>{var r;sP(o,n)&&(i[o]=e,null===(r=t._automaticallyAssignedMetaProps)||void 0===r||r.add(o))})),Kv(t,i)}function lP(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];function n(){}Qv(n,t);for(let o=0;o<e.length;o++)n.prototype[e[o]]=void 0;return n}function hP(t){return Number.isInteger(t)&&t>=0}function cP(t,e){if(!t())throw new Error(`Assertion failed: ${e}`)}function uP(t){return null==t}const dP=()=>({_automaticallyAssignedMetaProps:void 0,activeHeaderClassName:"ht__active_highlight",allowEmpty:!0,allowHtml:!1,allowInsertColumn:!0,allowInsertRow:!0,allowInvalid:!0,allowRemoveColumn:!0,allowRemoveRow:!0,ariaTags:!0,autoColumnSize:void 0,autoRowSize:void 0,autoWrapCol:!1,autoWrapRow:!1,bindRowsWithHeaders:void 0,cell:[],cells:void 0,checkedTemplate:void 0,className:void 0,colHeaders:null,collapsibleColumns:void 0,columnHeaderHeight:void 0,columns:void 0,columnSorting:void 0,columnSummary:void 0,colWidths:void 0,commentedCellClassName:"htCommentCell",comments:!1,contextMenu:void 0,copyable:!0,copyPaste:!0,correctFormat:!1,currentColClassName:void 0,currentHeaderClassName:"ht__highlight",currentRowClassName:void 0,customBorders:!1,data:void 0,dataSchema:void 0,dateFormat:"DD/MM/YYYY",datePickerConfig:void 0,defaultDate:void 0,disableVisualSelection:!1,dragToScroll:!0,dropdownMenu:void 0,editor:void 0,enterBeginsEditing:!0,enterMoves:{col:0,row:1},fillHandle:{autoInsertRow:!1},filter:!0,filteringCaseSensitive:!1,filters:void 0,fixedColumnsLeft:0,fixedColumnsStart:0,fixedRowsBottom:0,fixedRowsTop:0,formulas:void 0,fragmentSelection:!1,height:void 0,hiddenColumns:void 0,hiddenRows:void 0,invalidCellClassName:"htInvalid",imeFastEdit:!1,isEmptyCol(t){let e,n,o;for(e=0,n=this.countRows();e<n;e++)if(o=this.getDataAtCell(e,t),!1===jp(o))return!1;return!0},isEmptyRow(t){let e,n,o,i;for(e=0,n=this.countCols();e<n;e++)if(o=this.getDataAtCell(t,e),!1===jp(o))return"object"==typeof o&&(i=this.getCellMeta(t,e),$v(this.getSchema()[i.prop],o));return!0},label:void 0,language:"en-US",layoutDirection:"inherit",licenseKey:void 0,locale:"en-US",manualColumnFreeze:void 0,manualColumnMove:void 0,manualColumnResize:void 0,manualRowMove:void 0,manualRowResize:void 0,maxCols:1/0,maxRows:1/0,mergeCells:!1,minCols:0,minRows:0,minSpareCols:0,minSpareRows:0,multiColumnSorting:void 0,navigableHeaders:!1,tabNavigation:!0,nestedHeaders:void 0,nestedRows:void 0,noWordWrapClassName:"htNoWrap",numericFormat:void 0,observeDOMVisibility:!0,outsideClickDeselects:!0,persistentState:void 0,placeholder:void 0,placeholderCellClassName:"htPlaceholder",preventOverflow:!1,preventWheel:!1,readOnly:!1,readOnlyCellClassName:"htDimmed",renderAllRows:!1,renderAllColumns:!1,renderer:void 0,rowHeaders:void 0,rowHeaderWidth:void 0,rowHeights:void 0,search:!1,selectionMode:"multiple",selectOptions:void 0,skipColumnOnPaste:!1,skipRowOnPaste:!1,sortByRelevance:!0,source:void 0,startCols:5,startRows:5,stretchH:"none",strict:void 0,tableClassName:void 0,tabMoves:{row:0,col:1},title:void 0,trimDropdown:!0,trimRows:void 0,trimWhitespace:!0,type:"text",uncheckedTemplate:void 0,undo:void 0,validator:void 0,viewportColumnRenderingOffset:"auto",viewportRowRenderingOffset:"auto",visibleRows:10,width:void 0,wordWrap:!0});function gP(t,e,n){return e=fP(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function fP(t){var e=mP(t,"string");return"symbol"==typeof e?e:String(e)}function mP(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function pP(){return class{}}class wP{constructor(t){gP(this,"metaCtor",pP()),gP(this,"meta",void 0),this.meta=this.metaCtor.prototype,Kv(this.meta,dP()),this.meta.instance=t}getMetaConstructor(){return this.metaCtor}getMeta(){return this.meta}updateMeta(t){var e;Kv(this.meta,t),aP(this.meta,w(p({},t),{type:null!==(e=t.type)&&void 0!==e?e:this.meta.type}),t)}}function AP(t,e,n){return e=vP(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function vP(t){var e=yP(t,"string");return"symbol"==typeof e?e:String(e)}function yP(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class CP{constructor(t){AP(this,"meta",void 0);const e=t.getMetaConstructor();this.meta=new e}getMeta(){return this.meta}updateMeta(t){Kv(this.meta,t),aP(this.meta,t,t)}}let bP;function SP(t,e,n){return e=EP(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function EP(t){var e=RP(t,"string");return"symbol"==typeof e?e:String(e)}function RP(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}bP=Symbol.iterator;class MP{constructor(t){SP(this,"valueFactory",void 0),SP(this,"data",[]),SP(this,"index",[]),SP(this,"holes",new Set),this.valueFactory=t}obtain(t){cP((()=>hP(t)),"Expecting an unsigned number.");const e=this._getStorageIndexByKey(t);let n;if(e>=0)n=this.data[e],void 0===n&&(n=this.valueFactory(t),this.data[e]=n);else if(n=this.valueFactory(t),this.holes.size>0){const e=this.holes.values().next().value;this.holes.delete(e),this.data[e]=n,this.index[t]=e}else this.data.push(n),this.index[t]=this.data.length-1;return n}insert(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;cP((()=>hP(t)||uP(t)),"Expecting an unsigned number or null/undefined argument.");const n=[],o=this.data.length;for(let r=0;r<e;r++)n.push(o+r),this.data.push(void 0);const i=uP(t)?this.index.length:t;this.index=[...this.index.slice(0,i),...n,...this.index.slice(i)]}remove(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;cP((()=>hP(t)||uP(t)),"Expecting an unsigned number or null/undefined argument.");const n=this.index.splice(uP(t)?this.index.length-e:t,e);for(let o=0;o<n.length;o++){const t=n[o];"number"==typeof t&&this.holes.add(t)}}size(){return this.data.length-this.holes.size}values(){return Ep(this.data,((t,e)=>!this.holes.has(e)))[Symbol.iterator]()}entries(){const t=[];for(let n=0;n<this.data.length;n++){const e=this._getKeyByStorageIndex(n);-1!==e&&t.push([e,this.data[n]])}let e=0;return{next:()=>{if(e<t.length){const n=t[e];return e+=1,{value:n,done:!1}}return{done:!0}}}}clear(){this.data=[],this.index=[],this.holes.clear()}_getStorageIndexByKey(t){return this.index.length>t?this.index[t]:-1}_getKeyByStorageIndex(t){return this.index.indexOf(t)}[bP](){return this.entries()}}function TP(t,e,n){return e=kP(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function kP(t){var e=xP(t,"string");return"symbol"==typeof e?e:String(e)}function xP(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}const IP=["data","width"];class OP{constructor(t){TP(this,"globalMeta",void 0),TP(this,"metas",new MP((()=>this._createMeta()))),this.globalMeta=t,this.metas=new MP((()=>this._createMeta()))}updateMeta(t,e){const n=this.getMeta(t);Kv(n,e),aP(n,e)}createColumn(t,e){this.metas.insert(t,e)}removeColumn(t,e){this.metas.remove(t,e)}getMeta(t){return this.metas.obtain(t)}getMetaConstructor(t){return this.metas.obtain(t).constructor}clearCache(){this.metas.clear()}_createMeta(){return lP(this.globalMeta.getMetaConstructor(),IP).prototype}}function HP(t,e,n){return e=DP(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function DP(t){var e=NP(t,"string");return"symbol"==typeof e?e:String(e)}function NP(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class PP{constructor(t){HP(this,"columnMeta",void 0),HP(this,"metas",new MP((()=>this._createRow()))),this.columnMeta=t}updateMeta(t,e,n){const o=this.getMeta(t,e);Kv(o,n),aP(o,n)}createRow(t,e){this.metas.insert(t,e)}createColumn(t,e){for(let n=0;n<this.metas.size();n++)this.metas.obtain(n).insert(t,e)}removeRow(t,e){this.metas.remove(t,e)}removeColumn(t,e){for(let n=0;n<this.metas.size();n++)this.metas.obtain(n).remove(t,e)}getMeta(t,e,n){const o=this.metas.obtain(t).obtain(e);return void 0===n?o:o[n]}setMeta(t,e,n,o){var i;const r=this.metas.obtain(t).obtain(e);null===(i=r._automaticallyAssignedMetaProps)||void 0===i||i.delete(n),r[n]=o}removeMeta(t,e,n){const o=this.metas.obtain(t).obtain(e);delete o[n]}getMetas(){const t=[],e=Array.from(this.metas.values());for(let n=0;n<e.length;n++)t.push(...e[n].values());return t}getMetasAtRow(t){cP((()=>hP(t)),"Expecting an unsigned number.");const e=new Map(this.metas);return e.has(t)?Array.from(e.get(t).values()):[]}clearCache(){this.metas.clear()}_createRow(){return new MP((t=>this._createMeta(t)))}_createMeta(t){const e=this.columnMeta.getMetaConstructor(t);return new e}}class _P{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];this.hot=t,this.globalMeta=new wP(t),this.tableMeta=new CP(this.globalMeta),this.columnMeta=new OP(this.globalMeta),this.cellMeta=new PP(this.columnMeta),n.forEach((t=>new t(this))),this.globalMeta.updateMeta(e)}getGlobalMeta(){return this.globalMeta.getMeta()}updateGlobalMeta(t){this.globalMeta.updateMeta(t)}getTableMeta(){return this.tableMeta.getMeta()}updateTableMeta(t){this.tableMeta.updateMeta(t)}getColumnMeta(t){return this.columnMeta.getMeta(t)}updateColumnMeta(t,e){this.columnMeta.updateMeta(t,e)}getCellMeta(t,e,n){let{visualRow:o,visualColumn:i}=n;const r=this.cellMeta.getMeta(t,e);return r.visualRow=o,r.visualCol=i,r.row=t,r.col=e,this.runLocalHooks("afterGetCellMeta",r),r}getCellMetaKeyValue(t,e,n){if("string"!=typeof n)throw new Error("The passed cell meta object key is not a string");return this.cellMeta.getMeta(t,e,n)}setCellMeta(t,e,n,o){this.cellMeta.setMeta(t,e,n,o)}updateCellMeta(t,e,n){this.cellMeta.updateMeta(t,e,n)}removeCellMeta(t,e,n){this.cellMeta.removeMeta(t,e,n)}getCellsMeta(){return this.cellMeta.getMetas()}getCellsMetaAtRow(t){return this.cellMeta.getMetasAtRow(t)}createRow(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.cellMeta.createRow(t,e)}removeRow(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.cellMeta.removeRow(t,e)}createColumn(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.cellMeta.createColumn(t,e),this.columnMeta.createColumn(t,e)}removeColumn(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.cellMeta.removeColumn(t,e),this.columnMeta.removeColumn(t,e)}clearCellsCache(){this.cellMeta.clearCache()}clearCache(){this.cellMeta.clearCache(),this.columnMeta.clearCache()}}function BP(t,e,n,o){const{hotInstance:i,dataMap:r,dataSource:s,internalSource:a,source:l,metaManager:h,firstRun:c}=o,u=iw(a),d=i.getSettings();Array.isArray(d.dataSchema)?i.dataType="array":iv(d.dataSchema)?i.dataType="function":i.dataType="object",r&&r.destroy(),t=i.runHooks(`before${u}`,t,c,l);const g=new JN(i,t,h);if(e(g),"object"==typeof t&&null!==t)t.push&&t.splice||(t=[t]);else{if(null!==t)throw new Error(`${a} only accepts array of objects or array of arrays (${typeof t} given)`);{const e=g.getSchema();t=[];let n,o=0,r=0;for(o=0,r=d.startRows;o<r;o++)if("object"!==i.dataType&&"function"!==i.dataType||!d.dataSchema)if("array"===i.dataType)n=qv(e[0]),t.push(n);else{n=[];for(let t=0,e=d.startCols;t<e;t++)n.push(null);t.push(n)}else n=qv(e),t.push(n)}}Array.isArray(t[0])&&(i.dataType="array"),d.data=t,g.dataSource=t,s.data=t,s.dataType=i.dataType,s.colToProp=g.colToProp.bind(g),s.propToCol=g.propToCol.bind(g),s.countCachedColumns=g.countCachedColumns.bind(g),n(g),i.runHooks(`after${u}`,t,c,l),c||(i.runHooks("afterChange",null,a),i.render()),i.getSettings().ariaTags&&dA(i.rootElement,[Nw(-1),Pw(i.countCols()+(i.view?i.countRowHeaders():0))])}function LP(t,e,n){return e=VP(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function VP(t){var e=WP(t,"string");return"symbol"==typeof e?e:String(e)}function WP(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}Jv(_P,YT);class FP{constructor(t){LP(this,"metaManager",void 0),LP(this,"metaSyncMemo",new Map),this.metaManager=t,t.addLocalHook("afterGetCellMeta",(t=>this.extendCellMeta(t))),aC.getSingleton().add("beforeRender",(t=>{t&&this.metaSyncMemo.clear()}),this.metaManager.hot)}extendCellMeta(t){var e;const{row:n,col:o}=t;if(null!==(e=this.metaSyncMemo.get(n))&&void 0!==e&&e.has(o))return;const{visualRow:i,visualCol:r}=t,s=this.metaManager.hot,a=s.colToProp(r);t.prop=a,s.runHooks("beforeGetCellMeta",i,r,t);const l=ay(t,"type")?t.type:null;let h=iv(t.cells)?t.cells(n,o,a):null;if(l)if(h){var c;h.type=null!==(c=h.type)&&void 0!==c?c:l}else h={type:l};h&&this.metaManager.updateCellMeta(n,o,h),s.runHooks("afterGetCellMeta",i,r,t),this.metaSyncMemo.has(n)||this.metaSyncMemo.set(n,new Set),this.metaSyncMemo.get(n).add(o)}}function jP(t,e,n){return e=UP(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function UP(t){var e=YP(t,"string");return"symbol"==typeof e?e:String(e)}function YP(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class zP{constructor(t){jP(this,"metaManager",void 0),jP(this,"usageTracker",new Set),jP(this,"propDescriptors",new Map([["ariaTags",{onChange(t,e,n){if(!n)throw new Error(`The \`${t}\` option can not be updated after the Handsontable instance was initialized.`)}}],["fixedColumnsLeft",{target:"fixedColumnsStart",onChange(t){if(this.metaManager.hot.isRtl()&&"fixedColumnsLeft"===t)throw new Error("The `fixedColumnsLeft` is not supported for RTL. Please use option `fixedColumnsStart`.");if(this.usageTracker.has("fixedColumnsLeft")&&this.usageTracker.has("fixedColumnsStart"))throw new Error("The `fixedColumnsLeft` and `fixedColumnsStart` should not be used together. Please use only the option `fixedColumnsStart`.")}}],["layoutDirection",{onChange(t,e,n){if(!n)throw new Error(`The \`${t}\` option can not be updated after the Handsontable is initialized.`)}}]])),this.metaManager=t,this.extendMetaProps()}extendMetaProps(){this.propDescriptors.forEach(((t,e)=>{const{target:n,onChange:o=(()=>{})}=t,i="string"==typeof n,r=i?n:e,s=`_${r}`;this.metaManager.globalMeta.meta[s]=this.metaManager.globalMeta.meta[r],this.installPropWatcher(e,s,o),i&&this.installPropWatcher(n,s,o)}))}installPropWatcher(t,e,n){const o=this;Object.defineProperty(this.metaManager.globalMeta.meta,t,{get(){return this[e]},set(i){const r=!o.usageTracker.has(t);o.usageTracker.add(t),n.call(o,t,i,r),this[e]=i},enumerable:!0,configurable:!0})}}const GP="gridDefault",QP="editorManager.handlingEditor",KP={name:"editorCloseAndSave",callback(t,e,n){const o=t._getEditorManager();o.closeEditorAndSaveChanges(e.ctrlKey||e.metaKey),o.moveSelectionAfterEnter(n.includes("shift"))}},XP={name:"editorCloseWithoutSaving",callback(t){const e=t._getEditorManager();e.closeEditorAndRestoreOriginalValue(t.getShortcutManager().isCtrlPressed()),e.activeEditor.focus()}},qP={name:"editorFastOpen",callback(t,e){const{highlight:n}=t.getSelectedRangeLast();n.isHeader()||t._getEditorManager().openEditor(null,e,!0)}},ZP={name:"editorOpen",callback(t,e,n){const o=t._getEditorManager(),{highlight:i}=t.getSelectedRangeLast();i.isHeader()||(t.getSettings().enterBeginsEditing?o.cellProperties.readOnly?o.moveSelectionAfterEnter():o.openEditor(null,e,!0):o.moveSelectionAfterEnter(n.includes("shift")),Uy(e))}};function JP(){return[KP,XP,qP,ZP]}const $P={name:"extendCellsSelectionDown",callback(t){const{highlight:e}=t.getSelectedRangeLast();(e.isCell()||e.isHeader()&&t.selection.isSelectedByRowHeader())&&t.selection.transformEnd(1,0)}},t_={name:"extendCellsSelectionDownByViewportHeight",callback(t){const{to:e}=t.getSelectedRangeLast(),n=Math.min(e.row+t.countVisibleRows(),t.countRows()-1),o=t.rowIndexMapper.getNearestNotHiddenIndex(n,-1);if(null!==o){const n=t._createCellCoords(o,e.col),i=e.row-t.view.getFirstFullyVisibleRow(),r=Math.min(n.row-i,t.countRows()-1);t.selection.setRangeEnd(n),t.scrollViewportTo({row:r,verticalSnap:"top",horizontalSnap:"start"})}}},e_={name:"extendCellsSelectionLeft",callback(t){const{highlight:e}=t.getSelectedRangeLast();(e.isCell()||e.isHeader()&&t.selection.isSelectedByColumnHeader())&&t.selection.transformEnd(0,-1*t.getDirectionFactor())}},n_={name:"extendCellsSelectionRight",callback(t){const{highlight:e}=t.getSelectedRangeLast();(e.isCell()||e.isHeader()&&t.selection.isSelectedByColumnHeader())&&t.selection.transformEnd(0,t.getDirectionFactor())}},o_={name:"extendCellsSelectionToColumns",callback(t){const{highlight:e,from:n,to:o}=t.getSelectedRangeLast();t.selection.isSelectedByRowHeader()?t.selection.selectAll(!0,!0):t.selectColumns(n.col,o.col,e.row)}},i_={name:"extendCellsSelectionToMostBottom",callback(t){const{selection:e,rowIndexMapper:n}=t,{highlight:o,from:i,to:r}=t.getSelectedRangeLast(),s=o.isHeader()&&t.selection.isSelectedByRowHeader();if(o.isCell()||s){const o=n.getNearestNotHiddenIndex(t.countRows()-1,-1);e.setRangeStart(i.clone()),s&&e.selectedByRowHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(o,r.col))}}},r_={name:"extendCellsSelectionToMostInlineEnd",callback(t){const{selection:e,columnIndexMapper:n}=t,{highlight:o}=t.getSelectedRangeLast();o.isCell()&&e.setRangeEnd(t._createCellCoords(e.selectedRange.current().from.row,n.getNearestNotHiddenIndex(t.countCols()-1,-1)))}},s_={name:"extendCellsSelectionToMostInlineStart",callback(t){const{selection:e,columnIndexMapper:n}=t,{highlight:o}=t.getSelectedRangeLast();o.isCell()&&e.setRangeEnd(t._createCellCoords(e.selectedRange.current().from.row,n.getNearestNotHiddenIndex(0,1)))}},a_={name:"extendCellsSelectionToMostLeft",callback(t){const{selection:e,columnIndexMapper:n}=t,{highlight:o,from:i,to:r}=t.getSelectedRangeLast(),s=o.isHeader()&&t.selection.isSelectedByColumnHeader();if(o.isCell()||s){const o=n.getNearestNotHiddenIndex(...t.isRtl()?[t.countCols()-1,-1]:[0,1]);e.setRangeStart(i.clone()),s&&e.selectedByColumnHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(r.row,o))}}},l_={name:"extendCellsSelectionToMostRight",callback(t){const{selection:e,columnIndexMapper:n}=t,{highlight:o,from:i,to:r}=t.getSelectedRangeLast(),s=o.isHeader()&&t.selection.isSelectedByColumnHeader();if(o.isCell()||s){const o=n.getNearestNotHiddenIndex(...t.isRtl()?[0,1]:[t.countCols()-1,-1]);e.setRangeStart(i.clone()),s&&e.selectedByColumnHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(r.row,o))}}},h_={name:"extendCellsSelectionToMostTop",callback(t){const{selection:e,rowIndexMapper:n}=t,{highlight:o,from:i,to:r}=t.getSelectedRangeLast(),s=o.isHeader()&&t.selection.isSelectedByRowHeader();if(o.isCell()||s){const o=n.getNearestNotHiddenIndex(0,1);e.setRangeStart(i.clone()),s&&e.selectedByRowHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(o,r.col))}}},c_={name:"extendCellsSelectionToRows",callback(t){const{highlight:e,from:n,to:o}=t.getSelectedRangeLast();t.selection.isSelectedByColumnHeader()?t.selection.selectAll(!0,!0):t.selectRows(n.row,o.row,e.col)}},u_={name:"extendCellsSelectionUp",callback(t){const{highlight:e}=t.getSelectedRangeLast();(e.isCell()||e.isHeader()&&t.selection.isSelectedByRowHeader())&&t.selection.transformEnd(-1,0)}},d_={name:"extendCellsSelectionUpByViewportHeight",callback(t){const{to:e}=t.getSelectedRangeLast(),n=Math.max(e.row-t.countVisibleRows(),0),o=t.rowIndexMapper.getNearestNotHiddenIndex(n,1);if(null!==o){const n=t._createCellCoords(o,e.col),i=e.row-t.view.getFirstFullyVisibleRow(),r=Math.max(n.row-i,0);t.selection.setRangeEnd(n),t.scrollViewportTo({row:r,verticalSnap:"top",horizontalSnap:"start"})}}};function g_(){return[$P,t_,e_,n_,o_,i_,r_,s_,a_,l_,h_,c_,u_,d_]}const f_={name:"moveCellSelectionDown",callback(t){let{selection:e}=t;e.transformStart(1,0)}},m_={name:"moveCellSelectionDownByViewportHeight",callback(t){const{navigableHeaders:e}=t.getSettings(),n=e?t.countColHeaders():0,{row:o}=t.getSelectedRangeLast().highlight;let i=t.countVisibleRows()+n;o===t.countRows()-1?i=1:o+i>t.countRows()&&(i=t.countRows()-o-1),t.selection.transformStart(i,0),t.getSelectedRangeLast().highlight.row<0&&t.scrollViewportTo({row:0})}},p_={name:"moveCellSelectionInlineEnd",callback(t,e){const n=t.getSettings(),o="function"==typeof n.tabMoves?n.tabMoves(e):n.tabMoves;t.selection.transformStart(-o.row,-o.col)}},w_={name:"moveCellSelectionInlineStart",callback(t,e){const n=t.getSettings(),o="function"==typeof n.tabMoves?n.tabMoves(e):n.tabMoves;t.selection.transformStart(o.row,o.col)}},A_={name:"moveCellSelectionLeft",callback(t){t.selection.transformStart(0,-1*t.getDirectionFactor())}},v_={name:"moveCellSelectionRight",callback(t){t.selection.transformStart(0,t.getDirectionFactor())}},y_={name:"moveCellSelectionToMostBottom",callback(t){const{col:e}=t.getSelectedRangeLast().highlight;let n=t.rowIndexMapper.getNearestNotHiddenIndex(t.countRows()-1,-1);null===n&&(n=-1),t.selection.setRangeStart(t._createCellCoords(n,e))}},C_={name:"moveCellSelectionToMostBottomInlineEnd",callback(t){const{selection:e,rowIndexMapper:n,columnIndexMapper:o}=t,i=parseInt(t.getSettings().fixedRowsBottom,10),r=n.getNearestNotHiddenIndex(t.countRows()-i-1,-1),s=o.getNearestNotHiddenIndex(t.countCols()-1,-1);e.setRangeStart(t._createCellCoords(r,s))}},b_={name:"moveCellSelectionToMostInlineEnd",callback(t){const{selection:e,columnIndexMapper:n}=t;e.setRangeStart(t._createCellCoords(t.getSelectedRangeLast().highlight.row,n.getNearestNotHiddenIndex(t.countCols()-1,-1)))}},S_={name:"moveCellSelectionToMostInlineStart",callback(t){const{selection:e,columnIndexMapper:n}=t,o=parseInt(t.getSettings().fixedColumnsStart,10),i=t.getSelectedRangeLast().highlight.row,r=n.getNearestNotHiddenIndex(o,1);e.setRangeStart(t._createCellCoords(i,r))}},E_={name:"moveCellSelectionToMostLeft",callback(t){const{selection:e,columnIndexMapper:n}=t,o=t.getSelectedRangeLast().highlight.row;let i=n.getNearestNotHiddenIndex(...t.isRtl()?[t.countCols()-1,-1]:[0,1]);null===i&&(i=t.isRtl()?-1:-t.countRowHeaders()),e.setRangeStart(t._createCellCoords(o,i))}},R_={name:"moveCellSelectionToMostRight",callback(t){const{selection:e,columnIndexMapper:n}=t,{row:o}=t.getSelectedRangeLast().highlight;let i=n.getNearestNotHiddenIndex(...t.isRtl()?[0,1]:[t.countCols()-1,-1]);null===i&&(i=t.isRtl()?-t.countRowHeaders():-1),e.setRangeStart(t._createCellCoords(o,i))}},M_={name:"moveCellSelectionToMostTop",callback(t){const{col:e}=t.getSelectedRangeLast().highlight;let n=t.rowIndexMapper.getNearestNotHiddenIndex(0,1);null===n&&(n=-t.countColHeaders()),t.selection.setRangeStart(t._createCellCoords(n,e))}},T_={name:"moveCellSelectionToMostTopInlineStart",callback(t){const{selection:e,rowIndexMapper:n,columnIndexMapper:o}=t,i=parseInt(t.getSettings().fixedRowsTop,10),r=parseInt(t.getSettings().fixedColumnsStart,10),s=n.getNearestNotHiddenIndex(i,1),a=o.getNearestNotHiddenIndex(r,1);e.setRangeStart(t._createCellCoords(s,a))}},k_={name:"moveCellSelectionUp",callback(t){let{selection:e}=t;e.transformStart(-1,0)}},x_={name:"moveCellSelectionUpByViewportHight",callback(t){const{navigableHeaders:e}=t.getSettings(),n=e?t.countColHeaders():0,{row:o}=t.getSelectedRangeLast().highlight;let i=-(t.countVisibleRows()+n);o===-n?i=-1:o+i<n&&(i=-(o+n)),t.selection.transformStart(i,0),t.getSelectedRangeLast().highlight.row<0&&t.scrollViewportTo({row:0})}};function I_(){return[f_,m_,p_,w_,A_,v_,y_,C_,b_,S_,E_,R_,M_,T_,k_,x_]}const O_={name:"emptySelectedCells",callback(t){t.emptySelectedCells(),t._getEditorManager().prepareEditor()}},H_={name:"scrollToFocusedCell",callback(t){const{highlight:e}=t.getSelectedRangeLast(),n=t.view.getFirstFullyVisibleRow()-1,o=t.view.getFirstFullyVisibleColumn()-1,i=t.view.getLastFullyVisibleRow()+1,r=t.view.getLastFullyVisibleColumn()+1,s=t._createCellCoords(n,o),a=t._createCellCoords(i,r);if(!t._createCellRange(s,s,a).includes(e)&&(e.row>=0||e.col>=0)){const n={};if(e.col>=0){const o=Math.floor(t.countVisibleCols()/2);n.col=Math.max(e.col-o,0)}if(e.row>=0){const o=Math.floor(t.countVisibleRows()/2);n.row=Math.max(e.row-o,0)}t.scrollViewportTo(w(p({},n),{verticalSnap:"top",horizontalSnap:"start"}))}}},D_={name:"selectAllCells",callback(t){t.selection.selectAll(!0,!0,{disableHeadersHighlight:!0})}},N_={name:"selectAllCellsAndHeaders",callback(t){t.selection.selectAll(!0,!0,{disableHeadersHighlight:!1})}},P_={name:"populateSelectedCellsData",callback(t){const e=t.getSelectedRange(),{row:n,col:o}=e[e.length-1].highlight.normalize(),i=t.getDataAtCell(n,o),r=new Map;for(let s=0;s<e.length;s++)e[s].forAll(((e,s)=>{if(e>=0&&s>=0&&(e!==n||s!==o)){const{readOnly:n}=t.getCellMeta(e,s);n||r.set(`${e}x${s}`,[e,s,i])}}));t.setDataAtCell(Array.from(r.values()))}},__=[...JP(),...g_(),...I_(),O_,H_,D_,N_,P_];function B_(t){const e={};return __.forEach((n=>{let{name:o,callback:i}=n;e[o]=function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return i(t,...n)}})),e}function L_(t){const e=t.getShortcutManager().addContext("editor"),n=B_(t),o={group:QP};e.addShortcuts([{keys:[["Enter"],["Enter","Shift"]],callback:(t,e)=>n.editorCloseAndSave(t,e)},{keys:[["Enter","Control/Meta"],["Enter","Control/Meta","Shift"]],captureCtrl:!0,callback:(t,e)=>n.editorCloseAndSave(t,e)},{keys:[["Escape"],["Escape","Control/Meta"]],callback:()=>n.editorCloseWithoutSaving()}],o)}function V_(t){const e=t.getShortcutManager().addContext("grid"),n=B_(t),o={runOnlyIf:()=>{const{navigableHeaders:e}=t.getSettings();return Wp(t.getSelected())&&(e||!e&&t.countRenderedRows()>0&&t.countRenderedCols()>0)},group:GP};e.addShortcuts([{keys:[["F2"]],callback:t=>n.editorFastOpen(t)},{keys:[["Enter"],["Enter","Shift"]],callback:(t,e)=>n.editorOpen(t,e)},{keys:[["Backspace"],["Delete"]],callback:()=>n.emptySelectedCells()}],{group:QP,runOnlyIf:()=>Wp(t.getSelected())}),e.addShortcuts([{keys:[["Control/Meta","A"]],callback:()=>n.selectAllCells()},{keys:[["Control/Meta","Shift","Space"]],callback:()=>n.selectAllCellsAndHeaders()},{keys:[["Control/Meta","Enter"]],callback:()=>n.populateSelectedCellsData(),runOnlyIf:()=>!t.getSelectedRangeLast().highlight.isHeader()&&t.getSelectedRangeLast().getCellsCount()>1},{keys:[["Control","Space"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToColumns()},{keys:[["Shift","Space"]],stopPropagation:!0,callback:()=>n.extendCellsSelectionToRows()},{keys:[["ArrowUp"]],callback:()=>n.moveCellSelectionUp()},{keys:[["ArrowUp","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostTop()},{keys:[["ArrowUp","Shift"]],callback:()=>n.extendCellsSelectionUp()},{keys:[["ArrowUp","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostTop(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByColumnHeader())},{keys:[["ArrowDown"]],callback:()=>n.moveCellSelectionDown()},{keys:[["ArrowDown","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostBottom()},{keys:[["ArrowDown","Shift"]],callback:()=>n.extendCellsSelectionDown()},{keys:[["ArrowDown","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostBottom(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByColumnHeader())},{keys:[["ArrowLeft"]],callback:()=>n.moveCellSelectionLeft()},{keys:[["ArrowLeft","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostLeft()},{keys:[["ArrowLeft","Shift"]],callback:()=>n.extendCellsSelectionLeft()},{keys:[["ArrowLeft","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostLeft(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByRowHeader())},{keys:[["ArrowRight"]],callback:()=>n.moveCellSelectionRight()},{keys:[["ArrowRight","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostRight()},{keys:[["ArrowRight","Shift"]],callback:()=>n.extendCellsSelectionRight()},{keys:[["ArrowRight","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostRight(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByRowHeader())},{keys:[["Home"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostInlineStart(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["Home","Shift"]],callback:()=>n.extendCellsSelectionToMostInlineStart()},{keys:[["Home","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostTopInlineStart(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostInlineEnd(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End","Shift"]],callback:()=>n.extendCellsSelectionToMostInlineEnd()},{keys:[["End","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostBottomInlineEnd(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["PageUp"]],callback:()=>n.moveCellSelectionUpByViewportHight()},{keys:[["PageUp","Shift"]],callback:()=>n.extendCellsSelectionUpByViewportHeight()},{keys:[["PageDown"]],callback:()=>n.moveCellSelectionDownByViewportHeight()},{keys:[["PageDown","Shift"]],callback:()=>n.extendCellsSelectionDownByViewportHeight()},{keys:[["Tab"]],preventDefault:!1,callback:()=>n.moveCellSelectionInlineStart()},{keys:[["Shift","Tab"]],preventDefault:!1,callback:()=>n.moveCellSelectionInlineEnd()},{keys:[["Control/Meta","Backspace"]],callback:()=>n.scrollToFocusedCell()}],o)}function W_(t){[L_,V_].forEach((e=>e(t)))}function F_(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=t.rootElement,o=j_(t),i=j_(t);return o.addEventListener("focus",(()=>null==e?void 0:e.onFocusFromTop())),i.addEventListener("focus",(()=>null==e?void 0:e.onFocusFromBottom())),n.firstChild.before(o),n.lastChild.after(i),{activate(){t._registerTimeout((()=>{o.tabIndex=0,i.tabIndex=0}),10)},deactivate(){t._registerTimeout((()=>{o.tabIndex=-1,i.tabIndex=-1}),10)}}}function j_(t){const e=t.rootDocument.createElement("input");return e.type="text",e.classList.add("htFocusCatcher"),t.getSettings().ariaTags&&dA(e,[fw(),Iw()]),e}function U_(t){const e=G_(t);let n;const{activate:o,deactivate:i}=F_(t,{onFocusFromTop(){var o;const i=null!==(o=e(n))&&void 0!==o?o:Y_(t);i&&(t.runHooks("modifyFocusOnTabNavigation","from_above",i),t.selectCell(i.row,i.col)),t.listen()},onFocusFromBottom(){var o;const i=null!==(o=e(n))&&void 0!==o?o:z_(t);i&&(t.runHooks("modifyFocusOnTabNavigation","from_below",i),t.selectCell(i.row,i.col)),t.listen()}}),r={wrapped:!1,flipped:!1};let s=!0,a=!1,l=!1;function h(){r.wrapped=!1,r.flipped=!1,t.deselectCell(),t.unlisten()}t.addHook("afterListen",(()=>i())),t.addHook("afterUnlisten",(()=>o())),t.addHook("afterSelection",((e,o,i,h,c)=>{var u;(a&&(r.wrapped&&r.flipped||l)&&(l=!1,c.value=!0),s)&&(n=null===(u=t.getSelectedRangeLast())||void 0===u?void 0:u.highlight)})),t.addHook("beforeRowWrap",((t,e,n)=>{r.wrapped=!0,r.flipped=n}));const c={keys:[["Tab"],["Shift","Tab"]],preventDefault:!1,stopPropagation:!1,relativeToGroup:GP,group:"focusCatcher"};t.getShortcutManager().getContext("grid").addShortcuts([w(p({},c),{callback:()=>{const{tabNavigation:e}=t.getSettings();a=!0,t.getSelectedRangeLast()&&!e&&(s=!1),e||(l=!0)},position:"before"}),w(p({},c),{callback:e=>{const{tabNavigation:o,autoWrapRow:i}=t.getSettings();if(a=!1,s=!0,!o||!t.selection.isSelected()||i&&r.wrapped&&r.flipped||!i&&r.wrapped)return i&&r.wrapped&&r.flipped&&(n=e.shiftKey?Y_(t):z_(t)),h(),!1;e.preventDefault()},position:"after"})])}function Y_(t){const{rowIndexMapper:e,columnIndexMapper:n}=t,{navigableHeaders:o}=t.getSettings();let i=o&&t.countColHeaders()>0?-t.countColHeaders():0,r=o&&t.countRowHeaders()>0?-t.countRowHeaders():0;return 0===i&&(i=e.getVisualFromRenderableIndex(i)),0===r&&(r=n.getVisualFromRenderableIndex(r)),null===i||null===r?null:t._createCellCoords(i,r)}function z_(t){var e,n;const{rowIndexMapper:o,columnIndexMapper:i}=t,{navigableHeaders:r}=t.getSettings();let s=o.getRenderableIndexesLength()-1,a=i.getRenderableIndexesLength()-1;if(s<0){if(!r||0===t.countColHeaders())return null;s=-1}if(a<0){if(!r||0===t.countColHeaders())return null;a=-1}return t._createCellCoords(null!==(e=o.getVisualFromRenderableIndex(s))&&void 0!==e?e:s,null!==(n=i.getVisualFromRenderableIndex(a))&&void 0!==n?n:a)}function G_(t){return e=>{if(!e)return null;const n=Y_(t),o=z_(t);return e.col<n.col&&(e.col=n.col),e.col>o.col&&(e.col=o.col),e.row<n.row&&(e.row=n.row),e.row>o.row&&(e.row=o.row),e}}const Q_=new Map([[" ","space"],["spacebar","space"],["scroll","scrolllock"],["del","delete"],["esc","escape"],["medianexttrack","mediatracknext"],["mediaprevioustrack","mediatrackprevious"],["volumeup","audiovolumeup"],["volumedown","audiovolumedown"],["volumemute","audiovolumemute"],["multiply","*"],["add","+"],["divide","/"],["subtract","-"],["left","arrowleft"],["right","arrowright"],["up","arrowup"],["down","arrowdown"]]),K_=t=>t.map((t=>{const e=t.toLowerCase();return Q_.has(e)?Q_.get(e):e})).sort().join("+"),X_=t=>t.split("+"),q_=new RegExp("^(?:Key|Digit)([A-Z0-9])$"),Z_=new Set(["Backquote","Minus","Equal","BracketLeft","BracketRight","Backslash","Semicolon","Quote","Comma","Period","Slash"]),J_=t=>{let{key:e,code:n}=t,o=e;return q_.test(n)?o=n.replace(q_,"$1"):Z_.has(n)&&(o=n),o.toLowerCase()},$_=Symbol("shortcut-context");function tB(t){return ty(t)&&t.__kindOf===$_}const eB=t=>{const e=Db({errorIdExists:e=>`The "${e}" shortcut is already registered in the "${t}" context.`}),n=function(){let{keys:t,callback:n,group:o,runOnlyIf:i=(()=>!0),captureCtrl:r=!1,preventDefault:s=!0,stopPropagation:a=!1,relativeToGroup:l,position:h,forwardToContext:c}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(Fp(o))throw new Error("You need to define the shortcut's group.");if(!1===iv(n))throw new Error("The shortcut's callback needs to be a function.");if(!1===Array.isArray(t))throw new Error(Lp`Pass the shortcut\'s keys as an array of arrays,\x20
      using the KeyboardEvent.key properties:\x20
      https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key/Key_Values.`);const u={callback:n,group:o,runOnlyIf:i,captureCtrl:r,preventDefault:s,stopPropagation:a};Wp(l)&&([u.relativeToGroup,u.position]=[l,h]),tB(c)&&(u.forwardToContext=c),t.forEach((t=>{const n=K_(t);if(e.hasItem(n)){const t=e.getItem(n);let o=t.findIndex((t=>t.group===l));-1!==o?"before"===h?o-=1:o+=1:o=t.length,t.splice(o,0,u)}else e.addItem(n,[u])}))},o=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};t.forEach((t=>{ny(e,((n,o)=>{!1===Object.prototype.hasOwnProperty.call(t,o)&&(t[o]=e[o])})),n(t)}))},i=t=>{const n=K_(t);e.removeItem(n)};return{__kindOf:$_,addShortcut:n,addShortcuts:o,getShortcuts:t=>{const n=K_(t),o=e.getItem(n);return Wp(o)?o.slice():[]},hasShortcut:t=>{const n=K_(t);return e.hasItem(n)},removeShortcutsByKeys:i,removeShortcutsByGroup:t=>{e.getItems().forEach((e=>{let[n,o]=e;const r=o.filter((e=>e.group!==t));0===r.length?i(X_(n)):(o.length=0,o.push(...r))}))}}};function nB(){const t=new Set;return{press(e){t.add(e)},release(e){t.delete(e)},releaseAll(){t.clear()},isPressed(e){return t.has(e)}}}const oB=["meta","alt","shift","control"],iB=nB();let rB=0;function sB(t,e,n,o,i){const r=t=>oB.includes(t),s=function(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=[];return t.altKey&&n.push("alt"),e&&(t.ctrlKey||t.metaKey)?n.push("control/meta"):(t.ctrlKey&&n.push("control"),t.metaKey&&n.push("meta")),t.shiftKey&&n.push("shift"),n},a=t=>{if(!1===e(t))return;const a=n(t);if(229===t.keyCode||!1===a||Yy(t))return;const l=J_(t);let h=[];r(l)||(h=s(t));const c=[l].concat(h);!i(t,c)&&(Hy()&&h.includes("meta")||!Hy()&&h.includes("control"))&&i(t,[l].concat(s(t,!0))),o(t)},l=t=>{const e=J_(t);r(e)&&iB.press(e)},h=t=>{const e=J_(t);r(e)&&iB.release(e)},c=()=>{iB.releaseAll()};return{mount:()=>{let e=t;for(rB+=1;e;)1===rB&&(e.document.documentElement.addEventListener("keydown",l),e.document.documentElement.addEventListener("keyup",h)),e.document.documentElement.addEventListener("keydown",a),e.document.documentElement.addEventListener("blur",c),e=tA(e)},unmount:()=>{let e=t;for(rB-=1;e;)0===rB&&(e.document.documentElement.removeEventListener("keydown",l),e.document.documentElement.removeEventListener("keyup",h)),e.document.documentElement.removeEventListener("keydown",a),e.document.documentElement.removeEventListener("blur",c),e=tA(e)},isPressed:t=>iB.isPressed(t),releasePressedKeys:()=>iB.releaseAll()}}const aB=t=>{let{ownerWindow:e,handleEvent:n,beforeKeyDown:o,afterKeyDown:i}=t;const r=Db({errorIdExists:t=>`The "${t}" context name is already registered.`});let s="grid";const a=t=>{const e=eB(t);return r.addItem(t,e),e},l=()=>s,h=t=>r.getItem(t),c=t=>{if(!r.hasItem(t))throw new Error(Lp`You've tried to activate the "${t}" shortcut context\x20
        that does not exist. Before activation, register the context using the "addContext" method.`);s=t};let u=!1;const d=function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:l();const o=tB(n)?n:h(n);let i=!1;if(!o.hasShortcut(e))return i;const r=o.getShortcuts(e);for(let s=0;s<r.length;s++){const{callback:n,runOnlyIf:o,preventDefault:a,stopPropagation:l,captureCtrl:h,forwardToContext:c}=r[s];if(!0===o(t)){if(u=h,i=!1===n(t,e),u=!1,a&&t.preventDefault(),l&&(Uy(t),t.stopPropagation()),i)break;c&&d(t,e,c)}}return i},g=sB(e,n,o,i,d);return g.mount(),{addContext:a,getActiveContextName:l,getContext:h,setActiveContextName:c,isCtrlPressed:()=>!u&&(g.isPressed("control")||g.isPressed("meta")),releasePressedKeys:()=>g.releasePressedKeys(),destroy:()=>g.unmount()}};let lB=null;const hB=new Map;function cB(t,e){var n,o=this;let i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=!1,s=this;const a=new MC(s);let l,h,c,u,d,g=!0;Cx(i)&&yx(this),this.rootElement=t,this.rootDocument=t.ownerDocument,this.rootWindow=this.rootDocument.defaultView,this.isDestroyed=!1,this.renderSuspendedCounter=0,this.executionSuspendedCounter=0;const f=null!==(n=null==e?void 0:e.layoutDirection)&&void 0!==n?n:"inherit",m=["rtl","ltr"].includes(f)?f:this.rootWindow.getComputedStyle(this.rootElement).direction;this.rootElement.setAttribute("dir",m),this.isRtl=function(){return"rtl"===m},this.isLtr=function(){return!s.isRtl()},this.getDirectionFactor=function(){return s.isLtr()?1:-1},e.language=pD(e.language);const p=new _P(s,e,[FP,zP]),w=p.getTableMeta(),A=p.getGlobalMeta(),v=Db();this.container=this.rootDocument.createElement("div"),this.renderCall=!1,t.insertBefore(this.container,t.firstChild),bx(this)&&ew(e.licenseKey,t),this.guid=`ht_${sw()}`,hB.set(this.guid,this),this.columnIndexMapper=new mO,this.rowIndexMapper=new mO,this.columnIndexMapper.addLocalHook("indexesSequenceChange",(t=>{s.runHooks("afterColumnSequenceChange",t)})),this.rowIndexMapper.addLocalHook("indexesSequenceChange",(t=>{s.runHooks("afterRowSequenceChange",t)})),h=new cI(s),(!this.rootElement.id||"ht_"===this.rootElement.id.substring(0,3))&&(this.rootElement.id=this.guid);const y=t=>{const{row:e,col:n}=t;return s._createCellCoords(e>=0?s.rowIndexMapper.getRenderableFromVisualIndex(e):e,n>=0?s.columnIndexMapper.getRenderableFromVisualIndex(n):n)},C=t=>{const{row:e,col:n}=t;return s._createCellCoords(e>=0?s.rowIndexMapper.getVisualFromRenderableIndex(e):e,n>=0?s.columnIndexMapper.getVisualFromRenderableIndex(n):n)};let b=new jN(w,{rowIndexMapper:s.rowIndexMapper,columnIndexMapper:s.columnIndexMapper,countCols:()=>s.countCols(),countRows:()=>s.countRows(),propToCol:t=>l.propToCol(t),isEditorOpened:()=>!!s.getActiveEditor()&&s.getActiveEditor().isOpened(),countRenderableColumns:()=>this.view.countRenderableColumns(),countRenderableRows:()=>this.view.countRenderableRows(),countRowHeaders:()=>this.countRowHeaders(),countColHeaders:()=>this.countColHeaders(),getShortcutManager:()=>s.getShortcutManager(),createCellCoords:(t,e)=>s._createCellCoords(t,e),createCellRange:(t,e,n)=>s._createCellRange(t,e,n),visualToRenderableCoords:y,renderableToVisualCoords:C,isDisabledCellSelection:(t,e)=>t<0||e<0?s.getSettings().disableVisualSelection:s.getCellMeta(t,e).disableVisualSelection});this.selection=b;const S=t=>{let{hiddenIndexesChanged:e}=t;e&&this.selection.refresh()};function E(t){const e=wO(t);dD(e)?(s.runHooks("beforeLanguageChange",e),A.language=e,s.runHooks("afterLanguageChange",e)):AO(t)}function R(t,e){const n="className"===t?s.rootElement:s.table;if(g)cA(n,e);else{let o=[],i=[];A[t]&&(o=Array.isArray(A[t])?A[t]:_p(A[t])),e&&(i=Array.isArray(e)?e:_p(e));const r=Dp(o,i),s=Dp(i,o);r.length&&uA(n,r),s.length&&cA(n,s)}A[t]=e}function M(){let t=!1;return{validatorsInQueue:0,valid:!0,addValidatorToQueue(){this.validatorsInQueue+=1,t=!1},removeValidatorFormQueue(){this.validatorsInQueue=this.validatorsInQueue-1<0?0:this.validatorsInQueue-1,this.checkIfQueueIsEmpty()},onQueueEmpty(){},checkIfQueueIsEmpty(){0===this.validatorsInQueue&&!1===t&&(t=!0,this.onQueueEmpty(this.valid))}}}function T(t){const e=t.replace(",",".");return!1===isNaN(parseFloat(e))?parseFloat(e):t}function k(t,e,n){if(!t.length)return;const o=s.getActiveEditor(),i=new M;let r=!0;i.onQueueEmpty=t=>{o&&r&&o.cancelChanges(),n(t)};for(let a=t.length-1;a>=0;a--){const[n,o,,h]=t[a],c=l.propToCol(o),u=s.getCellMeta(n,c);"numeric"===u.type&&"string"==typeof h&&yb(h)&&(t[a][3]=T(h)),s.getCellValidator(u)&&(i.addValidatorToQueue(),s.validateCell(t[a][3],u,function(e,n){return function(o){if("boolean"!=typeof o)throw new Error("Validation error: result is not boolean");if(!1===o&&!1===n.allowInvalid){r=!1,t.splice(e,1),n.valid=!0;const o=s.getCell(n.visualRow,n.visualCol);null!==o&&uA(o,w.invalidCellClassName)}i.removeValidatorFormQueue()}}(a,u),e))}i.checkIfQueueIsEmpty()}function x(t,e){let n=t.length-1;if(n<0)return;for(;n>=0;n--){let o=!1;if(null!==t[n]){if(null!==t[n][2]&&void 0!==t[n][2]||null!==t[n][3]&&void 0!==t[n][3]){if(w.allowInsertRow)for(;t[n][0]>s.countRows()-1;){const{delta:t}=l.createRow(void 0,void 0,{source:e});if(0===t){o=!0;break}}if("array"===s.dataType&&(!w.columns||0===w.columns.length)&&w.allowInsertColumn)for(;l.propToCol(t[n][1])>s.countCols()-1;){const{delta:t}=l.createCol(void 0,void 0,{source:e});if(0===t){o=!0;break}}o||l.set(t[n][0],t[n][1],t[n][3])}}else t.splice(n,1)}s.forceFullRender=!0,c.adjustRowsAndCols(),s.runHooks("beforeChangeRender",t,e),u.lockEditor(),s._refreshBorders(null),u.unlockEditor(),s.view.adjustElementsSize(),s.runHooks("afterChange",t,e||"edit");const o=s.getActiveEditor();o&&Wp(o.refreshValue)&&o.refreshValue()}function I(t,e,n){return Array.isArray(t)?t:[[t,e,n]]}function O(t,e){const n=s.getActiveEditor(),o=s.runHooks("beforeChange",t,e||"edit"),i=t.filter((t=>null!==t));return!1===o||0===i.length?(n&&n.cancelChanges(),[]):i}this.columnIndexMapper.addLocalHook("cacheUpdated",S),this.rowIndexMapper.addLocalHook("cacheUpdated",S),this.selection.addLocalHook("afterSetRangeEnd",(t=>{const e=sy(!1),n=this.selection.getSelectedRange(),{from:o,to:i}=n.current(),a=n.size()-1;this.runHooks("afterSelection",o.row,o.col,i.row,i.col,e,a),this.runHooks("afterSelectionByProp",o.row,s.colToProp(o.col),i.row,s.colToProp(i.col),e,a);let l=!0;r&&(l=!1),e.isTouched()&&(l=!e.value);const h=this.selection.selectedRange.current(),c=this.selection.isSelectedByAnyHeader(),u=this.selection.isSelectedByRowHeader(),d=this.selection.isSelectedByColumnHeader();if(!1!==l)if(c)u?this.scrollViewportTo({row:t.row}):d&&this.scrollViewportTo({col:t.col});else if(h&&!this.selection.isMultiple()){const{row:t,col:e}=h.from;t<0&&e>=0?this.scrollViewportTo({col:e}):e<0&&t>=0?this.scrollViewportTo({row:t}):this.scrollViewportTo({row:t,col:e})}else this.scrollViewportTo(t.toObject());u&&d?cA(this.rootElement,["ht__selection--rows","ht__selection--columns"]):u?(uA(this.rootElement,"ht__selection--columns"),cA(this.rootElement,"ht__selection--rows")):d?(uA(this.rootElement,"ht__selection--rows"),cA(this.rootElement,"ht__selection--columns")):uA(this.rootElement,["ht__selection--rows","ht__selection--columns"]),this._refreshBorders(null)})),this.selection.addLocalHook("afterSelectionFinished",(t=>{const e=t.length-1,{from:n,to:o}=t[e];this.runHooks("afterSelectionEnd",n.row,n.col,o.row,o.col,e),this.runHooks("afterSelectionEndByProp",n.row,s.colToProp(n.col),o.row,s.colToProp(o.col),e)})),this.selection.addLocalHook("afterIsMultipleSelection",(t=>{const e=this.runHooks("afterIsMultipleSelection",t.value);t.value&&(t.value=e)})),this.selection.addLocalHook("afterDeselect",(()=>{u.destroyEditor(),this._refreshBorders(),uA(this.rootElement,["ht__selection--rows","ht__selection--columns"]),this.runHooks("afterDeselect")})),this.selection.addLocalHook("beforeHighlightSet",(()=>this.runHooks("beforeSelectionHighlightSet"))).addLocalHook("beforeSetRangeStart",(function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return o.runHooks("beforeSetRangeStart",...e)})).addLocalHook("beforeSetRangeStartOnly",(function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return o.runHooks("beforeSetRangeStartOnly",...e)})).addLocalHook("beforeSetRangeEnd",(function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return o.runHooks("beforeSetRangeEnd",...e)})).addLocalHook("beforeSelectColumns",(function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return o.runHooks("beforeSelectColumns",...e)})).addLocalHook("afterSelectColumns",(function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return o.runHooks("afterSelectColumns",...e)})).addLocalHook("beforeSelectRows",(function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return o.runHooks("beforeSelectRows",...e)})).addLocalHook("afterSelectRows",(function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return o.runHooks("afterSelectRows",...e)})).addLocalHook("beforeModifyTransformStart",(function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return o.runHooks("modifyTransformStart",...e)})).addLocalHook("afterModifyTransformStart",(function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return o.runHooks("afterModifyTransformStart",...e)})).addLocalHook("beforeModifyTransformEnd",(function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return o.runHooks("modifyTransformEnd",...e)})).addLocalHook("afterModifyTransformEnd",(function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return o.runHooks("afterModifyTransformEnd",...e)})).addLocalHook("beforeRowWrap",(function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return o.runHooks("beforeRowWrap",...e)})).addLocalHook("beforeColumnWrap",(function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return o.runHooks("beforeColumnWrap",...e)})).addLocalHook("insertRowRequire",(t=>this.alter("insert_row_above",t,1,"auto"))).addLocalHook("insertColRequire",(t=>this.alter("insert_col_start",t,1,"auto"))),c={alter(t,e){var n,o;let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3?arguments[3]:void 0,a=arguments.length>4?arguments[4]:void 0;const h=t=>{if(0===t.length)return[];const e=[...t];return e.sort(((t,e)=>{let[n]=t,[o]=e;return n===o?0:n>o?1:-1})),Sp(e,((t,e)=>{let[n,o]=e;const i=t[t.length-1],[r,s]=i,a=r+s;if(n<=a){const t=Math.max(o-(a-n),0);i[1]+=t}else t.push([n,o]);return t}),[e[0]])};switch(t){case"insert_row_below":case"insert_row_above":const a=s.countSourceRows();if(w.maxRows===a)return;const u="insert_row_below"===t?"below":"above";e=null!==(n=e)&&void 0!==n?n:"below"===u?a:0;const{delta:d,startPhysicalIndex:g}=l.createRow(e,i,{source:r,mode:u});if(d){const t=b.selectedRange.current(),e=null==t?void 0:t.from,n=null==e?void 0:e.row,o=s.toVisualRow(g);if(b.isSelectedByCorner())b.selectAll(!0,!0,{disableHeadersHighlight:!0});else if(Wp(n)&&n>=o){const{row:o,col:i}=t.to;let r=e.col;b.isSelectedByRowHeader()&&(r=-1),b.getSelectedRange().pop(),b.setRangeStartOnly(s._createCellCoords(n+d,r),!0),b.setRangeEnd(s._createCellCoords(o+d,i))}else s._refreshBorders()}break;case"insert_col_start":case"insert_col_end":const f="insert_col_end"===t?"end":"start";e=null!==(o=e)&&void 0!==o?o:"end"===f?s.countSourceCols():0;const{delta:m,startPhysicalIndex:p}=l.createCol(e,i,{source:r,mode:f});if(m){if(Array.isArray(w.colHeaders)){const t=[s.toVisualColumn(p),0];t.length+=m,Array.prototype.splice.apply(w.colHeaders,t)}const t=b.selectedRange.current(),e=null==t?void 0:t.from,n=null==e?void 0:e.col,o=s.toVisualColumn(p);if(b.isSelectedByCorner())b.selectAll(!0,!0,{disableHeadersHighlight:!0});else if(Wp(n)&&n>=o){const{row:o,col:i}=t.to;let r=e.row;b.isSelectedByColumnHeader()&&(r=-1),b.getSelectedRange().pop(),b.setRangeStartOnly(s._createCellCoords(r,n+m),!0),b.setRangeEnd(s._createCellCoords(o,i+m))}else s._refreshBorders()}break;case"remove_row":const A=t=>{let e=0;Mp(t,(t=>{let[n,o]=t;const i=jp(n)?s.countRows()-1:Math.max(n-e,0);if(Number.isInteger(n)&&(n=Math.max(n-e,0)),!l.removeRow(n,o,r))return;const a=s.countRows(),h=w.fixedRowsTop;h>=i+1&&(w.fixedRowsTop-=Math.min(o,h-i));const c=w.fixedRowsBottom;c&&i>=a-c&&(w.fixedRowsBottom-=Math.min(o,c)),e+=o}))};Array.isArray(e)?A(h(e)):A([[e,i]]),c.adjustRowsAndCols(),s._refreshBorders();break;case"remove_col":const v=t=>{let e=0;Mp(t,(t=>{let[n,o]=t;const i=jp(n)?s.countCols()-1:Math.max(n-e,0);let a=s.toPhysicalColumn(i);if(Number.isInteger(n)&&(n=Math.max(n-e,0)),!l.removeCol(n,o,r))return;const h=w.fixedColumnsStart;h>=i+1&&(w.fixedColumnsStart-=Math.min(o,h-i)),Array.isArray(w.colHeaders)&&("undefined"==typeof a&&(a=-1),w.colHeaders.splice(a,o)),e+=o}))};Array.isArray(e)?v(h(e)):v([[e,i]]),c.adjustRowsAndCols(),s._refreshBorders();break;default:throw new Error(`There is no such action "${t}"`)}a||c.adjustRowsAndCols()},adjustRowsAndCols(){const t=w.minRows,e=w.minSpareRows,n=w.minCols,o=w.minSpareCols;if(0===s.countRows()&&0===s.countCols()&&b.deselect(),t){const e=s.countRows();e<t&&l.createRow(e,t-e,{source:"auto"})}if(e){const t=s.countEmptyRows(!0);if(t<e){const n=e-t,o=Math.min(n,w.maxRows-s.countSourceRows());l.createRow(s.countRows(),o,{source:"auto"})}}{let t;(n||o)&&(t=s.countEmptyCols(!0));let e=s.countCols();if(n&&!w.columns&&e<n){const o=n-e;t+=o,l.createCol(e,o,{source:"auto"})}if(o&&!w.columns&&"array"===s.dataType&&t<o){e=s.countCols();const n=o-t,i=Math.min(n,w.maxCols-e);l.createCol(e,i,{source:"auto"})}}if(b.isSelected()){const t=s.countRows(),e=s.countCols();Mp(b.selectedRange,(n=>{let o=!1,i=n.from.row,r=n.from.col,a=n.to.row,l=n.to.col;i>t-1?(i=t-1,o=!0,a>i&&(a=i)):a>t-1&&(a=t-1,o=!0,i>a&&(i=a)),r>e-1?(r=e-1,o=!0,l>r&&(l=r)):l>e-1&&(l=e-1,o=!0,r>l&&(r=l)),o&&(r<0?s.selectRows(i,a,r):i<0?s.selectColumns(r,l,i):s.selectCell(i,r,a,l))}))}s.view&&s.view.adjustElementsSize()},populateFromArray(t,e,n,o,i){let r,a,l,h;const c=[],u={},d=[],g=t.row,f=t.col;if(a=e.length,0===a)return!1;let m=0,p=0;switch(ty(n)&&(m=n.col-f+1,p=n.row-g+1),i){case"shift_down":const i=bp(e),A=i.length,v=Math.max(A,m),y=s.getData().slice(g),C=bp(y).slice(f,f+v);for(l=0;l<v;l+=1)if(l<A){for(r=0,a=i[l].length;r<p-a;r+=1)i[l].push(i[l][r%a]);l<C.length?d.push(i[l].concat(C[l])):d.push(i[l].concat(new Array(y.length).fill(null)))}else d.push(i[l%A].concat(C[l]));s.populateFromArray(g,f,bp(d));break;case"shift_right":const b=e.length,S=Math.max(b,p),E=s.getData().slice(g).map((t=>t.slice(f)));for(r=0;r<S;r+=1)if(r<b){for(l=0,h=e[r].length;l<m-h;l+=1)e[r].push(e[r][l%h]);if(r<E.length)for(let t=0;t<E[r].length;t+=1)e[r].push(E[r][t]);else e[r].push(...new Array(E[0].length).fill(null))}else e.push(e[r%a].slice(0,S).concat(E[r]));s.populateFromArray(g,f,e);break;case"overwrite":default:u.row=t.row,u.col=t.col;let R,M=0,T=0,k=!0;const x=function(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const o=e[t%e.length];return null!==n?o[n%o.length]:o},I=e.length,O=n?n.row-t.row+1:0;for(a=n?O:Math.max(I,O),r=0;r<a&&!(n&&u.row>n.row&&O>I||!w.allowInsertRow&&u.row>s.countRows()-1||u.row>=w.maxRows);r++){const e=r-M,i=x(e).length,d=n?n.col-t.col+1:0;if(h=n?d:Math.max(i,d),u.col=t.col,R=s.getCellMeta(u.row,u.col),"CopyPaste.paste"!==o&&"Autofill.fill"!==o||!R.skipRowOnPaste){for(T=0,l=0;l<h&&!(n&&u.col>n.col&&d>i||!w.allowInsertColumn&&u.col>s.countCols()-1||u.col>=w.maxCols);l++){if(R=s.getCellMeta(u.row,u.col),("CopyPaste.paste"===o||"Autofill.fill"===o)&&R.skipColumnOnPaste){T+=1,u.col+=1,h+=1;continue}if(R.readOnly&&"UndoRedo.undo"!==o){u.col+=1;continue}const t=l-T;let n=x(e,t),i=s.getDataAtCell(u.row,u.col);if(null!==n&&"object"==typeof n)if(Array.isArray(n)&&null===i&&(i=[]),null===i||"object"!=typeof i)k=!1;else{const t=Gv(Array.isArray(i)?i:i[0]||i),e=Gv(Array.isArray(n)?n:n[0]||n);$v(t,e)||Array.isArray(t)&&Array.isArray(e)?n=qv(n):k=!1}else null!==i&&"object"==typeof i&&(k=!1);k&&c.push([u.row,u.col,n]),k=!0,u.col+=1}u.row+=1}else M+=1,u.row+=1,a+=1}s.setDataAtCell(c,null,null,o||"populateFromArray");break}}},this.init=function(){h.setData(w.data),s.runHooks("beforeInit"),(ky()||Iy())&&cA(s.rootElement,"mobile"),this.updateSettings(w,!0),this.view=new Qx(this),u=FC.getInstance(s,w,b),d=new ab(s),bx(this)&&U_(s),s.runHooks("init"),this.forceFullRender=!0,this.view.render(),g&&null===s.rootElement.offsetParent&&$A(s.rootElement,(()=>{s.view._wt.wtOverlays.updateLastSpreaderSize(),s.render(),s.view.adjustElementsSize()})),"object"==typeof g&&(s.runHooks("afterChange",g[0],g[1]),g=!1),s.runHooks("afterInit")},this._createCellCoords=function(t,e){return s.view._wt.createCellCoords(t,e)},this._createCellRange=function(t,e,n){return s.view._wt.createCellRange(t,e,n)},this.validateCell=function(t,e,n,o){let i=s.getCellValidator(e);function r(t){if(arguments.length>1&&void 0!==arguments[1]&&!arguments[1]||!0===e.hidden)return void n(t);const o=e.visualCol,i=e.visualRow,r=s.getCell(i,o,!0);if(r&&"TH"!==r.nodeName){const t=s.rowIndexMapper.getRenderableFromVisualIndex(i),e=s.columnIndexMapper.getRenderableFromVisualIndex(o);s.view._wt.getSetting("cellRenderer",t,e,r)}n(t)}Up(i)&&(i=function(t){return function(e,n){n(t.test(e))}}(i)),iv(i)?(t=s.runHooks("beforeValidate",t,e.visualRow,e.prop,o),s._registerImmediate((()=>{i.call(e,t,(n=>{s&&(n=s.runHooks("afterValidate",n,t,e.visualRow,e.prop,o),e.valid=n,r(n),s.runHooks("postAfterValidate",n,t,e.visualRow,e.prop,o))}))}))):s._registerImmediate((()=>{e.valid=!0,r(e.valid,!1)}))},this.setDataAtCell=function(t,e,n,o){const i=I(t,e,n),r=[];let a,c,u,d=o;for(a=0,c=i.length;a<c;a++){if("object"!=typeof i[a])throw new Error("Method `setDataAtCell` accepts row number or changes array of arrays as its first parameter");if("number"!=typeof i[a][1])throw new Error("Method `setDataAtCell` accepts row and column number as its parameters. If you want to use object property name, use method `setDataAtRowProp`");u=i[a][1]>=this.countCols()?i[a][1]:l.colToProp(i[a][1]),r.push([i[a][0],u,h.getAtCell(this.toPhysicalRow(i[a][0]),i[a][1]),i[a][2]])}!d&&"object"==typeof t&&(d=e);const g=O(r,o);s.runHooks("afterSetDataAtCell",g,d),k(g,d,(()=>{x(g,d)}))},this.setDataAtRowProp=function(t,e,n,o){const i=I(t,e,n),r=[];let a,l,c=o;for(a=0,l=i.length;a<l;a++)r.push([i[a][0],i[a][1],h.getAtCell(this.toPhysicalRow(i[a][0]),i[a][1]),i[a][2]]);!c&&"object"==typeof t&&(c=e);const u=O(r,o);s.runHooks("afterSetDataAtRowProp",u,c),k(u,c,(()=>{x(u,c)}))},this.listen=function(){s&&!s.isListening()&&(hB.forEach((t=>{s!==t&&t.unlisten()})),lB=s.guid,s.runHooks("afterListen"))},this.unlisten=function(){this.isListening()&&(lB=null,s.runHooks("afterUnlisten"))},this.isListening=function(){return lB===s.guid},this.destroyEditor=function(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];s._refreshBorders(t,e)},this.populateFromArray=function(t,e,n,o,i,r,a){if("object"!=typeof n||"object"!=typeof n[0])throw new Error("populateFromArray parameter `input` must be an array of arrays");const l="number"==typeof o?s._createCellCoords(o,i):null;return c.populateFromArray(s._createCellCoords(t,e),n,l,r,a)},this.spliceCol=function(t,e,n){for(var o=arguments.length,i=new Array(o>3?o-3:0),r=3;r<o;r++)i[r-3]=arguments[r];return l.spliceCol(t,e,n,...i)},this.spliceRow=function(t,e,n){for(var o=arguments.length,i=new Array(o>3?o-3:0),r=3;r<o;r++)i[r-3]=arguments[r];return l.spliceRow(t,e,n,...i)},this.getSelected=function(){if(b.isSelected())return Rp(b.getSelectedRange(),(t=>{let{from:e,to:n}=t;return[e.row,e.col,n.row,n.col]}))},this.getSelectedLast=function(){const t=this.getSelected();let e;return t&&t.length>0&&(e=t[t.length-1]),e},this.getSelectedRange=function(){if(b.isSelected())return Array.from(b.getSelectedRange())},this.getSelectedRangeLast=function(){const t=this.getSelectedRange();let e;return t&&t.length>0&&(e=t[t.length-1]),e},this.emptySelectedCells=function(t){if(!b.isSelected()||0===this.countRows()||0===this.countCols())return;const e=[];Mp(b.getSelectedRange(),(t=>{if(t.isSingleHeader())return;const n=t.getTopStartCorner(),o=t.getBottomEndCorner();Cb(n.row,o.row,(t=>{Cb(n.col,o.col,(n=>{this.getCellMeta(t,n).readOnly||e.push([t,n,null])}))}))})),e.length>0&&this.setDataAtCell(e,t)},this.isRenderSuspended=function(){return this.renderSuspendedCounter>0},this.suspendRender=function(){this.renderSuspendedCounter+=1},this.resumeRender=function(){const t=this.renderSuspendedCounter-1;this.renderSuspendedCounter=Math.max(t,0),!this.isRenderSuspended()&&t===this.renderSuspendedCounter&&(this.renderCall?this.render():this._refreshBorders(null))},this.render=function(){this.view&&(this.renderCall=!0,this.forceFullRender=!0,this.isRenderSuspended()||(u.lockEditor(),this._refreshBorders(null),u.unlockEditor()))},this.batchRender=function(t){this.suspendRender();const e=t();return this.resumeRender(),e},this.isExecutionSuspended=function(){return this.executionSuspendedCounter>0},this.suspendExecution=function(){this.executionSuspendedCounter+=1,this.columnIndexMapper.suspendOperations(),this.rowIndexMapper.suspendOperations()},this.resumeExecution=function(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const e=this.executionSuspendedCounter-1;this.executionSuspendedCounter=Math.max(e,0),(!this.isExecutionSuspended()&&e===this.executionSuspendedCounter||t)&&(this.columnIndexMapper.resumeOperations(),this.rowIndexMapper.resumeOperations())},this.batchExecution=function(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.suspendExecution();const n=t();return this.resumeExecution(e),n},this.batch=function(t){this.suspendRender(),this.suspendExecution();const e=t();return this.resumeExecution(),this.resumeRender(),e},this.refreshDimensions=function(){if(!s.view)return;const{width:t,height:e}=s.view.getLastSize(),{width:n,height:o}=s.rootElement.getBoundingClientRect(),i=n!==t||o!==e;!1!==s.runHooks("beforeRefreshDimensions",{width:t,height:e},{width:n,height:o},i)&&((i||s.view._wt.wtOverlays.scrollableElement===s.rootWindow)&&(s.view.setLastSize(n,o),s.render()),s.runHooks("afterRefreshDimensions",{width:t,height:e},{width:n,height:o},i))},this.updateData=function(t,e){BP(t,(t=>{l=t}),(t=>{l=t,s.columnIndexMapper.fitToLength(this.getInitialColumnCount()),s.rowIndexMapper.fitToLength(this.countSourceRows()),c.adjustRowsAndCols()}),{hotInstance:s,dataMap:l,dataSource:h,internalSource:"updateData",source:e,metaManager:p,firstRun:g})},this.loadData=function(t,e){BP(t,(t=>{l=t}),(()=>{p.clearCellsCache(),s.initIndexMappers(),c.adjustRowsAndCols(),g&&(g=[null,"loadData"])}),{hotInstance:s,dataMap:l,dataSource:h,internalSource:"loadData",source:e,metaManager:p,firstRun:g})},this.getInitialColumnCount=function(){const t=w.columns;let e=0;if(Array.isArray(t))e=t.length;else if(iv(t))if("array"===s.dataType){const n=this.countSourceCols();for(let o=0;o<n;o+=1)t(o)&&(e+=1)}else("object"===s.dataType||"function"===s.dataType)&&(e=l.colToPropCache.length);else if(Wp(w.dataSchema)){const t=l.getSchema();e=Array.isArray(t)?t.length:ry(t)}else e=this.countSourceCols();return e},this.initIndexMappers=function(){this.columnIndexMapper.initToLength(this.getInitialColumnCount()),this.rowIndexMapper.initToLength(this.countSourceRows())},this.getData=function(t,e,n,o){return Fp(t)?l.getAll():l.getRange(s._createCellCoords(t,e),s._createCellCoords(n,o),l.DESTINATION_RENDERER)},this.getCopyableText=function(t,e,n,o){return l.getCopyableText(s._createCellCoords(t,e),s._createCellCoords(n,o))},this.getCopyableData=function(t,e){return l.getCopyable(t,l.colToProp(e))},this.getSchema=function(){return l.getSchema()},this.updateSettings=function(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=(g?s.loadData:s.updateData).bind(this);let o,i,r=!1;if(Wp(t.rows))throw new Error('The "rows" setting is no longer supported. Do you mean startRows, minRows or maxRows?');if(Wp(t.cols))throw new Error('The "cols" setting is no longer supported. Do you mean startCols, minCols or maxCols?');if(Wp(t.ganttChart))throw new Error('Since 8.0.0 the "ganttChart" setting is no longer supported.');for(o in t)"data"===o||("language"===o?E(t.language):"className"===o?R("className",t.className):"tableClassName"===o&&s.table?(R("tableClassName",t.tableClassName),s.view._wt.wtOverlays.syncOverlayTableClassNames()):aC.getSingleton().isRegistered(o)||aC.getSingleton().isDeprecated(o)?(iv(t[o])||Array.isArray(t[o]))&&(t[o].initialHook=!0,s.addHook(o,t[o])):!e&&ay(t,o)&&(A[o]=t[o]));void 0===t.data&&void 0===w.data?n(null,"updateSettings"):void 0!==t.data?n(t.data,"updateSettings"):void 0!==t.columns&&(l.createMap(),s.initIndexMappers());const a=s.countCols(),h=w.columns;if(h&&iv(h)&&(r=!0),(void 0!==t.cell||void 0!==t.cells||void 0!==t.columns)&&p.clearCache(),a>0)for(o=0,i=0;o<a;o++){if(h){const t=r?h(o):h[i];t&&p.updateColumnMeta(i,t)}i+=1}Wp(t.cell)&&ny(t.cell,(t=>{s.setCellMetaObject(t.row,t.col,t)})),s.runHooks("afterCellMetaReset");let d=s.rootElement.style.height;""!==d&&(d=parseInt(s.rootElement.style.height,10));let f=t.height;if(iv(f)&&(f=f()),e&&s.rootElement.getAttribute("style")&&s.rootElement.setAttribute("data-initialstyle",s.rootElement.getAttribute("style")),null===f){const t=s.rootElement.getAttribute("data-initialstyle");t&&(t.indexOf("height")>-1||t.indexOf("overflow")>-1)?s.rootElement.setAttribute("style",t):(s.rootElement.style.height="",s.rootElement.style.overflow="")}else void 0!==f&&(s.rootElement.style.height=isNaN(f)?`${f}`:`${f}px`,s.rootElement.style.overflow="hidden");if("undefined"!=typeof t.width){let e=t.width;iv(e)&&(e=e()),s.rootElement.style.width=isNaN(e)?`${e}`:`${e}px`}e||(s.view&&(s.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked(),s.view._wt.exportSettingsAsClassNames()),s.runHooks("afterUpdateSettings",t)),c.adjustRowsAndCols(),s.view&&!g&&(s.forceFullRender=!0,u.lockEditor(),s._refreshBorders(null),s.view._wt.wtOverlays.adjustElementsSize(),u.unlockEditor()),!e&&s.view&&(""===d||""===f||void 0===f)&&d!==f&&s.view._wt.wtOverlays.updateMainScrollableElements()},this.getValue=function(){const t=s.getSelectedLast();if(w.getValue){if(iv(w.getValue))return w.getValue.call(s);if(t)return s.getData()[t[0][0]][w.getValue]}else if(t)return s.getDataAtCell(t[0],t[1])},this.getSettings=function(){return w},this.clear=function(){this.selectAll(),this.emptySelectedCells()},this.alter=function(t,e,n,o,i){c.alter(t,e,n,o,i)},this.getCell=function(t,e){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=e,i=t;if(e>=0){if(this.columnIndexMapper.isHidden(this.toPhysicalColumn(e)))return null;o=this.columnIndexMapper.getRenderableFromVisualIndex(e)}if(t>=0){if(this.rowIndexMapper.isHidden(this.toPhysicalRow(t)))return null;i=this.rowIndexMapper.getRenderableFromVisualIndex(t)}return null===i||null===o?null:s.view.getCellAtCoords(s._createCellCoords(i,o),n)},this.getCoords=function(t){const e=this.view._wt.wtTable.getCoords(t);if(null===e)return null;const{row:n,col:o}=e;let i=n,r=o;return n>=0&&(i=this.rowIndexMapper.getVisualFromRenderableIndex(n)),o>=0&&(r=this.columnIndexMapper.getVisualFromRenderableIndex(o)),s._createCellCoords(i,r)},this.colToProp=function(t){return l.colToProp(t)},this.propToCol=function(t){return l.propToCol(t)},this.toVisualRow=t=>this.rowIndexMapper.getVisualFromPhysicalIndex(t),this.toVisualColumn=t=>this.columnIndexMapper.getVisualFromPhysicalIndex(t),this.toPhysicalRow=t=>this.rowIndexMapper.getPhysicalFromVisualIndex(t),this.toPhysicalColumn=t=>this.columnIndexMapper.getPhysicalFromVisualIndex(t),this.getDataAtCell=function(t,e){return l.get(t,l.colToProp(e))},this.getDataAtRowProp=function(t,e){return l.get(t,e)},this.getDataAtCol=function(t){const e=[],n=l.getRange(s._createCellCoords(0,t),s._createCellCoords(w.data.length-1,t),l.DESTINATION_RENDERER);for(let o=0;o<n.length;o+=1)for(let t=0;t<n[o].length;t+=1)e.push(n[o][t]);return e},this.getDataAtProp=function(t){const e=[],n=l.getRange(s._createCellCoords(0,l.propToCol(t)),s._createCellCoords(w.data.length-1,l.propToCol(t)),l.DESTINATION_RENDERER);for(let o=0;o<n.length;o+=1)for(let t=0;t<n[o].length;t+=1)e.push(n[o][t]);return e},this.getSourceData=function(t,e,n,o){let i;return i=void 0===t?h.getData():h.getByRange(s._createCellCoords(t,e),s._createCellCoords(n,o)),i},this.getSourceDataArray=function(t,e,n,o){let i;return i=void 0===t?h.getData(!0):h.getByRange(s._createCellCoords(t,e),s._createCellCoords(n,o),!0),i},this.getSourceDataAtCol=function(t){return h.getAtColumn(t)},this.setSourceDataAtCell=function(t,e,n,o){const i=I(t,e,n),r=this.hasHook("afterSetSourceDataAtCell"),a=[];r&&Mp(i,(t=>{let[e,n,o]=t;a.push([e,n,h.getAtCell(e,n),o])})),Mp(i,(t=>{let[e,n,o]=t;h.setAtCell(e,n,o)})),r&&this.runHooks("afterSetSourceDataAtCell",a,o),this.render();const l=s.getActiveEditor();l&&Wp(l.refreshValue)&&l.refreshValue()},this.getSourceDataAtRow=function(t){return h.getAtRow(t)},this.getSourceDataAtCell=function(t,e){return h.getAtCell(t,e)},this.getDataAtRow=function(t){return l.getRange(s._createCellCoords(t,0),s._createCellCoords(t,this.countCols()-1),l.DESTINATION_RENDERER)[0]||[]},this.getDataType=function(t,e,n,o){const i=void 0===t?[0,0,this.countRows(),this.countCols()]:[t,e,n,o],[r,s]=i;let[,,a,l]=i,h=null,c=null;void 0===a&&(a=r),void 0===l&&(l=s);let u="mixed";return Cb(Math.max(Math.min(r,a),0),Math.max(r,a),(t=>{let e=!0;return Cb(Math.max(Math.min(s,l),0),Math.max(s,l),(n=>(c=this.getCellMeta(t,n).type,h?e=h===c:h=c,e))),u=e?c:"mixed",e})),u},this.removeCellMeta=function(t,e,n){const[o,i]=[this.toPhysicalRow(t),this.toPhysicalColumn(e)];let r=p.getCellMetaKeyValue(o,i,n);!1!==s.runHooks("beforeRemoveCellMeta",t,e,n,r)&&(p.removeCellMeta(o,i,n),s.runHooks("afterRemoveCellMeta",t,e,n,r)),r=null},this.spliceCellsMeta=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;for(var n=arguments.length,o=new Array(n>2?n-2:0),i=2;i<n;i++)o[i-2]=arguments[i];if(o.length>0&&!Array.isArray(o[0]))throw new Error("The 3rd argument (cellMetaRows) has to be passed as an array of cell meta objects array.");e>0&&p.removeRow(this.toPhysicalRow(t),e),o.length>0&&Mp(o.reverse(),(e=>{p.createRow(this.toPhysicalRow(t)),Mp(e,((e,n)=>this.setCellMetaObject(t,n,e)))})),s.render()},this.setCellMetaObject=function(t,e,n){"object"==typeof n&&ny(n,((n,o)=>{this.setCellMeta(t,e,o,n)}))},this.setCellMeta=function(t,e,n,o){if(!1===s.runHooks("beforeSetCellMeta",t,e,n,o))return;let i=t,r=e;t<this.countRows()&&(i=this.toPhysicalRow(t)),e<this.countCols()&&(r=this.toPhysicalColumn(e)),p.setCellMeta(i,r,n,o),s.runHooks("afterSetCellMeta",t,e,n,o)},this.getCellsMeta=function(){return p.getCellsMeta()},this.getCellMeta=function(t,e){let n=this.toPhysicalRow(t),o=this.toPhysicalColumn(e);return null===n&&(n=t),null===o&&(o=e),p.getCellMeta(n,o,{visualRow:t,visualColumn:e})},this.getCellMetaAtRow=function(t){return p.getCellsMetaAtRow(t)},this.isColumnModificationAllowed=function(){return!("object"===s.dataType||w.columns)},this.getCellRenderer=function(t,e){const n="number"==typeof t?s.getCellMeta(t,e).renderer:t.renderer;return"string"==typeof n?$b(n):Fp(n)?$b("text"):n},this.getCellEditor=function(t,e){const n="number"==typeof t?s.getCellMeta(t,e).editor:t.editor;return"string"==typeof n?AC(n):Fp(n)?AC("text"):n},this.getCellValidator=function(t,e){const n="number"==typeof t?s.getCellMeta(t,e).validator:t.validator;return"string"==typeof n?sS(n):n},this.validateCells=function(t){this._validateCells(t)},this.validateRows=function(t,e){if(!Array.isArray(t))throw new Error("validateRows parameter `rows` must be an array");this._validateCells(e,t)},this.validateColumns=function(t,e){if(!Array.isArray(t))throw new Error("validateColumns parameter `columns` must be an array");this._validateCells(e,void 0,t)},this._validateCells=function(t,e,n){const o=new M;t&&(o.onQueueEmpty=t);let i=s.countRows()-1;for(;i>=0;){if(void 0!==e&&-1===e.indexOf(i)){i-=1;continue}let t=s.countCols()-1;for(;t>=0;)void 0===n||-1!==n.indexOf(t)?(o.addValidatorToQueue(),s.validateCell(s.getDataAtCell(i,t),s.getCellMeta(i,t),(t=>{if("boolean"!=typeof t)throw new Error("Validation error: result is not boolean");!1===t&&(o.valid=!1),o.removeValidatorFormQueue()}),"validateCells"),t-=1):t-=1;i-=1}o.checkIfQueueIsEmpty()},this.getRowHeader=function(t){let e=w.rowHeaders,n=t;return void 0!==n&&(n=s.runHooks("modifyRowHeader",n)),void 0===n?(e=[],Cb(s.countRows()-1,(t=>{e.push(s.getRowHeader(t))}))):Array.isArray(e)&&void 0!==e[n]?e=e[n]:iv(e)?e=e(n):e&&"string"!=typeof e&&"number"!=typeof e&&(e=n+1),e},this.hasRowHeaders=function(){return!!w.rowHeaders},this.hasColHeaders=function(){if(void 0!==w.colHeaders&&null!==w.colHeaders)return!!w.colHeaders;for(let t=0,e=s.countCols();t<e;t++)if(s.getColHeader(t))return!0;return!1},this.getColHeader=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;const n=s.runHooks("modifyColHeader",t);if(void 0===n){const t=[],e=s.countCols();for(let n=0;n<e;n++)t.push(s.getColHeader(n));return t}let o=w.colHeaders;const i=function(t){const e=[],n=s.countCols();let o=0;for(;o<n;o++)iv(w.columns)&&w.columns(o)&&e.push(o);return e[t]},r=s.toPhysicalColumn(n),a=i(r);return!1===w.colHeaders?o=null:w.columns&&iv(w.columns)&&w.columns(a)&&w.columns(a).title?o=w.columns(a).title:w.columns&&w.columns[r]&&w.columns[r].title?o=w.columns[r].title:Array.isArray(w.colHeaders)&&void 0!==w.colHeaders[r]?o=w.colHeaders[r]:iv(w.colHeaders)?o=w.colHeaders(r):w.colHeaders&&"string"!=typeof w.colHeaders&&"number"!=typeof w.colHeaders&&(o=qx(n)),o=s.runHooks("modifyColumnHeaderValue",o,t,e),o},this._getColWidthFromSettings=function(t){let e;if(t>=0&&(e=s.getCellMeta(0,t).width),(void 0===e||e===w.width)&&(e=w.colWidths),null!=e){switch(typeof e){case"object":e=e[t];break;case"function":e=e(t);break}"string"==typeof e&&(e=parseInt(e,10))}return e},this.getColWidth=function(t){let e=s._getColWidthFromSettings(t);return e=s.runHooks("modifyColWidth",e,t),void 0===e&&(e=mE.DEFAULT_WIDTH),e},this._getRowHeightFromSettings=function(t){let e=w.rowHeights;if(null!=e){switch(typeof e){case"object":e=e[t];break;case"function":e=e(t);break}"string"==typeof e&&(e=parseInt(e,10))}return e},this.getRowHeight=function(t){let e=s._getRowHeightFromSettings(t);return e=s.runHooks("modifyRowHeight",e,t),e},this.countSourceRows=function(){return h.countRows()},this.countSourceCols=function(){return h.countFirstRowKeys()},this.countRows=function(){return l.getLength()},this.countCols=function(){const t=w.maxCols,e=this.columnIndexMapper.getNotTrimmedIndexesLength();return Math.min(t,e)},this.countRenderedRows=function(){return s.view._wt.drawn?s.view._wt.wtTable.getRenderedRowsCount():-1},this.countVisibleRows=function(){return s.view._wt.drawn?s.view._wt.wtTable.getVisibleRowsCount():-1},this.countRenderedCols=function(){return s.view._wt.drawn?s.view._wt.wtTable.getRenderedColumnsCount():-1},this.countVisibleCols=function(){return s.view._wt.drawn?s.view._wt.wtTable.getVisibleColumnsCount():-1},this.countRowHeaders=function(){return this.view.getRowHeadersCount()},this.countColHeaders=function(){return this.view.getColumnHeadersCount()},this.countEmptyRows=function(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=0;return bb(s.countRows()-1,(n=>{if(s.isEmptyRow(n))e+=1;else if(!0===t)return!1})),e},this.countEmptyCols=function(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=0;return bb(s.countCols()-1,(n=>{if(s.isEmptyCol(n))e+=1;else if(!0===t)return!1})),e},this.isEmptyRow=function(t){return w.isEmptyRow.call(s,t)},this.isEmptyCol=function(t){return w.isEmptyCol.call(s,t)},this.selectCell=function(t,e,n,o){let i=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],r=!(arguments.length>5&&void 0!==arguments[5])||arguments[5];return!Fp(t)&&!Fp(e)&&this.selectCells([[t,e,n,o]],i,r)},this.selectCells=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[[]],e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];!1===e&&(r=!0);const o=b.selectCells(t);return o&&n&&s.listen(),r=!1,o},this.selectColumns=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t,n=arguments.length>2?arguments[2]:void 0;return b.selectColumns(t,e,n)},this.selectRows=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t,n=arguments.length>2?arguments[2]:void 0;return b.selectRows(t,e,n)},this.deselectCell=function(){b.deselect()},this.selectAll=function(){let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t,n=arguments.length>2?arguments[2]:void 0;r=!0,b.selectAll(t,e,n),r=!1};const H=(t,e)=>t.getNearestNotHiddenIndex(e,1,!0);function D(t){return()=>{throw new Error(`The "${t}" method cannot be called because this Handsontable instance has been destroyed`)}}this.scrollViewportTo=function(t){var e,n;"number"==typeof t&&(t={row:arguments[0],col:arguments[1],verticalSnap:arguments[2]?"bottom":"top",horizontalSnap:arguments[3]?"end":"start",considerHiddenIndexes:null===(n=arguments[4])||void 0===n||n});const{row:o,col:i,verticalSnap:r,horizontalSnap:a,considerHiddenIndexes:l}=null!==(e=t)&&void 0!==e?e:{};let h,c,u,d;void 0!==r&&(h="top"===r,c=!h),void 0!==a&&(u="start"===a,d=!u);let g=o,f=i;if(void 0===l||l){const t=Number.isInteger(o)&&o>=0,e=Number.isInteger(i)&&i>=0,n=t?H(this.rowIndexMapper,o):void 0,r=e?H(this.columnIndexMapper,i):void 0;if(null===n||null===r)return!1;g=t?s.rowIndexMapper.getRenderableFromVisualIndex(n):o,f=e?s.columnIndexMapper.getRenderableFromVisualIndex(r):i}const m=Number.isInteger(g),p=Number.isInteger(f);return m&&g>=0&&p&&f>=0?s.view.scrollViewport(s._createCellCoords(g,f),h,d,c,u):m&&g>=0&&(p&&f<0||!p)?s.view.scrollViewportVertically(g,h,c):!!(p&&f>=0&&(m&&g<0||!m))&&s.view.scrollViewportHorizontally(f,d,u)},this.scrollToFocusedCell=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:()=>{};if(!this.selection.isSelected())return;this.addHookOnce("afterScroll",t);const{highlight:e}=this.getSelectedRangeLast();this.scrollViewportTo(e.toObject())?this.view.render():(this.removeHook("afterScroll",t),this._registerImmediate((()=>t())))},this.destroy=function(){if(s._clearTimeouts(),s._clearImmediates(),s.view&&s.view.destroy(),h&&h.destroy(),h=null,this.getShortcutManager().destroy(),p.clearCache(),hB.delete(this.guid),bx(s)){const t=this.rootDocument.querySelector(".hot-display-license-info");t&&t.parentNode.removeChild(t)}mA(s.rootElement),a.destroy(),u&&u.destroy(),s.batchExecution((()=>{s.rowIndexMapper.unregisterAll(),s.columnIndexMapper.unregisterAll(),v.getItems().forEach((t=>{let[,e]=t;e.destroy()})),v.clear(),s.runHooks("afterDestroy")}),!0),aC.getSingleton().destroy(s),ny(s,((t,e,n)=>{iv(t)?n[e]=D(e):"guid"!==e&&(n[e]=null)})),s.isDestroyed=!0,l&&l.destroy(),l=null,c=null,b=null,u=null,s=null},this.getActiveEditor=function(){return u.getActiveEditor()},this.getPlugin=function(t){const e=iw(t);return"UndoRedo"===e?this.undoRedo:v.getItem(e)},this.getPluginName=function(t){return t===this.undoRedo?this.undoRedo.constructor.PLUGIN_KEY:v.getId(t)},this.getInstance=function(){return s},this.addHook=function(t,e){aC.getSingleton().add(t,e,s)},this.hasHook=function(t){return aC.getSingleton().has(t,s)||aC.getSingleton().has(t)},this.addHookOnce=function(t,e){aC.getSingleton().once(t,e,s)},this.removeHook=function(t,e){aC.getSingleton().remove(t,e,s)},this.runHooks=function(t,e,n,o,i,r,a){return aC.getSingleton().run(s,t,e,n,o,i,r,a)},this.getTranslatedPhrase=function(t,e){return fD(w.language,t,e)},this.toHTML=()=>mb(this),this.toTableElement=()=>{const t=this.rootDocument.createElement("div");return t.insertAdjacentHTML("afterbegin",mb(this)),t.firstElementChild},this.timeouts=[],this._registerTimeout=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=t;"function"==typeof n&&(n=setTimeout(n,e)),this.timeouts.push(n)},this._clearTimeouts=function(){Mp(this.timeouts,(t=>{clearTimeout(t)}))},this.immediates=[],this._registerImmediate=function(t){this.immediates.push(setImmediate(t))},this._clearImmediates=function(){Mp(this.immediates,(t=>{clearImmediate(t)}))},this._refreshBorders=function(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];u.destroyEditor(t),s.view.render(),e&&b.isSelected()&&u.prepareEditor()},this._getEditorManager=function(){return u},this.isRtl=function(){return"rtl"===s.rootWindow.getComputedStyle(s.rootElement).direction},this.isLtr=function(){return!s.isRtl()},this.getDirectionFactor=function(){return s.isLtr()?1:-1};const N=aB({handleEvent(){return s.isListening()},beforeKeyDown:t=>this.runHooks("beforeKeyDown",t),afterKeyDown:t=>{this.isDestroyed||s.runHooks("afterDocumentKeyDown",t)},ownerWindow:this.rootWindow});this.addHook("beforeOnCellMouseDown",(t=>{!1===t.ctrlKey&&!1===t.metaKey&&N.releasePressedKeys()})),this.getShortcutManager=function(){return N},this.getFocusManager=function(){return d},jb().forEach((t=>{const e=Ub(t);v.addItem(t,new e(this))})),W_(s),N.setActiveContextName("grid"),aC.getSingleton().run(s,"construct")}const uB="hooksRefRegisterer",dB={_hooksStorage:Object.create(null),addHook(t,e){return this._hooksStorage[t]||(this._hooksStorage[t]=[]),this.hot.addHook(t,e),this._hooksStorage[t].push(e),this},removeHooksByKey(t){Mp(this._hooksStorage[t]||[],(e=>{this.hot.removeHook(t,e)}))},clearHooks(){ny(this._hooksStorage,((t,e)=>this.removeHooksByKey(e))),this._hooksStorage={}}};ey(dB,"MIXIN_NAME",uB,{writable:!1,enumerable:!1});const gB=dB;function fB(t,e,n){return e=mB(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function mB(t){var e=pB(t,"string");return"symbol"==typeof e?e:String(e)}function pB(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}const wB="base",AB=Object.freeze({VIRGIN:"STATE_VIRGIN",EDITING:"STATE_EDITING",WAITING:"STATE_WAITING",FINISHED:"STATE_FINISHED"}),vB="baseEditor";class yB{static get EDITOR_TYPE(){return wB}constructor(t){fB(this,"hot",void 0),fB(this,"state",AB.VIRGIN),fB(this,"_opened",!1),fB(this,"_fullEditMode",!1),fB(this,"_closeCallback",null),fB(this,"TD",null),fB(this,"row",null),fB(this,"col",null),fB(this,"prop",null),fB(this,"originalValue",null),fB(this,"cellProperties",null),this.hot=t,this.init()}_fireCallbacks(t){this._closeCallback&&(this._closeCallback(t),this._closeCallback=null)}init(){}getValue(){throw Error("Editor getValue() method unimplemented")}setValue(){throw Error("Editor setValue() method unimplemented")}open(){throw Error("Editor open() method unimplemented")}close(){throw Error("Editor close() method unimplemented")}prepare(t,e,n,o,i,r){this.TD=o,this.row=t,this.col=e,this.prop=n,this.originalValue=i,this.cellProperties=r,this.state=AB.VIRGIN}extend(){return class extends this.constructor{}}saveValue(t,e){let n,o,i,r;if(e){const t=this.hot.getSelectedLast();n=Math.max(Math.min(t[0],t[2]),0),o=Math.max(Math.min(t[1],t[3]),0),i=Math.max(t[0],t[2]),r=Math.max(t[1],t[3])}else[n,o,i,r]=[this.row,this.col,null,null];const s=this.hot.runHooks("modifyGetCellCoords",n,o);Array.isArray(s)&&([n,o]=s);const a=this.hot.getShortcutManager().getContext("editor"),l={runOnlyIf:()=>Wp(this.hot.getSelected()),group:vB};this.isInFullEditMode()&&a.addShortcuts([{keys:[["ArrowUp"]],callback:()=>{this.hot.selection.transformStart(-1,0)}},{keys:[["ArrowDown"]],callback:()=>{this.hot.selection.transformStart(1,0)}},{keys:[["ArrowLeft"]],callback:()=>{this.hot.selection.transformStart(0,-1*this.hot.getDirectionFactor())}},{keys:[["ArrowRight"]],callback:()=>{this.hot.selection.transformStart(0,this.hot.getDirectionFactor())}}],l),this.hot.populateFromArray(n,o,t,i,r,"edit")}beginEditing(t,e){if(this.state!==AB.VIRGIN)return;const n=this.hot,o=n.rowIndexMapper.getRenderableFromVisualIndex(this.row),i=n.columnIndexMapper.getRenderableFromVisualIndex(this.col);if(n.view.scrollViewport(n._createCellCoords(o,i)),this.state=AB.EDITING,this.isInFullEditMode()){const e="string"==typeof t?t:Vp(this.originalValue);this.setValue(e)}this.open(e),this._opened=!0,this.focus(),n.view.render(),n.runHooks("afterBeginEditing",this.row,this.col)}finishEditing(t,e,n){let o;if(n){const t=this._closeCallback;this._closeCallback=e=>{t&&t(e),n(e),this.hot.view.render()}}if(this.isWaiting())return;const i=this.hot.getShortcutManager().getContext("editor");if(i.removeShortcutsByGroup(vB),i.removeShortcutsByGroup(NC),this.state!==AB.VIRGIN){if(this.state===AB.EDITING){if(t)return this.cancelChanges(),void this.hot.view.render();const n=this.getValue();o=this.cellProperties.trimWhitespace?[["string"==typeof n?String.prototype.trim.call(n||""):n]]:[[n]],this.state=AB.WAITING,this.saveValue(o,e),this.hot.getCellValidator(this.cellProperties)?this.hot.addHookOnce("postAfterValidate",(t=>{this.state=AB.FINISHED,this.discardEditor(t)})):(this.state=AB.FINISHED,this.discardEditor(!0))}}else this.hot._registerTimeout((()=>{this._fireCallbacks(!0)}))}cancelChanges(){this.state=AB.FINISHED,this.discardEditor()}discardEditor(t){this.state===AB.FINISHED&&(!1===t&&!0!==this.cellProperties.allowInvalid?(this.hot.selectCell(this.row,this.col),this.focus(),this.state=AB.EDITING,this._fireCallbacks(!1)):(this.close(),this._opened=!1,this._fullEditMode=!1,this.state=AB.VIRGIN,this._fireCallbacks(!0),this.hot.getShortcutManager().setActiveContextName("grid")))}enableFullEditMode(){this._fullEditMode=!0}isInFullEditMode(){return this._fullEditMode}isOpened(){return this._opened}isWaiting(){return this.state===AB.WAITING}getEditedCellRect(){var t;const e=this.getEditedCell();if(!e)return;const{wtOverlays:n,wtViewport:o}=this.hot.view._wt,i=this.hot.rootWindow,r=yA(e),s=IA(e),a=yA(this.hot.rootElement),l=IA(this.hot.rootElement),h=n.topOverlay.holder,c=n.inlineStartOverlay.holder,u=h!==i?h.scrollTop:0,d=c!==i?c.scrollLeft:0,g=i.innerWidth-a.left-l,{wtTable:f}=null!==(t=n.getParentOverlay(e))&&void 0!==t?t:this.hot.view._wt,m=f.name,p=["master","inline_start"].includes(m)?u:0,w=["master","top","bottom"].includes(m)?d:0,A=r.top===a.top?0:1;let v=r.top-a.top-A-p,y=0;y=this.hot.isRtl()?i.innerWidth-r.left-s-g-1+w:r.left-a.left-1-w,["top","top_inline_start_corner"].includes(m)&&(v+=n.topOverlay.getOverlayOffset()),["inline_start","top_inline_start_corner"].includes(m)&&(y+=Math.abs(n.inlineStartOverlay.getOverlayOffset()));const C=this.hot.hasColHeaders(),b=this.hot.rowIndexMapper.getRenderableFromVisualIndex(this.row),S=this.hot.columnIndexMapper.getRenderableFromVisualIndex(this.col),E=this.hot.rowIndexMapper.getRenderableIndexesLength()-this.hot.view._wt.getSetting("fixedRowsBottom");(C&&b<=0||b===E)&&(v+=1),S<=0&&(y+=1);const R=o.rowsRenderCalculator.startPosition,M=o.columnsRenderCalculator.startPosition,T=Math.abs(n.inlineStartOverlay.getScrollPosition()),k=n.topOverlay.getScrollPosition(),x=UA(this.hot.rootDocument);let I=e.offsetTop;if(["inline_start","master"].includes(m)&&(I+=R-k),["bottom","bottom_inline_start_corner"].includes(m)){const{wtViewport:t,wtTable:e}=n.bottomOverlay.clone;I+=t.getWorkspaceHeight()-e.getHeight()-x}let O=e.offsetLeft;this.hot.isRtl()?(O=O>=0?f.getWidth()-e.offsetLeft:Math.abs(O),O+=M-T-s):["top","master","bottom"].includes(m)&&(O+=M-T);const H=xA(this.TD,this.hot.rootWindow),D=this.hot.isRtl()?"borderRightWidth":"borderLeftWidth",N=parseInt(H[D],10)>0?0:1,P=parseInt(H.borderTopWidth,10)>0?0:1,_=IA(e)+N,B=OA(e)+P,L=YA(h)?x:0,V=zA(c)?x:0,W=this.hot.view.maximumVisibleElementWidth(O)-L+N,F=Math.max(this.hot.view.maximumVisibleElementHeight(I)-V+P,23);return{top:v,start:y,height:B,maxHeight:F,width:_,maxWidth:W}}getEditedCellsLayerClass(){switch(this.checkEditorSection()){case"inline-start":return"ht_clone_left ht_clone_inline_start";case"bottom":return"ht_clone_bottom";case"bottom-inline-start-corner":return"ht_clone_bottom_left_corner ht_clone_bottom_inline_start_corner";case"top":return"ht_clone_top";case"top-inline-start-corner":return"ht_clone_top_left_corner ht_clone_top_inline_start_corner";default:return"ht_clone_master"}}getEditedCell(){return this.hot.getCell(this.row,this.col,!0)}checkEditorSection(){const t=this.hot.countRows();let e="";return this.row<this.hot.getSettings().fixedRowsTop?e=this.col<this.hot.getSettings().fixedColumnsStart?"top-inline-start-corner":"top":this.hot.getSettings().fixedRowsBottom&&this.row>=t-this.hot.getSettings().fixedRowsBottom?e=this.col<this.hot.getSettings().fixedColumnsStart?"bottom-inline-start-corner":"bottom":this.col<this.hot.getSettings().fixedColumnsStart&&(e="inline-start"),e}}function CB(t,e,n){t.addEventListener(e,n,!1)}function bB(t,e,n){t.removeEventListener(e,n,!1)}function SB(t){return t.ownerDocument.defaultView.getComputedStyle(t)}function EB(t){const e={minHeight:200,maxHeight:300,minWidth:100,maxWidth:300},n=t.body,o=t.createTextNode(""),i=t.createElement("span");let r;function s(){o.textContent=r.value,i.style.position="absolute",i.style.fontSize=SB(r).fontSize,i.style.fontFamily=SB(r).fontFamily,i.style.whiteSpace="pre",n.appendChild(i);const t=i.clientWidth+2;n.removeChild(i);const s=r.style;s.height=`${e.minHeight}px`,e.minWidth>t?s.width=`${e.minWidth}px`:t>e.maxWidth?s.width=`${e.maxWidth}px`:s.width=`${t}px`;const a=r.scrollHeight?r.scrollHeight-1:0;e.minHeight>a?s.height=`${e.minHeight}px`:e.maxHeight<a?(s.height=`${e.maxHeight}px`,s.overflowY="visible"):s.height=`${a}px`}function a(){t.defaultView.setTimeout(s,0)}function l(t){if(t&&t.minHeight)if("inherit"===t.minHeight)e.minHeight=r.clientHeight;else{const n=parseInt(t.minHeight,10);isNaN(n)||(e.minHeight=n)}if(t&&t.maxHeight)if("inherit"===t.maxHeight)e.maxHeight=r.clientHeight;else{const n=parseInt(t.maxHeight,10);isNaN(n)||(e.maxHeight=n)}if(t&&t.minWidth)if("inherit"===t.minWidth)e.minWidth=r.clientWidth;else{const n=parseInt(t.minWidth,10);isNaN(n)||(e.minWidth=n)}if(t&&t.maxWidth)if("inherit"===t.maxWidth)e.maxWidth=r.clientWidth;else{const n=parseInt(t.maxWidth,10);isNaN(n)||(e.maxWidth=n)}i.firstChild||(i.className="autoResize",i.style.display="inline-block",i.appendChild(o))}function h(t,n){let o=arguments.length>2&&void 0!==arguments[2]&&arguments[2];r=t,l(n),"TEXTAREA"===r.nodeName&&(r.style.resize="none",r.style.overflowY="",r.style.height=`${e.minHeight}px`,r.style.minWidth=`${e.minWidth}px`,r.style.maxWidth=`${e.maxWidth}px`,r.style.overflowY="hidden"),o&&(CB(r,"input",s),CB(r,"keydown",a)),s()}return{init:h,resize:s,unObserve(){bB(r,"input",s),bB(r,"keydown",a)}}}function RB(t,e){const n=_A(e),o=e.value.split("\n");let i=n,r=0;for(let s=0;s<o.length;s++){const e=o[s];0!==s&&(r+=o[s-1].length+1);const a=r+e.length;if("home"===t?i=r:"end"===t&&(i=a),n<=a)break}WA(e,i)}function MB(t,e,n){return e=TB(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function TB(t){var e=kB(t,"string");return"symbol"==typeof e?e:String(e)}function kB(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}Jv(yB,gB);const xB="ht_editor_visible",IB="ht_editor_hidden",OB="textEditor",HB="text";class DB extends yB{static get EDITOR_TYPE(){return HB}constructor(t){super(t),MB(this,"eventManager",new MC(this)),MB(this,"autoResize",EB(this.hot.rootDocument)),MB(this,"TEXTAREA",void 0),MB(this,"textareaStyle",void 0),MB(this,"TEXTAREA_PARENT",void 0),MB(this,"textareaParentStyle",void 0),MB(this,"layerClass",void 0),this.eventManager=new MC(this),this.createElements(),this.bindEvents(),this.hot.addHookOnce("afterDestroy",(()=>this.destroy()))}getValue(){return this.TEXTAREA.value}setValue(t){this.TEXTAREA.value=t}open(){this.refreshDimensions(),this.showEditableElement(),this.hot.getShortcutManager().setActiveContextName("editor"),this.registerShortcuts()}close(){this.autoResize.unObserve(),Jw(this.hot.rootDocument.activeElement,this.hot.rootElement)&&this.hot.listen(),this.hideEditableElement(),this.unregisterShortcuts()}prepare(t,e,n,o,i,r){const s=this.state;if(super.prepare(t,e,n,o,i,r),!r.readOnly){this.refreshDimensions(!0);const{allowInvalid:t}=r;t&&(this.TEXTAREA.value=""),s!==AB.FINISHED&&this.hideEditableElement()}}beginEditing(t,e){this.state===AB.VIRGIN&&(this.TEXTAREA.value="",super.beginEditing(t,e))}focus(){this.TEXTAREA.select(),WA(this.TEXTAREA,this.TEXTAREA.value.length)}createElements(){const{rootDocument:t}=this.hot;this.TEXTAREA=t.createElement("TEXTAREA"),dA(this.TEXTAREA,[["data-hot-input",""],dw(-1)]),this.hot.getSettings().ariaTags&&dA(this.TEXTAREA,[Iw()]),cA(this.TEXTAREA,"handsontableInput"),this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,this.textareaStyle.overflowY="visible",this.TEXTAREA_PARENT=t.createElement("DIV"),cA(this.TEXTAREA_PARENT,"handsontableInputHolder"),hA(this.TEXTAREA_PARENT,this.layerClass)&&uA(this.TEXTAREA_PARENT,this.layerClass),cA(this.TEXTAREA_PARENT,IB),this.textareaParentStyle=this.TEXTAREA_PARENT.style,this.TEXTAREA_PARENT.appendChild(this.TEXTAREA),this.hot.rootElement.appendChild(this.TEXTAREA_PARENT)}hideEditableElement(){My()&&(this.textareaStyle.textIndent="-99999px"),this.textareaStyle.overflowY="visible",this.textareaParentStyle.opacity="0",this.textareaParentStyle.height="1px",uA(this.TEXTAREA_PARENT,this.layerClass),cA(this.TEXTAREA_PARENT,IB)}showEditableElement(){this.textareaParentStyle.height="",this.textareaParentStyle.overflow="",this.textareaParentStyle.position="",this.textareaParentStyle[this.hot.isRtl()?"left":"right"]="auto",this.textareaParentStyle.opacity="1",this.textareaStyle.textIndent="",this.textareaStyle.overflowY="hidden";const t=this.TEXTAREA_PARENT.childNodes;let e=!1;Cb(t.length-1,(n=>{const o=t[n];if(hA(o,"handsontableEditor"))return e=!0,!1})),hA(this.TEXTAREA_PARENT,IB)&&uA(this.TEXTAREA_PARENT,IB),e?(this.layerClass=xB,cA(this.TEXTAREA_PARENT,this.layerClass)):(this.layerClass=this.getEditedCellsLayerClass(),cA(this.TEXTAREA_PARENT,this.layerClass))}refreshValue(){const t=this.hot.toPhysicalRow(this.row),e=this.hot.getSourceDataAtCell(t,this.col);this.originalValue=e,this.setValue(e),this.refreshDimensions()}refreshDimensions(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.state!==AB.EDITING&&!t)return;if(this.TD=this.getEditedCell(),!this.TD)return void(t||this.close());const{top:e,start:n,width:o,maxWidth:i,height:r,maxHeight:s}=this.getEditedCellRect();this.textareaParentStyle.top=`${e}px`,this.textareaParentStyle[this.hot.isRtl()?"right":"left"]=`${n}px`,this.showEditableElement();const a=xA(this.TD,this.hot.rootWindow);this.TEXTAREA.style.fontSize=a.fontSize,this.TEXTAREA.style.fontFamily=a.fontFamily,this.TEXTAREA.style.backgroundColor=this.TD.style.backgroundColor;const l=xA(this.TEXTAREA),h=parseInt(l.paddingLeft,10)+parseInt(l.paddingRight,10),c=parseInt(l.paddingTop,10)+parseInt(l.paddingBottom,10),u=o-h,d=r-c,g=i-h,f=s-c;this.autoResize.init(this.TEXTAREA,{minWidth:Math.min(u,g),minHeight:Math.min(d,f),maxWidth:g,maxHeight:f},!0)}bindEvents(){xy()&&this.eventManager.addEventListener(this.TEXTAREA,"focusout",(()=>this.finishEditing(!1))),this.addHook("afterScrollHorizontally",(()=>this.refreshDimensions())),this.addHook("afterScrollVertically",(()=>this.refreshDimensions())),this.addHook("afterColumnResize",(()=>{this.refreshDimensions(),this.state===AB.EDITING&&this.focus()})),this.addHook("afterRowResize",(()=>{this.refreshDimensions(),this.state===AB.EDITING&&this.focus()}))}allowKeyEventPropagation(){}destroy(){this.eventManager.destroy(),this.clearHooks()}registerShortcuts(){const t=this.hot.getShortcutManager(),e=t.getContext("editor"),n=t.getContext("grid"),o={runOnlyIf:()=>Wp(this.hot.getSelected()),group:OB},i=()=>{this.hot.rootDocument.execCommand("insertText",!1,"\n")};e.addShortcuts([{keys:[["Tab"],["Shift","Tab"],["PageUp"],["PageDown"]],forwardToContext:n,callback:()=>{}},{keys:[["Control","Enter"]],callback:()=>(i(),!1),runOnlyIf:t=>!this.hot.selection.isMultiple()&&!t.altKey},{keys:[["Meta","Enter"]],callback:()=>(i(),!1),runOnlyIf:()=>!this.hot.selection.isMultiple()},{keys:[["Alt","Enter"]],callback:()=>(i(),!1)},{keys:[["Home"]],callback:(t,e)=>{let[n]=e;RB(n,this.TEXTAREA)}},{keys:[["End"]],callback:(t,e)=>{let[n]=e;RB(n,this.TEXTAREA)}}],o)}unregisterShortcuts(){const t=this.hot.getShortcutManager().getContext("editor");t.removeShortcutsByGroup(NC),t.removeShortcutsByGroup(OB),t.removeShortcutsByGroup(vB)}}const NB="base";function PB(t,e,n,o,i,r,s){const a=s.ariaTags,l=[],h=[],c=[],u=[];s.className&&cA(e,s.className),s.readOnly?(l.push(s.readOnlyCellClassName),a&&u.push(Ww())):a&&c.push(Ww()[0]),!1===s.valid&&s.invalidCellClassName?(l.push(s.invalidCellClassName),a&&u.push(Fw())):(h.push(s.invalidCellClassName),a&&c.push(Fw()[0])),!1===s.wordWrap&&s.noWordWrapClassName&&l.push(s.noWordWrapClassName),!r&&s.placeholder&&l.push(s.placeholderCellClassName),uA(e,h),cA(e,l),gA(e,c),dA(e,u)}PB.RENDERER_TYPE=NB;const _B="text";function BB(t,e,n,o,i,r,s){PB.apply(this,[t,e,n,o,i,r,s]);let a=r;if(!a&&s.placeholder&&(a=s.placeholder),a=Vp(a),s.trimWhitespace&&(a=a.trim()),s.rendererTemplate){mA(e);const o=t.rootDocument.createElement("TEMPLATE");o.setAttribute("bind","{{}}"),o.innerHTML=s.rendererTemplate,HTMLTemplateElement.decorate(o),o.model=t.getSourceDataAtRow(n),e.appendChild(o)}else AA(e,a)}BB.RENDERER_TYPE=_B;const LB="text",VB={CELL_TYPE:LB,editor:DB,renderer:BB};function WB(t,e){const n=new cB(t,e||{},vx);return n.init(),n}function FB(t,e,n){return e=$B(e),nL(t,jB()?Reflect.construct(e,n||[],$B(t).constructor):e.apply(t,n))}function jB(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(jB=function(){return!!t})()}function UB(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function YB(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?UB(Object(n),!0).forEach((function(e){ZB(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):UB(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function zB(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function GB(t){var e=zB(t,"string");return"symbol"==typeof e?e:String(e)}function QB(t){return QB="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},QB(t)}function KB(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function XB(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,GB(o.key),o)}}function qB(t,e,n){return e&&XB(t.prototype,e),n&&XB(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function ZB(t,e,n){return e=GB(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function JB(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&tL(t,e)}function $B(t){return $B=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},$B(t)}function tL(t,e){return tL=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},tL(t,e)}function eL(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function nL(t,e){if(e&&("object"==typeof e||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return eL(t)}rP(VB),WB.editors={BaseEditor:yB},WB.Core=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new cB(t,e,vx)},WB.DefaultSettings=dP(),WB.hooks=aC.getSingleton(),WB.CellCoords=WE,WB.CellRange=$E,WB.packageName="handsontable",WB.buildDate="16/01/2024 10:27:23",WB.version="14.1.0",WB.languages={dictionaryKeys:oD,getLanguageDictionary:uD,getLanguagesDictionaries:gD,registerLanguageDictionary:hD,getTranslatedPhrase:fD};var oL=Symbol("unassigned"),iL=null,rL="The Handsontable instance bound to this component was destroyed and cannot be used properly.";function sL(t){t.hotInstance&&(t.hotInstance.addHook("beforeChange",(function(){t.__internalEdit=!0})),t.hotInstance.addHook("beforeCreateRow",(function(){t.__internalEdit=!0})),t.hotInstance.addHook("beforeCreateCol",(function(){t.__internalEdit=!0})),t.hotInstance.addHook("beforeRemoveRow",(function(){t.__internalEdit=!0})),t.hotInstance.addHook("beforeRemoveCol",(function(){t.__internalEdit=!0})))}function aL(t){var e=WB.hooks.getRegistered(),n={};for(var o in Object.assign(n,WB.DefaultSettings),n)n[o]={default:oL};for(var i=0;i<e.length;i++)n[e[i]]={default:oL};return n.settings={default:oL},"HotTable"===t&&(n.id={type:String,default:"hot-"+Math.random().toString(36).substring(5)},n.wrapperRendererCacheSize={type:Number,default:3e3}),n}function lL(t){var e={},n=t.settings;if(n!==oL)for(var o in n)n.hasOwnProperty(o)&&n[o]!==oL&&(e[o]=n[o]);for(var i in t)t.hasOwnProperty(i)&&"settings"!==i&&t[i]!==oL&&(e[i]=t[i]);return e}function hL(t,e){var n=lL(t),o=t.settings?t.settings:n,i=t.settings?n:null,r={};for(var s in o)o.hasOwnProperty(s)&&void 0!==o[s]&&(!e||"data"===s||!gL(e[s],o[s]))&&(r[s]=o[s]);for(var a in i)i.hasOwnProperty(a)&&"id"!==a&&"settings"!==a&&"wrapperRendererCacheSize"!==a&&void 0!==i[a]&&(!e||"data"===a||!gL(e[a],i[a]))&&(r[a]=i[a]);return r}function cL(t,e){var n=null;return t.every((function(t,o){return!t.data||!t.data.attrs||void 0===t.data.attrs[e]||(n=t,!1)})),n}function uL(t){return t.filter((function(t){return"HotColumn"===t.$options.name}))}function dL(t,e,n,o){var i=e.$el?e.$el.ownerDocument:document,r={propsData:n,parent:e,data:o};iL||(iL=i.createElement("DIV"),iL.id="vueHotComponents",i.body.appendChild(iL));var s=i.createElement("DIV");return iL.appendChild(s),new t.componentOptions.Ctor(r).$mount(s)}function gL(t,e){var n=function(){var t=new WeakSet;return function(e,n){if("object"===QB(n)&&null!==n){if(t.has(n))return;t.add(n)}return n}}();return JSON.stringify(t,n)===JSON.stringify(e,n)}var fL="14.1.0";"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof n.g?n.g:"undefined"!=typeof self&&self;function mL(t,e){return e={exports:{}},t(e,e.exports),e.exports}var pL=mL((function(t,e){(function(t,n){var o=e;n(o)})(0,(function(t){var e=Symbol("newer"),n=Symbol("older");function o(t,e){"number"!=typeof t&&(e=t,t=0),this.size=0,this.limit=t,this.oldest=this.newest=void 0,this._keymap=new Map,e&&(this.assign(e),t<1&&(this.limit=this.size))}function i(t,o){this.key=t,this.value=o,this[e]=void 0,this[n]=void 0}t.LRUMap=o,o.prototype._markEntryAsUsed=function(t){t!==this.newest&&(t[e]&&(t===this.oldest&&(this.oldest=t[e]),t[e][n]=t[n]),t[n]&&(t[n][e]=t[e]),t[e]=void 0,t[n]=this.newest,this.newest&&(this.newest[e]=t),this.newest=t)},o.prototype.assign=function(t){var o,r=this.limit||Number.MAX_VALUE;this._keymap.clear();for(var s=t[Symbol.iterator](),a=s.next();!a.done;a=s.next()){var l=new i(a.value[0],a.value[1]);if(this._keymap.set(l.key,l),o?(o[e]=l,l[n]=o):this.oldest=l,o=l,0==r--)throw new Error("overflow")}this.newest=o,this.size=this._keymap.size},o.prototype.get=function(t){var e=this._keymap.get(t);if(e)return this._markEntryAsUsed(e),e.value},o.prototype.set=function(t,o){var r=this._keymap.get(t);return r?(r.value=o,this._markEntryAsUsed(r),this):(this._keymap.set(t,r=new i(t,o)),this.newest?(this.newest[e]=r,r[n]=this.newest):this.oldest=r,this.newest=r,++this.size,this.size>this.limit&&this.shift(),this)},o.prototype.shift=function(){var t=this.oldest;if(t)return this.oldest[e]?(this.oldest=this.oldest[e],this.oldest[n]=void 0):(this.oldest=void 0,this.newest=void 0),t[e]=t[n]=void 0,this._keymap.delete(t.key),--this.size,[t.key,t.value]},o.prototype.has=function(t){return this._keymap.has(t)}}))})),wL=pL.LRUMap,AL={name:"HotTable",props:aL("HotTable"),watch:{mergedHotSettings:function(t){!this.hotInstance||void 0===t||(t.data&&(this.hotInstance.isColumnModificationAllowed()||!this.hotInstance.isColumnModificationAllowed()&&this.hotInstance.countSourceCols()===this.miscCache.currentSourceColumns)&&(this.matchHotMappersSize(),delete t.data),Object.keys(t).length?this.hotInstance.updateSettings(t):this.hotInstance.render(),this.miscCache.currentSourceColumns=this.hotInstance.countSourceCols())}},data:function(){var t=this,e=new wL(this.wrapperRendererCacheSize);return e.shift=function(){var t=wL.prototype.shift.call(this);return t[1].component.$destroy(),t},{__internalEdit:!1,miscCache:{currentSourceColumns:null},__hotInstance:null,columnSettings:null,rendererCache:e,editorCache:new Map,get hotInstance(){return!t.__hotInstance||t.__hotInstance&&!t.__hotInstance.isDestroyed?t.__hotInstance:(console.warn(rL),null)},set hotInstance(e){t.__hotInstance=e}}},computed:{mergedHotSettings:function(){return hL(this.$props,this.hotInstance?this.hotInstance.getSettings():void 0)}},methods:{hotInit:function(){var t=this.getGlobalRendererVNode(),e=this.getGlobalEditorVNode(),n=hL(this.$props);n.columns=this.columnSettings?this.columnSettings:n.columns,e&&(n.editor=this.getEditorClass(e,this),e.child.$destroy()),t&&(n.renderer=this.getRendererWrapper(t,this),t.child.$destroy()),this.hotInstance=new WB.Core(this.$el,n),this.hotInstance.init(),sL(this),this.miscCache.currentSourceColumns=this.hotInstance.countSourceCols()},matchHotMappersSize:function(){var t=this;if(this.hotInstance){var e,n=this.hotInstance.getSourceData(),o=[],i=[],r=this.hotInstance.rowIndexMapper.getNumberOfIndexes(),s=this.hotInstance.isColumnModificationAllowed(),a=0;if(n&&n.length!==r&&n.length<r)for(var l=n.length;l<r;l++)o.push(l);if(s)if(a=this.hotInstance.columnIndexMapper.getNumberOfIndexes(),n&&n[0]&&(null===(e=n[0])||void 0===e?void 0:e.length)!==a&&n[0].length<a)for(var h=n[0].length;h<a;h++)i.push(h);this.hotInstance.batch((function(){o.length>0?t.hotInstance.rowIndexMapper.removeIndexes(o):t.hotInstance.rowIndexMapper.insertIndexes(r-1,n.length-r),s&&0!==n.length&&(i.length>0?t.hotInstance.columnIndexMapper.removeIndexes(i):t.hotInstance.columnIndexMapper.insertIndexes(a-1,n[0].length-a))}))}},getGlobalRendererVNode:function(){var t=this.$slots.default||[];return cL(t,"hot-renderer")},getGlobalEditorVNode:function(){var t=this.$slots.default||[];return cL(t,"hot-editor")},getColumnSettings:function(){var t=uL(this.$children),e=!1,n=t.map((function(t){return t.usesRendererComponent&&(e=!0),YB({},t.columnSettings)}));return e&&this.settings&&(!1!==this.settings.autoColumnSize||this.settings.autoRowSize)&&(!1!==this.autoColumnSize||this.autoRowSize)&&console.warn("Your `hot-table` configuration includes both `hot-column` and `autoRowSize`/`autoColumnSize`, which are not compatible with each other in this version of `@handsontable/vue`. Disable `autoRowSize` and `autoColumnSize` to prevent row and column misalignment."),n.length?n:void 0},getRendererWrapper:function(t,e){var n=this;return function(o,i,r,s,a,l,h){if(i&&!i.getAttribute("ghost-table")){var c=n.rendererCache,u={hotInstance:o,TD:i,row:r,col:s,prop:a,value:l,cellProperties:h,isRenderer:!0};if(c&&!c.has("".concat(r,"-").concat(s))){var d=dL(t,e,t.componentOptions.propsData,u);c.set("".concat(r,"-").concat(s),{component:d,lastUsedTD:null})}var g=c.get("".concat(r,"-").concat(s)),f=g.component,m=g.lastUsedTD;if(Object.assign(f.$data,u),!f.$el.parentElement||m!==i){for(;i.firstChild;)i.removeChild(i.firstChild);i.appendChild(f.$el),g.lastUsedTD=i}}return i}},getEditorClass:function(t,e){var n=t.key?t.key.toString():null,o=t.componentOptions.Ctor.options.name,i=n?"".concat(o,":").concat(n):o,r=this.editorCache,s=null;return r.has(i)?s=r.get(i):(s=dL(t,e,t.componentOptions.propsData,{isEditor:!0}),r.set(i,s)),s.$data.hotCustomEditorClass}},mounted:function(){return this.columnSettings=this.getColumnSettings(),this.hotInit()},beforeDestroy:function(){this.hotInstance&&this.hotInstance.destroy()},version:fL};function vL(t,e,n,o,i,r,s,a,l,h){"boolean"!=typeof s&&(l=a,a=s,s=!1);const c="function"==typeof n?n.options:n;let u;if(t&&t.render&&(c.render=t.render,c.staticRenderFns=t.staticRenderFns,c._compiled=!0,i&&(c.functional=!0)),o&&(c._scopeId=o),r?(u=function(t){t=t||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,!t&&"undefined"!=typeof __VUE_SSR_CONTEXT__&&(t=__VUE_SSR_CONTEXT__),e&&e.call(this,l(t)),t&&t._registeredComponents&&t._registeredComponents.add(r)},c._ssrRegister=u):e&&(u=s?function(t){e.call(this,h(t,this.$root.$options.shadowRoot))}:function(t){e.call(this,a(t))}),u)if(c.functional){const t=c.render;c.render=function(e,n){return u.call(n),t(e,n)}}else{const t=c.beforeCreate;c.beforeCreate=t?[].concat(t,u):[u]}return n}var yL=AL,CL=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:t.id}},[t._t("default")],2)},bL=[],SL=void 0,EL=void 0,RL=void 0,ML=!1,TL=vL({render:CL,staticRenderFns:bL},SL,yL,EL,ML,RL,!1,void 0,void 0,void 0);
/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */
function kL(t,e,n,o){var i,r=arguments.length,s=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(s=(r<3?i(s):r>3?i(e,n,s):i(e,n))||s);return r>3&&s&&Object.defineProperty(e,n,s),s}function xL(t){return xL="function"==typeof Symbol&&"symbol"===QB(Symbol.iterator)?function(t){return QB(t)}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":QB(t)},xL(t)}function IL(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function OL(t){return HL(t)||DL(t)||NL()}function HL(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}function DL(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}function NL(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function PL(){return"undefined"!=typeof Reflect&&Reflect.defineMetadata&&Reflect.getOwnMetadataKeys}function _L(t,e){BL(t,e),Object.getOwnPropertyNames(e.prototype).forEach((function(n){BL(t.prototype,e.prototype,n)})),Object.getOwnPropertyNames(e).forEach((function(n){BL(t,e,n)}))}function BL(t,e,n){var o=n?Reflect.getOwnMetadataKeys(e,n):Reflect.getOwnMetadataKeys(e);o.forEach((function(o){var i=n?Reflect.getOwnMetadata(o,e,n):Reflect.getOwnMetadata(o,e);n?Reflect.defineMetadata(o,i,t,n):Reflect.defineMetadata(o,i,t)}))}aL("HotColumn");var LL={__proto__:[]},VL=LL instanceof Array;function WL(t){var e=xL(t);return null==t||"object"!==e&&"function"!==e}function FL(t,e){var n=e.prototype._init;e.prototype._init=function(){var e=this,n=Object.getOwnPropertyNames(t);if(t.$options.props)for(var o in t.$options.props)t.hasOwnProperty(o)||n.push(o);n.forEach((function(n){Object.defineProperty(e,n,{get:function(){return t[n]},set:function(e){t[n]=e},configurable:!0})}))};var o=new e;e.prototype._init=n;var i={};return Object.keys(o).forEach((function(t){void 0!==o[t]&&(i[t]=o[t])})),i}var jL=["data","beforeCreate","created","beforeMount","mounted","beforeDestroy","destroyed","beforeUpdate","updated","activated","deactivated","render","errorCaptured","serverPrefetch"];function UL(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};e.name=e.name||t._componentTag||t.name;var n=t.prototype;Object.getOwnPropertyNames(n).forEach((function(t){if("constructor"!==t){if(jL.indexOf(t)>-1)return void(e[t]=n[t]);var o=Object.getOwnPropertyDescriptor(n,t);void 0!==o.value?"function"==typeof o.value?(e.methods||(e.methods={}))[t]=o.value:(e.mixins||(e.mixins=[])).push({data:function(){return IL({},t,o.value)}}):(o.get||o.set)&&((e.computed||(e.computed={}))[t]={get:o.get,set:o.set})}})),(e.mixins||(e.mixins=[])).push({data:function(){return FL(this,t)}});var i=t.__decorators__;i&&(i.forEach((function(t){return t(e)})),delete t.__decorators__);var r=Object.getPrototypeOf(t.prototype),s=r instanceof o["default"]?r.constructor:o["default"],a=s.extend(e);return zL(a,t,s),PL()&&_L(a,t),a}var YL={prototype:!0,arguments:!0,callee:!0,caller:!0};function zL(t,e,n){Object.getOwnPropertyNames(e).forEach((function(o){if(!YL[o]){var i=Object.getOwnPropertyDescriptor(t,o);if(!i||i.configurable){var r=Object.getOwnPropertyDescriptor(e,o);if(!VL){if("cid"===o)return;var s=Object.getOwnPropertyDescriptor(n,o);if(!WL(r.value)&&s&&s.value===r.value)return}Object.defineProperty(t,o,r)}}}))}function GL(t){return"function"==typeof t?UL(t):function(e){return UL(e,t)}}GL.registerHooks=function(t){jL.push.apply(jL,OL(t))};var QL=function(t){function e(){var t;return KB(this,e),t=FB(this,e,arguments),t.name="BaseEditorComponent",t.instance=null,t.row=null,t.col=null,t.prop=null,t.TD=null,t.originalValue=null,t.cellProperties=null,t.state=null,t.hot=null,t}return JB(e,t),qB(e,[{key:"mounted",value:function(){var t=this;this.$data.hotCustomEditorClass=function(){var e=function(e){function n(e){var o;return KB(this,n),o=FB(this,n,[e]),t.$data.hotCustomEditorInstance=eL(o),o}return JB(n,e),qB(n,[{key:"focus",value:function(){}},{key:"getValue",value:function(){}},{key:"setValue",value:function(){}},{key:"open",value:function(){}},{key:"close",value:function(){}}]),n}(WB.editors.BaseEditor);return Object.getOwnPropertyNames(WB.editors.BaseEditor.prototype).forEach((function(n){"constructor"!==n&&(e.prototype[n]=function(){for(var e,o=arguments.length,i=new Array(o),r=0;r<o;r++)i[r]=arguments[r];return(e=t[n]).call.apply(e,[this].concat(i))})})),e}()}},{key:"_fireCallbacks",value:function(){for(var t,e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];(t=WB.editors.BaseEditor.prototype._fireCallbacks).call.apply(t,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"beginEditing",value:function(){for(var t,e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return(t=WB.editors.BaseEditor.prototype.beginEditing).call.apply(t,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"cancelChanges",value:function(){for(var t,e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return(t=WB.editors.BaseEditor.prototype.cancelChanges).call.apply(t,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"checkEditorSection",value:function(){for(var t,e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return(t=WB.editors.BaseEditor.prototype.checkEditorSection).call.apply(t,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"close",value:function(){for(var t,e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return(t=WB.editors.BaseEditor.prototype.close).call.apply(t,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"discardEditor",value:function(){for(var t,e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return(t=WB.editors.BaseEditor.prototype.discardEditor).call.apply(t,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"enableFullEditMode",value:function(){for(var t,e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return(t=WB.editors.BaseEditor.prototype.enableFullEditMode).call.apply(t,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"extend",value:function(){for(var t,e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return(t=WB.editors.BaseEditor.prototype.extend).call.apply(t,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"finishEditing",value:function(){for(var t,e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return(t=WB.editors.BaseEditor.prototype.finishEditing).call.apply(t,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"focus",value:function(){for(var t,e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return(t=WB.editors.BaseEditor.prototype.focus).call.apply(t,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"getValue",value:function(){for(var t,e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return(t=WB.editors.BaseEditor.prototype.getValue).call.apply(t,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"init",value:function(){for(var t,e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return(t=WB.editors.BaseEditor.prototype.init).call.apply(t,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"isInFullEditMode",value:function(){for(var t,e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return(t=WB.editors.BaseEditor.prototype.isInFullEditMode).call.apply(t,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"isOpened",value:function(){for(var t,e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return(t=WB.editors.BaseEditor.prototype.isOpened).call.apply(t,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"isWaiting",value:function(){for(var t,e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return(t=WB.editors.BaseEditor.prototype.isWaiting).call.apply(t,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"open",value:function(){for(var t,e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return(t=WB.editors.BaseEditor.prototype.open).call.apply(t,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"prepare",value:function(t,e,n,o,i,r){return this.$data.hotInstance=r.instance,this.$data.row=t,this.$data.col=e,this.$data.prop=n,this.$data.TD=o,this.$data.originalValue=i,this.$data.cellProperties=r,WB.editors.BaseEditor.prototype.prepare.call(this.$data.hotCustomEditorInstance,t,e,n,o,i,r)}},{key:"saveValue",value:function(){for(var t,e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return(t=WB.editors.BaseEditor.prototype.saveValue).call.apply(t,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"setValue",value:function(){for(var t,e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return(t=WB.editors.BaseEditor.prototype.setValue).call.apply(t,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"addHook",value:function(){for(var t,e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return(t=WB.editors.BaseEditor.prototype.addHook).call.apply(t,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"removeHooksByKey",value:function(){for(var t,e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return(t=WB.editors.BaseEditor.prototype.removeHooksByKey).call.apply(t,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"clearHooks",value:function(){for(var t,e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return(t=WB.editors.BaseEditor.prototype.clearHooks).call.apply(t,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"getEditedCell",value:function(){for(var t,e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return(t=WB.editors.BaseEditor.prototype.getEditedCell).call.apply(t,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"getEditedCellRect",value:function(){for(var t,e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return(t=WB.editors.BaseEditor.prototype.getEditedCellRect).call.apply(t,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"getEditedCellsZIndex",value:function(){for(var t,e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return(t=WB.editors.BaseEditor.prototype.getEditedCellsZIndex).call.apply(t,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"getEditedCellsLayerClass",value:function(){for(var t,e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return(t=WB.editors.BaseEditor.prototype.getEditedCellsLayerClass).call.apply(t,[this.$data.hotCustomEditorInstance].concat(n))}}]),e}(o["default"]);function KL(t,e){return`${t}-${e}`}QL=kL([GL({})],QL),(()=>{if(!window.matchMedia)return{value:(0,o.ref)(null)};const t=(0,o.ref)(window.matchMedia("(prefers-color-scheme: dark)").matches);window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",(e=>t.value=e.matches))})();const XL={create(){return(0,r.r)("xlsx.worker.js").defaults((()=>new Worker(new URL(n.p+n.u(895),n.b),{type:void 0})))}},qL={create(){return(0,r.r)("sheet.worker.js").defaults((()=>new Worker(new URL(n.p+n.u(879),n.b),{type:void 0})))}},ZL="handsontableEditor",JL="handsontable";class $L extends DB{static get EDITOR_TYPE(){return JL}open(){super.open(),this.htEditor&&this.htEditor.destroy(),"none"===this.htContainer.style.display&&(this.htContainer.style.display=""),this.htEditor=new this.hot.constructor(this.htContainer,this.htOptions),this.htEditor.init(),this.htEditor.rootElement.style.display="",this.cellProperties.strict?this.htEditor.selectCell(0,0):this.htEditor.deselectCell(),WA(this.TEXTAREA,0,this.TEXTAREA.value.length),this.refreshDimensions()}close(){this.htEditor&&(this.htEditor.rootElement.style.display="none"),this.removeHooksByKey("beforeKeyDown"),super.close()}prepare(t,e,n,o,i,r){super.prepare(t,e,n,o,i,r);const s=this,a={startRows:0,startCols:0,minRows:0,minCols:0,className:"listbox",copyPaste:!1,autoColumnSize:!1,autoRowSize:!1,readOnly:!0,fillHandle:!1,autoWrapCol:!1,autoWrapRow:!1,ariaTags:!1,afterOnCellMouseDown(t,e){const n=this.getSourceData(e.row,e.col);void 0!==n&&s.setValue(n),s.hot.destroyEditor()},preventWheel:!0,layoutDirection:this.hot.isRtl()?"rtl":"ltr"};this.cellProperties.handsontable&&Kv(a,r.handsontable),this.htOptions=a}beginEditing(t,e){const n=this.hot.getSettings().onBeginEditing;n&&!1===n()||super.beginEditing(t,e)}createElements(){super.createElements();const t=this.hot.rootDocument.createElement("DIV");t.className="handsontableEditor",this.TEXTAREA_PARENT.appendChild(t),this.htContainer=t,this.assignHooks()}finishEditing(t,e,n){if(this.htEditor&&this.htEditor.isListening()&&this.hot.listen(),this.htEditor&&this.htEditor.getSelectedLast()){const t=this.htEditor.getValue();void 0!==t&&this.setValue(t)}super.finishEditing(t,e,n)}assignHooks(){this.hot.addHook("afterDestroy",(()=>{this.htEditor&&this.htEditor.destroy()}))}registerShortcuts(){const t=this.hot.getShortcutManager().getContext("editor");super.registerShortcuts();const e={group:ZL,relativeToGroup:NC,position:"before"},n=(t,e)=>{const n=this.htEditor;if(void 0!==t&&(t<0||n.flipped&&t>n.countRows()-1?n.deselectCell():n.selectCell(t,0),n.getData().length))return e.preventDefault(),Uy(e),this.hot.listen(),this.TEXTAREA.focus(),!1};t.addShortcuts([{keys:[["ArrowUp"]],callback:t=>{const e=this.htEditor;let o,i;return!e.getSelectedLast()&&e.flipped?o=e.countRows()-1:e.getSelectedLast()&&(e.flipped?(i=e.getSelectedLast()[0],o=Math.max(0,i-1)):(i=e.getSelectedLast()[0],o=i-1)),n(o,t)},preventDefault:!1},{keys:[["ArrowDown"]],callback:t=>{const e=this.htEditor;let o,i;if(e.getSelectedLast()||e.flipped){if(e.getSelectedLast())if(e.flipped)o=e.getSelectedLast()[0]+1;else if(!e.flipped){const t=e.countRows()-1;i=e.getSelectedLast()[0],o=Math.min(t,i+1)}}else o=0;return n(o,t)},preventDefault:!1}],e)}unregisterShortcuts(){super.unregisterShortcuts(),this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(ZL)}}function tV(t,e,n){eV(t,e),e.set(t,n)}function eV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function nV(t,e,n){return e=oV(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function oV(t){var e=iV(t,"string");return"symbol"==typeof e?e:String(e)}function iV(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function rV(t,e){var n=sV(t,e,"get");return aV(t,n)}function sV(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function aV(t,e){return e.get?e.get.call(t):e.value}const lV="autocomplete";var hV=new WeakMap;class cV extends $L{constructor(){super(...arguments),nV(this,"query",null),nV(this,"strippedChoices",[]),nV(this,"rawChoices",[]),tV(this,hV,{writable:!0,value:this.hot.guid.slice(0,9)}),nV(this,"sortByRelevance",(function(t,e,n){const o=[],i=[],r=t.length;let s,a,l,h,c=e.length;if(0===r){for(l=0;l<c;l++)i.push(l);return i}for(l=0;l<c;l++){if(a=hw(Vp(e[l])),n)h=a.indexOf(t);else{const e=this.cellProperties.locale;h=a.toLocaleLowerCase(e).indexOf(t.toLocaleLowerCase(e))}-1!==h&&(s=a.length-h-r,o.push({baseIndex:l,index:h,charsLeft:s,value:a}))}for(o.sort(((t,e)=>{if(-1===e.index)return-1;if(-1===t.index)return 1;if(t.index<e.index)return-1;if(e.index<t.index)return 1;if(t.index===e.index){if(t.charsLeft<e.charsLeft)return-1;if(t.charsLeft>e.charsLeft)return 1}return 0})),l=0,c=o.length;l<c;l++)i.push(o[l].baseIndex);return i}))}static get EDITOR_TYPE(){return lV}getValue(){const t=this.rawChoices.find((t=>this.stripValueIfNeeded(t)===this.TEXTAREA.value));return Wp(t)?t:this.TEXTAREA.value}createElements(){super.createElements(),cA(this.htContainer,"autocompleteEditor"),cA(this.htContainer,-1===this.hot.rootWindow.navigator.platform.indexOf("Mac")?"":"htMacScroll"),this.hot.getSettings().ariaTags&&dA(this.TEXTAREA,[kw(),bw(),Dw("listbox"),Yw()])}prepare(t,e,n,o,i,r){super.prepare(t,e,n,o,i,r),this.hot.getSettings().ariaTags&&dA(this.TEXTAREA,[Lw("false"),zw(`${rV(this,hV)}-listbox-${t}-${e}`)])}open(){super.open();const t=void 0===this.cellProperties.trimDropdown||this.cellProperties.trimDropdown,e=this.hot.getSettings().ariaTags,n=Array.isArray(this.cellProperties.source)?this.cellProperties.source:null,o=null==n?void 0:n.length,{row:i,col:r}=this;this.showEditableElement(),this.focus();let s=UA();0===s&&Hy()&&(s+=15),this.addHook("beforeKeyDown",(t=>this.onBeforeKeyDown(t))),this.htEditor.updateSettings({colWidths:t?[IA(this.TEXTAREA)-2]:void 0,width:t?IA(this.TEXTAREA)+s:void 0,autoColumnSize:!0,renderer:(t,i,r,s,a,l,h)=>{BB(t,i,r,s,a,l,h);const{filteringCaseSensitive:c,allowHtml:u,locale:d}=this.cellProperties,g=this.query;let f,m,p=Vp(l);p&&!u&&(f=!0===c?p.indexOf(g):p.toLocaleLowerCase(d).indexOf(g.toLocaleLowerCase(d)),-1!==f&&(m=p.substr(f,g.length),p=p.replace(m,`<strong>${m}</strong>`))),e&&dA(i,[Ew(),...n?[Xw(o)]:[],...n?[qw(n.indexOf(l)+1)]:[],["id",`${this.htEditor.rootElement.id}_${r}-${s}`]]),i.innerHTML=p},afterSelection:(t,n)=>{if(e){const e=this.htEditor.getCell(t,n,!0);dA(e,[Uw()]),dA(this.TEXTAREA,...Gw(e.id))}}}),e&&(dA(this.htEditor.view._wt.wtOverlays.wtTable.TABLE,...fw()),dA(this.htEditor.rootElement,[Sw(),Qw("polite"),Kw("text"),["id",`${rV(this,hV)}-listbox-${i}-${r}`]]),dA(this.TEXTAREA,...Lw("true"))),this.hot._registerTimeout((()=>{this.queryChoices(this.TEXTAREA.value)}))}close(){this.removeHooksByKey("beforeKeyDown"),super.close(),this.hot.getSettings().ariaTags&&dA(this.TEXTAREA,[Lw("false")])}discardEditor(t){super.discardEditor(t),this.hot.view.render()}queryChoices(t){const e=this.cellProperties.source;this.query=t,"function"==typeof e?e.call(this.cellProperties,t,(t=>{this.rawChoices=t,this.updateChoicesList(this.stripValuesIfNeeded(t))})):Array.isArray(e)?(this.rawChoices=e,this.updateChoicesList(this.stripValuesIfNeeded(e))):this.updateChoicesList([])}updateChoicesList(t){const e=_A(this.TEXTAREA),n=BA(this.TEXTAREA),o=this.cellProperties.sortByRelevance,i=this.cellProperties.filter;let r=null,s=null,a=t;o&&(r=this.sortByRelevance(this.stripValueIfNeeded(this.getValue()),a,this.cellProperties.filteringCaseSensitive));const l=Array.isArray(r)?r.length:0;if(!1===i)l&&(s=r[0]);else{const t=[];for(let e=0,n=a.length;e<n&&!(o&&l<=e);e++)l?t.push(a[r[e]]):t.push(a[e]);s=0,a=t}this.strippedChoices=a,this.htEditor.loadData(bp([a])),0===a.length?this.htEditor.rootElement.style.display="none":(this.htEditor.rootElement.style.display="",this.updateDropdownHeight(),this.flipDropdownIfNeeded(),!0===this.cellProperties.strict&&this.highlightBestMatchingChoice(s)),this.hot.listen(),WA(this.TEXTAREA,e,e===n?void 0:n)}flipDropdownIfNeeded(){const t=MA(this.hot.view._wt.wtTable.TABLE),e=t===this.hot.rootWindow,n=this.cellProperties.preventOverflow;if(e||!e&&(n||"horizontal"===n))return!1;const o=yA(this.TEXTAREA),i=OA(this.TEXTAREA),r=this.getDropdownHeight(),s=t.scrollTop,a=OA(this.hot.view._wt.wtTable.THEAD),l=yA(t),h=o.top-l.top-a+s,c=t.scrollHeight-h-a-i,u=r>c&&h>c;return u?this.flipDropdown(r):this.unflipDropdown(),this.limitDropdownIfNeeded(u?h:c,r),u}limitDropdownIfNeeded(t,e){if(e>t){let n=0,o=0,i=0,r=null;do{i=this.htEditor.getRowHeight(o)||this.htEditor.view._wt.getSetting("defaultRowHeight"),n+=i,o+=1}while(n<t);r=n-i,this.htEditor.flipped&&(this.htEditor.rootElement.style.top=parseInt(this.htEditor.rootElement.style.top,10)+e-r+"px"),this.setDropdownHeight(n-i)}}flipDropdown(t){const e=this.htEditor.rootElement.style;e.position="absolute",e.top=-t+"px",this.htEditor.flipped=!0}unflipDropdown(){const t=this.htEditor.rootElement.style;t.position="absolute",t.top="",this.htEditor.flipped=void 0}updateDropdownHeight(){const t=this.htEditor.getColWidth(0)+UA(this.hot.rootDocument)+2,e=this.cellProperties.trimDropdown;this.htEditor.updateSettings({height:this.getDropdownHeight(),width:e?void 0:t}),this.htEditor.view._wt.wtTable.alignOverlaysWithTrimmingContainer()}setDropdownHeight(t){this.htEditor.updateSettings({height:t})}highlightBestMatchingChoice(t){"number"==typeof t?this.htEditor.selectCell(t,0,void 0,void 0,void 0,!1):this.htEditor.deselectCell()}getDropdownHeight(){const t=this.htEditor.getRowHeight(0)||23,e=this.cellProperties.visibleRows;return this.strippedChoices.length>=e?e*t:this.strippedChoices.length*t+8}stripValueIfNeeded(t){return this.stripValuesIfNeeded([t])[0]}stripValuesIfNeeded(t){const{allowHtml:e}=this.cellProperties,n=Rp(t,(t=>Vp(t)));return Rp(n,(t=>e?t:hw(t)))}allowKeyEventPropagation(t){const e=this.htEditor.getSelectedRangeLast(),n={row:e?e.from.row:-1};let o=!1;return t===Py.ARROW_DOWN&&n.row>0&&n.row<this.htEditor.countRows()-1&&(o=!0),t===Py.ARROW_UP&&n.row>-1&&(o=!0),o}onBeforeKeyDown(t){if(By(t.keyCode)||t.keyCode===Py.BACKSPACE||t.keyCode===Py.DELETE||t.keyCode===Py.INSERT){let e=10;if(t.keyCode===Py.C&&(t.ctrlKey||t.metaKey))return;this.isOpened()||(e+=10),this.htEditor&&this.hot._registerTimeout((()=>{this.queryChoices(this.TEXTAREA.value)}),e)}}}const uV="checkbox";class dV extends yB{static get EDITOR_TYPE(){return uV}beginEditing(t,e){if(e&&"mouseup"===e.type){const t=this.TD.querySelector('input[type="checkbox"]');hA(t,"htBadValue")||t.click()}}finishEditing(){}init(){}open(){}close(){}getValue(){}setValue(){}focus(){}}
/*!
 * Pikaday
 *
 * Copyright Â© 2014 David Bushell | BSD & MIT license | https://github.com/Pikaday/Pikaday
 */const gV=()=>window,fV=()=>window.document,mV=(t,e)=>window.setTimeout(t,e),pV=function(t,e,n,o){t.addEventListener(e,n,!!o)},wV=function(t,e,n,o){t.removeEventListener(e,n,!!o)},AV=function(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")},vV=function(t,e){return-1!==(" "+t.className+" ").indexOf(" "+e+" ")},yV=function(t,e){vV(t,e)||(t.className=""===t.className?e:t.className+" "+e)},CV=function(t,e){t.className=AV((" "+t.className+" ").replace(" "+e+" "," "))},bV=function(t){return/Array/.test(Object.prototype.toString.call(t))},SV=function(t){return/Date/.test(Object.prototype.toString.call(t))&&!isNaN(t.getTime())},EV=function(t){let e=t.getDay();return 0===e||6===e},RV=function(t){return t%4===0&&t%100!==0||t%400===0},MV=function(t,e){return[31,RV(t)?29:28,31,30,31,30,31,31,30,31,30,31][e]},TV=function(t){SV(t)&&t.setHours(0,0,0,0)},kV=function(t,e){return t.getTime()===e.getTime()},xV=function(t,e,n){let o,i;for(o in e)i=void 0!==t[o],i&&"object"==typeof e[o]&&null!==e[o]&&void 0===e[o].nodeName?SV(e[o])?n&&(t[o]=new Date(e[o].getTime())):bV(e[o])?n&&(t[o]=e[o].slice(0)):t[o]=xV({},e[o],n):(n||!i)&&(t[o]=e[o]);return t},IV=function(t,e,n){let o=fV().createEvent("HTMLEvents");o.initEvent(e,!0,!1),o=xV(o,n),t.dispatchEvent(o)},OV=function(t){return t.month<0&&(t.year-=Math.ceil(Math.abs(t.month)/12),t.month+=12),t.month>11&&(t.year+=Math.floor(Math.abs(t.month)/12),t.month-=12),t},HV={field:null,bound:void 0,ariaLabel:"Use the arrow keys to pick a date",position:"bottom left",reposition:!0,format:"YYYY-MM-DD",toString:null,parse:null,defaultDate:null,setDefaultDate:!1,firstDay:0,firstWeekOfYearMinDays:4,formatStrict:!1,minDate:null,maxDate:null,yearRange:10,showWeekNumber:!1,pickWholeWeek:!1,minYear:0,maxYear:9999,minMonth:void 0,maxMonth:void 0,startRange:null,endRange:null,isRTL:!1,yearSuffix:"",showMonthAfterYear:!1,showDaysInNextAndPreviousMonths:!1,enableSelectionDaysInNextAndPreviousMonths:!1,numberOfMonths:1,mainCalendar:"left",container:void 0,blurFieldOnSelect:!0,i18n:{previousMonth:"Previous Month",nextMonth:"Next Month",months:["January","February","March","April","May","June","July","August","September","October","November","December"],weekdays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],weekdaysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},theme:null,events:[],onSelect:null,onOpen:null,onClose:null,onDraw:null,keyboardInput:!0},DV=function(t,e,n){for(e+=t.firstDay;e>=7;)e-=7;return n?t.i18n.weekdaysShort[e]:t.i18n.weekdays[e]},NV=function(t){let e=[],n="false";if(t.isEmpty){if(!t.showDaysInNextAndPreviousMonths)return'<td class="is-empty"></td>';e.push("is-outside-current-month"),t.enableSelectionDaysInNextAndPreviousMonths||e.push("is-selection-disabled")}return t.isDisabled&&e.push("is-disabled"),t.isToday&&e.push("is-today"),t.isSelected&&(e.push("is-selected"),n="true"),t.hasEvent&&e.push("has-event"),t.isInRange&&e.push("is-inrange"),t.isStartRange&&e.push("is-startrange"),t.isEndRange&&e.push("is-endrange"),'<td data-day="'+t.day+'" class="'+e.join(" ")+'" aria-selected="'+n+'"><button class="pika-button pika-day" type="button" data-pika-year="'+t.year+'" data-pika-month="'+t.month+'" data-pika-day="'+t.day+'">'+t.day+"</button></td>"},PV=function(t,e){t.setHours(0,0,0,0);let n=t.getDate(),o=t.getDay(),i=e,r=i-1,s=7,a=function(t){return(t+s-1)%s};t.setDate(n+r-a(o));let l=new Date(t.getFullYear(),0,i),h=864e5,c=(t.getTime()-l.getTime())/h;return 1+Math.round((c-r+a(l.getDay()))/s)},_V=function(t,e,n,o,i){let r=new Date(o,n,e);return'<td class="pika-week">'+(t.hasMoment?t.moment(r).isoWeek():PV(r,i))+"</td>"},BV=function(t,e,n,o){return'<tr class="pika-row'+(n?" pick-whole-week":"")+(o?" is-selected":"")+'">'+(e?t.reverse():t).join("")+"</tr>"},LV=function(t){return"<tbody>"+t.join("")+"</tbody>"},VV=function(t){let e,n=[];for(t.showWeekNumber&&n.push("<th></th>"),e=0;e<7;e++)n.push('<th scope="col"><abbr title="'+DV(t,e)+'">'+DV(t,e,!0)+"</abbr></th>");return"<thead><tr>"+(t.isRTL?n.reverse():n).join("")+"</tr></thead>"},WV=function(t,e,n,o,i,r){let s,a,l,h,c,u=t._o,d=n===u.minYear,g=n===u.maxYear,f='<div id="'+r+'" class="pika-title" role="heading" aria-live="polite">',m=!0,p=!0;for(l=[],s=0;s<12;s++)l.push('<option value="'+(n===i?s-e:12+s-e)+'"'+(s===o?' selected="selected"':"")+(d&&s<u.minMonth||g&&s>u.maxMonth?' disabled="disabled"':"")+">"+u.i18n.months[s]+"</option>");for(h='<div class="pika-label">'+u.i18n.months[o]+'<select class="pika-select pika-select-month" tabindex="-1">'+l.join("")+"</select></div>",bV(u.yearRange)?(s=u.yearRange[0],a=u.yearRange[1]+1):(s=n-u.yearRange,a=1+n+u.yearRange),l=[];s<a&&s<=u.maxYear;s++)s>=u.minYear&&l.push('<option value="'+s+'"'+(s===n?' selected="selected"':"")+">"+s+"</option>");return c='<div class="pika-label">'+n+u.yearSuffix+'<select class="pika-select pika-select-year" tabindex="-1">'+l.join("")+"</select></div>",u.showMonthAfterYear?f+=c+h:f+=h+c,d&&(0===o||u.minMonth>=o)&&(m=!1),g&&(11===o||u.maxMonth<=o)&&(p=!1),0===e&&(f+='<button class="pika-prev'+(m?"":" is-disabled")+'" type="button">'+u.i18n.previousMonth+"</button>"),e===t._o.numberOfMonths-1&&(f+='<button class="pika-next'+(p?"":" is-disabled")+'" type="button">'+u.i18n.nextMonth+"</button>"),f+"</div>"},FV=function(t,e,n){return'<table cellpadding="0" cellspacing="0" class="pika-table" role="grid" aria-labelledby="'+n+'">'+VV(t)+LV(e)+"</table>"};function jV(t){let e=this,n=e.config(t);e._onMouseDown=function(t){if(!e._v)return;t=t||gV().event;let o=t.target||t.srcElement;if(o)if(vV(o,"is-disabled")||(!vV(o,"pika-button")||vV(o,"is-empty")||vV(o.parentNode,"is-disabled")?vV(o,"pika-prev")?e.prevMonth():vV(o,"pika-next")&&e.nextMonth():(e.setDate(new Date(o.getAttribute("data-pika-year"),o.getAttribute("data-pika-month"),o.getAttribute("data-pika-day"))),n.bound&&mV((function(){e.hide(),n.blurFieldOnSelect&&n.field&&n.field.blur()}),100))),vV(o,"pika-select"))e._c=!0;else{if(!t.preventDefault)return t.returnValue=!1,!1;t.preventDefault()}},e._onChange=function(t){t=t||gV().event;let n=t.target||t.srcElement;n&&(vV(n,"pika-select-month")?e.gotoMonth(n.value):vV(n,"pika-select-year")&&e.gotoYear(n.value))},e._onKeyChange=function(t){if(t=t||gV().event,e.isVisible())switch(t.keyCode){case 13:case 27:n.field&&n.field.blur();break;case 37:e.adjustDate("subtract",1);break;case 38:e.adjustDate("subtract",7);break;case 39:e.adjustDate("add",1);break;case 40:e.adjustDate("add",7);break;case 8:case 46:e.setDate(null);break}},e._parseFieldValue=function(){if(n.parse)return n.parse(n.field.value,n.format);if(this.hasMoment){let t=this.moment(n.field.value,n.format,n.formatStrict);return t&&t.isValid()?t.toDate():null}return new Date(Date.parse(n.field.value))},e._onInputChange=function(t){let n;t.firedBy!==e&&(n=e._parseFieldValue(),SV(n)&&e.setDate(n),e._v||e.show())},e._onInputFocus=function(){e.show()},e._onInputClick=function(){e.show()},e._onInputBlur=function(){let t=fV().activeElement;do{if(vV(t,"pika-single"))return}while(t=t.parentNode);e._c||(e._b=mV((function(){e.hide()}),50)),e._c=!1},e._onClick=function(t){t=t||gV().event;let o=t.target||t.srcElement,i=o;if(o){!hasEventListeners&&vV(o,"pika-select")&&(o.onchange||(o.setAttribute("onchange","return;"),pV(o,"change",e._onChange)));do{if(vV(i,"pika-single")||i===n.trigger)return}while(i=i.parentNode);e._v&&o!==n.trigger&&i!==n.trigger&&e.hide()}},e.el=fV().createElement("div"),e.el.className="pika-single"+(n.isRTL?" is-rtl":"")+(n.theme?" "+n.theme:""),pV(e.el,"mousedown",e._onMouseDown,!0),pV(e.el,"touchend",e._onMouseDown,!0),pV(e.el,"change",e._onChange),n.keyboardInput&&pV(fV(),"keydown",e._onKeyChange),n.field&&(n.container?n.container.appendChild(e.el):n.bound?fV().body.appendChild(e.el):n.field.parentNode.insertBefore(e.el,n.field.nextSibling),pV(n.field,"change",e._onInputChange),n.defaultDate||(n.defaultDate=e._parseFieldValue(),n.setDefaultDate=!0));let o=n.defaultDate;SV(o)?n.setDefaultDate?e.setDate(o,!0):e.gotoDate(o):e.gotoDate(new Date),n.bound?(this.hide(),e.el.className+=" is-bound",pV(n.trigger,"click",e._onInputClick),pV(n.trigger,"focus",e._onInputFocus),pV(n.trigger,"blur",e._onInputBlur)):this.show()}function UV(t,e,n){return e=YV(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function YV(t){var e=zV(t,"string");return"symbol"==typeof e?e:String(e)}function zV(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}jV.prototype={config:function(t){this._o||(this._o=xV({},HV,!0));let e=xV(this._o,t,!0);e.isRTL=!!e.isRTL,e.field=e.field&&e.field.nodeName?e.field:null,e.theme="string"==typeof e.theme&&e.theme?e.theme:null,e.bound=!!(void 0!==e.bound?e.field&&e.bound:e.field),e.trigger=e.trigger&&e.trigger.nodeName?e.trigger:e.field,e.disableWeekends=!!e.disableWeekends,e.disableDayFn="function"==typeof e.disableDayFn?e.disableDayFn:null;let n=parseInt(e.numberOfMonths,10)||1;if(e.numberOfMonths=n>4?4:n,SV(e.minDate)||(e.minDate=!1),SV(e.maxDate)||(e.maxDate=!1),e.minDate&&e.maxDate&&e.maxDate<e.minDate&&(e.maxDate=e.minDate=!1),e.minDate&&this.setMinDate(e.minDate),e.maxDate&&this.setMaxDate(e.maxDate),bV(e.yearRange)){let t=(new Date).getFullYear()-10;e.yearRange[0]=parseInt(e.yearRange[0],10)||t,e.yearRange[1]=parseInt(e.yearRange[1],10)||t}else e.yearRange=Math.abs(parseInt(e.yearRange,10))||HV.yearRange,e.yearRange>100&&(e.yearRange=100);return e},toString:function(t){return t=t||this._o.format,SV(this._d)?this._o.toString?this._o.toString(this._d,t):this.hasMoment?this.moment(this._d).format(t):this._d.toDateString():""},getMoment:function(){return this.hasMoment?this.moment(this._d):null},setMoment:function(t,e){this.hasMoment&&this.moment.isMoment(t)&&this.setDate(t.toDate(),e)},useMoment:function(t){this.hasMoment=!0,this.moment=t},getDate:function(){return SV(this._d)?new Date(this._d.getTime()):null},setDate:function(t,e){if(!t)return this._d=null,this._o.field&&(this._o.field.value="",IV(this._o.field,"change",{firedBy:this})),this.draw();if("string"==typeof t&&(t=new Date(Date.parse(t))),!SV(t))return;let n=this._o.minDate,o=this._o.maxDate;SV(n)&&t<n?t=n:SV(o)&&t>o&&(t=o),this._d=new Date(t.getTime()),TV(this._d),this.gotoDate(this._d),this._o.field&&(this._o.field.value=this.toString(),IV(this._o.field,"change",{firedBy:this})),!e&&"function"==typeof this._o.onSelect&&this._o.onSelect.call(this,this.getDate())},clear:function(){this.setDate(null)},gotoDate:function(t){let e=!0;if(SV(t)){if(this.calendars){let n=new Date(this.calendars[0].year,this.calendars[0].month,1),o=new Date(this.calendars[this.calendars.length-1].year,this.calendars[this.calendars.length-1].month,1),i=t.getTime();o.setMonth(o.getMonth()+1),o.setDate(o.getDate()-1),e=i<n.getTime()||o.getTime()<i}e&&(this.calendars=[{month:t.getMonth(),year:t.getFullYear()}],"right"===this._o.mainCalendar&&(this.calendars[0].month+=1-this._o.numberOfMonths)),this.adjustCalendars()}},adjustDate:function(t,e){let n,o=this.getDate()||new Date,i=24*parseInt(e)*60*60*1e3;"add"===t?n=new Date(o.valueOf()+i):"subtract"===t&&(n=new Date(o.valueOf()-i)),this.setDate(n)},adjustCalendars:function(){this.calendars[0]=OV(this.calendars[0]);for(let t=1;t<this._o.numberOfMonths;t++)this.calendars[t]=OV({month:this.calendars[0].month+t,year:this.calendars[0].year});this.draw()},gotoToday:function(){this.gotoDate(new Date)},gotoMonth:function(t){isNaN(t)||(this.calendars[0].month=parseInt(t,10),this.adjustCalendars())},nextMonth:function(){this.calendars[0].month++,this.adjustCalendars()},prevMonth:function(){this.calendars[0].month--,this.adjustCalendars()},gotoYear:function(t){isNaN(t)||(this.calendars[0].year=parseInt(t,10),this.adjustCalendars())},setMinDate:function(t){t instanceof Date?(TV(t),this._o.minDate=t,this._o.minYear=t.getFullYear(),this._o.minMonth=t.getMonth()):(this._o.minDate=HV.minDate,this._o.minYear=HV.minYear,this._o.minMonth=HV.minMonth,this._o.startRange=HV.startRange),this.draw()},setMaxDate:function(t){t instanceof Date?(TV(t),this._o.maxDate=t,this._o.maxYear=t.getFullYear(),this._o.maxMonth=t.getMonth()):(this._o.maxDate=HV.maxDate,this._o.maxYear=HV.maxYear,this._o.maxMonth=HV.maxMonth,this._o.endRange=HV.endRange),this.draw()},setStartRange:function(t){this._o.startRange=t},setEndRange:function(t){this._o.endRange=t},draw:function(t){if(!this._v&&!t)return;let e,n=this._o,o=n.minYear,i=n.maxYear,r=n.minMonth,s=n.maxMonth,a="";this._y<=o&&(this._y=o,!isNaN(r)&&this._m<r&&(this._m=r)),this._y>=i&&(this._y=i,!isNaN(s)&&this._m>s&&(this._m=s));for(let l=0;l<n.numberOfMonths;l++)e="pika-title-"+Math.random().toString(36).replace(/[^a-z]+/g,"").substr(0,2),a+='<div class="pika-lendar">'+WV(this,l,this.calendars[l].year,this.calendars[l].month,this.calendars[0].year,e)+this.render(this.calendars[l].year,this.calendars[l].month,e)+"</div>";this.el.innerHTML=a,n.bound&&"hidden"!==n.field.type&&mV((function(){n.trigger.focus()}),1),"function"==typeof this._o.onDraw&&this._o.onDraw(this),n.bound&&n.field.setAttribute("aria-label",n.ariaLabel)},adjustPosition:function(){let t,e,n,o,i,r,s,a,l,h,c;this._o.container||(this.el.style.position="absolute",t=this._o.trigger,e=this.el.offsetWidth,n=this.el.offsetHeight,o=gV().innerWidth||fV().documentElement.clientWidth,i=gV().innerHeight||fV().documentElement.clientHeight,r=fV().body.scrollTop||fV().documentElement.scrollTop,h=!0,c=!0,l=t.getBoundingClientRect(),s=l.left+gV().pageXOffset,a=l.bottom+gV().pageYOffset,(this._o.reposition&&s+e>o||this._o.position.indexOf("right")>-1&&s-e+t.offsetWidth>0)&&(s=s-e+t.offsetWidth,h=!1),(this._o.reposition&&a+n>i+r||this._o.position.indexOf("top")>-1&&a-n-t.offsetHeight>0)&&(a=a-n-t.offsetHeight,c=!1),s<0&&(s=0),a<0&&(a=0),this.el.style.left=s+"px",this.el.style.top=a+"px",yV(this.el,h?"left-aligned":"right-aligned"),yV(this.el,c?"bottom-aligned":"top-aligned"),CV(this.el,h?"right-aligned":"left-aligned"),CV(this.el,c?"top-aligned":"bottom-aligned"))},render:function(t,e,n){let o=this._o,i=new Date,r=MV(t,e),s=new Date(t,e,1).getDay(),a=[],l=[];TV(i),o.firstDay>0&&(s-=o.firstDay,s<0&&(s+=7));let h=0===e?11:e-1,c=11===e?0:e+1,u=0===e?t-1:t,d=11===e?t+1:t,g=MV(u,h),f=r+s,m=f;for(;m>7;)m-=7;f+=7-m;let p=!1;for(let w=0,A=0;w<f;w++){let n=new Date(t,e,w-s+1),f=!!SV(this._d)&&kV(n,this._d),m=kV(n,i),v=-1!==o.events.indexOf(n.toDateString()),y=w<s||w>=r+s,C=w-s+1,b=e,S=t,E=o.startRange&&kV(o.startRange,n),R=o.endRange&&kV(o.endRange,n),M=o.startRange&&o.endRange&&o.startRange<n&&n<o.endRange,T=o.minDate&&n<o.minDate||o.maxDate&&n>o.maxDate||o.disableWeekends&&EV(n)||o.disableDayFn&&o.disableDayFn(n);y&&(w<s?(C=g+C,b=h,S=u):(C-=r,b=c,S=d));let k={day:C,month:b,year:S,hasEvent:v,isSelected:f,isToday:m,isDisabled:T,isEmpty:y,isStartRange:E,isEndRange:R,isInRange:M,showDaysInNextAndPreviousMonths:o.showDaysInNextAndPreviousMonths,enableSelectionDaysInNextAndPreviousMonths:o.enableSelectionDaysInNextAndPreviousMonths};o.pickWholeWeek&&f&&(p=!0),l.push(NV(k)),7===++A&&(o.showWeekNumber&&l.unshift(_V(this,w-s,e,t,o.firstWeekOfYearMinDays)),a.push(BV(l,o.isRTL,o.pickWholeWeek,p)),l=[],A=0,p=!1)}return FV(o,a,n)},isVisible:function(){return this._v},show:function(){this.isVisible()||(this._v=!0,this.draw(),CV(this.el,"is-hidden"),this._o.bound&&(pV(fV(),"click",this._onClick),this.adjustPosition()),"function"==typeof this._o.onOpen&&this._o.onOpen.call(this))},hide:function(){let t=this._v;!1!==t&&(this._o.bound&&wV(fV(),"click",this._onClick),this._o.container||(this.el.style.position="static",this.el.style.left="auto",this.el.style.top="auto"),yV(this.el,"is-hidden"),this._v=!1,void 0!==t&&"function"==typeof this._o.onClose&&this._o.onClose.call(this))},destroy:function(){let t=this._o;this.hide(),wV(this.el,"mousedown",this._onMouseDown,!0),wV(this.el,"touchend",this._onMouseDown,!0),wV(this.el,"change",this._onChange),t.keyboardInput&&wV(fV(),"keydown",this._onKeyChange),t.field&&(wV(t.field,"change",this._onInputChange),t.bound&&(wV(t.trigger,"click",this._onInputClick),wV(t.trigger,"focus",this._onInputFocus),wV(t.trigger,"blur",this._onInputBlur))),this.el.parentNode&&this.el.parentNode.removeChild(this.el)}};const GV="date",QV="dateEditor";class KV extends DB{constructor(){super(...arguments),UV(this,"defaultDateFormat","DD/MM/YYYY"),UV(this,"parentDestroyed",!1),UV(this,"$datePicker",null)}static get EDITOR_TYPE(){return GV}init(){if("function"!=typeof gh)throw new Error("You need to include moment.js to your project.");if("function"!=typeof jV)throw new Error("You need to include Pikaday to your project.");super.init(),this.hot.addHook("afterDestroy",(()=>{this.parentDestroyed=!0,this.destroyElements()}))}createElements(){super.createElements(),this.datePicker=this.hot.rootDocument.createElement("DIV"),this.datePickerStyle=this.datePicker.style,this.datePickerStyle.position="absolute",this.datePickerStyle.top=0,this.datePickerStyle.left=0,this.datePickerStyle.zIndex=9999,this.datePicker.setAttribute("dir",this.hot.isRtl()?"rtl":"ltr"),cA(this.datePicker,"htDatepickerHolder"),this.hot.rootDocument.body.appendChild(this.datePicker),this.eventManager.addEventListener(this.datePicker,"mousedown",(t=>{hA(t.target,"pika-day")&&this.hideDatepicker(),t.stopPropagation()}))}destroyElements(){const t=this.datePicker.parentNode;this.$datePicker&&this.$datePicker.destroy(),t&&t.removeChild(this.datePicker)}prepare(t,e,n,o,i,r){super.prepare(t,e,n,o,i,r)}open(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;const e=this.hot.getShortcutManager().getContext("editor");super.open(),this.showDatepicker(t),e.addShortcuts([{keys:[["ArrowLeft"]],callback:()=>{this.$datePicker.adjustDate("subtract",1)}},{keys:[["ArrowRight"]],callback:()=>{this.$datePicker.adjustDate("add",1)}},{keys:[["ArrowUp"]],callback:()=>{this.$datePicker.adjustDate("subtract",7)}},{keys:[["ArrowDown"]],callback:()=>{this.$datePicker.adjustDate("add",7)}}],{group:QV})}close(){var t;this._opened=!1,null!==(t=this.$datePicker)&&void 0!==t&&t.destroy&&this.$datePicker.destroy(),this.hot._registerTimeout((()=>{this.hot._refreshBorders()})),this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(QV),super.close()}finishEditing(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];super.finishEditing(t,e)}showDatepicker(t){const e=this.TD.getBoundingClientRect(),n=this.cellProperties.dateFormat||this.defaultDateFormat,o=this.hot.view.isMouseDown(),i=!!t&&Ly(t.keyCode);let r;this.datePicker.style.display="block",this.$datePicker=new jV(this.getDatePickerConfig()),"function"==typeof this.$datePicker.useMoment&&this.$datePicker.useMoment(gh),this.$datePicker._onInputFocus=function(){},this.datePickerStyle.top=`${this.hot.rootWindow.pageYOffset+e.top+OA(this.TD)}px`;let s=this.hot.rootWindow.pageXOffset;s=this.hot.isRtl()?e.right-IA(this.datePicker):e.left,this.datePickerStyle.left=`${s}px`,this.originalValue?(r=this.originalValue,gh(r,n,!0).isValid()&&this.$datePicker.setMoment(gh(r,n),!0),this.getValue()!==this.originalValue&&this.setValue(this.originalValue),!i&&!o&&this.setValue("")):this.cellProperties.defaultDate?(r=this.cellProperties.defaultDate,gh(r,n,!0).isValid()&&this.$datePicker.setMoment(gh(r,n),!0),!i&&!o&&this.setValue("")):this.$datePicker.gotoToday()}hideDatepicker(){this.datePickerStyle.display="none",this.$datePicker.hide()}getDatePickerConfig(){const t=this.TEXTAREA,e={};this.cellProperties&&this.cellProperties.datePickerConfig&&Xv(e,this.cellProperties.datePickerConfig);const n=e.onSelect,o=e.onClose;return e.field=t,e.trigger=t,e.container=this.datePicker,e.bound=!1,e.keyboardInput=!1,e.format=e.format||this.defaultDateFormat,e.reposition=e.reposition||!1,e.isRTL=!1,e.onSelect=t=>{let e=t;isNaN(e.getTime())||(e=gh(e).format(this.cellProperties.dateFormat||this.defaultDateFormat)),this.setValue(e),n&&n()},e.onClose=()=>{this.parentDestroyed||this.finishEditing(!1),o&&o()},e}}const XV="dropdown";class qV extends cV{static get EDITOR_TYPE(){return XV}prepare(t,e,n,o,i,r){super.prepare(t,e,n,o,i,r),this.cellProperties.filter=!1,this.cellProperties.strict=!0}}aC.getSingleton().add("beforeValidate",(function(t,e,n){const o=this.getCellMeta(e,this.propToCol(n));o.editor===qV&&void 0===o.strict&&(o.filter=!1,o.strict=!0)}));const ZV="numeric";class JV extends DB{static get EDITOR_TYPE(){return ZV}}const $V="password";class tW extends DB{static get EDITOR_TYPE(){return $V}createElements(){super.createElements(),this.TEXTAREA=this.hot.rootDocument.createElement("input"),this.TEXTAREA.setAttribute("type","password"),this.TEXTAREA.setAttribute("data-hot-input",""),this.TEXTAREA.className="handsontableInput",this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,this.hot.getSettings().ariaTags&&dA(this.TEXTAREA,[Iw()]),mA(this.TEXTAREA_PARENT),this.TEXTAREA_PARENT.appendChild(this.TEXTAREA)}}const eW="ht_editor_visible",nW="selectEditor",oW="select";class iW extends yB{static get EDITOR_TYPE(){return oW}init(){this.select=this.hot.rootDocument.createElement("select"),this.select.setAttribute("data-hot-input","true"),this.select.style.display="none",cA(this.select,"htSelectEditor"),this.hot.rootElement.appendChild(this.select),this.registerHooks()}getValue(){return this.select.value}setValue(t){this.select.value=t}open(){this._opened=!0,this.refreshDimensions(),this.select.style.display="",this.hot.getShortcutManager().setActiveContextName("editor"),this.registerShortcuts()}close(){this._opened=!1,this.select.style.display="none",hA(this.select,eW)&&uA(this.select,eW),this.unregisterShortcuts(),this.clearHooks()}focus(){this.select.focus()}registerHooks(){this.addHook("afterScrollHorizontally",(()=>this.refreshDimensions())),this.addHook("afterScrollVertically",(()=>this.refreshDimensions())),this.addHook("afterColumnResize",(()=>this.refreshDimensions())),this.addHook("afterRowResize",(()=>this.refreshDimensions()))}prepare(t,e,n,o,i,r){super.prepare(t,e,n,o,i,r);const s=this.cellProperties.selectOptions;let a;a="function"==typeof s?this.prepareOptions(s(this.row,this.col,this.prop)):this.prepareOptions(s),mA(this.select),ny(a,((t,e)=>{const n=this.hot.rootDocument.createElement("OPTION");n.value=e,wA(n,t),this.select.appendChild(n)}))}prepareOptions(t){let e={};if(Array.isArray(t))for(let n=0,o=t.length;n<o;n++)e[t[n]]=t[n];else"object"==typeof t&&(e=t);return e}refreshValue(){const t=this.hot.getSourceDataAtCell(this.row,this.prop);this.originalValue=t,this.setValue(t),this.refreshDimensions()}refreshDimensions(){if(this.state!==AB.EDITING)return;if(this.TD=this.getEditedCell(),!this.TD)return void this.close();const{top:t,start:e,width:n,height:o}=this.getEditedCellRect(),i=this.select.style;i.height=`${o}px`,i.width=`${n}px`,i.top=`${t}px`,i[this.hot.isRtl()?"right":"left"]=`${e}px`,i.margin="0px",cA(this.select,eW)}registerShortcuts(){const t=this.hot.getShortcutManager(),e=t.getContext("editor"),n=t.getContext("grid"),o={group:nW};!1!==this.isInFullEditMode()&&e.addShortcuts([{keys:[["Tab"],["Shift","Tab"]],forwardToContext:n,callback:()=>{}},{keys:[["ArrowUp"]],callback:()=>{const t=this.select.selectedIndex-1;t>=0&&(this.select[t].selected=!0)}},{keys:[["ArrowDown"]],callback:()=>{const t=this.select.selectedIndex+1;t<=this.select.length-1&&(this.select[t].selected=!0)}}],o)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(nW)}}const rW="time";class sW extends DB{static get EDITOR_TYPE(){return rW}prepare(t,e,n,o,i,r){super.prepare(t,e,n,o,i,r),this.TEXTAREA.dir="ltr"}}function aW(){vC(yB),vC(cV),vC(dV),vC(KV),vC(qV),vC($L),vC(JV),vC(tW),vC(iW),vC(DB),vC(sW)}const lW="html";function hW(t,e,n,o,i,r,s){PB.apply(this,[t,e,n,o,i,r,s]),wA(e,null==r?"":r,!1)}hW.RENDERER_TYPE=lW;const cW="autocomplete";function uW(t,e,n,o,i,r,s){const{rootDocument:a}=t,l=s.allowHtml?hW:BB,h=a.createElement("DIV"),c=t.getSettings().ariaTags;if(h.className="htAutocompleteArrow",c&&h.setAttribute(...Iw()),h.appendChild(a.createTextNode(String.fromCharCode(9660))),l.apply(this,[t,e,n,o,i,r,s]),e.firstChild||e.appendChild(a.createTextNode(String.fromCharCode(160))),e.insertBefore(h,e.firstChild),cA(e,"htAutocomplete"),!t.acArrowListener){const i=new MC(t);t.acArrowListener=function(i){hA(i.target,"htAutocompleteArrow")&&t.view._wt.getSetting("onCellDblClick",null,t._createCellCoords(n,o),e)},i.addEventListener(t.rootElement,"mousedown",t.acArrowListener),t.addHookOnce("afterDestroy",(()=>{i.destroy()}))}}uW.RENDERER_TYPE=cW;const dW="dropdown";function gW(t,e,n,o,i,r,s){uW.apply(this,[t,e,n,o,i,r,s])}gW.RENDERER_TYPE=dW;const fW=new WeakMap,mW=new WeakMap,pW="htBadValue",wW="data-row",AW="data-col",vW="checkboxRenderer",yW="checkbox";function CW(t,e,n,o,i,r,s){const{rootDocument:a}=t,l=t.getSettings().ariaTags;PB.apply(this,[t,e,n,o,i,r,s]),bW(t);let h=SW(a);const c=s.label;let u=!1;if("undefined"==typeof s.checkedTemplate&&(s.checkedTemplate=!0),"undefined"==typeof s.uncheckedTemplate&&(s.uncheckedTemplate=!1),mA(e),r===s.checkedTemplate||Vp(r).toLocaleLowerCase(s.locale)===Vp(s.checkedTemplate).toLocaleLowerCase(s.locale)?h.checked=!0:r===s.uncheckedTemplate||Vp(r).toLocaleLowerCase(s.locale)===Vp(s.uncheckedTemplate).toLocaleLowerCase(s.locale)?h.checked=!1:jp(r)?cA(h,"noValue"):(h.style.display="none",cA(h,pW),u=!0),dA(h,[[wW,n],[AW,o]]),l&&dA(h,[xw(h.checked?t.getTranslatedPhrase(JH):t.getTranslatedPhrase($H)),jw(h.checked),Rw()]),!u&&c){let s="";if(c.value)s="function"==typeof c.value?c.value.call(this,n,o,i,r):c.value;else if(c.property){const e=t.getDataAtRowProp(n,c.property);s=null!==e?e:""}const l=EW(a,s,!0!==c.separated);"before"===c.position?c.separated?(e.appendChild(l),e.appendChild(h)):(l.appendChild(h),h=l):(!c.position||"after"===c.position)&&(c.separated?(e.appendChild(h),e.appendChild(l)):(l.insertBefore(h,l.firstChild),h=l))}function d(){const e=t.getShortcutManager().getContext("grid"),n={group:vW};e.addShortcuts([{keys:[["space"]],callback:()=>(g(),!f())},{keys:[["enter"]],callback:()=>(g(),!f()),runOnlyIf:()=>t.getSettings().enterBeginsEditing},{keys:[["delete"],["backspace"]],callback:()=>(g(!0),!f()),relativeToGroup:QP,position:"before"}],n)}function g(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const n=t.getSelectedRange();if(n)for(let o=0;o<n.length;o++){const{row:i,col:r}=n[o].getTopStartCorner(),{row:s,col:a}=n[o].getBottomEndCorner(),l=[];for(let n=i;n<=s;n+=1)for(let o=r;o<=a;o+=1){const i=t.getCellMeta(n,o);if("checkbox"!==i.type)return;if(!0===i.readOnly)continue;"undefined"==typeof i.checkedTemplate&&(i.checkedTemplate=!0),"undefined"==typeof i.uncheckedTemplate&&(i.uncheckedTemplate=!1);const r=t.getDataAtCell(n,o);!1===e?[i.checkedTemplate,i.checkedTemplate.toString()].includes(r)?l.push([n,o,i.uncheckedTemplate]):[i.uncheckedTemplate,i.uncheckedTemplate.toString(),null,void 0].includes(r)&&l.push([n,o,i.checkedTemplate]):l.push([n,o,i.uncheckedTemplate])}l.length>0&&t.setDataAtCell(l)}}function f(){const e=t.getSelectedRange();if(e){for(let n=0;n<e.length;n++){const o=e[n].getTopStartCorner(),i=e[n].getBottomEndCorner();for(let e=o.row;e<=i.row;e++)for(let n=o.col;n<=i.col;n++){const o=t.getCellMeta(e,n);if("checkbox"!==o.type)return!1;const i=t.getCell(e,n);if(null==i)return!0;if(i.querySelectorAll("input[type=checkbox]").length>0&&!o.readOnly)return!0}}return!1}}(!c||c&&!c.separated)&&e.appendChild(h),u&&e.appendChild(a.createTextNode("#bad-value#")),fW.has(t)||(fW.set(t,!0),d())}function bW(t){let e=mW.get(t);if(!e){const{rootElement:n}=t;e=new MC(t),e.addEventListener(n,"click",(e=>MW(e,t))),e.addEventListener(n,"mouseup",(e=>RW(e,t))),e.addEventListener(n,"change",(e=>TW(e,t))),mW.set(t,e)}return e}function SW(t){const e=t.createElement("input");return e.className="htCheckboxRendererInput",e.type="checkbox",e.setAttribute("tabindex","-1"),e.cloneNode(!1)}function EW(t,e,n){const o=t.createElement("label");return o.className="htCheckboxRendererLabel "+(n?"fullWidth":""),o.appendChild(t.createTextNode(e)),o.cloneNode(!0)}function RW(t,e){const{target:n}=t;kW(n)&&(!n.hasAttribute(wW)||!n.hasAttribute(AW)||setTimeout(e.listen,10))}function MW(t,e){const{target:n}=t;if(!kW(n)||!n.hasAttribute(wW)||!n.hasAttribute(AW))return;const o=parseInt(n.getAttribute(wW),10),i=parseInt(n.getAttribute(AW),10);e.getCellMeta(o,i).readOnly&&t.preventDefault()}function TW(t,e){const{target:n}=t;if(!kW(n)||!n.hasAttribute(wW)||!n.hasAttribute(AW))return;const o=parseInt(n.getAttribute(wW),10),i=parseInt(n.getAttribute(AW),10),r=e.getCellMeta(o,i);if(!r.readOnly){let n=null;n=t.target.checked?void 0===r.uncheckedTemplate||r.checkedTemplate:void 0!==r.uncheckedTemplate&&r.uncheckedTemplate,e.setDataAtCell(o,i,n)}}function kW(t){return"INPUT"===t.tagName&&"checkbox"===t.getAttribute("type")}aC.getSingleton().add("modifyAutoColumnSizeSeed",(function(t,e,n){const{label:o,type:i,row:r,column:s,prop:a}=e;if(i===yW){if(o){const{value:e,property:i}=o;let l=n;if(e)l="function"==typeof e?e(r,s,a,n):e;else if(i){const t=this.getDataAtRowProp(r,i);l=null!==t?t:n}t=l}return t}})),CW.RENDERER_TYPE=yW;const xW="handsontable";function IW(t,e,n,o,i,r,s){uW.apply(this,[t,e,n,o,i,r,s])}IW.RENDERER_TYPE=xW;var OW={exports:{}};(function(t,e){(function(e){t.exports=e()})((function(){return function t(e,n,o){function i(a,l){if(!n[a]){if(!e[a]){var h="function"==typeof s.c&&s.c;if(!l&&h)return h(a,!0);if(r)return r(a,!0);var c=new Error("Cannot find module '"+a+"'");throw c.code="MODULE_NOT_FOUND",c}var u=n[a]={exports:{}};e[a][0].call(u.exports,(function(t){return i(e[a][1][t]||t)}),u,u.exports,t,e,n,o)}return n[a].exports}for(var r="function"==typeof s.c&&s.c,a=0;a<o.length;a++)i(o[a]);return i}({1:[function(t,e,n){(function(t){var n,o=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,i=Math.ceil,r=Math.floor,s="[BigNumber Error] ",a=s+"Number primitive has more than 15 significant digits: ",l=1e14,h=14,c=9007199254740991,u=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],d=1e7,g=1e9;function f(t){var e=0|t;return 0<t||t===e?e:e-1}function m(t){for(var e,n,o=1,i=t.length,r=t[0]+"";o<i;){for(e=t[o++]+"",n=h-e.length;n--;e="0"+e);r+=e}for(i=r.length;48===r.charCodeAt(--i););return r.slice(0,i+1||1)}function p(t,e){var n,o,i=t.c,r=e.c,s=t.s,a=e.s,l=t.e,h=e.e;if(!s||!a)return null;if(n=i&&!i[0],o=r&&!r[0],n||o)return n?o?0:-a:s;if(s!=a)return s;if(n=s<0,o=l==h,!i||!r)return o?0:!i^n?1:-1;if(!o)return h<l^n?1:-1;for(a=(l=i.length)<(h=r.length)?l:h,s=0;s<a;s++)if(i[s]!=r[s])return i[s]>r[s]^n?1:-1;return l==h?0:h<l^n?1:-1}function w(t,e,n,o){if(t<e||n<t||t!==(t<0?i(t):r(t)))throw Error(s+(o||"Argument")+("number"==typeof t?t<e||n<t?" out of range: ":" not an integer: ":" not a primitive number: ")+String(t))}function A(t){var e=t.c.length-1;return f(t.e/h)==e&&t.c[e]%2!=0}function v(t,e){return(1<t.length?t.charAt(0)+"."+t.slice(1):t)+(e<0?"e":"e+")+e}function y(t,e,n){var o,i;if(e<0){for(i=n+".";++e;i+=n);t=i+t}else if(++e>(o=t.length)){for(i=n,e-=o;--e;i+=n);t+=i}else e<o&&(t=t.slice(0,e)+"."+t.slice(e));return t}(n=function t(e){var n,C,b,S,E,R,M,T,k,x,I=U.prototype={constructor:U,toString:null,valueOf:null},O=new U(1),H=20,D=4,N=-7,P=21,_=-1e7,B=1e7,L=!1,V=1,W=0,F={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:"Â ",suffix:""},j="0123456789abcdefghijklmnopqrstuvwxyz";function U(t,e){var n,i,s,l,u,d,g,f,m=this;if(!(m instanceof U))return new U(t,e);if(null==e){if(t instanceof U)return m.s=t.s,m.e=t.e,void(m.c=(t=t.c)?t.slice():t);if((d="number"==typeof t)&&0*t==0){if(m.s=1/t<0?(t=-t,-1):1,t===~~t){for(l=0,u=t;10<=u;u/=10,l++);return m.e=l,void(m.c=[t])}f=String(t)}else{if(f=String(t),!o.test(f))return b(m,f,d);m.s=45==f.charCodeAt(0)?(f=f.slice(1),-1):1}-1<(l=f.indexOf("."))&&(f=f.replace(".","")),0<(u=f.search(/e/i))?(l<0&&(l=u),l+=+f.slice(u+1),f=f.substring(0,u)):l<0&&(l=f.length)}else{if(w(e,2,j.length,"Base"),f=String(t),10==e)return Q(m=new U(t instanceof U?t:f),H+m.e+1,D);if(d="number"==typeof t){if(0*t!=0)return b(m,f,d,e);if(m.s=1/t<0?(f=f.slice(1),-1):1,U.DEBUG&&15<f.replace(/^0\.0*|\./,"").length)throw Error(a+t);d=!1}else m.s=45===f.charCodeAt(0)?(f=f.slice(1),-1):1;for(n=j.slice(0,e),l=u=0,g=f.length;u<g;u++)if(n.indexOf(i=f.charAt(u))<0){if("."==i){if(l<u){l=g;continue}}else if(!s&&(f==f.toUpperCase()&&(f=f.toLowerCase())||f==f.toLowerCase()&&(f=f.toUpperCase()))){s=!0,u=-1,l=0;continue}return b(m,String(t),d,e)}-1<(l=(f=C(f,e,10,m.s)).indexOf("."))?f=f.replace(".",""):l=f.length}for(u=0;48===f.charCodeAt(u);u++);for(g=f.length;48===f.charCodeAt(--g););if(f=f.slice(u,++g)){if(g-=u,d&&U.DEBUG&&15<g&&(c<t||t!==r(t)))throw Error(a+m.s*t);if(B<(l=l-u-1))m.c=m.e=null;else if(l<_)m.c=[m.e=0];else{if(m.e=l,m.c=[],u=(l+1)%h,l<0&&(u+=h),u<g){for(u&&m.c.push(+f.slice(0,u)),g-=h;u<g;)m.c.push(+f.slice(u,u+=h));f=f.slice(u),u=h-f.length}else u-=g;for(;u--;f+="0");m.c.push(+f)}}else m.c=[m.e=0]}function Y(t,e,n,o){var i,r,s,a,l;if(null==n?n=D:w(n,0,8),!t.c)return t.toString();if(i=t.c[0],s=t.e,null==e)l=m(t.c),l=1==o||2==o&&(s<=N||P<=s)?v(l,s):y(l,s,"0");else if(r=(t=Q(new U(t),e,n)).e,a=(l=m(t.c)).length,1==o||2==o&&(e<=r||r<=N)){for(;a<e;l+="0",a++);l=v(l,r)}else if(e-=s,l=y(l,r,"0"),a<r+1){if(0<--e)for(l+=".";e--;l+="0");}else if(0<(e+=r-a))for(r+1==a&&(l+=".");e--;l+="0");return t.s<0&&i?"-"+l:l}function z(t,e){for(var n,o=1,i=new U(t[0]);o<t.length;o++){if(!(n=new U(t[o])).s){i=n;break}e.call(i,n)&&(i=n)}return i}function G(t,e,n){for(var o=1,i=e.length;!e[--i];e.pop());for(i=e[0];10<=i;i/=10,o++);return(n=o+n*h-1)>B?t.c=t.e=null:t.c=n<_?[t.e=0]:(t.e=n,e),t}function Q(t,e,n,o){var s,a,c,d,g,f,m,p=t.c,w=u;if(p){t:{for(s=1,d=p[0];10<=d;d/=10,s++);if((a=e-s)<0)a+=h,c=e,m=(g=p[f=0])/w[s-c-1]%10|0;else if((f=i((a+1)/h))>=p.length){if(!o)break t;for(;p.length<=f;p.push(0));g=m=0,c=(a%=h)-h+(s=1)}else{for(g=d=p[f],s=1;10<=d;d/=10,s++);m=(c=(a%=h)-h+s)<0?0:g/w[s-c-1]%10|0}if(o=o||e<0||null!=p[f+1]||(c<0?g:g%w[s-c-1]),o=n<4?(m||o)&&(0==n||n==(t.s<0?3:2)):5<m||5==m&&(4==n||o||6==n&&(0<a?0<c?g/w[s-c]:0:p[f-1])%10&1||n==(t.s<0?8:7)),e<1||!p[0])return p.length=0,o?(e-=t.e+1,p[0]=w[(h-e%h)%h],t.e=-e||0):p[0]=t.e=0,t;if(0==a?(p.length=f,d=1,f--):(p.length=f+1,d=w[h-a],p[f]=0<c?r(g/w[s-c]%w[c])*d:0),o)for(;;){if(0==f){for(a=1,c=p[0];10<=c;c/=10,a++);for(c=p[0]+=d,d=1;10<=c;c/=10,d++);a!=d&&(t.e++,p[0]==l&&(p[0]=1));break}if(p[f]+=d,p[f]!=l)break;p[f--]=0,d=1}for(a=p.length;0===p[--a];p.pop());}t.e>B?t.c=t.e=null:t.e<_&&(t.c=[t.e=0])}return t}function K(t){var e,n=t.e;return null===n?t.toString():(e=m(t.c),e=n<=N||P<=n?v(e,n):y(e,n,"0"),t.s<0?"-"+e:e)}return U.clone=t,U.ROUND_UP=0,U.ROUND_DOWN=1,U.ROUND_CEIL=2,U.ROUND_FLOOR=3,U.ROUND_HALF_UP=4,U.ROUND_HALF_DOWN=5,U.ROUND_HALF_EVEN=6,U.ROUND_HALF_CEIL=7,U.ROUND_HALF_FLOOR=8,U.EUCLID=9,U.config=U.set=function(t){var e,n;if(null!=t){if("object"!=typeof t)throw Error(s+"Object expected: "+t);if(t.hasOwnProperty(e="DECIMAL_PLACES")&&(w(n=t[e],0,g,e),H=n),t.hasOwnProperty(e="ROUNDING_MODE")&&(w(n=t[e],0,8,e),D=n),t.hasOwnProperty(e="EXPONENTIAL_AT")&&((n=t[e])&&n.pop?(w(n[0],-g,0,e),w(n[1],0,g,e),N=n[0],P=n[1]):(w(n,-g,g,e),N=-(P=n<0?-n:n))),t.hasOwnProperty(e="RANGE"))if((n=t[e])&&n.pop)w(n[0],-g,-1,e),w(n[1],1,g,e),_=n[0],B=n[1];else{if(w(n,-g,g,e),!n)throw Error(s+e+" cannot be zero: "+n);_=-(B=n<0?-n:n)}if(t.hasOwnProperty(e="CRYPTO")){if((n=t[e])!==!!n)throw Error(s+e+" not true or false: "+n);if(n){if("undefined"==typeof crypto||!crypto||!crypto.getRandomValues&&!crypto.randomBytes)throw L=!n,Error(s+"crypto unavailable");L=n}else L=n}if(t.hasOwnProperty(e="MODULO_MODE")&&(w(n=t[e],0,9,e),V=n),t.hasOwnProperty(e="POW_PRECISION")&&(w(n=t[e],0,g,e),W=n),t.hasOwnProperty(e="FORMAT")){if("object"!=typeof(n=t[e]))throw Error(s+e+" not an object: "+n);F=n}if(t.hasOwnProperty(e="ALPHABET")){if("string"!=typeof(n=t[e])||/^.$|[+-.\s]|(.).*\1/.test(n))throw Error(s+e+" invalid: "+n);j=n}}return{DECIMAL_PLACES:H,ROUNDING_MODE:D,EXPONENTIAL_AT:[N,P],RANGE:[_,B],CRYPTO:L,MODULO_MODE:V,POW_PRECISION:W,FORMAT:F,ALPHABET:j}},U.isBigNumber=function(t){return t instanceof U||t&&!0===t._isBigNumber||!1},U.maximum=U.max=function(){return z(arguments,I.lt)},U.minimum=U.min=function(){return z(arguments,I.gt)},U.random=(S=9007199254740992,E=Math.random()*S&2097151?function(){return r(Math.random()*S)}:function(){return 8388608*(1073741824*Math.random()|0)+(8388608*Math.random()|0)},function(t){var e,n,o,a,l,c=0,d=[],f=new U(O);if(null==t?t=H:w(t,0,g),a=i(t/h),L)if(crypto.getRandomValues){for(e=crypto.getRandomValues(new Uint32Array(a*=2));c<a;)9e15<=(l=131072*e[c]+(e[c+1]>>>11))?(n=crypto.getRandomValues(new Uint32Array(2)),e[c]=n[0],e[c+1]=n[1]):(d.push(l%1e14),c+=2);c=a/2}else{if(!crypto.randomBytes)throw L=!1,Error(s+"crypto unavailable");for(e=crypto.randomBytes(a*=7);c<a;)9e15<=(l=281474976710656*(31&e[c])+1099511627776*e[c+1]+4294967296*e[c+2]+16777216*e[c+3]+(e[c+4]<<16)+(e[c+5]<<8)+e[c+6])?crypto.randomBytes(7).copy(e,c):(d.push(l%1e14),c+=7);c=a/7}if(!L)for(;c<a;)(l=E())<9e15&&(d[c++]=l%1e14);for(a=d[--c],t%=h,a&&t&&(l=u[h-t],d[c]=r(a/l)*l);0===d[c];d.pop(),c--);if(c<0)d=[o=0];else{for(o=-1;0===d[0];d.splice(0,1),o-=h);for(c=1,l=d[0];10<=l;l/=10,c++);c<h&&(o-=h-c)}return f.e=o,f.c=d,f}),U.sum=function(){for(var t=1,e=arguments,n=new U(e[0]);t<e.length;)n=n.plus(e[t++]);return n},C=function(){var t="0123456789";function e(t,e,n,o){for(var i,r,s=[0],a=0,l=t.length;a<l;){for(r=s.length;r--;s[r]*=e);for(s[0]+=o.indexOf(t.charAt(a++)),i=0;i<s.length;i++)s[i]>n-1&&(null==s[i+1]&&(s[i+1]=0),s[i+1]+=s[i]/n|0,s[i]%=n)}return s.reverse()}return function(o,i,r,s,a){var l,h,c,u,d,g,f,p,w=o.indexOf("."),A=H,v=D;for(0<=w&&(u=W,W=0,o=o.replace(".",""),g=(p=new U(i)).pow(o.length-w),W=u,p.c=e(y(m(g.c),g.e,"0"),10,r,t),p.e=p.c.length),c=u=(f=e(o,i,r,a?(l=j,t):(l=t,j))).length;0==f[--u];f.pop());if(!f[0])return l.charAt(0);if(w<0?--c:(g.c=f,g.e=c,g.s=s,f=(g=n(g,p,A,v,r)).c,d=g.r,c=g.e),w=f[h=c+A+1],u=r/2,d=d||h<0||null!=f[h+1],d=v<4?(null!=w||d)&&(0==v||v==(g.s<0?3:2)):u<w||w==u&&(4==v||d||6==v&&1&f[h-1]||v==(g.s<0?8:7)),h<1||!f[0])o=d?y(l.charAt(1),-A,l.charAt(0)):l.charAt(0);else{if(f.length=h,d)for(--r;++f[--h]>r;)f[h]=0,h||(++c,f=[1].concat(f));for(u=f.length;!f[--u];);for(w=0,o="";w<=u;o+=l.charAt(f[w++]));o=y(o,c,l.charAt(0))}return o}}(),n=function(){function t(t,e,n){var o,i,r,s,a=0,l=t.length,h=e%d,c=e/d|0;for(t=t.slice();l--;)a=((i=h*(r=t[l]%d)+(o=c*r+(s=t[l]/d|0)*h)%d*d+a)/n|0)+(o/d|0)+c*s,t[l]=i%n;return a&&(t=[a].concat(t)),t}function e(t,e,n,o){var i,r;if(n!=o)r=o<n?1:-1;else for(i=r=0;i<n;i++)if(t[i]!=e[i]){r=t[i]>e[i]?1:-1;break}return r}function n(t,e,n,o){for(var i=0;n--;)t[n]-=i,i=t[n]<e[n]?1:0,t[n]=i*o+t[n]-e[n];for(;!t[0]&&1<t.length;t.splice(0,1));}return function(o,i,s,a,c){var u,d,g,m,p,w,A,v,y,C,b,S,E,R,M,T,k,x=o.s==i.s?1:-1,I=o.c,O=i.c;if(!(I&&I[0]&&O&&O[0]))return new U(o.s&&i.s&&(I?!O||I[0]!=O[0]:O)?I&&0==I[0]||!O?0*x:x/0:NaN);for(y=(v=new U(x)).c=[],x=s+(d=o.e-i.e)+1,c||(c=l,d=f(o.e/h)-f(i.e/h),x=x/h|0),g=0;O[g]==(I[g]||0);g++);if(O[g]>(I[g]||0)&&d--,x<0)y.push(1),m=!0;else{for(R=I.length,T=O.length,x+=2,1<(p=r(c/(O[g=0]+1)))&&(O=t(O,p,c),I=t(I,p,c),T=O.length,R=I.length),E=T,b=(C=I.slice(0,T)).length;b<T;C[b++]=0);k=O.slice(),k=[0].concat(k),M=O[0],O[1]>=c/2&&M++;do{if(p=0,(u=e(O,C,T,b))<0){if(S=C[0],T!=b&&(S=S*c+(C[1]||0)),1<(p=r(S/M)))for(c<=p&&(p=c-1),A=(w=t(O,p,c)).length,b=C.length;1==e(w,C,A,b);)p--,n(w,T<A?k:O,A,c),A=w.length,u=1;else 0==p&&(u=p=1),A=(w=O.slice()).length;if(A<b&&(w=[0].concat(w)),n(C,w,b,c),b=C.length,-1==u)for(;e(O,C,T,b)<1;)p++,n(C,T<b?k:O,b,c),b=C.length}else 0===u&&(p++,C=[0]);y[g++]=p,C[0]?C[b++]=I[E]||0:(C=[I[E]],b=1)}while((E++<R||null!=C[0])&&x--);m=null!=C[0],y[0]||y.splice(0,1)}if(c==l){for(g=1,x=y[0];10<=x;x/=10,g++);Q(v,s+(v.e=g+d*h-1)+1,a,m)}else v.e=d,v.r=+m;return v}}(),R=/^(-?)0([xbo])(?=\w[\w.]*$)/i,M=/^([^.]+)\.$/,T=/^\.([^.]+)$/,k=/^-?(Infinity|NaN)$/,x=/^\s*\+(?=[\w.])|^\s+|\s+$/g,b=function(t,e,n,o){var i,r=n?e:e.replace(x,"");if(k.test(r))t.s=isNaN(r)?null:r<0?-1:1,t.c=t.e=null;else{if(!n&&(r=r.replace(R,(function(t,e,n){return i="x"==(n=n.toLowerCase())?16:"b"==n?2:8,o&&o!=i?t:e})),o&&(i=o,r=r.replace(M,"$1").replace(T,"0.$1")),e!=r))return new U(r,i);if(U.DEBUG)throw Error(s+"Not a"+(o?" base "+o:"")+" number: "+e);t.c=t.e=t.s=null}},I.absoluteValue=I.abs=function(){var t=new U(this);return t.s<0&&(t.s=1),t},I.comparedTo=function(t,e){return p(this,new U(t,e))},I.decimalPlaces=I.dp=function(t,e){var n,o,i;if(null!=t)return w(t,0,g),null==e?e=D:w(e,0,8),Q(new U(this),t+this.e+1,e);if(!(n=this.c))return null;if(o=((i=n.length-1)-f(this.e/h))*h,i=n[i])for(;i%10==0;i/=10,o--);return o<0&&(o=0),o},I.dividedBy=I.div=function(t,e){return n(this,new U(t,e),H,D)},I.dividedToIntegerBy=I.idiv=function(t,e){return n(this,new U(t,e),0,1)},I.exponentiatedBy=I.pow=function(t,e){var n,o,a,l,c,u,d,g,f=this;if((t=new U(t)).c&&!t.isInteger())throw Error(s+"Exponent not an integer: "+K(t));if(null!=e&&(e=new U(e)),c=14<t.e,!f.c||!f.c[0]||1==f.c[0]&&!f.e&&1==f.c.length||!t.c||!t.c[0])return g=new U(Math.pow(+K(f),c?2-A(t):+K(t))),e?g.mod(e):g;if(u=t.s<0,e){if(e.c?!e.c[0]:!e.s)return new U(NaN);(o=!u&&f.isInteger()&&e.isInteger())&&(f=f.mod(e))}else{if(9<t.e&&(0<f.e||f.e<-1||(0==f.e?1<f.c[0]||c&&24e7<=f.c[1]:f.c[0]<8e13||c&&f.c[0]<=9999975e7)))return l=f.s<0&&A(t)?-0:0,-1<f.e&&(l=1/l),new U(u?1/l:l);W&&(l=i(W/h+2))}for(d=c?(n=new U(.5),u&&(t.s=1),A(t)):(a=Math.abs(+K(t)))%2,g=new U(O);;){if(d){if(!(g=g.times(f)).c)break;l?g.c.length>l&&(g.c.length=l):o&&(g=g.mod(e))}if(a){if(0===(a=r(a/2)))break;d=a%2}else if(Q(t=t.times(n),t.e+1,1),14<t.e)d=A(t);else{if(0==(a=+K(t)))break;d=a%2}f=f.times(f),l?f.c&&f.c.length>l&&(f.c.length=l):o&&(f=f.mod(e))}return o?g:(u&&(g=O.div(g)),e?g.mod(e):l?Q(g,W,D,void 0):g)},I.integerValue=function(t){var e=new U(this);return null==t?t=D:w(t,0,8),Q(e,e.e+1,t)},I.isEqualTo=I.eq=function(t,e){return 0===p(this,new U(t,e))},I.isFinite=function(){return!!this.c},I.isGreaterThan=I.gt=function(t,e){return 0<p(this,new U(t,e))},I.isGreaterThanOrEqualTo=I.gte=function(t,e){return 1===(e=p(this,new U(t,e)))||0===e},I.isInteger=function(){return!!this.c&&f(this.e/h)>this.c.length-2},I.isLessThan=I.lt=function(t,e){return p(this,new U(t,e))<0},I.isLessThanOrEqualTo=I.lte=function(t,e){return-1===(e=p(this,new U(t,e)))||0===e},I.isNaN=function(){return!this.s},I.isNegative=function(){return this.s<0},I.isPositive=function(){return 0<this.s},I.isZero=function(){return!!this.c&&0==this.c[0]},I.minus=function(t,e){var n,o,i,r,s=this,a=s.s;if(e=(t=new U(t,e)).s,!a||!e)return new U(NaN);if(a!=e)return t.s=-e,s.plus(t);var c=s.e/h,u=t.e/h,d=s.c,g=t.c;if(!c||!u){if(!d||!g)return d?(t.s=-e,t):new U(g?s:NaN);if(!d[0]||!g[0])return g[0]?(t.s=-e,t):new U(d[0]?s:3==D?-0:0)}if(c=f(c),u=f(u),d=d.slice(),a=c-u){for((i=(r=a<0)?(a=-a,d):(u=c,g)).reverse(),e=a;e--;i.push(0));i.reverse()}else for(o=(r=(a=d.length)<(e=g.length))?a:e,a=e=0;e<o;e++)if(d[e]!=g[e]){r=d[e]<g[e];break}if(r&&(i=d,d=g,g=i,t.s=-t.s),0<(e=(o=g.length)-(n=d.length)))for(;e--;d[n++]=0);for(e=l-1;a<o;){if(d[--o]<g[o]){for(n=o;n&&!d[--n];d[n]=e);--d[n],d[o]+=l}d[o]-=g[o]}for(;0==d[0];d.splice(0,1),--u);return d[0]?G(t,d,u):(t.s=3==D?-1:1,t.c=[t.e=0],t)},I.modulo=I.mod=function(t,e){var o,i,r=this;return t=new U(t,e),!r.c||!t.s||t.c&&!t.c[0]?new U(NaN):!t.c||r.c&&!r.c[0]?new U(r):(9==V?(i=t.s,t.s=1,o=n(r,t,0,3),t.s=i,o.s*=i):o=n(r,t,0,V),(t=r.minus(o.times(t))).c[0]||1!=V||(t.s=r.s),t)},I.multipliedBy=I.times=function(t,e){var n,o,i,r,s,a,c,u,g,m,p,w,A,v,y,C=this,b=C.c,S=(t=new U(t,e)).c;if(!(b&&S&&b[0]&&S[0]))return!C.s||!t.s||b&&!b[0]&&!S||S&&!S[0]&&!b?t.c=t.e=t.s=null:(t.s*=C.s,b&&S?(t.c=[0],t.e=0):t.c=t.e=null),t;for(o=f(C.e/h)+f(t.e/h),t.s*=C.s,(c=b.length)<(m=S.length)&&(A=b,b=S,S=A,i=c,c=m,m=i),i=c+m,A=[];i--;A.push(0));for(v=l,y=d,i=m;0<=--i;){for(n=0,p=S[i]%y,w=S[i]/y|0,r=i+(s=c);i<r;)n=((u=p*(u=b[--s]%y)+(a=w*u+(g=b[s]/y|0)*p)%y*y+A[r]+n)/v|0)+(a/y|0)+w*g,A[r--]=u%v;A[r]=n}return n?++o:A.splice(0,1),G(t,A,o)},I.negated=function(){var t=new U(this);return t.s=-t.s||null,t},I.plus=function(t,e){var n,o=this,i=o.s;if(e=(t=new U(t,e)).s,!i||!e)return new U(NaN);if(i!=e)return t.s=-e,o.minus(t);var r=o.e/h,s=t.e/h,a=o.c,c=t.c;if(!r||!s){if(!a||!c)return new U(i/0);if(!a[0]||!c[0])return c[0]?t:new U(a[0]?o:0*i)}if(r=f(r),s=f(s),a=a.slice(),i=r-s){for((n=0<i?(s=r,c):(i=-i,a)).reverse();i--;n.push(0));n.reverse()}for((i=a.length)-(e=c.length)<0&&(n=c,c=a,a=n,e=i),i=0;e;)i=(a[--e]=a[e]+c[e]+i)/l|0,a[e]=l===a[e]?0:a[e]%l;return i&&(a=[i].concat(a),++s),G(t,a,s)},I.precision=I.sd=function(t,e){var n,o,i;if(null!=t&&t!==!!t)return w(t,1,g),null==e?e=D:w(e,0,8),Q(new U(this),t,e);if(!(n=this.c))return null;if(o=(i=n.length-1)*h+1,i=n[i]){for(;i%10==0;i/=10,o--);for(i=n[0];10<=i;i/=10,o++);}return t&&this.e+1>o&&(o=this.e+1),o},I.shiftedBy=function(t){return w(t,-c,c),this.times("1e"+t)},I.squareRoot=I.sqrt=function(){var t,e,o,i,r,s=this,a=s.c,l=s.s,h=s.e,c=H+4,u=new U("0.5");if(1!==l||!a||!a[0])return new U(!l||l<0&&(!a||a[0])?NaN:a?s:1/0);if((o=0==(l=Math.sqrt(+K(s)))||l==1/0?(((e=m(a)).length+h)%2==0&&(e+="0"),l=Math.sqrt(+e),h=f((h+1)/2)-(h<0||h%2),new U(e=l==1/0?"1e"+h:(e=l.toExponential()).slice(0,e.indexOf("e")+1)+h)):new U(l+"")).c[0])for((l=(h=o.e)+c)<3&&(l=0);;)if(r=o,o=u.times(r.plus(n(s,r,c,1))),m(r.c).slice(0,l)===(e=m(o.c)).slice(0,l)){if(o.e<h&&--l,"9999"!=(e=e.slice(l-3,l+1))&&(i||"4999"!=e)){+e&&(+e.slice(1)||"5"!=e.charAt(0))||(Q(o,o.e+H+2,1),t=!o.times(o).eq(s));break}if(!i&&(Q(r,r.e+H+2,0),r.times(r).eq(s))){o=r;break}c+=4,l+=4,i=1}return Q(o,o.e+H+1,D,t)},I.toExponential=function(t,e){return null!=t&&(w(t,0,g),t++),Y(this,t,e,1)},I.toFixed=function(t,e){return null!=t&&(w(t,0,g),t=t+this.e+1),Y(this,t,e)},I.toFormat=function(t,e,n){var o;if(null==n)null!=t&&e&&"object"==typeof e?(n=e,e=null):t&&"object"==typeof t?(n=t,t=e=null):n=F;else if("object"!=typeof n)throw Error(s+"Argument not an object: "+n);if(o=this.toFixed(t,e),this.c){var i,r=o.split("."),a=+n.groupSize,l=+n.secondaryGroupSize,h=n.groupSeparator||"",c=r[0],u=r[1],d=this.s<0,g=d?c.slice(1):c,f=g.length;if(l&&(i=a,a=l,f-=l=i),0<a&&0<f){for(i=f%a||a,c=g.substr(0,i);i<f;i+=a)c+=h+g.substr(i,a);0<l&&(c+=h+g.slice(i)),d&&(c="-"+c)}o=u?c+(n.decimalSeparator||"")+((l=+n.fractionGroupSize)?u.replace(new RegExp("\\d{"+l+"}\\B","g"),"$&"+(n.fractionGroupSeparator||"")):u):c}return(n.prefix||"")+o+(n.suffix||"")},I.toFraction=function(t){var e,o,i,r,a,l,c,d,g,f,p,w,A=this,v=A.c;if(null!=t&&(!(c=new U(t)).isInteger()&&(c.c||1!==c.s)||c.lt(O)))throw Error(s+"Argument "+(c.isInteger()?"out of range: ":"not an integer: ")+K(c));if(!v)return new U(A);for(e=new U(O),g=o=new U(O),i=d=new U(O),w=m(v),a=e.e=w.length-A.e-1,e.c[0]=u[(l=a%h)<0?h+l:l],t=!t||0<c.comparedTo(e)?0<a?e:g:c,l=B,B=1/0,c=new U(w),d.c[0]=0;f=n(c,e,0,1),1!=(r=o.plus(f.times(i))).comparedTo(t);)o=i,i=r,g=d.plus(f.times(r=g)),d=r,e=c.minus(f.times(r=e)),c=r;return r=n(t.minus(o),i,0,1),d=d.plus(r.times(g)),o=o.plus(r.times(i)),d.s=g.s=A.s,p=n(g,i,a*=2,D).minus(A).abs().comparedTo(n(d,o,a,D).minus(A).abs())<1?[g,i]:[d,o],B=l,p},I.toNumber=function(){return+K(this)},I.toPrecision=function(t,e){return null!=t&&w(t,1,g),Y(this,t,e,2)},I.toString=function(t){var e,n=this,o=n.s,i=n.e;return null===i?o?(e="Infinity",o<0&&(e="-"+e)):e="NaN":(e=null==t?i<=N||P<=i?v(m(n.c),i):y(m(n.c),i,"0"):10===t?y(m((n=Q(new U(n),H+i+1,D)).c),n.e,"0"):(w(t,2,j.length,"Base"),C(y(m(n.c),i,"0"),10,t,o,!0)),o<0&&n.c[0]&&(e="-"+e)),e},I.valueOf=I.toJSON=function(){return K(this)},I._isBigNumber=!0,"function"==typeof Symbol&&"symbol"==typeof Symbol.iterator&&(I[Symbol.toStringTag]="BigNumber",I[Symbol.for("nodejs.util.inspect.custom")]=I.valueOf),null!=e&&U.set(e),U}()).default=n.BigNumber=n,void 0!==e&&e.exports?e.exports=n:(t||(t="undefined"!=typeof self&&self?self:window),t.BigNumber=n)})(this)},{}],2:[function(t,e,n){e.exports={languageTag:"en-US",delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},spaceSeparated:!1,ordinal:function(t){var e=t%10;return 1==~~(t%100/10)?"th":1===e?"st":2===e?"nd":3===e?"rd":"th"},currency:{symbol:"$",position:"prefix",code:"USD"},currencyFormat:{thousandSeparated:!0,totalLength:4,spaceSeparated:!0},formats:{fourDigits:{totalLength:4,spaceSeparated:!0},fullWithTwoDecimals:{output:"currency",thousandSeparated:!0,mantissa:2},fullWithTwoDecimalsNoCurrency:{thousandSeparated:!0,mantissa:2},fullWithNoDecimals:{output:"currency",thousandSeparated:!0,mantissa:0}}}},{}],3:[function(t,e,n){function o(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],o=!0,i=!1,r=void 0;try{for(var s,a=t[Symbol.iterator]();!(o=(s=a.next()).done)&&(n.push(s.value),!e||n.length!==e);o=!0);}catch(l){i=!0,r=l}finally{try{o||null==a.return||a.return()}finally{if(i)throw r}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var i=t("./globalState"),r=t("./validating"),s=t("./parsing"),a=["B","KB","MB","GB","TB","PB","EB","ZB","YB"],l={general:{scale:1024,suffixes:a,marker:"bd"},binary:{scale:1024,suffixes:["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],marker:"b"},decimal:{scale:1e3,suffixes:a,marker:"d"}},h={totalLength:0,characteristic:0,forceAverage:!1,average:!1,mantissa:-1,optionalMantissa:!0,thousandSeparated:!1,spaceSeparated:!1,negative:"sign",forceSign:!1};function c(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},n=2<arguments.length?arguments[2]:void 0;if("string"==typeof e&&(e=s.parseFormat(e)),!r.validateFormat(e))return"ERROR: invalid format";var o=e.prefix||"",a=e.postfix||"",c=function(t,e,n){switch(e.output){case"currency":return e=m(e,i.currentCurrencyDefaultFormat()),function(t,e,n){var o=n.currentCurrency(),i=Object.assign({},h,e),r=void 0,s="",a=!!i.totalLength||!!i.forceAverage||i.average,l=e.currencyPosition||o.position,c=e.currencySymbol||o.symbol;i.spaceSeparated&&(s=" "),"infix"===l&&(r=s+c+s);var u=f({instance:t,providedFormat:e,state:n,decimalSeparator:r});return"prefix"===l&&(u=t._value<0&&"sign"===i.negative?"-".concat(s).concat(c).concat(u.slice(1)):c+s+u),l&&"postfix"!==l||(u=u+(s=a?"":s)+c),u}(t,e,i);case"percent":return e=m(e,i.currentPercentageDefaultFormat()),function(t,e,n,o){var i=e.prefixSymbol,r=f({instance:o(100*t._value),providedFormat:e,state:n}),s=Object.assign({},h,e);return i?"%".concat(s.spaceSeparated?" ":"").concat(r):"".concat(r).concat(s.spaceSeparated?" ":"","%")}(t,e,i,n);case"byte":return e=m(e,i.currentByteDefaultFormat()),y=t,b=i,S=n,E=(C=e).base||"binary",R=l[E],M=u(y._value,R.suffixes,R.scale),T=M.value,k=M.suffix,x=f({instance:S(T),providedFormat:C,state:b,defaults:b.currentByteDefaultFormat()}),I=b.currentAbbreviations(),"".concat(x).concat(I.spaced?" ":"").concat(k);case"time":return e=m(e,i.currentTimeDefaultFormat()),p=t,w=Math.floor(p._value/60/60),A=Math.floor((p._value-60*w*60)/60),v=Math.round(p._value-60*w*60-60*A),"".concat(w,":").concat(A<10?"0":"").concat(A,":").concat(v<10?"0":"").concat(v);case"ordinal":return e=m(e,i.currentOrdinalDefaultFormat()),o=t,r=e,a=(s=i).currentOrdinal(),c=Object.assign({},h,r),d=f({instance:o,providedFormat:r,state:s}),g=a(o._value),"".concat(d).concat(c.spaceSeparated?" ":"").concat(g);case"number":default:return f({instance:t,providedFormat:e,numbro:n})}var o,r,s,a,c,d,g,p,w,A,v,y,C,b,S,E,R,M,T,k,x,I}(t,e,n);return(c=o+c)+a}function u(t,e,n){var o=e[0],i=Math.abs(t);if(n<=i){for(var r=1;r<e.length;++r){var s=Math.pow(n,r),a=Math.pow(n,r+1);if(s<=i&&i<a){o=e[r],t/=s;break}}o===e[0]&&(t/=Math.pow(n,e.length-1),o=e[e.length-1])}return{value:t,suffix:o}}function d(t){for(var e="",n=0;n<t;n++)e+="0";return e}function g(t,e){return-1!==t.toString().indexOf("e")?function(t,e){var n=t.toString(),i=o(n.split("e"),2),r=i[0],s=i[1],a=o(r.split("."),2),l=a[0],h=a[1],c=void 0===h?"":h;if(0<+s)n=l+c+d(s-c.length);else{var u=".";u=+l<0?"-0".concat(u):"0".concat(u);var g=(d(-s-1)+Math.abs(l)+c).substr(0,e);g.length<e&&(g+=d(e-g.length)),n=u+g}return 0<+s&&0<e&&(n+=".".concat(d(e))),n}(t,e):(Math.round(+"".concat(t,"e+").concat(e))/Math.pow(10,e)).toFixed(e)}function f(t){var e=t.instance,n=t.providedFormat,r=t.state,s=void 0===r?i:r,a=t.decimalSeparator,l=t.defaults,c=void 0===l?s.currentDefaults():l,u=e._value;if(0===u&&s.hasZeroFormat())return s.getZeroFormat();if(!isFinite(u))return u.toString();var d,f,m,p,w,A,v,y,C=Object.assign({},h,c,n),b=C.totalLength,S=b?0:C.characteristic,E=C.optionalCharacteristic,R=C.forceAverage,M=!!b||!!R||C.average,T=b?-1:M&&void 0===n.mantissa?0:C.mantissa,k=!b&&(void 0===n.optionalMantissa?-1===T:C.optionalMantissa),x=C.trimMantissa,I=C.thousandSeparated,O=C.spaceSeparated,H=C.negative,D=C.forceSign,N=C.exponential,P="";if(M){var _=function(t){var e=t.value,n=t.forceAverage,o=t.abbreviations,i=t.spaceSeparated,r=void 0!==i&&i,s=t.totalLength,a=void 0===s?0:s,l="",h=Math.abs(e),c=-1;if(h>=Math.pow(10,12)&&!n||"trillion"===n?(l=o.trillion,e/=Math.pow(10,12)):h<Math.pow(10,12)&&h>=Math.pow(10,9)&&!n||"billion"===n?(l=o.billion,e/=Math.pow(10,9)):h<Math.pow(10,9)&&h>=Math.pow(10,6)&&!n||"million"===n?(l=o.million,e/=Math.pow(10,6)):(h<Math.pow(10,6)&&h>=Math.pow(10,3)&&!n||"thousand"===n)&&(l=o.thousand,e/=Math.pow(10,3)),l&&(l=(r?" ":"")+l),a){var u=e.toString().split(".")[0];c=Math.max(a-u.length,0)}return{value:e,abbreviation:l,mantissaPrecision:c}}({value:u,forceAverage:R,abbreviations:s.currentAbbreviations(),spaceSeparated:O,totalLength:b});u=_.value,P+=_.abbreviation,b&&(T=_.mantissaPrecision)}if(N){var B=(f=(d={value:u,characteristicPrecision:S}).value,m=d.characteristicPrecision,p=void 0===m?0:m,w=o(f.toExponential().split("e"),2),A=w[0],v=w[1],y=+A,p&&1<p&&(y*=Math.pow(10,p-1),v=0<=(v=+v-(p-1))?"+".concat(v):v),{value:y,abbreviation:"e".concat(v)});u=B.value,P=B.abbreviation+P}var L,V,W,F=function(t,e,n,i,r){if(-1===i)return t;var s=g(e,i),a=o(s.toString().split("."),2),l=a[0],h=a[1],c=void 0===h?"":h;if(c.match(/^0+$/)&&(n||r))return l;var u=c.match(/0+$/);return r&&u?"".concat(l,".").concat(c.toString().slice(0,u.index)):s.toString()}(u.toString(),u,k,T,x);return F=function(t,e,n,o,i){var r=o.currentDelimiters(),s=r.thousands;i=i||r.decimal;var a=r.thousandsSize||3,l=t.toString(),h=l.split(".")[0],c=l.split(".")[1];return n&&(e<0&&(h=h.slice(1)),function(t,e){for(var n=[],o=0,i=t;0<i;i--)o===e&&(n.unshift(i),o=0),o++;return n}(h.length,a).forEach((function(t,e){h=h.slice(0,t+e)+s+h.slice(t+e)})),e<0&&(h="-".concat(h))),c?h+i+c:h}(F=function(t,e,n,i){var r=t,s=o(r.toString().split("."),2),a=s[0],l=s[1];if(a.match(/^-?0$/)&&n)return l?"".concat(a.replace("0",""),".").concat(l):a.replace("0","");if(a.length<i)for(var h=i-a.length,c=0;c<h;c++)r="0".concat(r);return r.toString()}(F,0,E,S),u,I,s,a),(M||N)&&(F+=P),(D||u<0)&&(L=F,W=H,F=0===(V=u)?L:0==+L?L.replace("-",""):0<V?"+".concat(L):"sign"===W?L:"(".concat(L.replace("-",""),")")),F}function m(t,e){if(!t)return e;var n=Object.keys(t);return 1===n.length&&"output"===n[0]?e:t}e.exports=function(t){return{format:function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return c.apply(void 0,n.concat([t]))},getByteUnit:function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return function(t){var e=l.general;return u(t._value,e.suffixes,e.scale).suffix}.apply(void 0,n.concat([t]))},getBinaryByteUnit:function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return function(t){var e=l.binary;return u(t._value,e.suffixes,e.scale).suffix}.apply(void 0,n.concat([t]))},getDecimalByteUnit:function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return function(t){var e=l.decimal;return u(t._value,e.suffixes,e.scale).suffix}.apply(void 0,n.concat([t]))},formatOrDefault:m}}},{"./globalState":4,"./parsing":8,"./validating":10}],4:[function(t,e,n){var o=t("./en-US"),i=t("./validating"),r=t("./parsing"),s={},a=void 0,l={},h=null,c={};function u(t){a=t}function d(){return l[a]}s.languages=function(){return Object.assign({},l)},s.currentLanguage=function(){return a},s.currentCurrency=function(){return d().currency},s.currentAbbreviations=function(){return d().abbreviations},s.currentDelimiters=function(){return d().delimiters},s.currentOrdinal=function(){return d().ordinal},s.currentDefaults=function(){return Object.assign({},d().defaults,c)},s.currentOrdinalDefaultFormat=function(){return Object.assign({},s.currentDefaults(),d().ordinalFormat)},s.currentByteDefaultFormat=function(){return Object.assign({},s.currentDefaults(),d().byteFormat)},s.currentPercentageDefaultFormat=function(){return Object.assign({},s.currentDefaults(),d().percentageFormat)},s.currentCurrencyDefaultFormat=function(){return Object.assign({},s.currentDefaults(),d().currencyFormat)},s.currentTimeDefaultFormat=function(){return Object.assign({},s.currentDefaults(),d().timeFormat)},s.setDefaults=function(t){t=r.parseFormat(t),i.validateFormat(t)&&(c=t)},s.getZeroFormat=function(){return h},s.setZeroFormat=function(t){return h="string"==typeof t?t:null},s.hasZeroFormat=function(){return null!==h},s.languageData=function(t){if(t){if(l[t])return l[t];throw new Error('Unknown tag "'.concat(t,'"'))}return d()},s.registerLanguage=function(t){var e=1<arguments.length&&void 0!==arguments[1]&&arguments[1];if(!i.validateLanguage(t))throw new Error("Invalid language data");l[t.languageTag]=t,e&&u(t.languageTag)},s.setLanguage=function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:o.languageTag;if(!l[t]){var n=t.split("-")[0],i=Object.keys(l).find((function(t){return t.split("-")[0]===n}));return l[i]?void u(i):void u(e)}u(t)},s.registerLanguage(o),a=o.languageTag,e.exports=s},{"./en-US":2,"./parsing":8,"./validating":10}],5:[function(t,e,n){e.exports=function(e){return{loadLanguagesInNode:function(n){return o=e,void n.forEach((function(e){var n=void 0;try{n=t("../languages/".concat(e))}catch(i){console.error('Unable to load "'.concat(e,'". No matching language file found.'))}n&&o.registerLanguage(n)}));var o}}}},{}],6:[function(t,e,n){var o=t("bignumber.js");function i(t,e,n){var i=new o(t._value),r=e;return n.isNumbro(e)&&(r=e._value),r=new o(r),t._value=i.minus(r).toNumber(),t}e.exports=function(t){return{add:function(e,n){return r=n,s=t,a=new o((i=e)._value),l=r,s.isNumbro(r)&&(l=r._value),l=new o(l),i._value=a.plus(l).toNumber(),i;var i,r,s,a,l},subtract:function(e,n){return i(e,n,t)},multiply:function(e,n){return r=n,s=t,a=new o((i=e)._value),l=r,s.isNumbro(r)&&(l=r._value),l=new o(l),i._value=a.times(l).toNumber(),i;var i,r,s,a,l},divide:function(e,n){return r=n,s=t,a=new o((i=e)._value),l=r,s.isNumbro(r)&&(l=r._value),l=new o(l),i._value=a.dividedBy(l).toNumber(),i;var i,r,s,a,l},set:function(e,n){return o=e,r=i=n,t.isNumbro(i)&&(r=i._value),o._value=r,o;var o,i,r},difference:function(e,n){return o=n,i(s=(r=t)(e._value),o,r),Math.abs(s._value);var o,r,s}}}},{"bignumber.js":1}],7:[function(t,e,n){function o(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}var i=t("./globalState"),r=t("./validating"),s=t("./loading")(g),a=t("./unformatting"),l=t("./formatting")(g),h=t("./manipulating")(g),c=t("./parsing"),u=function(){function t(e){(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,t),this._value=e}var e,n;return e=t,(n=[{key:"clone",value:function(){return g(this._value)}},{key:"format",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return l.format(this,t)}},{key:"formatCurrency",value:function(t){return"string"==typeof t&&(t=c.parseFormat(t)),(t=l.formatOrDefault(t,i.currentCurrencyDefaultFormat())).output="currency",l.format(this,t)}},{key:"formatTime",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return t.output="time",l.format(this,t)}},{key:"binaryByteUnits",value:function(){return l.getBinaryByteUnit(this)}},{key:"decimalByteUnits",value:function(){return l.getDecimalByteUnit(this)}},{key:"byteUnits",value:function(){return l.getByteUnit(this)}},{key:"difference",value:function(t){return h.difference(this,t)}},{key:"add",value:function(t){return h.add(this,t)}},{key:"subtract",value:function(t){return h.subtract(this,t)}},{key:"multiply",value:function(t){return h.multiply(this,t)}},{key:"divide",value:function(t){return h.divide(this,t)}},{key:"set",value:function(t){return h.set(this,d(t))}},{key:"value",value:function(){return this._value}},{key:"valueOf",value:function(){return this._value}}])&&o(e.prototype,n),t}();function d(t){var e=t;return g.isNumbro(t)?e=t._value:"string"==typeof t?e=g.unformat(t):isNaN(t)&&(e=NaN),e}function g(t){return new u(d(t))}g.version="2.1.2",g.isNumbro=function(t){return t instanceof u},g.language=i.currentLanguage,g.registerLanguage=i.registerLanguage,g.setLanguage=i.setLanguage,g.languages=i.languages,g.languageData=i.languageData,g.zeroFormat=i.setZeroFormat,g.defaultFormat=i.currentDefaults,g.setDefaults=i.setDefaults,g.defaultCurrencyFormat=i.currentCurrencyDefaultFormat,g.validate=r.validate,g.loadLanguagesInNode=s.loadLanguagesInNode,g.unformat=a.unformat,e.exports=g},{"./formatting":3,"./globalState":4,"./loading":5,"./manipulating":6,"./parsing":8,"./unformatting":9,"./validating":10}],8:[function(t,e,n){e.exports={parseFormat:function(t){var e,n,o,i,r,s,a,l,h,c,u,d,g,f,m,p,w,A,v,y,C=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return"string"!=typeof t?t:(n=C,t=(o=(e=t).match(/^{([^}]*)}/))?(n.prefix=o[1],e.slice(o[0].length)):e,r=C,function(t,e){if(-1===t.indexOf("$")){if(-1===t.indexOf("%"))return-1!==t.indexOf("bd")?(e.output="byte",e.base="general"):-1!==t.indexOf("b")?(e.output="byte",e.base="binary"):-1!==t.indexOf("d")?(e.output="byte",e.base="decimal"):-1===t.indexOf(":")?-1!==t.indexOf("o")&&(e.output="ordinal"):e.output="time";e.output="percent"}else e.output="currency"}(t=(s=(i=t).match(/{([^}]*)}$/))?(r.postfix=s[1],i.slice(0,-s[0].length)):i,C),a=C,(l=t.match(/[1-9]+[0-9]*/))&&(a.totalLength=+l[0]),h=C,(c=t.split(".")[0].match(/0+/))&&(h.characteristic=c[0].length),function(t,e){if(-1!==t.indexOf(".")){var n=t.split(".")[0];e.optionalCharacteristic=-1===n.indexOf("0")}}(t,C),u=C,-1!==t.indexOf("a")&&(u.average=!0),g=C,-1!==(d=t).indexOf("K")?g.forceAverage="thousand":-1!==d.indexOf("M")?g.forceAverage="million":-1!==d.indexOf("B")?g.forceAverage="billion":-1!==d.indexOf("T")&&(g.forceAverage="trillion"),function(t,e){var n=t.split(".")[1];if(n){var o=n.match(/0+/);o&&(e.mantissa=o[0].length)}}(t,C),m=C,(f=t).match(/\[\.]/)?m.optionalMantissa=!0:f.match(/\./)&&(m.optionalMantissa=!1),p=C,-1!==t.indexOf(",")&&(p.thousandSeparated=!0),w=C,-1!==t.indexOf(" ")&&(w.spaceSeparated=!0),v=C,(A=t).match(/^\+?\([^)]*\)$/)&&(v.negative="parenthesis"),A.match(/^\+?-/)&&(v.negative="sign"),y=C,t.match(/^\+/)&&(y.forceSign=!0),C)}}},{}],9:[function(t,e,n){var o=[{key:"ZiB",factor:Math.pow(1024,7)},{key:"ZB",factor:Math.pow(1e3,7)},{key:"YiB",factor:Math.pow(1024,8)},{key:"YB",factor:Math.pow(1e3,8)},{key:"TiB",factor:Math.pow(1024,4)},{key:"TB",factor:Math.pow(1e3,4)},{key:"PiB",factor:Math.pow(1024,5)},{key:"PB",factor:Math.pow(1e3,5)},{key:"MiB",factor:Math.pow(1024,2)},{key:"MB",factor:Math.pow(1e3,2)},{key:"KiB",factor:Math.pow(1024,1)},{key:"KB",factor:Math.pow(1e3,1)},{key:"GiB",factor:Math.pow(1024,3)},{key:"GB",factor:Math.pow(1e3,3)},{key:"EiB",factor:Math.pow(1024,6)},{key:"EB",factor:Math.pow(1e3,6)},{key:"B",factor:1}];function i(t){return t.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&")}function r(t,e){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"",r=3<arguments.length?arguments[3]:void 0,s=4<arguments.length?arguments[4]:void 0,a=5<arguments.length?arguments[5]:void 0,l=6<arguments.length?arguments[6]:void 0;if(""!==t)return t===s?0:function t(e,n){var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"",s=3<arguments.length?arguments[3]:void 0,a=4<arguments.length?arguments[4]:void 0,l=5<arguments.length?arguments[5]:void 0,h=6<arguments.length?arguments[6]:void 0;if(!isNaN(+e))return+e;var c="",u=e.replace(/(^[^(]*)\((.*)\)([^)]*$)/,"$1$2$3");if(u!==e)return-1*t(u,n,r,s,a,l,h);for(var d=0;d<o.length;d++){var g=o[d];if((c=e.replace(g.key,""))!==e)return t(c,n,r,s,a,l,h)*g.factor}if((c=e.replace("%",""))!==e)return t(c,n,r,s,a,l,h)/100;var f=parseFloat(e);if(!isNaN(f)){var m=s(f);if(m&&"."!==m&&(c=e.replace(new RegExp("".concat(i(m),"$")),""))!==e)return t(c,n,r,s,a,l,h);var p={};Object.keys(l).forEach((function(t){p[l[t]]=t}));for(var w=Object.keys(p).sort().reverse(),A=w.length,v=0;v<A;v++){var y=w[v],C=p[y];if((c=e.replace(y,""))!==e){var b=void 0;switch(C){case"thousand":b=Math.pow(10,3);break;case"million":b=Math.pow(10,6);break;case"billion":b=Math.pow(10,9);break;case"trillion":b=Math.pow(10,12)}return t(c,n,r,s,a,l,h)*b}}}}(function(t,e){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"",o=t.replace(n,"");return(o=o.replace(new RegExp("([0-9])".concat(i(e.thousands),"([0-9])"),"g"),"$1$2")).replace(e.decimal,".")}(t,e,n),e,n,r,s,a,l)}e.exports={unformat:function(e,n){var o,i,s,a=t("./globalState"),l=a.currentDelimiters(),h=a.currentCurrency().symbol,c=a.currentOrdinal(),u=a.getZeroFormat(),d=a.currentAbbreviations(),g=void 0;if("string"==typeof e)g=function(t,e){if(!t.indexOf(":")||":"===e.thousands)return!1;var n=t.split(":");if(3!==n.length)return!1;var o=+n[0],i=+n[1],r=+n[2];return!isNaN(o)&&!isNaN(i)&&!isNaN(r)}(e,l)?(o=e.split(":"),i=+o[0],s=+o[1],+o[2]+60*s+3600*i):r(e,l,h,c,u,d,n);else{if("number"!=typeof e)return;g=e}if(void 0!==g)return g}}},{"./globalState":4}],10:[function(t,e,n){function o(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function i(t){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var r=t("./unformatting"),s=/^[a-z]{2,3}(-[a-zA-Z]{4})?(-([A-Z]{2}|[0-9]{3}))?$/,a={output:{type:"string",validValues:["currency","percent","byte","time","ordinal","number"]},base:{type:"string",validValues:["decimal","binary","general"],restriction:function(t,e){return"byte"===e.output},message:"`base` must be provided only when the output is `byte`",mandatory:function(t){return"byte"===t.output}},characteristic:{type:"number",restriction:function(t){return 0<=t},message:"value must be positive"},prefix:"string",postfix:"string",forceAverage:{type:"string",validValues:["trillion","billion","million","thousand"]},average:"boolean",currencyPosition:{type:"string",validValues:["prefix","infix","postfix"]},currencySymbol:"string",totalLength:{type:"number",restrictions:[{restriction:function(t){return 0<=t},message:"value must be positive"},{restriction:function(t,e){return!e.exponential},message:"`totalLength` is incompatible with `exponential`"}]},mantissa:{type:"number",restriction:function(t){return 0<=t},message:"value must be positive"},optionalMantissa:"boolean",trimMantissa:"boolean",optionalCharacteristic:"boolean",thousandSeparated:"boolean",spaceSeparated:"boolean",abbreviations:{type:"object",children:{thousand:"string",million:"string",billion:"string",trillion:"string"}},negative:{type:"string",validValues:["sign","parenthesis"]},forceSign:"boolean",exponential:{type:"boolean"},prefixSymbol:{type:"boolean",restriction:function(t,e){return"percent"===e.output},message:"`prefixSymbol` can be provided only when the output is `percent`"}},l={languageTag:{type:"string",mandatory:!0,restriction:function(t){return t.match(s)},message:"the language tag must follow the BCP 47 specification (see https://tools.ieft.org/html/bcp47)"},delimiters:{type:"object",children:{thousands:"string",decimal:"string",thousandsSize:"number"},mandatory:!0},abbreviations:{type:"object",children:{thousand:{type:"string",mandatory:!0},million:{type:"string",mandatory:!0},billion:{type:"string",mandatory:!0},trillion:{type:"string",mandatory:!0}},mandatory:!0},spaceSeparated:"boolean",ordinal:{type:"function",mandatory:!0},currency:{type:"object",children:{symbol:"string",position:"string",code:"string"},mandatory:!0},defaults:"format",ordinalFormat:"format",byteFormat:"format",percentageFormat:"format",currencyFormat:"format",timeDefaults:"format",formats:{type:"object",children:{fourDigits:{type:"format",mandatory:!0},fullWithTwoDecimals:{type:"format",mandatory:!0},fullWithTwoDecimalsNoCurrency:{type:"format",mandatory:!0},fullWithNoDecimals:{type:"format",mandatory:!0}}}};function h(t){return!!r.unformat(t)}function c(t,e,n){var r=3<arguments.length&&void 0!==arguments[3]&&arguments[3],s=Object.keys(t).map((function(o){if(!e[o])return console.error("".concat(n," Invalid key: ").concat(o)),!1;var r=t[o],s=e[o];if("string"==typeof s&&(s={type:s}),"format"===s.type){if(!c(r,a,"[Validate ".concat(o,"]"),!0))return!1}else if(i(r)!==s.type)return console.error("".concat(n," ").concat(o,' type mismatched: "').concat(s.type,'" expected, "').concat(i(r),'" provided')),!1;if(s.restrictions&&s.restrictions.length)for(var l=s.restrictions.length,h=0;h<l;h++){var u=s.restrictions[h],d=u.restriction,g=u.message;if(!d(r,t))return console.error("".concat(n," ").concat(o," invalid value: ").concat(g)),!1}return s.restriction&&!s.restriction(r,t)?(console.error("".concat(n," ").concat(o," invalid value: ").concat(s.message)),!1):s.validValues&&-1===s.validValues.indexOf(r)?(console.error("".concat(n," ").concat(o," invalid value: must be among ").concat(JSON.stringify(s.validValues),', "').concat(r,'" provided')),!1):!(s.children&&!c(r,s.children,"[Validate ".concat(o,"]")))}));return r||s.push.apply(s,o(Object.keys(e).map((function(o){var i=e[o];if("string"==typeof i&&(i={type:i}),i.mandatory){var r=i.mandatory;if("function"==typeof r&&(r=r(t)),r&&void 0===t[o])return console.error("".concat(n,' Missing mandatory key "').concat(o,'"')),!1}return!0})))),s.reduce((function(t,e){return t&&e}),!0)}function u(t){return c(t,a,"[Validate format]")}e.exports={validate:function(t,e){var n=h(t),o=u(e);return n&&o},validateFormat:u,validateInput:h,validateLanguage:function(t){return c(t,l,"[Validate language]")}}},{"./unformatting":9}]},{},[7])(7)}))})(OW);var HW=OW.exports;const DW=(0,i.g)(HW),NW="numeric";function PW(t,e,n,o,i,r,s){let a=r;if(vb(a)){const t=s.numericFormat,n=t&&t.culture||"-",o=t&&t.pattern,i=s.className||"",r=i.length?i.split(" "):[];if("undefined"!=typeof n&&!DW.languages()[n]){const t=n.replace("-",""),e=DW.allLanguages?DW.allLanguages[n]:DW[t];e&&DW.registerLanguage(e)}DW.setLanguage(n),a=DW(a).format(o||"0"),r.indexOf("htLeft")<0&&r.indexOf("htCenter")<0&&r.indexOf("htRight")<0&&r.indexOf("htJustify")<0&&r.push("htRight"),r.indexOf("htNumeric")<0&&r.push("htNumeric"),s.className=r.join(" "),e.dir="ltr"}BB(t,e,n,o,i,a,s)}PW.RENDERER_TYPE=NW;const _W="password";function BW(t,e,n,o,i,r,s){BB.apply(this,[t,e,n,o,i,r,s]);const a=s.hashLength||e.innerHTML.length,l=s.hashSymbol||"*";let h="";Cb(a-1,(()=>{h+=l})),wA(e,h)}BW.RENDERER_TYPE=_W;const LW="select";function VW(t,e,n,o,i,r,s){BB.apply(this,[t,e,n,o,i,r,s])}VW.RENDERER_TYPE=LW;const WW="time";function FW(t,e,n,o,i,r,s){BB.apply(this,[t,e,n,o,i,r,s]),e.dir="ltr"}function jW(){tS(uW),tS(PB),tS(CW),tS(gW),tS(IW),tS(hW),tS(PW),tS(BW),tS(VW),tS(BB),tS(FW)}FW.RENDERER_TYPE=WW;const UW="autocomplete";function YW(t,e){let n=t;null==n&&(n=""),this.allowEmpty&&""===n?e(!0):this.strict&&this.source?"function"==typeof this.source?this.source(n,zW(n,e)):zW(n,e)(this.source):e(!0)}function zW(t,e){const n=t;return function(t){let o=!1;for(let e=0,i=t.length;e<i;e++)if(n===t[e]){o=!0;break}e(o)}}function GW(t){const e=new Date(t);return isNaN(new Date(`${t}T00:00`).getDate())?e:new Date(e.getTime()+6e4*e.getTimezoneOffset())}YW.VALIDATOR_TYPE=UW;const QW=Object.freeze(Object.defineProperty({__proto__:null,getNormalizedDate:GW},Symbol.toStringTag,{value:"Module"})),KW="date";function XW(t,e){const n=wC(GV,this.instance);let o=t,i=!0;null==o&&(o="");let r=gh(o,this.dateFormat||n.defaultDateFormat,!0).isValid(),s=gh(new Date(o)).isValid()||r;if(this.allowEmpty&&""===o&&(s=!0,r=!0),s||(i=!1),!s&&r&&(i=!0),s&&!r)if(!0===this.correctFormat){const t=qW(o,this.dateFormat),e=this.instance.toVisualRow(this.row),n=this.instance.toVisualColumn(this.col);this.instance.setDataAtCell(e,n,t,"dateValidator"),i=!0}else i=!1;e(i)}function qW(t,e){const n=gh(GW(t)),o=gh(t,e),i=t.search(/[A-z]/g)>-1;let r;return r=n.isValid()&&n.format("x")===o.format("x")||!o.isValid()||i?n:o,r.format(e)}XW.VALIDATOR_TYPE=KW;const ZW="dropdown";function JW(t,e){YW.apply(this,[t,e])}JW.VALIDATOR_TYPE=ZW;const $W="numeric";function tF(t,e){let n=t;null==n&&(n=""),this.allowEmpty&&""===n?e(!0):e(""!==n&&vb(t))}tF.VALIDATOR_TYPE=$W;const eF=["YYYY-MM-DDTHH:mm:ss.SSSZ","X","x"],nF="time";function oF(t,e){const n=this.timeFormat||"h:mm:ss a";let o=!0,i=t;null===i&&(i=""),i=/^\d{3,}$/.test(i)?parseInt(i,10):i;const r=/^\d{1,2}$/.test(i);r&&(i+=":00");const s=gh(i,eF,!0).isValid()?gh(i):gh(i,n);let a=s.isValid(),l=gh(i,n,!0).isValid()&&!r;if(this.allowEmpty&&""===i&&(a=!0,l=!0),a||(o=!1),!a&&l&&(o=!0),a&&!l)if(!0===this.correctFormat){const t=s.format(n),e=this.instance.toVisualRow(this.row),i=this.instance.toVisualColumn(this.col);this.instance.setDataAtCell(e,i,t,"timeValidator"),o=!0}else o=!1;e(o)}function iF(){aS(YW),aS(JW),aS(XW),aS(tF),aS(oF)}oF.VALIDATOR_TYPE=nF;const rF="autocomplete",sF={CELL_TYPE:rF,editor:cV,renderer:uW,validator:YW},aF="checkbox",lF={CELL_TYPE:aF,editor:dV,renderer:CW},hF="date";function cF(t,e,n,o,i,r,s){uW.apply(this,[t,e,n,o,i,r,s])}cF.RENDERER_TYPE=hF;const uF="date",dF={CELL_TYPE:uF,editor:KV,renderer:cF,validator:XW},gF="dropdown",fF={CELL_TYPE:gF,editor:qV,renderer:gW,validator:JW},mF="handsontable",pF={CELL_TYPE:mF,editor:$L,renderer:IW},wF="numeric",AF={CELL_TYPE:wF,editor:JV,renderer:PW,validator:tF,dataType:"number"},vF="password",yF={CELL_TYPE:vF,editor:tW,renderer:BW,copyable:!1},CF="select",bF={CELL_TYPE:CF,editor:iW,renderer:VW},SF="time",EF={CELL_TYPE:SF,editor:sW,renderer:FW,validator:oF};function RF(){rP(sF),rP(lF),rP(dF),rP(fF),rP(pF),rP(AF),rP(yF),rP(bF),rP(VB),rP(EF)}function MF(t,e){kF(t,e),e.add(t)}function TF(t,e,n){kF(t,e),e.set(t,n)}function kF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function xF(t,e,n){return e=IF(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function IF(t){var e=OF(t,"string");return"symbol"==typeof e?e:String(e)}function OF(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function HF(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function DF(t,e){var n=NF(t,e,"get");return PF(t,n)}function NF(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function PF(t,e){return e.get?e.get.call(t):e.value}const _F=new Map([["plugin",Yb],["cell-type",eP],["editor",gC],["renderer",qb],["validator",oS]]),BF="base",LF=[];let VF=null;var WF=new WeakMap,FF=new WeakSet;class jF{static get PLUGIN_KEY(){return BF}static get SETTING_KEYS(){return[this.PLUGIN_KEY]}constructor(t){MF(this,FF),xF(this,"eventManager",new MC(this)),xF(this,"pluginName",null),xF(this,"pluginsInitializedCallbacks",[]),xF(this,"isPluginsReady",!1),xF(this,"enabled",!1),xF(this,"initialized",!1),TF(this,WF,{writable:!0,value:{}}),ey(this,"hot",t,{writable:!1}),VF=null,this.hot.addHook("afterPluginsInitialized",(()=>this.onAfterPluginsInitialized())),this.hot.addHook("afterUpdateSettings",(t=>this.onUpdateSettings(t))),this.hot.addHook("beforeInit",(()=>this.init()))}init(){this.pluginName=this.hot.getPluginName(this);const t=this.constructor.PLUGIN_DEPS,e=Array.isArray(t)?t:[];if(e.length>0){const t=[];if(e.forEach((e=>{const[n,o]=e.split(":");if(!_F.has(n))throw new Error(`Unknown plugin dependency type "${n}" was found.`);_F.get(n)(o)||t.push(` - ${o} (${n})`)})),t.length>0){const e=[`The ${this.pluginName} plugin requires the following modules:\n`,`${t.join("\n")}\n`].join("");LF.push(e)}}if(VF||(VF=jb()),VF.indexOf("UndoRedo")>=0&&VF.splice(VF.indexOf("UndoRedo"),1),VF.indexOf(this.pluginName)>=0&&VF.splice(VF.indexOf(this.pluginName),1),this.hot.addHookOnce("afterPluginsInitialized",(()=>{this.isEnabled&&this.isEnabled()&&this.enablePlugin()})),0===VF.length){if(LF.length>0){const t=[`${LF.join("\n")}\n`,"You have to import and register them manually."].join("");throw new Error(t)}this.hot.runHooks("afterPluginsInitialized")}this.initialized=!0}enablePlugin(){this.enabled=!0}disablePlugin(){var t;null===(t=this.eventManager)||void 0===t||t.clear(),this.clearHooks(),this.enabled=!1}addHook(t,e){DF(this,WF)[t]=DF(this,WF)[t]||[];const n=DF(this,WF)[t];this.hot.addHook(t,e),n.push(e),DF(this,WF)[t]=n}removeHooks(t){Mp(DF(this,WF)[t]||[],(e=>{this.hot.removeHook(t,e)}))}clearHooks(){const t=DF(this,WF);ny(t,((t,e)=>this.removeHooks(e))),t.length=0}callOnPluginsReady(t){this.isPluginsReady?t():this.pluginsInitializedCallbacks.push(t)}onAfterPluginsInitialized(){Mp(this.pluginsInitializedCallbacks,(t=>t())),this.pluginsInitializedCallbacks.length=0,this.isPluginsReady=!0}onUpdateSettings(t){const e=HF(this,FF,UF).call(this,t);this.isEnabled&&(this.enabled&&!this.isEnabled()&&this.disablePlugin(),!this.enabled&&this.isEnabled()&&this.enablePlugin(),this.enabled&&this.isEnabled()&&e&&this.updatePlugin(t))}updatePlugin(){}destroy(){var t;null===(t=this.eventManager)||void 0===t||t.destroy(),this.clearHooks(),ny(this,((t,e)=>{"hot"!==e&&(this[e]=null)})),delete this.t,delete this.hot}}function UF(t){if(!t)return!1;const e=this.constructor.SETTING_KEYS;if("boolean"==typeof e)return e;for(let n=0;n<e.length;n++)if(void 0!==t[e[n]])return!0;return!1}function YF(t,e,n){return e=zF(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function zF(t){var e=GF(t,"string");return"symbol"==typeof e?e:String(e)}function GF(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}let QF=class{constructor(t){YF(this,"hot",null),YF(this,"container",null),YF(this,"injected",!1),YF(this,"rows",[]),YF(this,"columns",[]),YF(this,"samples",null),YF(this,"settings",{useHeaders:!0}),this.hot=t}addRow(t,e){if(this.columns.length)throw new Error("Doesn't support multi-dimensional table");this.rows.length||(this.container=this.createContainer(this.hot.rootElement.className));const n={row:t};this.rows.push(n),this.samples=e,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol(t)),this.table.tr.appendChild(this.createRow(t)),this.container.container.appendChild(this.table.fragment),n.table=this.table.table}addColumnHeadersRow(t){const e=this.hot.getColHeader(0);if(null!=e){const e={row:-1};this.rows.push(e),this.container=this.createContainer(this.hot.rootElement.className),this.samples=t,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol()),this.appendColumnHeadersRow(),this.container.container.appendChild(this.table.fragment),e.table=this.table.table}}addColumn(t,e){if(this.rows.length)throw new Error("Doesn't support multi-dimensional table");this.columns.length||(this.container=this.createContainer(this.hot.rootElement.className));const n={col:t};this.columns.push(n),this.samples=e,this.table=this.createTable(this.hot.table.className),this.getSetting("useHeaders")&&null!==this.hot.getColHeader(t)&&this.hot.view.appendColHeader(t,this.table.th),this.table.tBody.appendChild(this.createCol(t)),this.container.container.appendChild(this.table.fragment),n.table=this.table.table}getHeights(t){this.injected||this.injectTable(),Mp(this.rows,(e=>{t(e.row,OA(e.table)-1)}))}getWidths(t){this.injected||this.injectTable(),Mp(this.columns,(e=>{const{width:n}=e.table.getBoundingClientRect();t(e.col,Math.ceil(n))}))}setSettings(t){this.settings=t}setSetting(t,e){this.settings||(this.settings={}),this.settings[t]=e}getSettings(){return this.settings}getSetting(t){return this.settings?this.settings[t]:null}createColGroupsCol(t){const e=this.hot.rootDocument.createDocumentFragment();return this.hot.hasRowHeaders()&&e.appendChild(this.createColElement(-1,-1)),this.samples.forEach((n=>{Mp(n.strings,(n=>{e.appendChild(this.createColElement(n.col,t))}))})),e}createRow(t){const{rootDocument:e}=this.hot,n=e.createDocumentFragment(),o=e.createElement("th");return this.hot.hasRowHeaders()&&(this.hot.view.appendRowHeader(t,o),n.appendChild(o)),this.samples.forEach((o=>{Mp(o.strings,(o=>{const i=o.col,r=this.hot.getCellMeta(t,i);r.col=i,r.row=t;const s=this.hot.getCellRenderer(r),a=e.createElement("td");a.setAttribute("ghost-table",1),s(this.hot,a,t,i,this.hot.colToProp(i),o.value,r),n.appendChild(a)}))})),n}appendColumnHeadersRow(){const{rootDocument:t}=this.hot,e=t.createDocumentFragment(),n=[];if(this.hot.hasRowHeaders()){const o=t.createElement("th");n.push([-1,o]),e.appendChild(o)}this.samples.forEach((o=>{Mp(o.strings,(o=>{const i=o.col,r=t.createElement("th");n.push([i,r]),e.appendChild(r)}))})),this.table.tHead.appendChild(e),Mp(n,(t=>{const[e,n]=t;this.hot.view.appendColHeader(e,n)}))}createCol(t){const{rootDocument:e}=this.hot,n=e.createDocumentFragment();return this.samples.forEach((o=>{Mp(o.strings,(o=>{const i=o.row,r=this.hot.getCellMeta(i,t);r.col=t,r.row=i;const s=this.hot.getCellRenderer(r),a=e.createElement("td"),l=e.createElement("tr");a.setAttribute("ghost-table",1),s(this.hot,a,i,t,this.hot.colToProp(t),o.value,r),l.appendChild(a),n.appendChild(l)}))})),n}clean(){this.rows.length=0,this.rows[-1]=void 0,this.columns.length=0,this.samples&&this.samples.clear(),this.samples=null,this.removeTable()}injectTable(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.injected||((t||this.hot.rootElement).appendChild(this.container.fragment),this.injected=!0)}removeTable(){this.injected&&this.container.container.parentNode&&(this.container.container.parentNode.removeChild(this.container.container),this.container=null,this.injected=!1)}createColElement(t,e){const n=this.hot.rootDocument.createElement("col");let o=0;e>=0&&t>=0&&(o=this.hot.getCellMeta(e,t).colspan);let i=this.hot.view._wt.wtTable.getStretchedColumnWidth(t);if(o>1)for(let r=t+1;r<t+o;r++)i+=this.hot.view._wt.wtTable.getStretchedColumnWidth(r);return n.style.width=`${i}px`,n}createTable(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";const{rootDocument:e}=this.hot,n=e.createDocumentFragment(),o=e.createElement("table"),i=e.createElement("thead"),r=e.createElement("tbody"),s=e.createElement("colgroup"),a=e.createElement("tr"),l=e.createElement("th");return this.isVertical()&&o.appendChild(s),this.isHorizontal()&&(a.appendChild(l),i.appendChild(a),o.style.tableLayout="auto",o.style.width="auto"),o.appendChild(i),this.isVertical()&&r.appendChild(a),o.appendChild(r),cA(o,t),n.appendChild(o),{fragment:n,table:o,tHead:i,tBody:r,colGroup:s,tr:a,th:l}}createContainer(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";const{rootDocument:e}=this.hot,n=e.createDocumentFragment(),o=e.createElement("div"),i=`htGhostTable htAutoSize ${t.trim()}`;return cA(o,i),n.appendChild(o),{fragment:n,container:o}}isVertical(){return!(!this.rows.length||this.columns.length)}isHorizontal(){return!(!this.columns.length||this.rows.length)}};const KF=QF;function XF(t,e,n){return e=qF(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function qF(t){var e=ZF(t,"string");return"symbol"==typeof e?e:String(e)}function ZF(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class JF{static get SAMPLE_COUNT(){return 3}constructor(t){XF(this,"samples",null),XF(this,"dataFactory",null),XF(this,"customSampleCount",null),XF(this,"allowDuplicates",!1),this.dataFactory=t}getSampleCount(){return this.customSampleCount?this.customSampleCount:JF.SAMPLE_COUNT}setSampleCount(t){this.customSampleCount=t}setAllowDuplicates(t){this.allowDuplicates=t}generateRowSamples(t,e){return this.generateSamples("row",e,t)}generateColumnSamples(t,e){return this.generateSamples("col",e,t)}generateSamples(t,e,n){const o=new Map,{from:i,to:r}="number"==typeof n?{from:n,to:n}:n;return Cb(i,r,(n=>{const i=this.generateSample(t,e,n);o.set(n,i)})),o}generateSample(t,e,n){if("row"!==t&&"col"!==t)throw new Error("Unsupported sample type");const o=new Map,i="row"===t?"col":"row",r=[];return Cb(e.from,e.to,(e=>{const s="row"===t?this.dataFactory(n,e):this.dataFactory(e,n);if(!1===s)return;const{value:a,bundleSeed:l}=s,h="string"==typeof l&&l.length>0;let c;c=h?l:ty(a)?`${Object.keys(a).length}`:Array.isArray(a)?`${a.length}`:`${Vp(a).length}`,o.has(c)||o.set(c,{needed:this.getSampleCount(),strings:[]});const u=o.get(c);u.needed&&(!(r.indexOf(a)>-1)||this.allowDuplicates||h)&&(u.strings.push({value:a,[i]:e}),r.push(a),u.needed-=1)})),o}}const $F=JF;function tj(t,e){nj(t,e),e.add(t)}function ej(t,e,n){nj(t,e),e.set(t,n)}function nj(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function oj(t,e,n){return e=ij(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ij(t){var e=rj(t,"string");return"symbol"==typeof e?e:String(e)}function rj(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function sj(t,e,n){var o=hj(t,e,"set");return aj(t,o,n),n}function aj(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function lj(t,e){var n=hj(t,e,"get");return cj(t,n)}function hj(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function cj(t,e){return e.get?e.get.call(t):e.value}function uj(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}aC.getSingleton().register("modifyAutoColumnSizeSeed");const dj="autoColumnSize",gj=10,fj="autoColumnSize";var mj=new WeakMap,pj=new WeakSet,wj=new WeakSet,Aj=new WeakSet,vj=new WeakSet,yj=new WeakSet,Cj=new WeakSet;class bj extends jF{static get PLUGIN_KEY(){return dj}static get PLUGIN_PRIORITY(){return gj}static get SETTING_KEYS(){return!0}static get CALCULATION_STEP(){return 50}static get SYNC_CALCULATION_LIMIT(){return 50}constructor(t){super(t),tj(this,Cj),tj(this,yj),tj(this,vj),tj(this,Aj),tj(this,wj),tj(this,pj),oj(this,"ghostTable",new KF(this.hot)),oj(this,"samplesGenerator",new $F(((t,e)=>{const n=this.hot.getCellMeta(t,e);let o="";n.spanned||(o=this.hot.getDataAtCell(t,e));let i="";return this.hot.hasHook("modifyAutoColumnSizeSeed")&&(i=this.hot.runHooks("modifyAutoColumnSizeSeed",i,n,o)),{value:o,bundleSeed:i}}))),oj(this,"firstCalculation",!0),oj(this,"inProgress",!1),oj(this,"measuredColumns",0),oj(this,"columnWidthsMap",new wI),ej(this,mj,{writable:!0,value:[]}),this.hot.columnIndexMapper.registerMap(fj,this.columnWidthsMap),this.addHook("beforeColumnResize",((t,e,n)=>uj(this,vj,Mj).call(this,t,e,n)))}isEnabled(){return!1!==this.hot.getSettings()[dj]&&!this.hot.getSettings().colWidths}enablePlugin(){var t=this;if(this.enabled)return;const e=this.hot.getSettings()[dj];e&&null!==e.useHeaders&&void 0!==e.useHeaders&&this.ghostTable.setSetting("useHeaders",e.useHeaders),this.setSamplingOptions(),this.addHook("afterLoadData",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return uj(t,wj,Ej).call(t,...n)})),this.addHook("beforeChangeRender",(t=>uj(this,Aj,Rj).call(this,t))),this.addHook("afterFormulasValuesUpdate",(t=>uj(this,Cj,kj).call(this,t))),this.addHook("beforeViewRender",(t=>uj(this,pj,Sj).call(this,t))),this.addHook("modifyColWidth",((t,e)=>this.getColumnWidth(e,t))),this.addHook("afterInit",(()=>uj(this,yj,Tj).call(this))),super.enablePlugin()}updatePlugin(){const t=this.findColumnsWhereHeaderWasChanged();t.length&&(this.clearCache(t),this.calculateVisibleColumnsWidth()),super.updatePlugin()}disablePlugin(){super.disablePlugin(),this.addHook("beforeColumnResize",((t,e,n)=>uj(this,vj,Mj).call(this,t,e,n)))}calculateVisibleColumnsWidth(){if(!this.hot.countRows())return;const t=this.hot.renderCall,e=this.getFirstVisibleColumn(),n=this.getLastVisibleColumn();-1===e||-1===n||this.calculateColumnsWidth({from:e,to:n},void 0,t)}calculateColumnsWidth(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{from:0,to:this.hot.countCols()-1},e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{from:0,to:this.hot.countRows()-1},n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const o="number"==typeof t?{from:t,to:t}:t,i="number"==typeof e?{from:e,to:e}:e;Cb(o.from,o.to,(t=>{let e=this.hot.toPhysicalColumn(t);if(null===e&&(e=t),n||null===this.columnWidthsMap.getValueAtIndex(e)&&!this.hot._getColWidthFromSettings(e)){const e=this.samplesGenerator.generateColumnSamples(t,i);Mp(e,(t=>{let[e,n]=t;return this.ghostTable.addColumn(e,n)}))}})),this.ghostTable.columns.length&&(this.hot.batchExecution((()=>{this.ghostTable.getWidths(((t,e)=>{const n=this.hot.toPhysicalColumn(t);this.columnWidthsMap.setValueAtIndex(n,e)}))}),!0),this.measuredColumns=o.to+1,this.ghostTable.clean())}calculateAllColumnsWidth(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{from:0,to:this.hot.countRows()-1},e=0;const n=this.hot.countCols()-1;let o=null;this.inProgress=!0;const i=()=>{if(!this.hot)return cy(o),void(this.inProgress=!1);this.calculateColumnsWidth({from:e,to:Math.min(e+bj.CALCULATION_STEP,n)},t),e=e+bj.CALCULATION_STEP+1,e<n?o=hy(i):(cy(o),this.inProgress=!1,this.hot.view.adjustElementsSize())},r=this.getSyncCalculationLimit();this.firstCalculation&&r>=0&&(this.calculateColumnsWidth({from:0,to:r},t),this.firstCalculation=!1,e=r+1),e<n?i():this.inProgress=!1}setSamplingOptions(){const t=this.hot.getSettings()[dj],e=t&&ay(t,"samplingRatio")?t.samplingRatio:void 0,n=t&&ay(t,"allowSampleDuplicates")?t.allowSampleDuplicates:void 0;e&&!isNaN(e)&&this.samplesGenerator.setSampleCount(parseInt(e,10)),n&&this.samplesGenerator.setAllowDuplicates(n)}recalculateAllColumnsWidth(){this.hot.view&&this.hot.view._wt.wtTable.isVisible()&&(this.clearCache(),this.calculateAllColumnsWidth())}getSyncCalculationLimit(){const t=this.hot.getSettings()[dj];let e=bj.SYNC_CALCULATION_LIMIT;const n=this.hot.countCols()-1;return ty(t)&&(e=t.syncLimit,aw(e)?e=Sb(n,e):e>>=0),Math.min(e,n)}getColumnWidth(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],o=e;return void 0===o&&(o=this.columnWidthsMap.getValueAtIndex(this.hot.toPhysicalColumn(t)),n&&"number"==typeof o&&(o=Math.max(o,mE.DEFAULT_WIDTH))),o}getFirstVisibleColumn(){const t=this.hot.view._wt;if(t.wtViewport.columnsVisibleCalculator){const e=t.wtTable.getFirstVisibleColumn();if(-1!==e)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(e)}if(t.wtViewport.columnsRenderCalculator){const e=t.wtTable.getFirstRenderedColumn();if(-1!==e)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(e)}return-1}getLastVisibleColumn(){const t=this.hot.view._wt;if(t.wtViewport.columnsVisibleCalculator){const e=t.wtTable.getLastVisibleColumn();if(-1!==e)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(e)}if(t.wtViewport.columnsRenderCalculator){const e=t.wtTable.getLastRenderedColumn();if(-1!==e)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(e)}return-1}findColumnsWhereHeaderWasChanged(){const t=this.hot.getColHeader();return Sp(t,((t,e,n)=>{const o=lj(this,mj).length;return(o-1<n||lj(this,mj)[n]!==e)&&t.push(n),o-1<n?lj(this,mj).push(e):lj(this,mj)[n]=e,t}),[])}clearCache(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];t.length?this.hot.batchExecution((()=>{Mp(t,(t=>{this.columnWidthsMap.setValueAtIndex(t,null)}))}),!0):this.columnWidthsMap.clear()}isNeedRecalculate(){return!!Ep(this.columnWidthsMap.getValues().slice(0,this.measuredColumns),(t=>null===t)).length}destroy(){this.ghostTable.clean(),super.destroy()}}function Sj(){this.calculateVisibleColumnsWidth(),this.isNeedRecalculate()&&!this.inProgress&&this.calculateAllColumnsWidth()}function Ej(){this.hot.view?this.recalculateAllColumnsWidth():setTimeout((()=>{this.hot&&this.recalculateAllColumnsWidth()}),0)}function Rj(t){const e=Rp(t,(t=>{let[,e]=t;return this.hot.toPhysicalColumn(this.hot.propToCol(e))}));this.clearCache(Array.from(new Set(e)))}function Mj(t,e,n){let o=t;return n&&(this.calculateColumnsWidth(e,void 0,!0),o=this.getColumnWidth(e,void 0,!1)),o}function Tj(){sj(this,mj,this.hot.getColHeader())}function kj(t){const e=Ep(t,(t=>{var e;return Wp(null===(e=t.address)||void 0===e?void 0:e.col)})),n=Rp(e,(t=>t.address.col));this.clearCache(Array.from(new Set(n)))}const xj={horizontal:"horizontal",vertical:"vertical"};function Ij(t,e,n){let o,i,r;return e[0]===t[0]&&e[1]<t[1]?(r="left",o=n(e[0],e[1]),i=n(e[2],t[1]-1)):e[2]===t[2]&&e[0]===t[0]&&e[3]>t[3]?(r="right",o=n(e[0],t[3]+1),i=n(e[2],e[3])):e[0]<t[0]&&e[1]===t[1]?(r="up",o=n(e[0],e[1]),i=n(t[0]-1,e[3])):e[2]>t[2]&&e[1]===t[1]&&(r="down",o=n(t[2]+1,e[1]),i=n(e[2],e[3])),o&&o.normalize(),i&&i.normalize(),{directionOfDrag:r,startOfDragCoords:o,endOfDragCoords:i}}function Oj(t){const e={};return!0===t?(e.directions=Object.keys(xj),e.autoInsertRow=!0):ty(t)?(Wp(t.autoInsertRow)?t.direction===xj.horizontal?e.autoInsertRow=!1:e.autoInsertRow=t.autoInsertRow:e.autoInsertRow=!1,Wp(t.direction)?e.directions=[t.direction]:e.directions=Object.keys(xj)):"string"==typeof t?(e.directions=[t],e.autoInsertRow=!0):(e.directions=[],e.autoInsertRow=!1),e}function Hj(t,e){Dj(t,e),e.add(t)}function Dj(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Nj(t,e,n){return e=Pj(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Pj(t){var e=_j(t,"string");return"symbol"==typeof e?e:String(e)}function _j(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function Bj(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}aC.getSingleton().register("modifyAutofillRange"),aC.getSingleton().register("beforeAutofill"),aC.getSingleton().register("afterAutofill");const Lj="autofill",Vj=20,Wj=["fillHandle"],Fj="insert_row_below",jj=200;var Uj=new WeakSet,Yj=new WeakSet,zj=new WeakSet,Gj=new WeakSet,Qj=new WeakSet;class Kj extends jF{constructor(){super(...arguments),Hj(this,Qj),Hj(this,Gj),Hj(this,zj),Hj(this,Yj),Hj(this,Uj),Nj(this,"addingStarted",!1),Nj(this,"mouseDownOnCellCorner",!1),Nj(this,"mouseDragOutside",!1),Nj(this,"handleDraggedCells",0),Nj(this,"directions",[]),Nj(this,"autoInsertRow",!1)}static get PLUGIN_KEY(){return Lj}static get PLUGIN_PRIORITY(){return Vj}static get SETTING_KEYS(){return[Lj,...Wj]}isEnabled(){return this.hot.getSettings().fillHandle}enablePlugin(){this.enabled||(this.mapSettings(),this.registerEvents(),this.addHook("afterOnCellCornerMouseDown",(t=>Bj(this,Yj,qj).call(this,t))),this.addHook("afterOnCellCornerDblClick",(t=>Bj(this,Uj,Xj).call(this,t))),this.addHook("beforeOnCellMouseOver",((t,e)=>Bj(this,zj,Zj).call(this,e))),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.clearMappedSettings(),super.disablePlugin()}getSelectionData(){const t=this.hot.getSelectedRangeLast(),{row:e,col:n}=t.getTopStartCorner(),{row:o,col:i}=t.getBottomEndCorner(),r=this.hot.runHooks("modifyCopyableRange",[{startRow:e,startCol:n,endRow:o,endCol:i}]),s=[],a=[],l=[];return Mp(r,(t=>{for(let e=t.startRow;e<=t.endRow;e+=1)-1===s.indexOf(e)&&s.push(e);for(let e=t.startCol;e<=t.endCol;e+=1)-1===a.indexOf(e)&&a.push(e)})),Mp(s,(t=>{const e=[];Mp(a,(n=>{e.push(this.hot.getCopyableData(t,n))})),l.push(e)})),l}fillIn(){if(this.hot.selection.highlight.getFill().isEmpty())return!1;const[t,e,n,o]=this.hot.selection.highlight.getFill().getVisualCorners(),i=this.hot.getSelectedRangeLast(),r=i.getTopStartCorner(),s=i.getBottomEndCorner();this.resetSelectionOfDraggedArea();const a=[r.row,r.col,s.row,s.col],l=this.hot.runHooks("modifyAutofillRange",[Math.min(r.row,t),Math.min(r.col,e),Math.max(s.row,n),Math.max(s.col,o)],a),{directionOfDrag:h,startOfDragCoords:c,endOfDragCoords:u}=Ij(a,l,((t,e)=>this.hot._createCellCoords(t,e)));if(c&&c.row>-1&&c.col>-1){const t=this.getSelectionData(),e=i.clone(),n=this.hot._createCellRange(c,c,u),o=this.hot.runHooks("beforeAutofill",t,e,n,h);if(!1===o)return this.hot.selection.highlight.getFill().clear(),this.hot.render(),!1;let r=o;const s=o;if(["up","left"].indexOf(h)>-1&&(1!==s.length||0!==s[0].length))if(r=[],"up"===h){const t=u.row-c.row+1,e=t%s.length;for(let n=0;n<t;n++)r.push(s[(n+(s.length-e))%s.length])}else{const t=u.col-c.col+1,e=t%s[0].length;for(let n=0;n<s.length;n++){r.push([]);for(let o=0;o<t;o++)r[n].push(s[n][(o+(s[n].length-e))%s[n].length])}}this.hot.populateFromArray(c.row,c.col,r,u.row,u.col,`${this.pluginName}.fill`,null),this.setSelection(l),this.hot.runHooks("afterAutofill",r,e,n,h),this.hot.render()}else this.hot._refreshBorders();return!0}reduceSelectionAreaIfNeeded(t){return t.row<0&&(t.row=0),t.col<0&&(t.col=0),t}getCoordsOfDragAndDropBorders(t){const e=this.hot.getSelectedRangeLast(),n=e.getBottomEndCorner();let o=t;if(this.directions.includes(xj.vertical)&&this.directions.includes(xj.horizontal)){const i=e.getTopStartCorner();(n.col<=t.col||i.col>=t.col)&&(o=this.hot._createCellCoords(n.row,t.col)),(n.row<t.row||i.row>t.row)&&(o=this.hot._createCellCoords(t.row,n.col))}else if(this.directions.includes(xj.vertical))o=this.hot._createCellCoords(t.row,n.col);else{if(!this.directions.includes(xj.horizontal))return;o=this.hot._createCellCoords(n.row,t.col)}return this.reduceSelectionAreaIfNeeded(o)}showBorder(t){const e=this.getCoordsOfDragAndDropBorders(t);e&&this.redrawBorders(e)}addRow(){this.hot._registerTimeout((()=>{this.hot.alter(Fj,void 0,1,`${this.pluginName}.fill`),this.addingStarted=!1}),jj)}addNewRowIfNeeded(){if(!this.hot.selection.highlight.getFill().isEmpty()&&!1===this.addingStarted&&this.autoInsertRow){const t=this.hot.getSelectedLast(),e=this.hot.selection.highlight.getFill().getVisualCorners(),n=this.hot.countRows();t[2]<n-1&&e[2]===n-1&&(this.addingStarted=!0,this.addRow())}}getIndexOfLastAdjacentFilledInRow(t){const e=this.hot.getData(),n=this.hot.countRows();let o;for(let i=t[2]+1;i<n;i++){for(let o=t[1];o<=t[3];o++)if(e[i][o])return-1;const n=e[i][t[1]-1],r=e[i][t[3]+1];(n||r)&&(o=i)}return o}addSelectionFromStartAreaToSpecificRowIndex(t,e){this.hot.selection.highlight.getFill().clear().add(this.hot._createCellCoords(t[0],t[1])).add(this.hot._createCellCoords(e,t[3])).commit()}setSelection(t){this.hot.selectCell(...Rp(t,(t=>Math.max(t,0))),!1,!1)}selectAdjacent(){const t=this.hot.getSelectedLast(),e=this.getIndexOfLastAdjacentFilledInRow(t);return-1!==e&&void 0!==e&&(this.addSelectionFromStartAreaToSpecificRowIndex(t,e),!0)}resetSelectionOfDraggedArea(){this.handleDraggedCells=0,this.hot.selection.highlight.getFill().clear()}redrawBorders(t){this.hot.selection.highlight.getFill().clear().add(this.hot.getSelectedRangeLast().from).add(this.hot.getSelectedRangeLast().to).add(t).commit(),this.hot.view.render()}getIfMouseWasDraggedOutside(t){const{documentElement:e}=this.hot.rootDocument,n=yA(this.hot.table).top-(this.hot.rootWindow.pageYOffset||e.scrollTop)+OA(this.hot.table),o=yA(this.hot.table).left-(this.hot.rootWindow.pageXOffset||e.scrollLeft)+IA(this.hot.table);return t.clientY>n&&t.clientX<=o}registerEvents(){const{documentElement:t}=this.hot.rootDocument;this.eventManager.addEventListener(t,"mouseup",(()=>Bj(this,Gj,Jj).call(this))),this.eventManager.addEventListener(t,"mousemove",(t=>Bj(this,Qj,$j).call(this,t)))}clearMappedSettings(){this.directions.length=0,this.autoInsertRow=!1}mapSettings(){const t=Oj(this.hot.getSettings().fillHandle);this.directions=t.directions,this.autoInsertRow=t.autoInsertRow}destroy(){super.destroy()}}function Xj(){this.selectAdjacent()&&this.fillIn()}function qj(){this.handleDraggedCells=1,this.mouseDownOnCellCorner=!0}function Zj(t){this.mouseDownOnCellCorner&&!this.hot.view.isMouseDown()&&this.handleDraggedCells&&(this.handleDraggedCells+=1,this.showBorder(t),this.addNewRowIfNeeded())}function Jj(){this.handleDraggedCells&&(this.handleDraggedCells>1&&this.fillIn(),this.handleDraggedCells=0,this.mouseDownOnCellCorner=!1)}function $j(t){const e=this.getIfMouseWasDraggedOutside(t);!1===this.addingStarted&&this.handleDraggedCells>0&&e?(this.mouseDragOutside=!0,this.addingStarted=!0):this.mouseDragOutside=!1,this.mouseDragOutside&&this.autoInsertRow&&this.addRow()}function tU(t,e){eU(t,e),e.add(t)}function eU(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function nU(t,e,n){return e=oU(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function oU(t){var e=iU(t,"string");return"symbol"==typeof e?e:String(e)}function iU(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function rU(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const sU="autoRowSize",aU=40,lU="autoRowSize";var hU=new WeakSet,cU=new WeakSet,uU=new WeakSet,dU=new WeakSet;class gU extends jF{static get PLUGIN_KEY(){return sU}static get PLUGIN_PRIORITY(){return aU}static get SETTING_KEYS(){return!0}static get CALCULATION_STEP(){return 50}static get SYNC_CALCULATION_LIMIT(){return 500}constructor(t){super(t),tU(this,dU),tU(this,uU),tU(this,cU),tU(this,hU),nU(this,"headerHeight",null),nU(this,"ghostTable",new KF(this.hot)),nU(this,"samplesGenerator",new $F(((t,e)=>{if(t>=0&&e>=0&&this.hot.getCellMeta(t,e).hidden)return!1;let n;return t>=0?n=this.hot.getDataAtCell(t,e):-1===t&&(n=this.hot.getColHeader(e)),{value:n}}))),nU(this,"firstCalculation",!0),nU(this,"inProgress",!1),nU(this,"measuredRows",0),nU(this,"rowHeightsMap",new wI),this.hot.rowIndexMapper.registerMap(lU,this.rowHeightsMap),this.addHook("beforeRowResize",((t,e,n)=>rU(this,cU,mU).call(this,t,e,n)))}isEnabled(){const t=this.hot.getSettings()[sU];return!0===t||ty(t)}enablePlugin(){var t=this;this.enabled||(this.setSamplingOptions(),this.addHook("afterLoadData",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return rU(t,uU,pU).call(t,...n)})),this.addHook("beforeChangeRender",(t=>rU(this,dU,wU).call(this,t))),this.addHook("beforeColumnResize",(()=>this.recalculateAllRowsHeight())),this.addHook("beforeViewRender",(t=>rU(this,hU,fU).call(this,t))),this.addHook("modifyRowHeight",((t,e)=>this.getRowHeight(e,t))),this.addHook("modifyColumnHeaderHeight",(()=>this.getColumnHeaderHeight())),super.enablePlugin())}disablePlugin(){this.headerHeight=null,super.disablePlugin(),this.addHook("beforeRowResize",((t,e,n)=>rU(this,cU,mU).call(this,t,e,n)))}calculateRowsHeight(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{from:0,to:this.hot.countRows()-1},e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{from:0,to:this.hot.countCols()-1},n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const o="number"==typeof t?{from:t,to:t}:t,i="number"==typeof e?{from:e,to:e}:e;if(null!==this.hot.getColHeader(0)){const t=this.samplesGenerator.generateRowSamples(-1,i);this.ghostTable.addColumnHeadersRow(t.get(-1))}Cb(o.from,o.to,(t=>{if(n||null===this.rowHeightsMap.getValueAtIndex(t)){const e=this.samplesGenerator.generateRowSamples(t,i);Mp(e,(t=>{let[e,n]=t;return this.ghostTable.addRow(e,n)}))}})),this.ghostTable.rows.length&&(this.hot.batchExecution((()=>{this.ghostTable.getHeights(((t,e)=>{t<0?this.headerHeight=e:this.rowHeightsMap.setValueAtIndex(this.hot.toPhysicalRow(t),e)}))}),!0),this.measuredRows=o.to+1,this.ghostTable.clean())}calculateAllRowsHeight(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{from:0,to:this.hot.countCols()-1},e=0;const n=this.hot.countRows()-1;let o=null;this.inProgress=!0;const i=()=>{if(!this.hot)return cy(o),void(this.inProgress=!1);this.calculateRowsHeight({from:e,to:Math.min(e+gU.CALCULATION_STEP,n)},t),e=e+gU.CALCULATION_STEP+1,e<n?o=hy(i):(cy(o),this.inProgress=!1,this.hot.view.adjustElementsSize(!0),this.hot.view._wt.wtOverlays.inlineStartOverlay.needFullRender&&this.hot.view._wt.wtOverlays.inlineStartOverlay.clone.draw())},r=this.getSyncCalculationLimit();this.firstCalculation&&r>=0&&(this.calculateRowsHeight({from:0,to:r},t),this.firstCalculation=!1,e=r+1),e<n?i():(this.inProgress=!1,this.hot.view.adjustElementsSize(!1))}setSamplingOptions(){const t=this.hot.getSettings()[sU],e=t&&ay(t,"samplingRatio")?t.samplingRatio:void 0,n=t&&ay(t,"allowSampleDuplicates")?t.allowSampleDuplicates:void 0;e&&!isNaN(e)&&this.samplesGenerator.setSampleCount(parseInt(e,10)),n&&this.samplesGenerator.setAllowDuplicates(n)}recalculateAllRowsHeight(){vA(this.hot.view._wt.wtTable.TABLE)&&(this.clearCache(),this.calculateAllRowsHeight())}getSyncCalculationLimit(){const t=this.hot.getSettings()[sU];let e=gU.SYNC_CALCULATION_LIMIT;const n=this.hot.countRows()-1;return ty(t)&&(e=t.syncLimit,aw(e)?e=Sb(n,e):e>>=0),Math.min(e,n)}getRowHeight(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;const n=t<0?this.headerHeight:this.rowHeightsMap.getValueAtIndex(this.hot.toPhysicalRow(t));let o=e;return null!==n&&n>(e||0)&&(o=n),o}getColumnHeaderHeight(){return this.headerHeight}getFirstVisibleRow(){const t=this.hot.view._wt;return t.wtViewport.rowsVisibleCalculator?t.wtTable.getFirstVisibleRow():t.wtViewport.rowsRenderCalculator?t.wtTable.getFirstRenderedRow():-1}getLastVisibleRow(){const t=this.hot.view._wt;return t.wtViewport.rowsVisibleCalculator?t.wtTable.getLastVisibleRow():t.wtViewport.rowsRenderCalculator?t.wtTable.getLastRenderedRow():-1}clearCache(){this.headerHeight=null,this.rowHeightsMap.init()}clearCacheByRange(t){const{from:e,to:n}="number"==typeof t?{from:t,to:t}:t;this.hot.batchExecution((()=>{Cb(Math.min(e,n),Math.max(e,n),(t=>{this.rowHeightsMap.setValueAtIndex(t,null)}))}),!0)}isNeedRecalculate(){return!!Ep(this.rowHeightsMap.getValues().slice(0,this.measuredRows),(t=>null===t)).length}destroy(){this.ghostTable.clean(),super.destroy()}}function fU(){const t=this.hot.renderCall,e=this.hot.getSettings().fixedRowsBottom,n=this.getFirstVisibleRow(),o=this.getLastVisibleRow();if(-1!==n&&-1!==o){if(this.calculateRowsHeight({from:n,to:o},void 0,t),e){const t=this.hot.countRows()-1;this.calculateRowsHeight({from:t-e,to:t})}this.isNeedRecalculate()&&!this.inProgress&&this.calculateAllRowsHeight()}}function mU(t,e,n){let o=t;return n&&(this.calculateRowsHeight(e,void 0,!0),o=this.getRowHeight(e)),o}function pU(){this.hot.view?this.recalculateAllRowsHeight():this.hot._registerTimeout((()=>{this.hot&&this.recalculateAllRowsHeight()}))}function wU(t){let e=null;1===t.length?e=t[0][0]:t.length>1&&(e={from:t[0][0],to:t[t.length-1][0]}),null!==e&&this.clearCacheByRange(e)}const{getListWithInsertedItems:AU,getListWithRemovedItems:vU}=xI("physicallyIndexed");class yU extends fI{constructor(){super((t=>t))}insert(t,e){const n=bI(this.indexedValues,e);this.indexedValues=AU(n,t,e,this.initValueOrFn),super.insert(t,e)}remove(t){const e=vU(this.indexedValues,t);this.indexedValues=CI(e,t),super.remove(t)}}const CU=yU,{getListWithInsertedItems:bU,getListWithRemovedItems:SU}=xI("physicallyIndexed");class EU extends fI{constructor(){super((t=>t))}insert(t,e){this.indexedValues=bU(this.indexedValues,t,e,((t,e)=>this.getNextValue(e))),super.insert(t,e)}remove(t){this.indexedValues=SU(this.indexedValues,t),super.remove(t)}getNextValue(t){return Math.max(...this.getValues())+1+t}}const RU=EU;function MU(t,e){TU(t,e),e.add(t)}function TU(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function kU(t,e,n){return e=xU(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function xU(t){var e=IU(t,"string");return"symbol"==typeof e?e:String(e)}function IU(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function OU(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const HU="bindRowsWithHeaders",DU=210,NU="loose",PU=new Map([["loose",CU],["strict",RU]]);var _U=new WeakSet;class BU extends jF{constructor(){super(...arguments),MU(this,_U),kU(this,"headerIndexes",null)}static get PLUGIN_KEY(){return HU}static get PLUGIN_PRIORITY(){return DU}isEnabled(){return!!this.hot.getSettings()[HU]}enablePlugin(){if(this.enabled)return;let t=this.hot.getSettings()[HU];"string"!=typeof t&&(t=NU);const e=PU.get(t);this.headerIndexes=this.hot.rowIndexMapper.registerMap("bindRowsWithHeaders",new e),this.addHook("modifyRowHeader",(t=>OU(this,_U,LU).call(this,t))),super.enablePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("bindRowsWithHeaders"),super.disablePlugin()}destroy(){super.destroy()}}function LU(t){return this.headerIndexes.getValueAtIndex(this.hot.toPhysicalRow(t))}function VU(t,e){FU(t,e),e.add(t)}function WU(t,e,n){FU(t,e),e.set(t,n)}function FU(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function jU(t,e,n){return e=UU(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function UU(t){var e=YU(t,"string");return"symbol"==typeof e?e:String(e)}function YU(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function zU(t,e){var n=XU(t,e,"get");return GU(t,n)}function GU(t,e){return e.get?e.get.call(t):e.value}function QU(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function KU(t,e,n){var o=XU(t,e,"set");return qU(t,o,n),n}function XU(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function qU(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}const ZU="collapsibleColumns",JU=290,$U=["nestedHeaders"],tY="collapsibleIndicator",eY=ZU,nY=new Map([["collapse",{hideColumn:!0,beforeHook:"beforeColumnCollapse",afterHook:"afterColumnCollapse"}],["expand",{hideColumn:!1,beforeHook:"beforeColumnExpand",afterHook:"afterColumnExpand"}]]);var oY=new WeakMap,iY=new WeakSet,rY=new WeakSet,sY=new WeakSet,aY=new WeakSet;class lY extends jF{constructor(){super(...arguments),VU(this,aY),VU(this,sY),VU(this,rY),VU(this,iY),jU(this,"nestedHeadersPlugin",null),jU(this,"headerStateManager",null),WU(this,oY,{writable:!0,value:null})}static get PLUGIN_KEY(){return ZU}static get PLUGIN_PRIORITY(){return JU}static get PLUGIN_DEPS(){return["plugin:NestedHeaders"]}static get SETTING_KEYS(){return[ZU,...$U]}isEnabled(){return!!this.hot.getSettings()[ZU]}enablePlugin(){var t=this;if(this.enabled)return;const{nestedHeaders:e}=this.hot.getSettings();e||Xy("You need to configure the Nested Headers plugin in order to use collapsible headers."),KU(this,oY,this.hot.columnIndexMapper.createAndRegisterIndexMap(this.pluginName,"hiding")),this.nestedHeadersPlugin=this.hot.getPlugin("nestedHeaders"),this.headerStateManager=this.nestedHeadersPlugin.getStateManager(),this.addHook("init",(()=>QU(this,sY,uY).call(this))),this.addHook("afterLoadData",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return QU(t,aY,dY).call(t,...n)})),this.addHook("afterGetColHeader",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return QU(t,iY,hY).call(t,...n)})),this.addHook("beforeOnCellMouseDown",((t,e,n)=>QU(this,rY,cY).call(this,t,e,n))),this.registerShortcuts(),super.enablePlugin(),this.updatePlugin()}updatePlugin(){if(this.hot.view){if(!this.nestedHeadersPlugin.detectedOverlappedHeaders){const{collapsibleColumns:t}=this.hot.getSettings();"boolean"==typeof t?this.headerStateManager.mapState((t=>({collapsible:t.origColspan>1}))):Array.isArray(t)&&(this.headerStateManager.mapState((()=>({collapsible:!1}))),this.headerStateManager.mergeStateWith(t))}super.updatePlugin()}}disablePlugin(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),KU(this,oY,null),this.nestedHeadersPlugin=null,this.unregisterShortcuts(),this.clearButtons(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{var t;const{row:e,col:n}=this.hot.getSelectedRangeLast().highlight,{collapsible:o,isCollapsed:i,columnIndex:r}=null!==(t=this.headerStateManager.getHeaderTreeNodeData(e,n))&&void 0!==t?t:{};o&&(i?this.expandSection({row:e,col:r}):this.collapseSection({row:e,col:r}))},runOnlyIf:()=>{var t;return null===(t=this.hot.getSelectedRangeLast())||void 0===t?void 0:t.highlight.isHeader()},group:eY})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(eY)}clearButtons(){if(!this.hot.view)return;const t=this.hot.view._wt.getSetting("columnHeaders").length,e=this.hot.view._wt.wtTable.THEAD,n=this.hot.view._wt.wtOverlays.topOverlay.clone.wtTable.THEAD,o=this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay?this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null,i=function(t){t&&t.parentNode.removeChild(t)};Cb(0,t-1,(t=>{const r=e.childNodes[t],s=n.childNodes[t],a=o?o.childNodes[t]:null;Cb(0,r.childNodes.length-1,(t=>{let e=r.childNodes[t].querySelector(`.${tY}`);i(e),s&&s.childNodes[t]&&(e=s.childNodes[t].querySelector(`.${tY}`),i(e)),o&&a&&a.childNodes[t]&&(e=a.childNodes[t].querySelector(`.${tY}`),i(e))}))}))}expandSection(t){this.toggleCollapsibleSection([t],"expand")}collapseSection(t){this.toggleCollapsibleSection([t],"collapse")}toggleAllCollapsibleSections(t){const e=this.headerStateManager.mapNodes((e=>{const{collapsible:n,origColspan:o,headerLevel:i,columnIndex:r,isCollapsed:s}=e;if(!0===n&&o>1&&(s&&"expand"===t||!s&&"collapse"===t))return{row:this.headerStateManager.levelToRowCoords(i),col:r}}));this.toggleCollapsibleSection(e,t)}collapseAll(){this.toggleAllCollapsibleSections("collapse")}expandAll(){this.toggleAllCollapsibleSections("expand")}toggleCollapsibleSection(t,e){if(!nY.has(e))throw new Error(`Unsupported action is passed (${e}).`);if(!Array.isArray(t))return;const n=Ep(t,(t=>{let{row:e}=t;return e<0}));let o=n.length>0;Mp(n,(t=>{var n;let{row:i,col:r}=t;const{collapsible:s,isCollapsed:a}=null!==(n=this.headerStateManager.getHeaderSettings(i,r))&&void 0!==n?n:{};if(!s||a&&"collapse"===e||!a&&"expand"===e)return o=!1,!1}));const i=[],r=[];o&&Mp(n,(t=>{let{row:n,col:o}=t;const{colspanCompensation:s,affectedColumns:a,rollbackModification:l}=this.headerStateManager.triggerNodeModification(e,n,o);s>0&&(r.push(...a),i.push(l))}));const s=this.getCollapsedColumns();let a=[];"collapse"===e?a=Hp([...s,...r]):"expand"===e&&(a=Ep(s,(t=>!r.includes(t))));const l=nY.get(e);if(!1===this.hot.runHooks(l.beforeHook,s,a,o))return void Mp(i,(t=>{t()}));this.hot.batchExecution((()=>{Mp(r,(t=>{zU(this,oY).setValueAtIndex(this.hot.toPhysicalColumn(t),l.hideColumn)}))}),!0);const h=this.getCollapsedColumns().length!==s.length;this.hot.runHooks(l.afterHook,s,a,o,h),this.hot.render(),this.hot.view.adjustElementsSize(!0)}getCollapsedColumns(){return zU(this,oY).getHiddenIndexes()}destroy(){KU(this,oY,null),super.destroy()}}function hY(t,e,n){var o;const{collapsible:i,origColspan:r,isCollapsed:s}=null!==(o=this.headerStateManager.getHeaderSettings(n,t))&&void 0!==o?o:{},a=i&&r>1&&t>=this.hot.getSettings().fixedColumnsStart,l=this.hot.getSettings().ariaTags;let h=e.querySelector(`.${tY}`);var c;(gA(e,[Lw("")[0]]),a)?(h||(h=this.hot.rootDocument.createElement("div"),cA(h,tY),e.querySelector("div:first-child").appendChild(h)),uA(h,["collapsed","expanded"]),s?(cA(h,"collapsed"),AA(h,"+"),l&&dA(e,...Lw(!1))):(cA(h,"expanded"),AA(h,"-"),l&&dA(e,...Lw(!0))),l&&dA(h,...Iw())):null===(c=h)||void 0===c||c.remove()}function cY(t,e){hA(t.target,tY)&&(hA(t.target,"expanded")?(this.eventManager.fireEvent(t.target,"mouseup"),this.toggleCollapsibleSection([e],"collapse")):hA(t.target,"collapsed")&&(this.eventManager.fireEvent(t.target,"mouseup"),this.toggleCollapsibleSection([e],"expand")),Uy(t))}function uY(){this.updatePlugin()}function dY(t,e){e||this.updatePlugin()}function gY(t,e,n){return e=fY(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function fY(t){var e=mY(t,"string");return"symbol"==typeof e?e:String(e)}function mY(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}const pY=["sortEmptyCells","indicator","headerAction","compareFunctionFactory"],wY=!1,AY=!0,vY=!0;class yY{constructor(t,e){gY(this,"hot",void 0),gY(this,"sortingStates",new MI),gY(this,"sortEmptyCells",wY),gY(this,"indicator",AY),gY(this,"headerAction",vY),gY(this,"compareFunctionFactory",void 0),gY(this,"mapName",void 0),this.hot=t,this.mapName=e,this.hot.columnIndexMapper.registerMap(e,this.sortingStates)}updateAllColumnsProperties(t){ty(t)&&ny(t,((t,e)=>{pY.includes(e)&&(this[e]=t)}))}getAllColumnsProperties(){const t={sortEmptyCells:this.sortEmptyCells,indicator:this.indicator,headerAction:this.headerAction};return"function"==typeof this.compareFunctionFactory&&(t.compareFunctionFactory=this.compareFunctionFactory),t}getSortOrderOfColumn(t){var e;return null===(e=this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(t)))||void 0===e?void 0:e.sortOrder}getIndexOfColumnInSortQueue(t){return t=this.hot.toPhysicalColumn(t),this.sortingStates.getEntries().findIndex((e=>{let[n]=e;return n===t}))}getNumberOfSortedColumns(){return this.sortingStates.getLength()}isListOfSortedColumnsEmpty(){return 0===this.getNumberOfSortedColumns()}isColumnSorted(t){return ty(this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(t)))}getSortStates(){return null===this.sortingStates?[]:this.sortingStates.getEntries().map((t=>{let[e,n]=t;return p({column:this.hot.toVisualColumn(e)},n)}))}getColumnSortState(t){const e=this.getSortOrderOfColumn(t);if(Wp(e))return{column:t,sortOrder:e}}setSortStates(t){this.sortingStates.clear();for(let e=0;e<t.length;e+=1)this.sortingStates.setValueAtIndex(this.hot.toPhysicalColumn(t[e].column),{sortOrder:t[e].sortOrder})}destroy(){this.hot.columnIndexMapper.unregisterMap(this.mapName),this.sortingStates=null}}const CY="asc",bY="desc",SY="colHeader";function EY(t){if(!1===ty(t))return!1;const{column:e,sortOrder:n}=t;return Number.isInteger(e)&&[CY,bY].includes(n)}function RY(t){if(t.some((t=>!1===EY(t))))return!1;const e=t.map((t=>{let{column:e}=t;return e}));return new Set(e).size===e.length}function MY(t){if(t!==bY)return t===CY?bY:CY}function TY(t){return t.querySelector(`.${SY}`)}function kY(t,e){if(t<0||!e.parentNode)return!1;const n=e.parentNode.parentNode.childNodes;return Array.from(n).indexOf(e.parentNode)-n.length===-1}function xY(t,e,n){return-1===t&&e>=0&&!1===zy(n)}const IY="ascending",OY="descending",HY="indicatorDisabled",DY="columnSorting",NY="sortAction",PY=new Map([[CY,IY],[bY,OY]]);function _Y(t,e,n,o){const i=[DY];if(o&&i.push(NY),!1===n)return i.push(HY),i;const r=t.getSortOrderOfColumn(e);return Wp(r)&&i.push(PY.get(r)),i}function BY(){return Array.from(PY.values()).concat(NY,HY,DY)}function LY(t,e,n){const o=e.locale;return function(e,i){const{sortEmptyCells:r}=n;return"string"==typeof e&&(e=e.toLocaleLowerCase(o)),"string"==typeof i&&(i=i.toLocaleLowerCase(o)),e===i?JY:jp(e)?jp(i)?JY:r&&"asc"===t?$Y:tz:jp(i)?r&&"asc"===t?tz:$Y:isNaN(e)&&!isNaN(i)?"asc"===t?tz:$Y:!isNaN(e)&&isNaN(i)||(isNaN(e)||isNaN(i)||(e=parseFloat(e),i=parseFloat(i)),e<i)?"asc"===t?$Y:tz:e>i?"asc"===t?tz:$Y:JY}}const VY="default";function WY(t,e,n){return function(e,o){const i=parseFloat(e),r=parseFloat(o),{sortEmptyCells:s}=n;if(i===r||isNaN(i)&&isNaN(r))return JY;if(s){if(jp(e))return"asc"===t?$Y:tz;if(jp(o))return"asc"===t?tz:$Y}return isNaN(i)?tz:isNaN(r)?$Y:i<r?"asc"===t?$Y:tz:i>r?"asc"===t?tz:$Y:JY}}const FY="numeric";function jY(t,e,n){const o=e.checkedTemplate,i=e.uncheckedTemplate,{sortEmptyCells:r}=n;return function(s,a){const l=jp(s),h=jp(a),c=l?i:s,u=h?i:a,d=c===i||c===o,g=u===i||u===o;if(!1===r){if(l&&!1===h)return tz;if(!1===l&&h)return $Y}return!1===d&&g?"asc"===t?$Y:tz:d&&!1===g?"asc"===t?tz:$Y:!1===d&&!1===g?LY(t,e,n)(s,a):c===i&&u===o?"asc"===t?$Y:tz:c===o&&u===i?"asc"===t?tz:$Y:JY}}const UY="checkbox";function YY(t,e,n){return function(o,i){const{sortEmptyCells:r}=n;if(o===i)return JY;if(jp(o))return jp(i)?JY:r&&"asc"===t?$Y:tz;if(jp(i))return r&&"asc"===t?tz:$Y;const s=e.dateFormat,a=gh(o,s),l=gh(i,s);return a.isValid()?l.isValid()?l.isAfter(a)?"asc"===t?$Y:tz:l.isBefore(a)?"asc"===t?tz:$Y:JY:$Y:tz}}const zY="date",{register:GY,getItem:QY,hasItem:KY}=hC("sorting.compareFunctionFactory"),{register:XY,getItem:qY}=hC("sorting.mainSortComparator");function ZY(t){return KY(t)?QY(t):QY(VY)}GY(FY,WY),GY(UY,jY),GY(zY,YY),GY(VY,LY);const JY=0,$Y=-1,tz=1;function ez(t,e){const n=qY(e);for(var o=arguments.length,i=new Array(o>2?o-2:0),r=2;r<o;r++)i[r-2]=arguments[r];t.sort(n(...i))}function nz(t,e){return function(n,o){const[,...i]=n,[,...r]=o;return function(n){const o=t[n],s=e[n],a=i[n],l=r[n],h=s.columnSorting;return(h.compareFunctionFactory?h.compareFunctionFactory:ZY(s.type))(o,s,h)(a,l)}(0)}}function oz(t,e){iz(t,e),e.add(t)}function iz(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function rz(t,e,n){return e=sz(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function sz(t){var e=az(t,"string");return"symbol"==typeof e?e:String(e)}function az(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function lz(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const hz="columnSorting",cz=50,uz="append",dz="replace",gz=hz;XY(hz,nz),aC.getSingleton().register("beforeColumnSort"),aC.getSingleton().register("afterColumnSort");var fz=new WeakSet,mz=new WeakSet,pz=new WeakSet,wz=new WeakSet;class Az extends jF{constructor(){super(...arguments),oz(this,wz),oz(this,pz),oz(this,mz),oz(this,fz),rz(this,"columnStatesManager",null),rz(this,"columnMetaCache",null),rz(this,"pluginKey",hz),rz(this,"indexesSequenceCache",null)}static get PLUGIN_KEY(){return hz}static get PLUGIN_PRIORITY(){return cz}isEnabled(){return!!this.hot.getSettings()[this.pluginKey]}enablePlugin(){var t=this;this.enabled||(this.columnStatesManager=new yY(this.hot,`${this.pluginKey}.sortingStates`),this.columnMetaCache=new wI((t=>{let e=this.hot.toVisualColumn(t);return null===e&&(e=t),this.getMergedPluginSettings(e)})),this.hot.columnIndexMapper.registerMap(`${this.pluginKey}.columnMeta`,this.columnMetaCache),this.addHook("afterGetColHeader",((t,e)=>lz(this,mz,yz).call(this,t,e))),this.addHook("beforeOnCellMouseDown",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return lz(t,wz,bz).call(t,...n)})),this.addHook("afterOnCellMouseDown",((t,e)=>this.onAfterOnCellMouseDown(t,e))),this.addHook("afterInit",(()=>lz(this,fz,vz).call(this))),this.addHook("afterLoadData",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return lz(t,pz,Cz).call(t,...n)})),this.hot.view&&lz(this,fz,vz).call(this),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){const t=(t,e)=>{const n=TY(e);!1===kY(t,e)||null===n||this.updateHeaderClasses(n)};this.hot.addHook("afterGetColHeader",t),this.hot.addHookOnce("afterViewRender",(()=>{this.hot.removeHook("afterGetColHeader",t)})),this.hot.batchExecution((()=>{null!==this.indexesSequenceCache&&(this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues()),this.hot.rowIndexMapper.unregisterMap(this.pluginKey))}),!0),this.hot.columnIndexMapper.unregisterMap(`${this.pluginKey}.columnMeta`),this.columnStatesManager.destroy(),this.columnMetaCache=null,this.columnStatesManager=null,this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{const{highlight:t}=this.hot.getSelectedRangeLast();-1===t.row&&t.col>=0&&this.sort(this.getColumnNextConfig(t.col))},runOnlyIf:()=>{var t;const e=null===(t=this.hot.getSelectedRangeLast())||void 0===t?void 0:t.highlight;return e&&this.hot.selection.isCellVisible(e)&&e.isHeader()},group:gz})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(gz)}sort(t){const e=this.getSortConfig(),n=this.getNormalizedSortConfigs(t),o=this.areValidSortConfigs(n);!1!==this.hot.runHooks("beforeColumnSort",e,n,o)&&(0===e.length&&null===this.indexesSequenceCache&&(this.indexesSequenceCache=this.hot.rowIndexMapper.registerMap(this.pluginKey,new II),this.indexesSequenceCache.setValues(this.hot.rowIndexMapper.getIndexesSequence())),o&&(this.columnStatesManager.setSortStates(n),this.sortByPresetSortStates(n),this.saveAllSortSettings(n)),this.hot.runHooks("afterColumnSort",e,o?n:e,o),o&&(this.hot.render(),this.hot.forceFullRender=!1,this.hot.view.render()))}clearSort(){this.sort([])}isSorted(){return this.enabled&&!this.columnStatesManager.isListOfSortedColumnsEmpty()}getSortConfig(t){return Wp(t)?this.columnStatesManager.getColumnSortState(t):this.columnStatesManager.getSortStates()}setSortConfig(t){const e=this.getNormalizedSortConfigs(t);this.areValidSortConfigs(e)&&this.columnStatesManager.setSortStates(e)}getNormalizedSortConfigs(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return Array.isArray(t)?t.slice(0,1):[t]}areValidSortConfigs(t){const e=this.hot.countCols();return RY(t)&&t.every((t=>{let{column:n}=t;return n<=e&&n>=0}))}saveAllSortSettings(t){const e=this.columnStatesManager.getAllColumnsProperties(),n=t=>{let e=t,{column:n}=e,o=A(e,["column"]);return p({column:this.hot.toPhysicalColumn(n)},o)};e.initialConfig=Rp(t,n),this.hot.runHooks("persistentStateSave","columnSorting",e)}getAllSavedSortSettings(){const t={};this.hot.runHooks("persistentStateLoad","columnSorting",t);const e=t.value,n=t=>{let e=t,{column:n}=e,o=A(e,["column"]);return p({column:this.hot.toVisualColumn(n)},o)};return Wp(e)&&Array.isArray(e.initialConfig)&&(e.initialConfig=Rp(e.initialConfig,n)),e}getColumnNextConfig(t){const e=this.columnStatesManager.getSortOrderOfColumn(t);if(Wp(e)){const n=MY(e);return Wp(n)?{column:t,sortOrder:n}:void 0}const n=this.hot.countCols();if(Number.isInteger(t)&&t>=0&&t<n)return{column:t,sortOrder:MY()}}getNextSortConfig(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:uz;const n=this.columnStatesManager.getIndexOfColumnInSortQueue(t),o=-1!==n,i=this.getSortConfig(),r=this.getColumnNextConfig(t);if(o){if(Fp(r))return[...i.slice(0,n),...i.slice(n+1)];if(e===uz)return[...i.slice(0,n),...i.slice(n+1),r];if(e===dz)return[...i.slice(0,n),r,...i.slice(n+1)]}return Wp(r)?i.concat(r):i}getPluginColumnConfig(t){if(ty(t)){const e=t[this.pluginKey];if(ty(e))return e}return{}}getMergedPluginSettings(t){const e=this.hot.getSettings()[this.pluginKey],n=this.columnStatesManager.getAllColumnsProperties(),o=this.hot.getCellMeta(0,t),i=Object.getPrototypeOf(o);return Array.isArray(i.columns)?Object.assign(n,e,this.getPluginColumnConfig(i.columns[t])):iv(i.columns)?Object.assign(n,e,this.getPluginColumnConfig(i.columns(t))):Object.assign(n,e)}getFirstCellSettings(t){const e=this.hot.getCellMeta(0,t),n=Object.create(e);return n[this.pluginKey]=this.columnMetaCache.getValueAtIndex(this.hot.toPhysicalColumn(t)),n}getNumberOfRowsToSort(t){const e=this.hot.getSettings();return e.maxRows<=t?e.maxRows:t-e.minSpareRows}sortByPresetSortStates(t){if(0===t.length)return void this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues());const e=[],n=this.hot.countRows(),o=e=>Rp(t,(t=>this.hot.getDataAtCell(e,t.column)));for(let l=0;l<this.getNumberOfRowsToSort(n);l+=1)e.push([this.hot.toPhysicalRow(l)].concat(o(l)));const i=Rp(e,(t=>t[0]));ez(e,this.pluginKey,Rp(t,(t=>t.sortOrder)),Rp(t,(t=>this.getFirstCellSettings(t.column))));for(let l=e.length;l<n;l+=1)e.push([l].concat(o(l)));const r=Rp(e,(t=>t[0])),s=new Map(Rp(i,((t,e)=>[t,r[e]]))),a=Rp(this.hot.rowIndexMapper.getIndexesSequence(),(t=>s.has(t)?s.get(t):t));this.hot.rowIndexMapper.setIndexesSequence(a)}sortBySettings(t){if(ty(t)){this.columnStatesManager.updateAllColumnsProperties(t);const e=t.initialConfig;(Array.isArray(e)||ty(e))&&this.sort(e)}else this.hot.render()}updateHeaderClasses(t){if(uA(t,BY()),!1!==this.enabled){for(var e=arguments.length,n=new Array(e>1?e-1:0),o=1;o<e;o++)n[o-1]=arguments[o];cA(t,_Y(...n))}}onUpdateSettings(t){super.onUpdateSettings(),null!==this.columnMetaCache&&this.columnMetaCache.init(this.hot.columnIndexMapper.getNumberOfIndexes()),Wp(t[this.pluginKey])&&this.sortBySettings(t[this.pluginKey])}wasClickableHeaderClicked(t,e){return this.getFirstCellSettings(e)[this.pluginKey].headerAction&&hA(t.target,SY)}onAfterOnCellMouseDown(t,e){!1!==xY(e.row,e.col,t)&&this.wasClickableHeaderClicked(t,e.col)&&(this.hot.getShortcutManager().isCtrlPressed()&&(this.hot.deselectCell(),this.hot.selectColumns(e.col)),this.sort(this.getColumnNextConfig(e.col)))}destroy(){var t;null===(t=this.columnStatesManager)||void 0===t||t.destroy(),super.destroy()}}function vz(){const t=this.getAllSavedSortSettings();if(ty(t))this.sortBySettings(t);else{const t=this.hot.getSettings()[this.pluginKey];this.sortBySettings(t)}}function yz(t,e){const n=TY(e);if(!1===kY(t,e)||null===n)return;const o=this.getFirstCellSettings(t)[this.pluginKey],i=o.indicator,r=o.headerAction;if(this.updateHeaderClasses(n,this.columnStatesManager,t,i,r),this.hot.getSettings().ariaTags){const n=this.columnStatesManager.getSortOrderOfColumn(t);dA(e,...Vw(n?`${n}ending`:"none"))}}function Cz(t){!0===t&&this.hot.view&&lz(this,fz,vz).call(this)}function bz(t,e,n,o){!1!==xY(e.row,e.col,t)&&this.wasClickableHeaderClicked(t,e.col)&&this.hot.getShortcutManager().isCtrlPressed()&&(o.column=!0)}function Sz(t,e,n){return e=Ez(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ez(t){var e=Rz(t,"string");return"symbol"==typeof e?e:String(e)}function Rz(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class Mz{constructor(t,e){Sz(this,"plugin",void 0),Sz(this,"hot",void 0),Sz(this,"endpoints",[]),Sz(this,"settings",void 0),Sz(this,"settingsType","array"),Sz(this,"currentEndpoint",null),Sz(this,"cellsToSetCache",[]),this.plugin=t,this.hot=this.plugin.hot,this.settings=e}initEndpoints(){this.endpoints=this.parseSettings(),this.refreshAllEndpoints()}getEndpoint(t){return"function"===this.settingsType?this.fillMissingEndpointData(this.settings)[t]:this.endpoints[t]}getAllEndpoints(){return"function"===this.settingsType?this.fillMissingEndpointData(this.settings):this.endpoints}fillMissingEndpointData(t){return this.parseSettings(t.call(this))}parseSettings(t){const e=[];let n=t;if(n||"function"!=typeof this.settings)return n||(n=this.settings),Mp(n,(t=>{const n={};this.assignSetting(t,n,"ranges",[[0,this.hot.countRows()-1]]),this.assignSetting(t,n,"reversedRowCoords",!1),this.assignSetting(t,n,"destinationRow",new Error("\n        You must provide a destination row for the Column Summary plugin in order to work properly!\n      ")),this.assignSetting(t,n,"destinationColumn",new Error("\n        You must provide a destination column for the Column Summary plugin in order to work properly!\n      ")),this.assignSetting(t,n,"sourceColumn",t.destinationColumn),this.assignSetting(t,n,"type","sum"),this.assignSetting(t,n,"forceNumeric",!1),this.assignSetting(t,n,"suppressDataTypeErrors",!0),this.assignSetting(t,n,"customFunction",null),this.assignSetting(t,n,"readOnly",!0),this.assignSetting(t,n,"roundFloat",!1),e.push(n)})),e;this.settingsType="function"}assignSetting(t,e,n,o){if("ranges"!==n||void 0!==t[n]){if("ranges"!==n||0!==t[n].length)if(void 0===t[n]){if(o instanceof Error)throw o;e[n]=o}else"destinationRow"===n&&e.reversedRowCoords?e[n]=this.hot.countRows()-t[n]-1:e[n]=t[n]}else e[n]=o}resetSetupBeforeStructureAlteration(t,e,n){if("function"!==this.settingsType)return;const o=t.indexOf("row")>-1?"row":"col",i=this.getAllEndpoints();Mp(i,(i=>{"row"===o&&i.destinationRow>=e&&("insert_row"===t?i.alterRowOffset=n:"remove_row"===t&&(i.alterRowOffset=-1*n)),"col"===o&&i.destinationColumn>=e&&("insert_col"===t?i.alterColumnOffset=n:"remove_col"===t&&(i.alterColumnOffset=-1*n))})),this.resetAllEndpoints(i,!1)}resetSetupAfterStructureAlteration(t,e,n,o,i){let r=!(arguments.length>5&&void 0!==arguments[5])||arguments[5];if("function"===this.settingsType){const t=()=>(this.hot.removeHook("beforeViewRender",t),this.refreshAllEndpoints());return void this.hot.addHookOnce("beforeViewRender",t)}const s=t.indexOf("row")>-1?"row":"col",a=t.indexOf("remove")>-1?-1:1,l=this.getAllEndpoints(),h=0===t.indexOf("move_row"),c=e;Mp(l,(t=>{"row"===s&&t.destinationRow>=c&&(t.alterRowOffset=a*n),"col"===s&&t.destinationColumn>=c&&(t.alterColumnOffset=a*n)})),this.resetAllEndpoints(l,!h),Mp(l,h?t=>{this.extendEndpointRanges(t,c,o[0],o.length),this.recreatePhysicalRanges(t),this.clearOffsetInformation(t)}:t=>{this.shiftEndpointCoordinates(t,c)}),r&&this.refreshAllEndpoints()}clearOffsetInformation(t){t.alterRowOffset=void 0,t.alterColumnOffset=void 0}extendEndpointRanges(t,e,n,o){Mp(t.ranges,(t=>{t[1]&&(e>=t[0]&&e<=t[1]?n>t[1]?t[1]+=o:n<t[0]&&(t[0]-=o):n>=t[0]&&n<=t[1]&&(t[1]-=o,e<=t[0]&&(t[0]+=1,t[1]+=1)))}))}recreatePhysicalRanges(t){const e=t.ranges,n=[],o=[];Mp(e,(t=>{const e=[];if(t[1])for(let n=t[0];n<=t[1];n++)e.push(this.hot.toPhysicalRow(n));else e.push(this.hot.toPhysicalRow(t[0]));o.push(e)})),Mp(o,(t=>{let e=[];Mp(t,((o,i)=>{0===i?e.push(o):t[i]!==t[i-1]+1&&(e.push(t[i-1]),n.push(e),e=[],e.push(o)),i===t.length-1&&(e.push(o),n.push(e))}))})),t.ranges=n}shiftEndpointCoordinates(t,e){t.alterRowOffset&&0!==t.alterRowOffset?(t.destinationRow+=t.alterRowOffset||0,Mp(t.ranges,(n=>{Mp(n,((o,i)=>{o>=e&&(n[i]+=t.alterRowOffset||0)}))}))):t.alterColumnOffset&&0!==t.alterColumnOffset&&(t.destinationColumn+=t.alterColumnOffset||0,t.sourceColumn+=t.alterColumnOffset||0)}resetAllEndpoints(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getAllEndpoints(),e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];t.some((t=>{const e=t.alterRowOffset||0,n=t.alterColumnOffset||0;return t.destinationRow+e>=this.hot.countRows()||t.destinationColumn+n>=this.hot.countCols()}))||(this.cellsToSetCache=[],Mp(t,(t=>{this.resetEndpointValue(t,e)})),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[])}refreshAllEndpoints(){this.cellsToSetCache=[],Mp(this.getAllEndpoints(),(t=>{this.currentEndpoint=t,this.plugin.calculate(t),this.setEndpointValue(t,"init")})),this.currentEndpoint=null,this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}refreshChangedEndpoints(t){const e=[];this.cellsToSetCache=[],Mp(t,((t,n,o)=>{`${t[2]||""}`!=`${t[3]}`&&Mp(this.getAllEndpoints(),((t,i)=>{this.hot.propToCol(o[n][1])===t.sourceColumn&&-1===e.indexOf(i)&&e.push(i)}))})),Mp(e,(t=>{this.refreshEndpoint(this.getEndpoint(t))})),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}refreshEndpoint(t){this.currentEndpoint=t,this.plugin.calculate(t),this.setEndpointValue(t),this.currentEndpoint=null}resetEndpointValue(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];const n=t.alterRowOffset||0,o=t.alterColumnOffset||0;this.cellsToSetCache.push([this.hot.toVisualRow(t.destinationRow+(e?n:0)),this.hot.toVisualColumn(t.destinationColumn+(e?o:0)),""])}setEndpointValue(t,e){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const o=this.hot.toVisualRow(t.destinationRow);if(t.destinationRow>=this.hot.countRows()||t.destinationColumn>=this.hot.countCols())return void this.throwOutOfBoundsWarning();const i=this.hot.toVisualRow(t.destinationRow);if(null!==i){const n=this.hot.getCellMeta(i,t.destinationColumn);("init"===e||n.readOnly!==t.readOnly)&&(n.readOnly=t.readOnly,n.className="columnSummaryResult")}if((!0===t.roundFloat||Number.isInteger(t.roundFloat))&&!isNaN(t.result)){const e=t.roundFloat;let n=0;Number.isInteger(e)&&(n=Math.min(Math.max(0,e),100)),t.result=t.result.toFixed(n)}n?this.hot.setDataAtCell(o,t.destinationColumn,t.result,"ColumnSummary.set"):this.cellsToSetCache.push([o,t.destinationColumn,t.result]),t.alterRowOffset=void 0,t.alterColumnOffset=void 0}throwOutOfBoundsWarning(){Xy("One of the Column Summary plugins' destination points you provided is beyond the table boundaries!")}}const Tz=Mz;function kz(t){return null==t||isNaN(t)}function xz(t,e){Iz(t,e),e.add(t)}function Iz(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Oz(t,e,n){return e=Hz(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Hz(t){var e=Dz(t,"string");return"symbol"==typeof e?e:String(e)}function Dz(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function Nz(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const Pz="columnSummary",_z=220;var Bz=new WeakSet,Lz=new WeakSet,Vz=new WeakSet;class Wz extends jF{constructor(){super(...arguments),xz(this,Vz),xz(this,Lz),xz(this,Bz),Oz(this,"endpoints",null)}static get PLUGIN_KEY(){return Pz}static get PLUGIN_PRIORITY(){return _z}isEnabled(){return!!this.hot.getSettings()[Pz]}enablePlugin(){var t=this;this.enabled||(this.settings=this.hot.getSettings()[Pz],this.endpoints=new Tz(this,this.settings),this.addHook("afterInit",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return Nz(t,Bz,Fz).call(t,...n)})),this.addHook("afterChange",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return Nz(t,Lz,jz).call(t,...n)})),this.addHook("beforeCreateRow",((t,e,n)=>this.endpoints.resetSetupBeforeStructureAlteration("insert_row",t,e,null,n))),this.addHook("beforeCreateCol",((t,e,n)=>this.endpoints.resetSetupBeforeStructureAlteration("insert_col",t,e,null,n))),this.addHook("beforeRemoveRow",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return t.endpoints.resetSetupBeforeStructureAlteration("remove_row",...n)})),this.addHook("beforeRemoveCol",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return t.endpoints.resetSetupBeforeStructureAlteration("remove_col",...n)})),this.addHook("afterCreateRow",((t,e,n)=>this.endpoints.resetSetupAfterStructureAlteration("insert_row",t,e,null,n))),this.addHook("afterCreateCol",((t,e,n)=>this.endpoints.resetSetupAfterStructureAlteration("insert_col",t,e,null,n))),this.addHook("afterRemoveRow",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return t.endpoints.resetSetupAfterStructureAlteration("remove_row",...n)})),this.addHook("afterRemoveCol",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return t.endpoints.resetSetupAfterStructureAlteration("remove_col",...n)})),this.addHook("afterRowMove",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return Nz(t,Vz,Uz).call(t,...n)})),super.enablePlugin())}disablePlugin(){this.endpoints=null,this.settings=null,this.currentEndpoint=null,super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.endpoints.initEndpoints(),super.updatePlugin()}calculate(t){switch(t.type.toLowerCase()){case"sum":t.result=this.calculateSum(t);break;case"min":t.result=this.calculateMinMax(t,t.type);break;case"max":t.result=this.calculateMinMax(t,t.type);break;case"count":t.result=this.countEntries(t);break;case"average":t.result=this.calculateAverage(t);break;case"custom":t.result=t.customFunction.call(this,t);break}}calculateSum(t){let e=0;return ny(t.ranges,(n=>{e+=this.getPartialSum(n,t.sourceColumn)})),e}getPartialSum(t,e){let n=0,o=t[1]||t[0],i=null,r=0;do{if(i=this.getCellValue(o,e),i=kz(i)?null:i,null!==i){const t=(`${i}`.split(".")[1]||[]).length||1;t>r&&(r=t)}n+=i||0,o-=1}while(o>=t[0]);return Math.round(n*f(10,r))/f(10,r)}calculateMinMax(t,e){let n=null;return ny(t.ranges,(o=>{const i=this.getPartialMinMax(o,t.sourceColumn,e);if(null===n&&null!==i&&(n=i),null!==i)switch(e){case"min":n=Math.min(n,i);break;case"max":n=Math.max(n,i);break}})),null===n?"Not enough data":n}getPartialMinMax(t,e,n){let o,i=null,r=t[1]||t[0];do{if(o=this.getCellValue(r,e),o=kz(o)?null:o,null===i)i=o;else if(null!==o)switch(n){case"min":i=Math.min(i,o);break;case"max":i=Math.max(i,o);break}r-=1}while(r>=t[0]);return i}countEmpty(t,e){let n,o=0,i=t[1]||t[0];do{n=this.getCellValue(i,e),n=kz(n)?null:n,null===n&&(o+=1),i-=1}while(i>=t[0]);return o}countEntries(t){let e=0;const n=t.ranges;return ny(n,(n=>{const o=void 0===n[1]?1:n[1]-n[0]+1,i=this.countEmpty(n,t.sourceColumn);e+=o,e-=i})),e}calculateAverage(t){const e=this.calculateSum(t),n=this.countEntries(t);return e/n}getCellValue(t,e){const n=this.hot.toVisualRow(t),o=this.hot.toVisualColumn(e);let i=this.hot.getSourceDataAtCell(t,e),r="";if(null!==n&&null!==o&&(r=this.hot.getCellMeta(n,o).className||""),r.indexOf("columnSummaryResult")>-1)return null;if(this.endpoints.currentEndpoint.forceNumeric&&("string"==typeof i&&(i=i.replace(/,/,".")),i=parseFloat(i)),isNaN(i)&&!this.endpoints.currentEndpoint.suppressDataTypeErrors)throw new Error(Lp`ColumnSummary plugin: cell at (${t}, ${e}) is not in a\x20
          numeric format. Cannot do the calculation.`);return i}}function Fz(){this.endpoints.initEndpoints()}function jz(t,e){t&&"ColumnSummary.reset"!==e&&"ColumnSummary.set"!==e&&"loadData"!==e&&this.endpoints.refreshChangedEndpoints(t)}function Uz(t,e){this.endpoints.resetSetupBeforeStructureAlteration("move_row",t[0],t.length,t,this.pluginName),this.endpoints.resetSetupAfterStructureAlteration("move_row",e,t.length,t,this.pluginName)}function Yz(t,e,n){return e=zz(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function zz(t){var e=Gz(t,"string");return"symbol"==typeof e?e:String(e)}function Gz(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class Qz{static get CLASS_EDITOR_CONTAINER(){return"htCommentsContainer"}static get CLASS_EDITOR(){return"htComments"}static get CLASS_INPUT(){return"htCommentTextArea"}static get CLASS_CELL(){return"htCommentCell"}constructor(t,e){Yz(this,"rootDocument",void 0),Yz(this,"isRtl",!1),Yz(this,"container",null),Yz(this,"editor",void 0),Yz(this,"editorStyle",void 0),Yz(this,"hidden",!0),this.rootDocument=t,this.isRtl=e,this.editor=this.createEditor(),this.editorStyle=this.editor.style,this.hide()}setPosition(t,e){this.editorStyle.left=`${t}px`,this.editorStyle.top=`${e}px`}setSize(t,e){if(t&&e){const n=this.getInputElement();n.style.width=`${t}px`,n.style.height=`${e}px`}}getSize(){return{width:IA(this.getInputElement()),height:OA(this.getInputElement())}}resetSize(){const t=this.getInputElement();t.style.width="",t.style.height=""}setReadOnlyState(t){const e=this.getInputElement();e.readOnly=t}show(){this.editorStyle.display="block",this.hidden=!1}hide(){this.hidden||(this.editorStyle.display="none"),this.hidden=!0}isVisible(){return"block"===this.editorStyle.display}setValue(){const t=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"")||"";this.getInputElement().value=t}getValue(){return this.getInputElement().value}isFocused(){return this.rootDocument.activeElement===this.getInputElement()}focus(){this.getInputElement().focus()}createEditor(){const t=this.rootDocument.createElement("div"),e=this.rootDocument.createElement("textarea");return t.style.display="none",this.container=this.rootDocument.createElement("div"),this.container.setAttribute("dir",this.isRtl?"rtl":"ltr"),cA(this.container,Qz.CLASS_EDITOR_CONTAINER),this.rootDocument.body.appendChild(this.container),cA(t,Qz.CLASS_EDITOR),cA(e,Qz.CLASS_INPUT),e.setAttribute("data-hot-input",!0),t.appendChild(e),this.container.appendChild(t),t}getInputElement(){return this.editor.querySelector(`.${Qz.CLASS_INPUT}`)}destroy(){const t=this.container?this.container.parentNode:null;this.editor.parentNode.removeChild(this.editor),this.editor=null,this.editorStyle=null,t&&t.removeChild(this.container)}}const Kz=Qz;function Xz(t,e,n){return e=qz(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function qz(t){var e=Zz(t,"string");return"symbol"==typeof e?e:String(e)}function Zz(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}const Jz=250,$z=250;class tG{constructor(t){Xz(this,"wasLastActionShow",!0),Xz(this,"showDebounced",null),Xz(this,"hidingTimer",null),this.updateDelay(t)}hide(){this.wasLastActionShow=!1,this.hidingTimer=setTimeout((()=>{!1===this.wasLastActionShow&&this.runLocalHooks("hide")}),$z)}show(t){this.wasLastActionShow=!0,this.showDebounced(t)}cancelHiding(){this.wasLastActionShow=!0,clearTimeout(this.hidingTimer),this.hidingTimer=null}updateDelay(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Jz;this.showDebounced=av((t=>{this.wasLastActionShow&&this.runLocalHooks("show",t.from.row,t.from.col)}),t)}destroy(){this.clearLocalHooks()}}Jv(tG,YT);const eG=tG;function nG(t,e){return-1!==t.indexOf(e)?t:`${t.replace("htTop","").replace("htMiddle","").replace("htBottom","").replace("  ","")} ${e}`}function oG(t,e){return-1!==t.indexOf(e)?t:`${t.replace("htLeft","").replace("htCenter","").replace("htRight","").replace("htJustify","").replace("  ","")} ${e}`}function iG(t,e){const n={};return Mp(t,(t=>{t.forAll(((t,o)=>{t>=0&&o>=0&&(n[t]||(n[t]=[]),n[t][o]=e(t,o))}))})),n}function rG(t,e,n,o,i){Mp(t,(t=>{t.forAll(((t,r)=>{t>=0&&r>=0&&sG(t,r,e,n,o,i)}))}))}function sG(t,e,n,o,i,r){const s=i(t,e);let a=o;s.className&&(a="vertical"===n?nG(s.className,o):oG(s.className,o)),r(t,e,"className",a)}function aG(t){return`<span class="selected">${String.fromCharCode(10003)}</span>${t}`}function lG(t,e){let n=!1;return Array.isArray(t)&&Mp(t,(t=>(t.forAll(((t,o)=>{if(t>=0&&o>=0&&e(t,o))return n=!0,!1})),n))),n}function hG(t,e){const n={top:0,left:0};if(e!==t.ownerDocument){const{frameElement:t}=e.defaultView,{top:o,left:i}=t.getBoundingClientRect();n.top=o,n.left=i}return n}const cG="---------";function uG(){return{name:cG}}const dG="alignment";function gG(){return{key:dG,name(){return this.getTranslatedPhrase(qO)},disabled(){if(0===this.countRows()||0===this.countCols())return!0;const t=this.getSelectedRangeLast();return!(t&&!t.isSingleHeader())||!(this.getSelectedRange()&&!this.selection.isSelectedByCorner())},submenu:{items:[{key:`${dG}:left`,name(){let t=this.getTranslatedPhrase(ZO);return lG(this.getSelectedRange(),((t,e)=>{const n=this.getCellMeta(t,e).className;if(n&&-1!==n.indexOf("htLeft"))return!0}))&&(t=aG(t)),t},callback(){const t=this.getSelectedRange(),e=iG(t,((t,e)=>this.getCellMeta(t,e).className)),n="horizontal",o="htLeft";this.runHooks("beforeCellAlignment",e,t,n,o),rG(t,n,o,((t,e)=>this.getCellMeta(t,e)),((t,e,n,o)=>this.setCellMeta(t,e,n,o))),this.render()},disabled:!1},{key:`${dG}:center`,name(){let t=this.getTranslatedPhrase(JO);return lG(this.getSelectedRange(),((t,e)=>{const n=this.getCellMeta(t,e).className;if(n&&-1!==n.indexOf("htCenter"))return!0}))&&(t=aG(t)),t},callback(){const t=this.getSelectedRange(),e=iG(t,((t,e)=>this.getCellMeta(t,e).className)),n="horizontal",o="htCenter";this.runHooks("beforeCellAlignment",e,t,n,o),rG(t,n,o,((t,e)=>this.getCellMeta(t,e)),((t,e,n,o)=>this.setCellMeta(t,e,n,o))),this.render()},disabled:!1},{key:`${dG}:right`,name(){let t=this.getTranslatedPhrase($O);return lG(this.getSelectedRange(),((t,e)=>{const n=this.getCellMeta(t,e).className;if(n&&-1!==n.indexOf("htRight"))return!0}))&&(t=aG(t)),t},callback(){const t=this.getSelectedRange(),e=iG(t,((t,e)=>this.getCellMeta(t,e).className)),n="horizontal",o="htRight";this.runHooks("beforeCellAlignment",e,t,n,o),rG(t,n,o,((t,e)=>this.getCellMeta(t,e)),((t,e,n,o)=>this.setCellMeta(t,e,n,o))),this.render()},disabled:!1},{key:`${dG}:justify`,name(){let t=this.getTranslatedPhrase(tH);return lG(this.getSelectedRange(),((t,e)=>{const n=this.getCellMeta(t,e).className;if(n&&-1!==n.indexOf("htJustify"))return!0}))&&(t=aG(t)),t},callback(){const t=this.getSelectedRange(),e=iG(t,((t,e)=>this.getCellMeta(t,e).className)),n="horizontal",o="htJustify";this.runHooks("beforeCellAlignment",e,t,n,o),rG(t,n,o,((t,e)=>this.getCellMeta(t,e)),((t,e,n,o)=>this.setCellMeta(t,e,n,o))),this.render()},disabled:!1},{name:cG},{key:`${dG}:top`,name(){let t=this.getTranslatedPhrase(eH);return lG(this.getSelectedRange(),((t,e)=>{const n=this.getCellMeta(t,e).className;if(n&&-1!==n.indexOf("htTop"))return!0}))&&(t=aG(t)),t},callback(){const t=this.getSelectedRange(),e=iG(t,((t,e)=>this.getCellMeta(t,e).className)),n="vertical",o="htTop";this.runHooks("beforeCellAlignment",e,t,n,o),rG(t,n,o,((t,e)=>this.getCellMeta(t,e)),((t,e,n,o)=>this.setCellMeta(t,e,n,o))),this.render()},disabled:!1},{key:`${dG}:middle`,name(){let t=this.getTranslatedPhrase(nH);return lG(this.getSelectedRange(),((t,e)=>{const n=this.getCellMeta(t,e).className;if(n&&-1!==n.indexOf("htMiddle"))return!0}))&&(t=aG(t)),t},callback(){const t=this.getSelectedRange(),e=iG(t,((t,e)=>this.getCellMeta(t,e).className)),n="vertical",o="htMiddle";this.runHooks("beforeCellAlignment",e,t,n,o),rG(t,n,o,((t,e)=>this.getCellMeta(t,e)),((t,e,n,o)=>this.setCellMeta(t,e,n,o))),this.render()},disabled:!1},{key:`${dG}:bottom`,name(){let t=this.getTranslatedPhrase(oH);return lG(this.getSelectedRange(),((t,e)=>{const n=this.getCellMeta(t,e).className;if(n&&-1!==n.indexOf("htBottom"))return!0}))&&(t=aG(t)),t},callback(){const t=this.getSelectedRange(),e=iG(t,((t,e)=>this.getCellMeta(t,e).className)),n="vertical",o="htBottom";this.runHooks("beforeCellAlignment",e,t,n,o),rG(t,n,o,((t,e)=>this.getCellMeta(t,e)),((t,e,n,o)=>this.setCellMeta(t,e,n,o))),this.render()},disabled:!1}]}}}const fG="clear_column";function mG(){return{key:fG,name(){return this.getTranslatedPhrase(_O)},callback(t,e){const n=e[0].start.col,o=e[0].end.col;this.countRows()&&this.populateFromArray(0,n,[[null]],Math.max(e[0].start.row,e[0].end.row),o,"ContextMenu.clearColumn")},disabled(){const t=this.getSelectedRangeLast();return!(t&&!(t.isSingleHeader()&&t.highlight.col<0))||!this.selection.isSelectedByColumnHeader()}}}const pG="col_left";function wG(){return{key:pG,name(){return this.getTranslatedPhrase(xO)},callback(){const t=this.getSelectedRangeLast().getTopLeftCorner(),e=this.isRtl()?"insert_col_end":"insert_col_start";this.alter(e,t.col,1,"ContextMenu.columnLeft")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeLast();return!(t&&!(t.isSingleHeader()&&t.highlight.col<0))||(this.selection.isSelectedByCorner()?0===this.countCols():this.selection.isSelectedByRowHeader()||this.countCols()>=this.getSettings().maxCols)},hidden(){return!this.getSettings().allowInsertColumn}}}const AG="col_right";function vG(){return{key:AG,name(){return this.getTranslatedPhrase(IO)},callback(){const t=this.getSelectedRangeLast().getTopRightCorner(),e=this.isRtl()?"insert_col_start":"insert_col_end";this.alter(e,t.col,1,"ContextMenu.columnRight")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeLast();return!(t&&!(t.isSingleHeader()&&t.highlight.col<0))||!this.selection.isSelectedByCorner()&&(this.selection.isSelectedByRowHeader()||this.countCols()>=this.getSettings().maxCols)},hidden(){return!this.getSettings().allowInsertColumn}}}const yG="make_read_only";function CG(){return{key:yG,name(){let t=this.getTranslatedPhrase(PO);return lG(this.getSelectedRange(),((t,e)=>this.getCellMeta(t,e).readOnly))&&(t=aG(t)),t},callback(){const t=this.getSelectedRange(),e=lG(t,((t,e)=>this.getCellMeta(t,e).readOnly));Mp(t,(t=>{t.forAll(((t,n)=>{t>=0&&n>=0&&this.setCellMeta(t,n,"readOnly",!e)}))})),this.render()},disabled(){const t=this.getSelectedRangeLast();return!(t&&!t.isSingleHeader()&&!this.selection.isSelectedByCorner()&&0!==this.countRows()&&0!==this.countCols()&&this.getSelectedRange()&&0!==this.getSelectedRange().length)}}}const bG="redo";function SG(){return{key:bG,name(){return this.getTranslatedPhrase(NO)},callback(){this.redo()},hidden(){const t=this.getPlugin("undoRedo");return!t||!t.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isRedoAvailable()}}}const EG="remove_col";function RG(){return{key:EG,name(){const t=this.getSelected();let e=0;if(t)if(t.length>1)e=1;else{const[,n,,o]=t[0];n-o!==0&&(e=1)}return this.getTranslatedPhrase(HO,e)},callback(){this.alter("remove_col",kN(this),null,"ContextMenu.removeColumn")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeLast();if(!t||t.isSingleHeader()&&t.highlight.col<0)return!0;const e=this.countCols();return this.selection.isSelectedByCorner()?0===e:this.selection.isSelectedByRowHeader()||0===e},hidden(){return!this.getSettings().allowRemoveColumn}}}const MG="remove_row";function TG(){return{key:MG,name(){const t=this.getSelected();let e=0;if(t)if(t.length>1)e=1;else{const[n,,o]=t[0];n-o!==0&&(e=1)}return this.getTranslatedPhrase(OO,e)},callback(){this.alter("remove_row",xN(this),1,"ContextMenu.removeRow")},disabled(){const t=this.getSelectedRangeLast();if(!t||t.isSingleHeader()&&t.highlight.row<0)return!0;const e=this.countRows();return this.selection.isSelectedByCorner()?0===e:this.selection.isSelectedByColumnHeader()||0===e},hidden(){return!this.getSettings().allowRemoveRow}}}const kG="row_above";function xG(){return{key:kG,name(){return this.getTranslatedPhrase(TO)},callback(){const t=this.getSelectedRangeLast().getTopLeftCorner();this.alter("insert_row_above",t.row,1,"ContextMenu.rowAbove")},disabled(){const t=this.getSelectedRangeLast();return!(t&&!(t.isSingleHeader()&&t.highlight.row<0))||(this.selection.isSelectedByCorner()?0===this.countRows():this.selection.isSelectedByColumnHeader()||this.countRows()>=this.getSettings().maxRows)},hidden(){return!this.getSettings().allowInsertRow}}}const IG="row_below";function OG(){return{key:IG,name(){return this.getTranslatedPhrase(kO)},callback(){const t=this.getSelectedRangeLast().getBottomRightCorner();this.alter("insert_row_below",t.row,1,"ContextMenu.rowBelow")},disabled(){const t=this.getSelectedRangeLast();return!(t&&!(t.isSingleHeader()&&t.highlight.row<0))||!this.selection.isSelectedByCorner()&&(this.selection.isSelectedByColumnHeader()||this.countRows()>=this.getSettings().maxRows)},hidden(){return!this.getSettings().allowInsertRow}}}const HG="no_items";function DG(){return{key:HG,name(){return this.getTranslatedPhrase(MO)},disabled:!0,isCommand:!1}}const NG="undo";function PG(){return{key:NG,name(){return this.getTranslatedPhrase(DO)},callback(){this.undo()},hidden(){const t=this.getPlugin("undoRedo");return!t||!t.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isUndoAvailable()}}}const _G=[kG,IG,pG,AG,fG,MG,EG,NG,bG,yG,dG,cG,HG],BG={[cG]:uG,[HG]:DG,[kG]:xG,[IG]:OG,[pG]:wG,[AG]:vG,[fG]:mG,[MG]:TG,[EG]:RG,[NG]:PG,[bG]:SG,[yG]:CG,[dG]:gG};function LG(){const t={};return ny(BG,((e,n)=>{t[n]=e()})),t}function VG(t){return{key:"commentsAddEdit",name(){var e;const n=null===(e=this.getSelectedRangeLast())||void 0===e?void 0:e.highlight;return null!=n&&n.isCell()&&t.getCommentAtCell(n.row,n.col)?this.getTranslatedPhrase(QO):this.getTranslatedPhrase(GO)},callback(){const e=this.getSelectedRangeLast();this.deselectCell(),t.setRange(e),t.show(),t.focusEditor()},disabled(){const t=this.getSelectedRangeLast();return!!(!t||t.highlight.isHeader()||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||0===this.countRenderedRows()||0===this.countRenderedCols())}}}function WG(t){return{key:"commentsRemove",name(){return this.getTranslatedPhrase(KO)},callback(){this.getSelectedRangeLast().forAll(((e,n)=>{e>=0&&n>=0&&t.removeCommentAtCell(e,n,!1)})),this.render()},disabled(){const t=this.getSelectedRangeLast();return!!(!t||t.highlight.isHeader()||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||0===this.countRenderedRows()||0===this.countRenderedCols())}}}function FG(t){return{key:"commentsReadOnly",name(){const e=this.getTranslatedPhrase(XO);return lG(this.getSelectedRange(),((e,n)=>t.getCommentMeta(e,n,rQ)))?aG(e):e},callback(){this.getSelectedRangeLast().forAll(((e,n)=>{if(e>=0&&n>=0){const o=!!t.getCommentMeta(e,n,rQ);t.updateCommentMeta(e,n,{[rQ]:!o})}}))},disabled(){const e=this.getSelectedRangeLast();return!!(!e||e.highlight.isHeader()||!t.getCommentAtCell(e.highlight.row,e.highlight.col)||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||0===this.countRenderedRows()||0===this.countRenderedCols())}}}function jG(t,e){YG(t,e),e.add(t)}function UG(t,e,n){YG(t,e),e.set(t,n)}function YG(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function zG(t,e,n){return e=GG(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function GG(t){var e=QG(t,"string");return"symbol"==typeof e?e:String(e)}function QG(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function KG(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function XG(t,e,n){var o=JG(t,e,"set");return qG(t,o,n),n}function qG(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function ZG(t,e){var n=JG(t,e,"get");return $G(t,n)}function JG(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function $G(t,e){return e.get?e.get.call(t):e.value}const tQ="comments",eQ=60,nQ="comment",oQ="value",iQ="style",rQ="readOnly",sQ=tQ,aQ=`plugin:${tQ}`;var lQ=new WeakMap,hQ=new WeakMap,cQ=new WeakMap,uQ=new WeakMap,dQ=new WeakMap,gQ=new WeakMap,fQ=new WeakMap,mQ=new WeakSet,pQ=new WeakSet,wQ=new WeakSet,AQ=new WeakSet,vQ=new WeakSet,yQ=new WeakSet,CQ=new WeakSet,bQ=new WeakSet,SQ=new WeakSet,EQ=new WeakSet;class RQ extends jF{constructor(){super(...arguments),jG(this,EQ),jG(this,SQ),jG(this,bQ),jG(this,CQ),jG(this,yQ),jG(this,vQ),jG(this,AQ),jG(this,wQ),jG(this,pQ),jG(this,mQ),zG(this,"range",{}),UG(this,lQ,{writable:!0,value:null}),UG(this,hQ,{writable:!0,value:null}),UG(this,cQ,{writable:!0,value:!1}),UG(this,uQ,{writable:!0,value:!1}),UG(this,dQ,{writable:!0,value:{}}),UG(this,gQ,{writable:!0,value:null}),UG(this,fQ,{writable:!0,value:""})}static get PLUGIN_KEY(){return tQ}static get PLUGIN_PRIORITY(){return eQ}isEnabled(){return!!this.hot.getSettings()[tQ]}enablePlugin(){this.enabled||(ZG(this,lQ)||XG(this,lQ,new Kz(this.hot.rootDocument,this.hot.isRtl())),ZG(this,hQ)||XG(this,hQ,new eG(this.getDisplayDelaySetting())),this.addHook("afterContextMenuDefaultOptions",(t=>this.addToContextMenu(t))),this.addHook("afterRenderer",((t,e,n,o,i,r)=>KG(this,AQ,xQ).call(this,t,r))),this.addHook("afterScroll",(()=>KG(this,EQ,PQ).call(this))),this.addHook("afterBeginEditing",(()=>this.hide())),this.addHook("afterDocumentKeyDown",(t=>KG(this,SQ,NQ).call(this,t))),ZG(this,hQ).addLocalHook("hide",(()=>this.hide())),ZG(this,hQ).addLocalHook("show",((t,e)=>this.showAtCell(t,e))),this.registerShortcuts(),this.registerListeners(),super.enablePlugin())}updatePlugin(){ZG(this,hQ).updateDelay(this.getDisplayDelaySetting()),super.updatePlugin()}disablePlugin(){this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){const t=this.hot.getShortcutManager(),e=t.getContext("grid"),n=t.addContext(aQ);e.addShortcut({keys:[["Control","Alt","M"]],callback:()=>{const e=this.hot.getSelectedRangeLast();XG(this,uQ,!0),this.hot.scrollToFocusedCell((()=>{this.setRange(e),this.show(),this.focusEditor(),t.setActiveContextName(aQ),this.hot._registerTimeout((()=>{XG(this,uQ,!1)}))}))},stopPropagation:!0,runOnlyIf:()=>{var t;return(null===(t=this.hot.getSelectedRangeLast())||void 0===t?void 0:t.highlight.isCell())&&!ZG(this,lQ).isVisible()},group:sQ}),n.addShortcut({keys:[["Escape"]],callback:()=>{ZG(this,lQ).setValue(ZG(this,fQ)),this.hide(),t.setActiveContextName("grid")},runOnlyIf:()=>{var t;return(null===(t=this.hot.getSelectedRangeLast())||void 0===t?void 0:t.highlight.isCell())&&ZG(this,lQ).isVisible()},group:sQ}),n.addShortcut({keys:[["Control/Meta","Enter"]],callback:()=>{this.hide(),t.setActiveContextName("grid")},runOnlyIf:()=>{var t;return(null===(t=this.hot.getSelectedRangeLast())||void 0===t?void 0:t.highlight.isCell())&&ZG(this,lQ).isVisible()},group:sQ})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(sQ)}registerListeners(){const{rootDocument:t}=this.hot,e=this.getEditorInputElement();this.eventManager.addEventListener(t,"mouseover",(t=>KG(this,pQ,TQ).call(this,t))),this.eventManager.addEventListener(t,"mousedown",(t=>KG(this,mQ,MQ).call(this,t))),this.eventManager.addEventListener(t,"mouseup",(()=>KG(this,wQ,kQ).call(this))),this.eventManager.addEventListener(e,"focus",(()=>KG(this,yQ,OQ).call(this))),this.eventManager.addEventListener(e,"blur",(()=>KG(this,vQ,IQ).call(this))),this.eventManager.addEventListener(e,"mousedown",(t=>KG(this,CQ,HQ).call(this,t))),this.eventManager.addEventListener(e,"mouseup",(t=>KG(this,bQ,DQ).call(this,t)))}setRange(t){this.range=t}clearRange(){this.range={}}targetIsCellWithComment(t){const e=nA(t.target,"TD","TBODY");return!!(e&&hA(e,"htCommentCell")&&nA(e,[this.hot.rootElement]))}targetIsCommentTextArea(t){return this.getEditorInputElement()===t.target}setComment(t){if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');const e=ZG(this,lQ).getValue();let n="";null!=t?n=t:null!=e&&(n=e);const o=this.range.from.row,i=this.range.from.col;this.updateCommentMeta(o,i,{[oQ]:n}),this.hot.render()}setCommentAtCell(t,e,n){this.setRange({from:this.hot._createCellCoords(t,e)}),this.setComment(n)}removeComment(){let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');this.hot.setCellMeta(this.range.from.row,this.range.from.col,nQ),t&&this.hot.render(),this.hide()}removeCommentAtCell(t,e){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];this.setRange({from:this.hot._createCellCoords(t,e)}),this.removeComment(n)}getComment(){const t=this.range.from.row,e=this.range.from.col;return this.getCommentMeta(t,e,oQ)}getCommentAtCell(t,e){return this.getCommentMeta(t,e,oQ)}show(){var t;if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');const{from:{row:e,col:n}}=this.range;if(e<0||e>this.hot.countSourceRows()-1||n<0||n>this.hot.countSourceCols()-1)return!1;const o=this.hot.getCellMeta(this.range.from.row,this.range.from.col);return ZG(this,hQ).cancelHiding(),ZG(this,lQ).setValue(null!==(t=o[nQ]?o[nQ][oQ]:null)&&void 0!==t?t:""),ZG(this,lQ).show(),this.refreshEditor(!0),!0}showAtCell(t,e){return this.setRange({from:this.hot._createCellCoords(t,e)}),this.show()}hide(){ZG(this,lQ).hide()}refreshEditor(){var t,e;if(!(arguments.length>0&&void 0!==arguments[0]&&arguments[0])&&(!this.range.from||!ZG(this,lQ).isVisible()))return;const{rowIndexMapper:n,columnIndexMapper:o}=this.hot,{row:i,col:r}=this.range.from;let s=n.getRenderableFromVisualIndex(i),a=o.getRenderableFromVisualIndex(r);const l=null===s;ZG(this,lQ).setPosition(0,0),null===s&&(s=n.getRenderableFromVisualIndex(n.getNearestNotHiddenIndex(i,-1))),null===a&&(a=o.getRenderableFromVisualIndex(o.getNearestNotHiddenIndex(r,-1)));const h=null===s,c=null===a;s=null!==(t=s)&&void 0!==t?t:0,a=null!==(e=a)&&void 0!==e?e:0;const{rootWindow:u,view:{_wt:d}}=this.hot,{wtTable:g}=d,f=d.getCell({row:s,col:a},!0),m=this.getCommentMeta(i,r,iQ);m?ZG(this,lQ).setSize(m.width,m.height):ZG(this,lQ).resetSize();const p=c?0:g.getStretchedColumnWidth(a),w=l&&!h?OA(f):0,{left:A,top:v,width:y,height:C}=f.getBoundingClientRect(),{width:b,height:S}=ZG(this,lQ).getSize(),{innerWidth:E,innerHeight:R}=this.hot.rootWindow,M=this.hot.rootDocument.documentElement;let T=A+u.scrollX+p,k=v+u.scrollY+w;this.hot.isRtl()&&(T-=b+p),this.hot.isLtr()&&A+y+b>E?T=A+u.scrollX-b-1:this.hot.isRtl()&&T<-(M.scrollWidth-M.clientWidth)&&(T=A+u.scrollX+p+1),v+S>R&&(k-=S-C+1),ZG(this,lQ).setPosition(T,k),ZG(this,lQ).setReadOnlyState(this.getCommentMeta(i,r,rQ))}focusEditor(){ZG(this,lQ).focus()}updateCommentMeta(t,e,n){const o=this.hot.getCellMeta(t,e)[nQ];let i;o?(i=qv(o),Xv(i,n)):i=n,this.hot.setCellMeta(t,e,nQ,i)}getCommentMeta(t,e,n){const o=this.hot.getCellMeta(t,e);if(o[nQ])return o[nQ][n]}addToContextMenu(t){t.items.push({name:cG},VG(this),WG(this),FG(this))}getDisplayDelaySetting(){const t=this.hot.getSettings()[tQ];if(ty(t))return t.displayDelay}getEditorInputElement(){return ZG(this,lQ).getInputElement()}destroy(){ZG(this,lQ)&&ZG(this,lQ).destroy(),ZG(this,hQ)&&ZG(this,hQ).destroy(),super.destroy()}}function MQ(t){if(this.hot.view&&this.hot.view._wt&&!ZG(this,cQ)&&!this.targetIsCommentTextArea(t)){const e=nA(t.target,"TD","TBODY");let n=null;e&&(n=this.hot.getCoords(e)),(!e||this.range.from&&n&&(this.range.from.row!==n.row||this.range.from.col!==n.col))&&this.hide()}}function TQ(t){const{rootDocument:e}=this.hot;if(!(ZG(this,cQ)||ZG(this,lQ).isFocused()||hA(t.target,"wtBorder")||ZG(this,gQ)===t.target)&&ZG(this,lQ))if(XG(this,gQ,e.elementFromPoint(t.clientX,t.clientY)),this.targetIsCellWithComment(t)){const e=this.hot._createCellRange(this.hot.getCoords(t.target));ZG(this,hQ).show(e)}else iA(t.target,e)&&!this.targetIsCommentTextArea(t)&&ZG(this,hQ).hide()}function kQ(){XG(this,cQ,!1)}function xQ(t,e){e[nQ]&&e[nQ][oQ]&&cA(t,e.commentedCellClassName)}function IQ(){XG(this,fQ,""),this.hot.getShortcutManager().setActiveContextName("grid"),this.setComment()}function OQ(){XG(this,fQ,this.getComment()),this.hot.listen(),this.hot.getShortcutManager().setActiveContextName(aQ)}function HQ(t){XG(this,dQ,{width:IA(t.target),height:OA(t.target)})}function DQ(t){const e=IA(t.target),n=OA(t.target);(e!==ZG(this,dQ).width+1||n!==ZG(this,dQ).height+2)&&this.updateCommentMeta(this.range.from.row,this.range.from.col,{[iQ]:{width:e,height:n}})}function NQ(t){ZG(this,lQ).isVisible()&&Uy(t)}function PQ(){ZG(this,uQ)||this.hide()}var _Q=Bt,BQ=TypeError,LQ=function(t,e){if(!delete t[e])throw new BQ("Cannot delete property "+_Q(e)+" of "+_Q(t))},VQ=Ki,WQ=he,FQ=ni,jQ=nr,UQ=LQ,YQ=rr,zQ=1!==[].unshift(0),GQ=function(){try{Object.defineProperty([],"length",{writable:!1}).unshift()}catch(t){return t instanceof TypeError}},QQ=zQ||!GQ();function KQ(t,e,n){return e=XQ(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function XQ(t){var e=qQ(t,"string");return"symbol"==typeof e?e:String(e)}function qQ(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}VQ({target:"Array",proto:!0,arity:1,forced:QQ},{unshift:function(t){var e=WQ(this),n=FQ(e),o=arguments.length;if(o){YQ(n+o);for(var i=n;i--;){var r=i+o;i in e?e[r]=e[i]:UQ(e,r)}for(var s=0;s<o;s++)e[s]=arguments[s]}return jQ(e,n+o)}});class ZQ{constructor(t){KQ(this,"hot",void 0),KQ(this,"commands",{}),KQ(this,"commonCallback",null),this.hot=t}registerCommand(t,e){this.commands[t]=e}setCommonCallback(t){this.commonCallback=t}execute(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),o=1;o<e;o++)n[o-1]=arguments[o];const i=t.split(":"),r=i[0],s=2===i.length?i[1]:null;let a=this.commands[r];if(!a)throw new Error(`Menu command '${r}' not exists.`);if(s&&a.submenu&&(a=JQ(s,a.submenu.items)),!0===a.disabled||"function"==typeof a.disabled&&!0===a.disabled.call(this.hot)||ay(a,"submenu"))return;const l=[];"function"==typeof a.callback&&l.push(a.callback),"function"==typeof this.commonCallback&&l.push(this.commonCallback),n.unshift(i.join(":")),Mp(l,(t=>t.apply(this.hot,n)))}}function JQ(t,e){let n;return Mp(e,(e=>{const o=e.key?e.key.split(":"):null;if(Array.isArray(o)&&o[1]===t)return n=e,!1})),n}function $Q(t,e,n){return e=tK(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function tK(t){var e=eK(t,"string");return"symbol"==typeof e?e:String(e)}function eK(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class nK{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;$Q(this,"hot",void 0),$Q(this,"predefinedItems",LG()),$Q(this,"defaultOrderPattern",void 0),this.hot=t,this.defaultOrderPattern=e}setPredefinedItems(t){const e={};this.defaultOrderPattern.length=0,ny(t,((t,n)=>{let o="";t.name===cG?(e[cG]=t,o=cG):isNaN(parseInt(n,10))?(t.key=void 0===t.key?n:t.key,e[n]=t,o=t.key):(e[t.key]=t,o=t.key),this.defaultOrderPattern.push(o)})),this.predefinedItems=e}getItems(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return oK(t,this.defaultOrderPattern,this.predefinedItems)}}function oK(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const o=[];let i=t;return i&&i.items?i=i.items:Array.isArray(i)||(i=e),ty(i)?ny(i,((t,e)=>{let i=n["string"==typeof t?t:e];i||(i=t),ty(t)?Kv(i,t):"string"==typeof i&&(i={name:i}),void 0===i.key&&(i.key=e),o.push(i)})):Mp(i,((t,e)=>{let i=n[t];!i&&_G.indexOf(t)>=0||(i||(i={name:t,key:`${e}`}),ty(t)&&Kv(i,t),void 0===i.key&&(i.key=e),o.push(i))})),o}function iK(t,e,n){return e=rK(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function rK(t){var e=sK(t,"string");return"symbol"==typeof e?e:String(e)}function sK(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class aK{constructor(t,e){iK(this,"top",void 0),iK(this,"topRelative",void 0),iK(this,"left",void 0),iK(this,"leftRelative",void 0),iK(this,"scrollTop",void 0),iK(this,"scrollLeft",void 0),iK(this,"cellHeight",void 0),iK(this,"cellWidth",void 0);const n=e.scrollY,o=e.scrollX;let i,r,s,a,l,h;this.rootWindow=e,this.type=this.getSourceType(t),"literal"===this.type?(i=parseInt(t.top,10),s=parseInt(t.left,10),l=t.height||0,h=t.width||0,r=i,a=s,i+=n,s+=o):"event"===this.type&&(i=parseInt(t.pageY,10),s=parseInt(t.pageX,10),l=t.target.clientHeight,h=t.target.clientWidth,r=i-n,a=s-o),this.top=i,this.topRelative=r,this.left=s,this.leftRelative=a,this.scrollTop=n,this.scrollLeft=o,this.cellHeight=l,this.cellWidth=h}getSourceType(t){let e="literal";return t instanceof Event&&(e="event"),e}fitsAbove(t){return this.topRelative>=t.offsetHeight}fitsBelow(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.rootWindow.innerHeight;return this.topRelative+t.offsetHeight<=e}fitsOnRight(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.rootWindow.innerWidth;return this.leftRelative+this.cellWidth+t.offsetWidth<=e}fitsOnLeft(t){return this.leftRelative>=t.offsetWidth}}function lK(t,e,n){hK(t,e),e.set(t,n)}function hK(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function cK(t,e){var n=gK(t,e,"get");return uK(t,n)}function uK(t,e){return e.get?e.get.call(t):e.value}function dK(t,e,n){var o=gK(t,e,"set");return fK(t,o,n),n}function gK(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function fK(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var mK=new WeakMap,pK=new WeakMap,wK=new WeakMap,AK=new WeakMap,vK=new WeakMap;class yK{constructor(t){lK(this,mK,{writable:!0,value:void 0}),lK(this,pK,{writable:!0,value:void 0}),lK(this,wK,{writable:!0,value:void 0}),lK(this,AK,{writable:!0,value:!1}),lK(this,vK,{writable:!0,value:{above:0,below:0,left:0,right:0}}),dK(this,AK,t)}setOffset(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return cK(this,vK)[t]=e,this}setElement(t){return dK(this,mK,t),this}setParentElement(t){return dK(this,pK,t),this}updatePosition(t){dK(this,wK,new aK(t,cK(this,mK).ownerDocument.defaultView)),cK(this,AK)?(cK(this,wK).fitsBelow(cK(this,mK))?this.setPositionBelowCursor():cK(this,wK).fitsAbove(cK(this,mK))?this.setPositionAboveCursor():this.setPositionBelowCursor(),this.updateHorizontalPosition()):(this.setPositionBelowCursor(),this.setPositionOnRightOfCursor())}updateHorizontalPosition(){"rtl"===cK(this,mK).dir?cK(this,wK).fitsOnLeft(cK(this,mK))?this.setPositionOnLeftOfCursor():this.setPositionOnRightOfCursor():cK(this,wK).fitsOnRight(cK(this,mK))?this.setPositionOnRightOfCursor():this.setPositionOnLeftOfCursor()}setPositionAboveCursor(){let t=cK(this,vK).above+cK(this,wK).top-cK(this,mK).offsetHeight;cK(this,pK)&&(t=cK(this,wK).top+cK(this,wK).cellHeight-cK(this,mK).offsetHeight+3),cK(this,mK).style.top=`${t}px`}setPositionBelowCursor(){let t=cK(this,vK).below+cK(this,wK).top+1;cK(this,pK)&&(t=cK(this,wK).top-1),cK(this,mK).style.top=`${t}px`}setPositionOnRightOfCursor(){let t=cK(this,wK).left;if(cK(this,pK)){const{right:e}=cK(this,pK).getBoundingClientRect();t+=cK(this,wK).cellWidth+e-(cK(this,wK).left+cK(this,wK).cellWidth)}else t+=cK(this,vK).right;cK(this,mK).style.left=`${t}px`}setPositionOnLeftOfCursor(){let t=cK(this,vK).left+cK(this,wK).left-cK(this,mK).offsetWidth;if(cK(this,pK)){const{left:e}=cK(this,pK).getBoundingClientRect();t-=cK(this,wK).left-e}cK(this,mK).style.left=`${t}px`}}function CK(t){let{initialPage:e=-1,size:n=(()=>0),onItemSelect:o=(()=>{}),onClear:i=(()=>{})}=t;const r=new Set;let s=Eb(e,-1,f()-1);function a(t,e){const n=f()-1;return t<0&&(t=n),t>n&&(t=0),r.has(t)?-1:(r.add(t),!1===o(t,!1)&&(t=a(1===e?++t:--t,e)),t)}function l(t){t>-1&&t<f()&&!1!==o(t,!0)&&(s=t)}function h(){return s}function c(){f()>0&&(r.clear(),s=a(0,1))}function u(){f()>0&&(r.clear(),s=a(f()-1,-1))}function d(){f()>0&&(r.clear(),s=a(++s,1))}function g(){f()>0&&(r.clear(),s=a(--s,-1))}function f(){return Math.max(n(),0)}function m(){r.clear(),s=e,i()}return{setCurrentPage:l,getCurrentPage:h,toFirstItem:c,toLastItem:u,toNextItem:d,toPreviousItem:g,getSize:f,clear:m}}function bK(t){return Rp(t,(t=>({start:t.getTopStartCorner(),end:t.getBottomEndCorner()})))}function SK(t){return ay(t,"submenu")}function EK(t){return new RegExp(cG,"i").test(t.name)}function RK(t,e){return!0===t.disabled||"function"==typeof t.disabled&&!0===t.disabled.call(e)}function MK(t){return ay(t,"disableSelection")}function TK(t){return hA(t,"htSeparator")}function kK(t){return hA(t,"htSubmenu")}function xK(t){return hA(t,"htDisabled")}function IK(t){return hA(t,"htSelectionDisabled")}function OK(t,e){return!t.hidden||!("function"==typeof t.hidden&&t.hidden.call(e))}function HK(t,e){const n=t.slice(0);for(let o=0;o<n.length&&n[o].name===e;)n.shift();return n}function DK(t,e){let n=t.slice(0);return n.reverse(),n=HK(n,e),n.reverse(),n}function NK(t){const e=[];return Mp(t,((t,n)=>{n>0?e[e.length-1].name!==t.name&&e.push(t):e.push(t)})),e}function PK(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:cG,n=t.slice(0);return n=HK(n,e),n=DK(n,e),n=NK(n),n}function _K(t){return CK({size:()=>t.countRows(),onItemSelect(e,n){const o=t.getCell(e,0);if(!o||TK(o)||xK(o)||IK(o))return!1;t.selectCell(e,0,...n?[e,0,!1,!1]:[])},onClear(){t.deselectCell()}})}function BK(t){return[{keys:[["Tab"],["Shift","Tab"],["Control/Meta","A"]],forwardToContext:t.hot.getShortcutManager().getContext("grid"),callback:()=>t.close(!0)},{keys:[["Escape"]],callback:()=>t.close()},{keys:[["ArrowDown"]],callback:()=>t.getNavigator().toNextItem()},{keys:[["ArrowUp"]],callback:()=>t.getNavigator().toPreviousItem()},{keys:[["ArrowRight"]],callback:()=>{const e=t.hotMenu.getSelectedLast();if(e){const n=t.openSubMenu(e[0]);n&&n.getNavigator().toFirstItem()}}},{keys:[["ArrowLeft"]],callback:()=>{t.hotMenu.getSelectedLast()&&t.isSubMenu()&&(t.close(),t.isSubMenu()&&t.parentMenu.hotMenu.listen())}},{keys:[["Control/Meta","ArrowUp"],["Home"]],callback:()=>t.getNavigator().toFirstItem()},{keys:[["Control/Meta","ArrowDown"],["End"]],callback:()=>t.getNavigator().toLastItem()},{keys:[["Enter"],["Space"]],callback:e=>{const n=t.hotMenu.getSelectedLast();n&&(t.hotMenu.getSourceDataAtRow(n[0]).submenu?t.openSubMenu(n[0]).getNavigator().toFirstItem():(t.executeCommand(e),t.close(!0)))}},{keys:[["PageUp"]],callback:()=>{t.hotMenu.getSelectedLast()?t.hotMenu.selection.transformStart(-t.hotMenu.countVisibleRows(),0):t.getNavigator().toFirstItem()}},{keys:[["PageDown"]],callback:()=>{t.hotMenu.getSelectedLast()?t.hotMenu.selection.transformStart(t.hotMenu.countVisibleRows(),0):t.getNavigator().toLastItem()}}]}const LK="menu",VK=LK;function WK(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];const n=[];function o(t,e){a(e).addShortcuts(t,{group:LK})}function i(t,e){const i=a(e);t.forEach((t=>{let{keys:e}=t;e.forEach((t=>i.removeShortcutsByKeys(t)))})),n.push({shortcuts:t,contextName:e}),o(t,e)}function r(){return[...n]}function s(t){return t?`${VK}:${t}`:VK}function a(e){var n;const o=t.hotMenu.getShortcutManager(),i=s(e);return null!==(n=o.getContext(i))&&void 0!==n?n:o.addContext(i)}function l(e){t.hotMenu.getShortcutManager().setActiveContextName(s(e))}return o(BK(t)),e.forEach((t=>{let{shortcuts:e,contextName:n}=t;i(e,n)})),{addCustomShortcuts:i,getCustomShortcuts:r,getContext:a,listen:l}}function FK(t){return(e,n,o,i,r,s)=>{if(n.hasAttribute("ghost-table"))return;const a=e.getSourceDataAtRow(o),l=t.rootDocument.createElement("div"),h="function"==typeof s?s.call(t):s;if(mA(n),cA(l,"htItemWrapper"),t.getSettings().ariaTags){const e=!RK(a,t)&&!MK(a)&&!EK(a);dA(n,[Cw(),xw(h),...e?[dw(-1)]:[],...RK(a,t)?[Ow()]:[],...SK(a)?[Lw(!1)]:[]])}n.className="",n.appendChild(l),EK(a)?cA(n,"htSeparator"):"function"==typeof a.renderer?(cA(n,"htCustomMenuRenderer"),n.appendChild(a.renderer(e,l,o,i,r,h))):wA(l,h),RK(a,t)?cA(n,"htDisabled"):MK(a)?cA(n,"htSelectionDisabled"):SK(a)&&cA(n,"htSubmenu")}}function jK(t,e,n){UK(t,e),e.set(t,n)}function UK(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function YK(t,e,n){return e=zK(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function zK(t){var e=GK(t,"string");return"symbol"==typeof e?e:String(e)}function GK(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function QK(t,e,n){var o=qK(t,e,"set");return KK(t,o,n),n}function KK(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function XK(t,e){var n=qK(t,e,"get");return ZK(t,n)}function qK(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function ZK(t,e){return e.get?e.get.call(t):e.value}const JK=215;var $K=new WeakMap,tX=new WeakMap;class eX{constructor(t,e){var n=this;YK(this,"hot",void 0),YK(this,"options",void 0),YK(this,"eventManager",new MC(this)),YK(this,"container",void 0),YK(this,"positioner",void 0),YK(this,"hotMenu",null),YK(this,"hotSubMenus",{}),YK(this,"parentMenu",void 0),YK(this,"menuItems",null),YK(this,"origOutsideClickDeselects",null),jK(this,$K,{writable:!0,value:void 0}),jK(this,tX,{writable:!0,value:void 0}),this.hot=t,this.options=e||{parent:null,name:null,className:"",keepInViewport:!0,standalone:!1,minWidth:JK,container:this.hot.rootDocument.documentElement},this.container=this.createContainer(this.options.name),this.positioner=new yK(this.options.keepInViewport),this.parentMenu=this.options.parent||null,this.registerEvents(),this.isSubMenu()&&this.addLocalHook("afterSelectionChange",(function(){for(var t=arguments.length,e=new Array(t),o=0;o<t;o++)e[o]=arguments[o];return n.parentMenu.runLocalHooks("afterSelectionChange",...e)}))}registerEvents(){let t=this.hot.rootWindow;for(;t;)this.eventManager.addEventListener(t.document,"mousedown",(t=>this.onDocumentMouseDown(t))),this.eventManager.addEventListener(t.document,"contextmenu",(t=>this.onDocumentContextMenu(t))),t=tA(t)}setMenuItems(t){this.menuItems=t}getNavigator(){return XK(this,$K)}getKeyboardShortcutsCtrl(){return XK(this,tX)}getSelectedItem(){return this.hasSelectedItem()?this.hotMenu.getSourceDataAtRow(this.hotMenu.getSelectedLast()[0]):null}hasSelectedItem(){return Array.isArray(this.hotMenu.getSelectedLast())}isSubMenu(){return null!==this.parentMenu}open(){this.runLocalHooks("beforeOpen"),this.container.removeAttribute("style"),this.container.style.display="block";const t=av((t=>this.openSubMenu(t)),300),e=this.options.minWidth||JK;let n=!1,o=Ep(this.menuItems,(t=>(t.key===HG&&(n=!0),OK(t,this.hot))));if(o.length<1&&!n)o.push(LG()[HG]);else if(0===o.length)return;o=PK(o,cG);let i=!1;const r={data:o,colHeaders:!1,autoColumnSize:!0,autoWrapRow:!1,modifyColWidth(t){return Wp(t)&&t<e?e:t},autoRowSize:!1,readOnly:!0,editor:!1,copyPaste:!1,hiddenRows:!0,maxCols:1,columns:[{data:"name",renderer:FK(this.hot)}],renderAllRows:!0,fragmentSelection:!1,outsideClickDeselects:!1,disableVisualSelection:"area",layoutDirection:this.hot.isRtl()?"rtl":"ltr",ariaTags:!1,beforeOnCellMouseOver:(t,e)=>{XK(this,$K).setCurrentPage(e.row)},afterOnCellMouseOver:(e,n)=>{this.isAllSubMenusClosed()?t(n.row):this.openSubMenu(n.row)},rowHeights:t=>o[t].name===cG?1:23,afterOnCellContextMenu:t=>{t.preventDefault(),Oy()&&i&&this.hasSelectedItem()&&this.close(!0)},afterSelection:(t,e,n,o,i)=>{this.hotMenu.view.isMouseDown()&&(i.value=!0),this.runLocalHooks("afterSelectionChange",this.getSelectedItem())},beforeOnCellMouseUp:t=>{this.hasSelectedItem()&&(i=!this.isCommandPassive(this.getSelectedItem()),this.executeCommand(t))},afterOnCellMouseUp:t=>{(!Oy()||!zy(t))&&i&&this.hasSelectedItem()&&(ky()||Iy()?this.hot._registerTimeout((()=>this.close(!0)),325):this.close(!0))},afterUnlisten:()=>{!this.hasSelectedItem()&&this.isOpened()&&this.hotMenu.listen()}};this.origOutsideClickDeselects=this.hot.getSettings().outsideClickDeselects,this.hot.getSettings().outsideClickDeselects=!1,this.hotMenu=new this.hot.constructor(this.container,r),this.hotMenu.addHook("afterInit",(()=>this.onAfterInit())),this.hotMenu.init(),QK(this,$K,_K(this.hotMenu)),QK(this,tX,WK(this)),XK(this,tX).listen(),this.focus(),this.isSubMenu()&&this.addLocalHook("afterOpen",(()=>this.parentMenu.runLocalHooks("afterSubmenuOpen",this))),this.runLocalHooks("afterOpen",this)}close(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.isOpened())if(t&&this.isSubMenu())this.parentMenu.close();else if(XK(this,$K).clear(),this.closeAllSubMenus(),this.container.style.display="none",this.hotMenu.destroy(),this.hotMenu=null,this.hot.getSettings().outsideClickDeselects=this.origOutsideClickDeselects,this.runLocalHooks("afterClose"),this.isSubMenu()){if(this.hot.getSettings().ariaTags){const t=this.parentMenu.hotMenu.getSelectedLast();if(t){const e=this.parentMenu.hotMenu.getCell(t[0],0);dA(e,[Lw(!1)])}}this.parentMenu.hotMenu.listen()}}openSubMenu(t){if(!this.hotMenu)return!1;const e=this.hotMenu.getCell(t,0);if(this.closeAllSubMenus(),!e||!kK(e))return!1;const n=this.hotMenu.getSourceDataAtRow(t),o=new eX(this.hot,{parent:this,name:n.name,className:this.options.className,keepInViewport:!0,container:this.options.container});return o.setMenuItems(n.submenu.items),o.open(),o.setPosition(e.getBoundingClientRect()),this.hotSubMenus[n.key]=o,this.hot.getSettings().ariaTags&&dA(e,[Lw(!0)]),o}closeSubMenu(t){const e=this.hotMenu.getSourceDataAtRow(t),n=this.hotSubMenus[e.key];if(n){n.destroy(),delete this.hotSubMenus[e.key];const o=this.hotMenu.getCell(t,0);this.hot.getSettings().ariaTags&&dA(o,[Lw(!1)])}}closeAllSubMenus(){Mp(this.hotMenu.getData(),((t,e)=>this.closeSubMenu(e)))}isAllSubMenusClosed(){return 0===Object.keys(this.hotSubMenus).length}focus(){this.isOpened()&&(this.hotMenu.rootElement.focus({preventScroll:!0}),this.getKeyboardShortcutsCtrl().listen(),this.hotMenu.listen())}destroy(){const t=this.container.parentNode;this.clearLocalHooks(),this.close(),this.parentMenu=null,this.eventManager.destroy(),t&&t.removeChild(this.container)}isOpened(){return null!==this.hotMenu}executeCommand(t){if(!this.isOpened()||!this.hasSelectedItem())return;const e=this.getSelectedItem();if(this.runLocalHooks("select",e,t),this.isCommandPassive(e))return;const n=this.hot.getSelectedRange(),o=n?bK(n):[];this.runLocalHooks("executeCommand",e.key,o,t),this.isSubMenu()&&this.parentMenu.runLocalHooks("executeCommand",e.key,o,t)}isCommandPassive(t){return!1===t.isCommand||EK(t)||RK(t,this.hot)||SK(t)}setOffset(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.positioner.setOffset(t,e)}setPosition(t){this.isSubMenu()&&this.positioner.setParentElement(this.parentMenu.container),this.positioner.setElement(this.container).updatePosition(t)}createContainer(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;const e=this.options.container.ownerDocument;let n,o=t;return o&&(iv(o)&&(o=o.call(this.hot),o=null===o||Fp(o)?"":o.toString()),o=o.replace(/[^A-z0-9]/g,"_"),o=`${this.options.className}Sub_${o}`,n=e.querySelector(`.${this.options.className}.${o}`)),n||(n=e.createElement("div"),cA(n,`htMenu ${this.options.className}`),o&&cA(n,o),this.options.container.appendChild(n)),n}onAfterInit(){const{wtTable:t}=this.hotMenu.view._wt,e=this.hotMenu.getSettings().data,n=t.hider.style,o=t.holder.style,i=parseInt(n.width,10),r=Sp(e,((t,e)=>t+(e.name===cG?1:26)),0);o.width=`${i+3}px`,o.height=`${r+3}px`,n.height=o.height,this.hot.getSettings().ariaTags&&dA(this.hotMenu.rootElement,[yw(),dw(-1)])}onDocumentMouseDown(t){this.isOpened()&&(this.options.standalone&&this.hotMenu&&!iA(t.target,this.hotMenu.rootElement)||(this.isAllSubMenusClosed()||this.isSubMenu())&&!iA(t.target,".htMenu"))&&this.close(!0)}onDocumentContextMenu(t){this.isOpened()&&hA(t.target,"htCore")&&iA(t.target,this.hotMenu.rootElement)&&t.preventDefault()}}function nX(t,e){oX(t,e),e.add(t)}function oX(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function iX(t,e,n){return e=rX(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function rX(t){var e=sX(t,"string");return"symbol"==typeof e?e:String(e)}function sX(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function aX(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}Jv(eX,YT);const lX="contextMenu",hX=70,cX=lX;aC.getSingleton().register("afterContextMenuDefaultOptions"),aC.getSingleton().register("beforeContextMenuShow"),aC.getSingleton().register("afterContextMenuShow"),aC.getSingleton().register("afterContextMenuHide"),aC.getSingleton().register("afterContextMenuExecute");var uX=new WeakSet,dX=new WeakSet,gX=new WeakSet,fX=new WeakSet;class mX extends jF{constructor(){super(...arguments),nX(this,fX),nX(this,gX),nX(this,dX),nX(this,uX),iX(this,"commandExecutor",new ZQ(this.hot)),iX(this,"itemsFactory",null),iX(this,"menu",null)}static get PLUGIN_KEY(){return lX}static get PLUGIN_PRIORITY(){return hX}static get PLUGIN_DEPS(){return["plugin:AutoColumnSize"]}static get DEFAULT_ITEMS(){return[kG,IG,cG,pG,AG,cG,MG,EG,cG,NG,bG,cG,yG,cG,dG]}isEnabled(){return!!this.hot.getSettings()[lX]}enablePlugin(){var t=this;if(this.enabled)return;const e=this.hot.getSettings()[lX];"function"==typeof e.callback&&this.commandExecutor.setCommonCallback(e.callback),this.menu=new eX(this.hot,{className:"htContextMenu",keepInViewport:!0,container:e.uiContainer||this.hot.rootDocument.body}),this.menu.addLocalHook("beforeOpen",(()=>aX(this,dX,wX).call(this))),this.menu.addLocalHook("afterOpen",(()=>aX(this,gX,AX).call(this))),this.menu.addLocalHook("afterClose",(()=>aX(this,fX,vX).call(this))),this.menu.addLocalHook("executeCommand",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return t.executeCommand.call(t,...n)})),this.addHook("afterOnCellContextMenu",(t=>aX(this,uX,pX).call(this,t))),this.registerShortcuts(),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.close(),this.menu&&(this.menu.destroy(),this.menu=null),this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Control/Meta","Shift","Backslash"],["Shift","F10"]],callback:()=>{const{highlight:t}=this.hot.getSelectedRangeLast();this.hot.scrollToFocusedCell();const e=this.hot.getCell(t.row,t.col,!0).getBoundingClientRect(),n=hG(this.menu.container,this.hot.rootDocument);this.open({left:e.left+n.left,top:e.top+n.top-1+e.height},{left:e.width,above:-e.height}),this.menu.getNavigator().toFirstItem()},runOnlyIf:()=>{var t;const e=null===(t=this.hot.getSelectedRangeLast())||void 0===t?void 0:t.highlight;return e&&this.hot.selection.isCellVisible(e)&&!this.menu.isOpened()},group:cX})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(cX)}open(t){var e;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{above:0,below:0,left:0,right:0};null!==(e=this.menu)&&void 0!==e&&e.isOpened()||(this.prepareMenuItems(),this.menu.open(),ny(n,((t,e)=>{this.menu.setOffset(e,t)})),this.menu.setPosition(t))}close(){var t;null===(t=this.menu)||void 0===t||t.close(),this.itemsFactory=null}executeCommand(t){null===this.itemsFactory&&this.prepareMenuItems();for(var e=arguments.length,n=new Array(e>1?e-1:0),o=1;o<e;o++)n[o-1]=arguments[o];this.commandExecutor.execute(t,...n)}prepareMenuItems(){this.itemsFactory=new nK(this.hot,mX.DEFAULT_ITEMS);const t=this.hot.getSettings()[lX],e={items:this.itemsFactory.getItems(t)};this.hot.runHooks("afterContextMenuDefaultOptions",e),this.itemsFactory.setPredefinedItems(e.items);const n=this.itemsFactory.getItems(t);this.hot.runHooks("beforeContextMenuSetItems",n),this.menu.setMenuItems(n),Mp(n,(t=>this.commandExecutor.registerCommand(t.key,t)))}destroy(){this.close(),this.menu&&this.menu.destroy(),super.destroy()}}function pX(t){const e=this.hot.getSettings(),n=e.rowHeaders,o=e.colHeaders;function i(t){return"TD"===t.nodeName||"TD"===t.parentNode.nodeName}const r=t.target;if(this.close(),hA(r,"handsontableInput")||(t.preventDefault(),t.stopPropagation(),!n&&!o&&!i(r)&&(!hA(r,"current")||!hA(r,"wtBorder"))))return;const s=hG(this.menu.container,this.hot.rootDocument);this.open({top:t.clientY+s.top,left:t.clientX+s.left})}function wX(){this.hot.runHooks("beforeContextMenuShow",this)}function AX(){this.hot.runHooks("afterContextMenuShow",this)}function vX(){this.hot.listen(),this.hot.runHooks("afterContextMenuHide",this)}function yX(t){return{key:"copy",name(){return this.getTranslatedPhrase(BO)},callback(){t.copyCellsOnly()},disabled(){if(0===this.countRows()||0===this.countCols())return!0;const t=this.getSelectedRangeLast();if(!t||t.isSingleHeader())return!0;const e=this.getSelected();return!e||e.length>1},hidden:!1}}function CX(t){return{key:"copy_column_headers_only",name(){const t=this.getSelectedRangeLast(),e=t?Eb(t.getWidth()-1,0,1):0;return this.getTranslatedPhrase(WO,e)},callback(){t.copyColumnHeadersOnly()},disabled(){if(!this.hasColHeaders())return!0;const t=this.getSelectedRangeLast();if(!t||t.isSingleHeader())return!0;const e=this.getSelected();return!e||e.length>1},hidden:!1}}function bX(t){return{key:"copy_with_column_group_headers",name(){const t=this.getSelectedRangeLast(),e=t?Eb(t.getWidth()-1,0,1):0;return this.getTranslatedPhrase(VO,e)},callback(){t.copyWithAllColumnHeaders()},disabled(){if(!this.hasColHeaders()||!this.getSettings().nestedHeaders)return!0;const t=this.getSelectedRangeLast();if(!t||t.isSingleHeader())return!0;const e=this.getSelected();return!e||e.length>1},hidden:!1}}function SX(t){return{key:"copy_with_column_headers",name(){const t=this.getSelectedRangeLast(),e=t?Eb(t.getWidth()-1,0,1):0;return this.getTranslatedPhrase(LO,e)},callback(){t.copyWithColumnHeaders()},disabled(){if(!this.hasColHeaders())return!0;const t=this.getSelectedRangeLast();if(!t||t.isSingleHeader())return!0;const e=this.getSelected();return!e||e.length>1},hidden:!1}}function EX(t){return{key:"cut",name(){return this.getTranslatedPhrase(FO)},callback(){t.cut()},disabled(){if(0===this.countRows()||0===this.countCols())return!0;const t=this.getSelectedRangeLast();if(!t||t.isSingleHeader())return!0;const e=this.getSelected();return!e||e.length>1},hidden:!1}}mX.SEPARATOR={name:cG};class RX{constructor(){this.data={}}setData(t,e){this.data[t]=e}getData(t){return this.data[t]||void 0}}class MX{constructor(){this.clipboardData=new RX}}function TX(t,e){xX(t,e),e.add(t)}function kX(t,e,n){xX(t,e),e.set(t,n)}function xX(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function IX(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function OX(t,e){var n=NX(t,e,"get");return HX(t,n)}function HX(t,e){return e.get?e.get.call(t):e.value}function DX(t,e,n){var o=NX(t,e,"set");return PX(t,o,n),n}function NX(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function PX(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var _X=new WeakMap,BX=new WeakMap,LX=new WeakMap,VX=new WeakMap,WX=new WeakMap,FX=new WeakMap,jX=new WeakSet,UX=new WeakSet;class YX{constructor(t){let{countRows:e,countColumns:n,rowsLimit:o,columnsLimit:i,countColumnHeaders:r}=t;TX(this,UX),TX(this,jX),kX(this,_X,{writable:!0,value:void 0}),kX(this,BX,{writable:!0,value:void 0}),kX(this,LX,{writable:!0,value:void 0}),kX(this,VX,{writable:!0,value:void 0}),kX(this,WX,{writable:!0,value:void 0}),kX(this,FX,{writable:!0,value:void 0}),DX(this,BX,e),DX(this,LX,n),DX(this,VX,o),DX(this,WX,i),DX(this,FX,r)}setSelectedRange(t){DX(this,_X,t)}getCellsRange(){if(0===OX(this,BX).call(this)||0===OX(this,LX).call(this))return null;const{row:t,col:e}=OX(this,_X).getTopStartCorner(),{row:n,col:o}=OX(this,_X).getBottomEndCorner(),i=IX(this,UX,GX).call(this,t,n),r=IX(this,jX,zX).call(this,e,o);return{isRangeTrimmed:n!==i||o!==r,startRow:t,startCol:e,endRow:i,endCol:r}}getMostBottomColumnHeadersRange(){if(0===OX(this,LX).call(this)||0===OX(this,FX).call(this))return null;const{col:t}=OX(this,_X).getTopStartCorner(),{col:e}=OX(this,_X).getBottomEndCorner(),n=IX(this,jX,zX).call(this,t,e);return{isRangeTrimmed:e!==n,startRow:-1,startCol:t,endRow:-1,endCol:n}}getAllColumnHeadersRange(){if(0===OX(this,LX).call(this)||0===OX(this,FX).call(this))return null;const{col:t}=OX(this,_X).getTopStartCorner(),{col:e}=OX(this,_X).getBottomEndCorner(),n=IX(this,jX,zX).call(this,t,e);return{isRangeTrimmed:e!==n,startRow:-OX(this,FX).call(this),startCol:t,endRow:-1,endCol:n}}}function zX(t,e){return Math.min(e,Math.max(t+OX(this,WX).call(this)-1,t))}function GX(t,e){return Math.min(e,Math.max(t+OX(this,VX).call(this)-1,t))}function QX(t){const e=[],n=[];return Mp(t,(t=>{const o=Math.min(t.startRow,t.endRow),i=Math.max(t.startRow,t.endRow);Cb(o,i,(t=>{-1===e.indexOf(t)&&e.push(t)}));const r=Math.min(t.startCol,t.endCol),s=Math.max(t.startCol,t.endCol);Cb(r,s,(t=>{-1===n.indexOf(t)&&n.push(t)}))})),{rows:e,columns:n}}function KX(t,e){qX(t,e),e.add(t)}function XX(t,e,n){qX(t,e),e.set(t,n)}function qX(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ZX(t,e,n){return e=JX(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function JX(t){var e=$X(t,"string");return"symbol"==typeof e?e:String(e)}function $X(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function tq(t,e){var n=iq(t,e,"get");return eq(t,n)}function eq(t,e){return e.get?e.get.call(t):e.value}function nq(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function oq(t,e,n){var o=iq(t,e,"set");return rq(t,o,n),n}function iq(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function rq(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}aC.getSingleton().register("afterCopyLimit"),aC.getSingleton().register("modifyCopyableRange"),aC.getSingleton().register("beforeCut"),aC.getSingleton().register("afterCut"),aC.getSingleton().register("beforePaste"),aC.getSingleton().register("afterPaste"),aC.getSingleton().register("beforeCopy"),aC.getSingleton().register("afterCopy");const sq="copyPaste",aq=80,lq=["fragmentSelection"],hq=['<meta name="generator" content="Handsontable"/>','<style type="text/css">td{white-space:normal}br{mso-data-placement:same-cell}</style>'].join("");var cq=new WeakMap,uq=new WeakMap,dq=new WeakMap,gq=new WeakMap,fq=new WeakMap,mq=new WeakMap,pq=new WeakMap,wq=new WeakMap,Aq=new WeakSet,vq=new WeakSet,yq=new WeakSet,Cq=new WeakSet,bq=new WeakSet,Sq=new WeakSet,Eq=new WeakSet,Rq=new WeakSet,Mq=new WeakSet,Tq=new WeakSet;class kq extends jF{constructor(){super(...arguments),KX(this,Tq),KX(this,Mq),KX(this,Rq),KX(this,Eq),KX(this,Sq),KX(this,bq),KX(this,Cq),KX(this,yq),KX(this,vq),KX(this,Aq),ZX(this,"columnsLimit",1/0),ZX(this,"rowsLimit",1/0),ZX(this,"pasteMode","overwrite"),ZX(this,"uiContainer",this.hot.rootDocument.body),XX(this,cq,{writable:!0,value:!1}),XX(this,uq,{writable:!0,value:!1}),XX(this,dq,{writable:!0,value:!1}),XX(this,gq,{writable:!0,value:"cells-only"}),XX(this,fq,{writable:!0,value:!1}),XX(this,mq,{writable:!0,value:!1}),XX(this,pq,{writable:!0,value:new YX({countRows:()=>this.hot.countRows(),countColumns:()=>this.hot.countCols(),rowsLimit:()=>this.rowsLimit,columnsLimit:()=>this.columnsLimit,countColumnHeaders:()=>this.hot.view.getColumnHeadersCount()})}),XX(this,wq,{writable:!0,value:!1}),ZX(this,"copyableRanges",[])}static get PLUGIN_KEY(){return sq}static get SETTING_KEYS(){return[sq,...lq]}static get PLUGIN_PRIORITY(){return aq}isEnabled(){return!!this.hot.getSettings()[sq]}enablePlugin(){var t=this;if(this.enabled)return;const{[sq]:e}=this.hot.getSettings();var n,o;"object"==typeof e&&(this.pasteMode=null!==(n=e.pasteMode)&&void 0!==n?n:this.pasteMode,this.rowsLimit=isNaN(e.rowsLimit)?this.rowsLimit:e.rowsLimit,this.columnsLimit=isNaN(e.columnsLimit)?this.columnsLimit:e.columnsLimit,oq(this,cq,!!e.copyColumnHeaders),oq(this,uq,!!e.copyColumnGroupHeaders),oq(this,dq,!!e.copyColumnHeadersOnly),this.uiContainer=null!==(o=e.uiContainer)&&void 0!==o?o:this.uiContainer);this.addHook("afterContextMenuDefaultOptions",(t=>nq(this,bq,Dq).call(this,t))),this.addHook("afterSelection",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return nq(t,Sq,Nq).call(t,...n)})),this.addHook("afterSelectionEnd",(()=>nq(this,Eq,Pq).call(this))),this.eventManager.addEventListener(this.hot.rootDocument,"copy",(function(){return t.onCopy(...arguments)})),this.eventManager.addEventListener(this.hot.rootDocument,"cut",(function(){return t.onCut(...arguments)})),this.eventManager.addEventListener(this.hot.rootDocument,"paste",(function(){return t.onPaste(...arguments)})),Ry()&&(this.eventManager.addEventListener(this.hot.rootDocument.body,"mouseenter",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return nq(t,Rq,_q).call(t,...n)})),this.eventManager.addEventListener(this.hot.rootDocument.body,"mouseleave",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return nq(t,Mq,Bq).call(t,...n)})),this.addHook("afterSelection",(()=>nq(this,Tq,Lq).call(this)))),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){super.disablePlugin()}copy(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"cells-only";oq(this,gq,t),oq(this,fq,!0),nq(this,Aq,xq).call(this,"copy")}copyCellsOnly(){this.copy("cells-only")}copyColumnHeadersOnly(){this.copy("column-headers-only")}copyWithAllColumnHeaders(){this.copy("with-column-group-headers")}copyWithColumnHeaders(){this.copy("with-column-headers")}cut(){oq(this,mq,!0),nq(this,Aq,xq).call(this,"cut")}getRangedCopyableData(t){return QN(this.getRangedData(t))}getRangedData(t){const e=[],{rows:n,columns:o}=QX(t);return Mp(n,(t=>{const n=[];Mp(o,(e=>{t<0?n.push(this.hot.getColHeader(e,t)):n.push(this.hot.getCopyableData(t,e))})),e.push(n)})),e}paste(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t;if(!t&&!e)return;const n=new MX;t&&n.clipboardData.setData("text/plain",t),e&&n.clipboardData.setData("text/html",e),this.onPaste(n)}setCopyableText(){const t=this.hot.getSelectedRangeLast();if(!t)return;if(t.isSingleHeader())return void(this.copyableRanges=[]);tq(this,pq).setSelectedRange(t);const e=new Map([["headers",null],["cells",null]]);"column-headers-only"===tq(this,gq)?e.set("headers",tq(this,pq).getMostBottomColumnHeadersRange()):("with-column-headers"===tq(this,gq)?e.set("headers",tq(this,pq).getMostBottomColumnHeadersRange()):"with-column-group-headers"===tq(this,gq)&&e.set("headers",tq(this,pq).getAllColumnHeadersRange()),e.set("cells",tq(this,pq).getCellsRange())),this.copyableRanges=Array.from(e.values()).filter((t=>null!==t)).map((t=>{let{startRow:e,startCol:n,endRow:o,endCol:i}=t;return{startRow:e,startCol:n,endRow:o,endCol:i}})),this.copyableRanges=this.hot.runHooks("modifyCopyableRange",this.copyableRanges);const n=e.get("cells");if(null!==n&&n.isRangeTrimmed){const{startRow:t,startCol:e,endRow:o,endCol:i}=n;this.hot.runHooks("afterCopyLimit",o-t+1,i-e+1,this.rowsLimit,this.columnsLimit)}}isEditorOpened(){var t;return null===(t=this.hot.getActiveEditor())||void 0===t?void 0:t.isOpened()}populateValues(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.hot.getSelectedRangeLast();if(!t.length)return;const n=t.length,o=t[0].length,i=[],{row:r,col:s}=e.getTopStartCorner(),{row:a,col:l}=e.getBottomEndCorner();let h=r,c=s,u=r,d=s;for(;i.length<n||h<=a;){const{skipRowOnPaste:e,visualRow:a}=this.hot.getCellMeta(h,s);if(h=a+1,!0===e)continue;u=a,c=s;const g=[],f=i.length%n;for(;g.length<o||c<=l;){const{skipColumnOnPaste:e,visualCol:n}=this.hot.getCellMeta(r,c);if(c=n+1,!0===e)continue;d=n;const i=g.length%o;g.push(t[f][i])}i.push(g)}return oq(this,wq,!0),this.hot.populateFromArray(r,s,i,void 0,void 0,"CopyPaste.paste",this.pasteMode),[r,s,u,d]}onCopy(t){if(!this.hot.isListening()&&!tq(this,fq)||this.isEditorOpened())return;this.setCopyableText(),oq(this,fq,!1);const e=this.getRangedData(this.copyableRanges),n=nq(this,vq,Iq).call(this,this.copyableRanges);if(this.hot.runHooks("beforeCopy",e,this.copyableRanges,n)){const o=QN(e);if(t&&t.clipboardData){const n=pb(e,this.hot.rootDocument);t.clipboardData.setData("text/plain",o),t.clipboardData.setData("text/html",[hq,n].join(""))}else"undefined"==typeof ClipboardEvent&&this.hot.rootWindow.clipboardData.setData("Text",o);this.hot.runHooks("afterCopy",e,this.copyableRanges,n)}oq(this,gq,"cells-only"),t.preventDefault()}onCut(t){if(!this.hot.isListening()&&!tq(this,mq)||this.isEditorOpened())return;this.setCopyableText(),oq(this,mq,!1);const e=this.getRangedData(this.copyableRanges);if(this.hot.runHooks("beforeCut",e,this.copyableRanges)){const n=QN(e);if(t&&t.clipboardData){const o=pb(e,this.hot.rootDocument);t.clipboardData.setData("text/plain",n),t.clipboardData.setData("text/html",[hq,o].join(""))}else"undefined"==typeof ClipboardEvent&&this.hot.rootWindow.clipboardData.setData("Text",n);this.hot.emptySelectedCells("CopyPaste.cut"),this.hot.runHooks("afterCut",e,this.copyableRanges)}t.preventDefault()}onPaste(t){if(!this.hot.isListening()||this.isEditorOpened()||!this.hot.getSelected())return;let e;if(t&&t.preventDefault&&t.preventDefault(),t&&"undefined"!=typeof t.clipboardData){const n=cw(t.clipboardData.getData("text/html"),{ADD_TAGS:["meta"],ADD_ATTR:["content"],FORCE_BODY:!0});e=n&&/(<table)|(<TABLE)/g.test(n)?wb(n,this.hot.rootDocument).data:t.clipboardData.getData("text/plain")}else"undefined"==typeof ClipboardEvent&&"undefined"!=typeof this.hot.rootWindow.clipboardData&&(e=this.hot.rootWindow.clipboardData.getData("Text"));if("string"==typeof e&&(e=GN(e)),void 0===e||e&&0===e.length||!1===this.hot.runHooks("beforePaste",e,this.copyableRanges))return;const[n,o,i,r]=this.populateValues(e);this.hot.selectCell(n,o,Math.min(this.hot.countRows()-1,i),Math.min(this.hot.countCols()-1,r)),this.hot.runHooks("afterPaste",e,this.copyableRanges)}destroy(){super.destroy()}}function xq(t){if(Ry()){const e=this.hot.getSelectedRangeLast();if(e){const{row:n,col:o}=e.highlight,i=this.hot.getCell(n,o,!0);i&&nv(i,(()=>{this.hot.rootDocument.execCommand(t)}))}}else this.hot.rootDocument.execCommand(t)}function Iq(t){const{rows:e}=QX(t);let n=0;for(let o=0;o<e.length&&!(e[o]>=0);o++)n+=1;return{columnHeadersCount:n}}function Oq(){if(this.hot.isListening()){const t=this.hot.getSelectedRangeLast();if(t){const{row:e,col:n}=t.highlight,o=this.hot.getCell(e,n,!0);o&&tv(o)}}}function Hq(){if(this.hot.isListening()){const t=this.hot.getSelectedRangeLast();if(t){const{row:e,col:n}=t.highlight,o=this.hot.getCell(e,n,!0);null!=o&&o.hasAttribute("contenteditable")&&ev(o)}}}function Dq(t){t.items.push({name:"---------"},yX(this)),tq(this,cq)&&t.items.push(SX(this)),tq(this,uq)&&t.items.push(bX(this)),tq(this,dq)&&t.items.push(CX(this)),t.items.push(EX(this))}function Nq(t,e,n,o,i){tq(this,wq)&&(i.value=!0),oq(this,wq,!1)}function Pq(){this.isEditorOpened()||this.hot.getSettings().fragmentSelection||this.setCopyableText()}function _q(){nq(this,Cq,Hq).call(this)}function Bq(){nq(this,yq,Oq).call(this)}function Lq(){nq(this,Cq,Hq).call(this)}function Vq(t,e){return`border_row${t}col${e}`}function Wq(){return{width:1,color:"#000"}}function Fq(){return{hide:!0}}function jq(){return{width:1,color:"#000",cornerVisible:!1}}function Uq(t){var e,n;(Wp(t.start)||Wp(t.left))&&(t.start=null!==(e=t.start)&&void 0!==e?e:t.left);(Wp(t.end)||Wp(t.right))&&(t.end=null!==(n=t.end)&&void 0!==n?n:t.right);return delete t.left,delete t.right,t}function Yq(t){return Wp(t.start)&&(t.left=t.start),Wp(t.end)&&(t.right=t.end),t}function zq(t,e){return{id:Vq(t,e),border:jq(),row:t,col:e,top:Fq(),bottom:Fq(),start:Fq(),end:Fq()}}function Gq(t,e){return ay(e,"border")&&e.border&&(t.border=e.border),ay(e,"top")&&Wp(e.top)&&(e.top?(ty(e.top)||(e.top=Wq()),t.top=e.top):(e.top=Fq(),t.top=e.top)),ay(e,"bottom")&&Wp(e.bottom)&&(e.bottom?(ty(e.bottom)||(e.bottom=Wq()),t.bottom=e.bottom):(e.bottom=Fq(),t.bottom=e.bottom)),ay(e,"start")&&Wp(e.start)&&(e.start?(ty(e.start)||(e.start=Wq()),t.start=e.start):(e.start=Fq(),t.start=e.start)),ay(e,"end")&&Wp(e.end)&&(e.end?(ty(e.end)||(e.end=Wq()),t.end=e.end):(e.end=Fq(),t.end=e.end)),t}function Qq(t,e){let n=!1;return Mp(t.getSelectedRange(),(o=>{o.forAll(((o,i)=>{if(o<0||i<0)return;const r=t.getCellMeta(o,i).borders;if(r){if(!e)return n=!0,!1;if(!ay(r[e],"hide")||!1===r[e].hide)return n=!0,!1}}))})),n}function Kq(t){return`<span class="selected">${String.fromCharCode(10003)}</span>${t}`}function Xq(t){return t.some((t=>Wp(t.left)||Wp(t.right)))}function qq(t){return t.some((t=>Wp(t.start)||Wp(t.end)))}const Zq=new Map([["left","start"],["right","end"]]);function Jq(t){var e;return null!==(e=Zq.get(t))&&void 0!==e?e:t}function $q(t){return{key:"borders:bottom",name(){let t=this.getTranslatedPhrase(aH);return Qq(this,"bottom")&&(t=Kq(t)),t},callback(e,n){const o=Qq(this,"bottom");t.prepareBorder(n,"bottom",o)}}}function tZ(t){const e=t.hot.isRtl()?"end":"start";return{key:"borders:left",name(){let t=this.getTranslatedPhrase(lH);return Qq(this,e)&&(t=Kq(t)),t},callback(n,o){const i=Qq(this,e);t.prepareBorder(o,e,i)}}}function eZ(t){return{key:"borders:no_borders",name(){return this.getTranslatedPhrase(hH)},callback(e,n){t.prepareBorder(n,"noBorders")},disabled(){return!Qq(this)}}}function nZ(t){const e=t.hot.isRtl()?"start":"end";return{key:"borders:right",name(){let t=this.getTranslatedPhrase(sH);return Qq(this,e)&&(t=Kq(t)),t},callback(n,o){const i=Qq(this,e);t.prepareBorder(o,e,i)}}}function oZ(t){return{key:"borders:top",name(){let t=this.getTranslatedPhrase(rH);return Qq(this,"top")&&(t=Kq(t)),t},callback(e,n){const o=Qq(this,"top");t.prepareBorder(n,"top",o)}}}function iZ(t,e){rZ(t,e),e.add(t)}function rZ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function sZ(t,e,n){return e=aZ(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function aZ(t){var e=lZ(t,"string");return"symbol"==typeof e?e:String(e)}function lZ(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function hZ(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const cZ="customBorders",uZ=90;var dZ=new WeakSet,gZ=new WeakSet;class fZ extends jF{constructor(){super(...arguments),iZ(this,gZ),iZ(this,dZ),sZ(this,"savedBorders",[])}static get PLUGIN_KEY(){return cZ}static get PLUGIN_PRIORITY(){return uZ}isEnabled(){return!!this.hot.getSettings()[cZ]}enablePlugin(){this.enabled||(this.addHook("afterContextMenuDefaultOptions",(t=>hZ(this,dZ,mZ).call(this,t))),this.addHook("init",(()=>hZ(this,gZ,pZ).call(this))),super.enablePlugin())}disablePlugin(){this.hideBorders(),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.changeBorderSettings(),super.updatePlugin()}setBorders(t,e){let n=["top","bottom","start","end"],o=null;e&&(this.checkSettingsCohesion([e]),n=Object.keys(e),o=Uq(e));const i=MN(t),r=TN(i,{createCellCoords:this.hot._createCellCoords.bind(this.hot),createCellRange:this.hot._createCellRange.bind(this.hot)});Mp(t,(t=>{r(t).forAll(((t,e)=>{Mp(n,(n=>{this.prepareBorderFromCustomAdded(t,e,o,Jq(n))}))}))})),this.hot.view.render()}getBorders(t){if(!Array.isArray(t))return this.savedBorders;const e=MN(t),n=TN(e,{createCellCoords:this.hot._createCellCoords.bind(this.hot),createCellRange:this.hot._createCellRange.bind(this.hot)}),o=[];return Mp(t,(t=>{n(t).forAll(((t,e)=>{Mp(this.savedBorders,(n=>{n.row===t&&n.col===e&&o.push(Yq(n))}))}))})),o}clearBorders(t){t?this.setBorders(t):(Mp(this.savedBorders,(t=>{this.clearBordersFromSelectionSettings(t.id),this.clearNullCellRange(),this.hot.removeCellMeta(t.row,t.col,"borders")})),this.savedBorders.length=0)}insertBorderIntoSettings(t,e){this.checkSavedBorders(t)||this.savedBorders.push(t);const n=this.hot._createCellRange(this.hot._createCellCoords(t.row,t.col));this.checkCustomSelections(t,n,e)||this.hot.selection.highlight.addCustomSelection({border:t,visualCellRange:n})}prepareBorderFromCustomAdded(t,e,n,o){const i=this.hot.countRows(),r=this.hot.countCols();if(t>=i||e>=r)return;let s=zq(t,e);n&&(s=Gq(s,n),Mp(this.hot.selection.highlight.customSelections,(t=>{if(s.id===t.settings.id)return Object.assign(t.settings,n),s.id=t.settings.id,s.top=t.settings.top,s.bottom=t.settings.bottom,s.start=t.settings.start,s.end=t.settings.end,!1}))),this.hot.setCellMeta(t,e,"borders",Yq(s)),this.insertBorderIntoSettings(s,o)}prepareBorderFromCustomAddedRange(t,e){const n=Math.min(t.to.row,this.hot.countRows()-1),o=Math.min(t.to.col,this.hot.countCols()-1);Cb(t.from.row,n,(n=>{Cb(t.from.col,o,(o=>{const i=zq(n,o);let r=0;n===t.from.row&&ay(e,"top")&&(r+=1,i.top=e.top),n===t.to.row&&ay(e,"bottom")&&(r+=1,i.bottom=e.bottom),o===t.from.col&&ay(e,"start")&&(r+=1,i.start=e.start),o===t.to.col&&ay(e,"end")&&(r+=1,i.end=e.end),r>0&&(this.hot.setCellMeta(n,o,"borders",Yq(i)),this.insertBorderIntoSettings(i))}))}))}removeAllBorders(t,e){const n=Vq(t,e);this.spliceBorder(n),this.clearBordersFromSelectionSettings(n),this.clearNullCellRange(),this.hot.removeCellMeta(t,e,"borders")}setBorder(t,e,n,o){let i=this.hot.getCellMeta(t,e).borders;i=i&&void 0!==i.border?Uq(i):zq(t,e),o?(i[n]=Fq(),4===this.countHide(i)?this.removeAllBorders(t,e):(this.checkCustomSelectionsFromContextMenu(i,n,o)||this.insertBorderIntoSettings(i),this.hot.setCellMeta(t,e,"borders",Yq(i)))):(i[n]=Wq(),this.checkCustomSelectionsFromContextMenu(i,n,o)||this.insertBorderIntoSettings(i),this.hot.setCellMeta(t,e,"borders",Yq(i)))}prepareBorder(t,e,n){Mp(t,(t=>{let{start:o,end:i}=t;if(o.row===i.row&&o.col===i.col)"noBorders"===e?this.removeAllBorders(o.row,o.col):this.setBorder(o.row,o.col,e,n);else switch(e){case"noBorders":Cb(o.col,i.col,(t=>{Cb(o.row,i.row,(e=>{this.removeAllBorders(e,t)}))}));break;case"top":Cb(o.col,i.col,(t=>{this.setBorder(o.row,t,e,n)}));break;case"bottom":Cb(o.col,i.col,(t=>{this.setBorder(i.row,t,e,n)}));break;case"start":Cb(o.row,i.row,(t=>{this.setBorder(t,o.col,e,n)}));break;case"end":Cb(o.row,i.row,(t=>{this.setBorder(t,i.col,e,n)}));break}}))}createCustomBorders(t){Mp(t,(t=>{const e=Uq(t);t.range?this.prepareBorderFromCustomAddedRange(t.range,e):this.prepareBorderFromCustomAdded(t.row,t.col,e)}))}countHide(t){const{top:e,bottom:n,start:o,end:i}=t;return Sp([e,n,o,i],((t,e)=>{let n=t;return e&&e.hide&&(n+=1),n}),0)}clearBordersFromSelectionSettings(t){const e=Rp(this.hot.selection.highlight.customSelections,(t=>t.settings.id)).indexOf(t);e>-1&&this.hot.selection.highlight.customSelections[e].clear()}clearNullCellRange(){Mp(this.hot.selection.highlight.customSelections,((t,e)=>{if(null===t.cellRange)return this.hot.selection.highlight.customSelections[e].destroy(),this.hot.selection.highlight.customSelections.splice(e,1),!1}))}hideBorders(){Mp(this.savedBorders,(t=>{this.clearBordersFromSelectionSettings(t.id),this.clearNullCellRange()}))}spliceBorder(t){const e=Rp(this.savedBorders,(t=>t.id)).indexOf(t);e>-1&&this.savedBorders.splice(e,1)}checkSavedBorders(t){let e=!1;return 4===this.countHide(t)?(this.spliceBorder(t.id),e=!0):Mp(this.savedBorders,((n,o)=>{if(t.id===n.id)return this.savedBorders[o]=t,e=!0,!1})),e}checkCustomSelectionsFromContextMenu(t,e,n){let o=!1;return Mp(this.hot.selection.highlight.customSelections,(i=>{if(t.id===i.settings.id){const t=this.hot.view._wt.selectionManager.getBorderInstances(i);return Mp(t,(t=>{t.toggleHiddenClass(e,n)})),o=!0,!1}})),o}checkCustomSelections(t,e,n){const o=this.countHide(t);let i=!1;return 4===o?(this.removeAllBorders(t.row,t.col),i=!0):Mp(this.hot.selection.highlight.customSelections,(o=>{if(t.id===o.settings.id){if(o.visualCellRange=e,o.commit(),n){const e=this.hot.view._wt.selectionManager.getBorderInstances(o);Mp(e,(e=>{e.changeBorderStyle(n,t)}))}return i=!0,!1}})),i}changeBorderSettings(){const t=this.hot.getSettings()[cZ];if(Array.isArray(t)){const e=qv(t);this.checkSettingsCohesion(e),e.length||(this.savedBorders=e),this.createCustomBorders(e)}else void 0!==t&&this.createCustomBorders(this.savedBorders)}checkSettingsCohesion(t){const e=Xq(t),n=qq(t);if(e&&n)throw new Error('The "left"/"right" and "start"/"end" options should not be used together. Please use only the option "start"/"end".');if(this.hot.isRtl()&&e)throw new Error('The "left"/"right" properties are not supported for RTL. Please use option "start"/"end".')}destroy(){super.destroy()}}function mZ(t){this.hot.getSettings()[cZ]&&t.items.push({name:"---------"},{key:"borders",name(){return this.getTranslatedPhrase(iH)},disabled(){const t=this.getSelectedRangeLast();return!(t&&!t.isSingleHeader())||this.selection.isSelectedByCorner()},submenu:{items:[oZ(this),nZ(this),$q(this),tZ(this),eZ(this)]}})}function pZ(){this.changeBorderSettings()}function wZ(t,e){AZ(t,e),e.add(t)}function AZ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function vZ(t,e,n){return e=yZ(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function yZ(t){var e=CZ(t,"string");return"symbol"==typeof e?e:String(e)}function CZ(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function bZ(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const SZ="dragToScroll",EZ=100;var RZ=new WeakSet;class MZ extends jF{constructor(){super(...arguments),wZ(this,RZ),vZ(this,"boundaries",null),vZ(this,"callback",null),vZ(this,"listening",!1)}static get PLUGIN_KEY(){return SZ}static get PLUGIN_PRIORITY(){return EZ}isEnabled(){return!!this.hot.getSettings()[SZ]}enablePlugin(){this.enabled||(this.addHook("afterOnCellMouseDown",(t=>bZ(this,RZ,TZ).call(this,t))),this.addHook("afterOnCellCornerMouseDown",(t=>bZ(this,RZ,TZ).call(this,t))),this.registerEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.unregisterEvents(),super.disablePlugin()}setBoundaries(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{left:0,right:this.hot.rootWindow.innerWidth,top:0,bottom:this.hot.rootWindow.innerHeight};this.boundaries=t}setCallback(t){this.callback=t}check(t,e){let n=0,o=0;e<this.boundaries.top?o=e-this.boundaries.top:e>this.boundaries.bottom&&(o=e-this.boundaries.bottom),t<this.boundaries.left?n=t-this.boundaries.left:t>this.boundaries.right&&(n=t-this.boundaries.right),this.callback(n,o)}listen(){this.listening=!0}unlisten(){this.listening=!1}isListening(){return this.listening}registerEvents(){const{rootWindow:t}=this.hot;let e=t;for(;e;)this.eventManager.addEventListener(e.document,"contextmenu",(()=>this.unlisten())),this.eventManager.addEventListener(e.document,"mouseup",(()=>this.unlisten())),this.eventManager.addEventListener(e.document,"mousemove",(t=>this.onMouseMove(t))),e=tA(e)}unregisterEvents(){this.eventManager.clear()}onMouseMove(t){this.isListening()&&this.check(t.clientX,t.clientY)}destroy(){super.destroy()}}function TZ(t){if(zy(t))return;const e=this.hot.view._wt.wtOverlays.topOverlay.mainTableScrollableElement;this.setBoundaries(e!==this.hot.rootWindow?e.getBoundingClientRect():void 0),this.setCallback(((t,n)=>{var o,i;const r=null!==(o=e.scrollLeft)&&void 0!==o?o:e.scrollX,s=null!==(i=e.scrollTop)&&void 0!==i?i:e.scrollY;e.scroll(r+50*Math.sign(t),s+20*Math.sign(n))})),this.listen()}function kZ(t,e){xZ(t,e),e.add(t)}function xZ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function IZ(t,e,n){return e=OZ(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function OZ(t){var e=HZ(t,"string");return"symbol"==typeof e?e:String(e)}function HZ(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function DZ(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}aC.getSingleton().register("afterDropdownMenuDefaultOptions"),aC.getSingleton().register("beforeDropdownMenuShow"),aC.getSingleton().register("afterDropdownMenuShow"),aC.getSingleton().register("afterDropdownMenuHide"),aC.getSingleton().register("afterDropdownMenuExecute");const NZ="dropdownMenu",PZ=230,_Z="changeType",BZ=NZ;var LZ=new WeakSet,VZ=new WeakSet,WZ=new WeakSet,FZ=new WeakSet,jZ=new WeakSet,UZ=new WeakSet,YZ=new WeakSet;class zZ extends jF{static get PLUGIN_KEY(){return NZ}static get PLUGIN_PRIORITY(){return PZ}static get PLUGIN_DEPS(){return["plugin:AutoColumnSize"]}static get DEFAULT_ITEMS(){return[pG,AG,cG,EG,cG,fG,cG,yG,cG,dG]}constructor(t){super(t),kZ(this,YZ),kZ(this,UZ),kZ(this,jZ),kZ(this,FZ),kZ(this,WZ),kZ(this,VZ),kZ(this,LZ),IZ(this,"commandExecutor",new ZQ(this.hot)),IZ(this,"itemsFactory",null),IZ(this,"menu",null),this.hot.addHook("afterGetColHeader",((t,e)=>DZ(this,WZ,KZ).call(this,t,e)))}isEnabled(){return this.hot.getSettings()[NZ]}enablePlugin(){var t=this;if(this.enabled)return;this.itemsFactory=new nK(this.hot,zZ.DEFAULT_ITEMS);const e=this.hot.getSettings()[NZ],n={items:this.itemsFactory.getItems(e)};this.registerEvents(),"function"==typeof e.callback&&this.commandExecutor.setCommonCallback(e.callback),this.registerShortcuts(),super.enablePlugin(),this.callOnPluginsReady((()=>{this.hot.runHooks("afterDropdownMenuDefaultOptions",n),this.itemsFactory.setPredefinedItems(n.items);const o=this.itemsFactory.getItems(e);this.menu&&this.menu.destroy(),this.menu=new eX(this.hot,{className:"htDropdownMenu",keepInViewport:!0,container:e.uiContainer||this.hot.rootDocument.body}),this.hot.runHooks("beforeDropdownMenuSetItems",o),this.menu.setMenuItems(o),this.menu.addLocalHook("beforeOpen",(()=>DZ(this,FZ,XZ).call(this))),this.menu.addLocalHook("afterOpen",(()=>DZ(this,jZ,qZ).call(this))),this.menu.addLocalHook("afterSubmenuOpen",(t=>DZ(this,UZ,ZZ).call(this,t))),this.menu.addLocalHook("afterClose",(()=>DZ(this,YZ,JZ).call(this))),this.menu.addLocalHook("executeCommand",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return t.executeCommand.call(t,...n)})),Mp(o,(t=>this.commandExecutor.registerCommand(t.key,t)))}))}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.close(),this.menu&&this.menu.destroy(),this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){const t=this.hot.getShortcutManager().getContext("grid"),e=()=>{const{highlight:t}=this.hot.getSelectedRangeLast();if((t.isHeader()&&-1===t.row||t.isCell())&&t.col>=0){this.hot.selectColumns(t.col,t.col,-1);const{from:e}=this.hot.getSelectedRangeLast(),n=hG(this.menu.container,this.hot.rootDocument),o=this.hot.getCell(-1,e.col,!0),i=o.getBoundingClientRect();this.open({left:i.left+n.left,top:i.top+o.offsetHeight+n.top},{left:i.width}),this.menu.getNavigator().toFirstItem()}};t.addShortcuts([{keys:[["Shift","Alt","ArrowDown"],["Control/Meta","Enter"]],callback:e,runOnlyIf:()=>{var t;const e=null===(t=this.hot.getSelectedRangeLast())||void 0===t?void 0:t.highlight;return e&&this.hot.selection.isCellVisible(e)&&e.isHeader()&&!this.menu.isOpened()},captureCtrl:!0,group:BZ},{keys:[["Shift","Alt","ArrowDown"]],callback:e,runOnlyIf:()=>{var t;const e=null===(t=this.hot.getSelectedRangeLast())||void 0===t?void 0:t.highlight;return e&&this.hot.selection.isCellVisible(e)&&e.isCell()&&!this.menu.isOpened()},group:BZ}])}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(BZ)}registerEvents(){this.eventManager.addEventListener(this.hot.rootElement,"click",(t=>DZ(this,VZ,QZ).call(this,t)))}open(t){var e;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{above:0,below:0,left:0,right:0};null!==(e=this.menu)&&void 0!==e&&e.isOpened()||(this.menu.open(),ny(n,((t,e)=>{this.menu.setOffset(e,t)})),this.menu.setPosition(t))}close(){var t;null===(t=this.menu)||void 0===t||t.close()}executeCommand(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),o=1;o<e;o++)n[o-1]=arguments[o];this.commandExecutor.execute(t,...n)}setListening(){let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.menu.isOpened()&&(t?this.menu.hotMenu.listen():this.menu.hotMenu.unlisten())}destroy(){this.close(),this.menu&&this.menu.destroy(),super.destroy()}}function GZ(t){t.getKeyboardShortcutsCtrl().addCustomShortcuts([{keys:[["Control/Meta","A"]],callback:()=>!1}])}function QZ(t){if(t.stopPropagation(),hA(t.target,_Z)){const e=hG(this.menu.container,this.hot.rootDocument),n=t.target.getBoundingClientRect();this.open({left:n.left+e.left,top:n.top+t.target.offsetHeight+3+e.top},{left:n.width})}}function KZ(t,e){const n=e.parentNode;if(!n)return;const o=n.parentNode.childNodes,i=Array.prototype.indexOf.call(o,n);if(t<0||i!==o.length-1)return;const r=e.querySelector(`.${_Z}`);if(this.enabled&&r)return;if(!this.enabled)return void(r&&r.parentNode.removeChild(r));const s=this.hot.rootDocument.createElement("button");s.className=_Z,s.type="button",s.tabIndex=-1,this.hot.getSettings().ariaTags&&(dA(s,[Iw(),xw(" ")]),dA(e,[Dw("menu")])),s.onclick=function(){return!1},e.firstChild.insertBefore(s,e.firstChild.firstChild)}function XZ(){this.hot.runHooks("beforeDropdownMenuShow",this)}function qZ(){this.hot.runHooks("afterDropdownMenuShow",this),DZ(this,LZ,GZ).call(this,this.menu)}function ZZ(t){DZ(this,LZ,GZ).call(this,t)}function JZ(){this.hot.listen(),this.hot.runHooks("afterDropdownMenuHide",this)}function $Z(t,e,n){return e=tJ(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function tJ(t){var e=eJ(t,"string");return"symbol"==typeof e?e:String(e)}function eJ(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}zZ.SEPARATOR={name:cG};class nJ{constructor(t){$Z(this,"hot",void 0),$Z(this,"options",{}),this.hot=t}setOptions(t){this.options=t}getData(){const{startRow:t,startCol:e,endRow:n,endCol:o}=this._getDataRange(),i=this.options,r=[];return Cb(t,n,(t=>{const n=[];!i.exportHiddenRows&&this._isHiddenRow(t)||(Cb(e,o,(e=>{!i.exportHiddenColumns&&this._isHiddenColumn(e)||n.push(this.hot.getDataAtCell(t,e))})),r.push(n))})),r}getRowHeaders(){const t=[];if(this.options.rowHeaders){const{startRow:e,endRow:n}=this._getDataRange(),o=this.hot.getRowHeader();Cb(e,n,(e=>{!this.options.exportHiddenRows&&this._isHiddenRow(e)||t.push(o[e])}))}return t}getColumnHeaders(){const t=[];if(this.options.columnHeaders){const{startCol:e,endCol:n}=this._getDataRange(),o=this.hot.getColHeader();Cb(e,n,(e=>{!this.options.exportHiddenColumns&&this._isHiddenColumn(e)||t.push(o[e])}))}return t}_getDataRange(){const t=this.hot.countCols()-1,e=this.hot.countRows()-1;let[n=0,o=0,i=e,r=t]=this.options.range;return n=Math.max(n,0),o=Math.max(o,0),i=Math.min(i,e),r=Math.min(r,t),{startRow:n,startCol:o,endRow:i,endCol:r}}_isHiddenRow(t){return this.hot.rowIndexMapper.isHidden(this.hot.toPhysicalRow(t))}_isHiddenColumn(t){return this.hot.columnIndexMapper.isHidden(this.hot.toPhysicalColumn(t))}}const oJ=nJ;function iJ(t,e,n){return e=rJ(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function rJ(t){var e=sJ(t,"string");return"symbol"==typeof e?e:String(e)}function sJ(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class aJ{static get DEFAULT_OPTIONS(){return{mimeType:"text/plain",fileExtension:"txt",filename:"Handsontable [YYYY]-[MM]-[DD]",encoding:"utf-8",bom:!1,columnHeaders:!1,rowHeaders:!1,exportHiddenColumns:!1,exportHiddenRows:!1,range:[]}}constructor(t,e){iJ(this,"dataProvider",void 0),iJ(this,"options",void 0),this.dataProvider=t,this.options=this._mergeOptions(e),this.dataProvider.setOptions(this.options)}_mergeOptions(t){let e=Zv(this.constructor.DEFAULT_OPTIONS);const n=new Date;return e=Kv(Zv(aJ.DEFAULT_OPTIONS),e),e=Kv(e,t),e.filename=lw(e.filename,{YYYY:n.getFullYear(),MM:`${n.getMonth()+1}`.padStart(2,"0"),DD:`${n.getDate()}`.padStart(2,"0")}),e}}const lJ=aJ,hJ=String.fromCharCode(13),cJ=String.fromCharCode(34),uJ=String.fromCharCode(10);class dJ extends lJ{static get DEFAULT_OPTIONS(){return{mimeType:"text/csv",fileExtension:"csv",bom:!0,columnDelimiter:",",rowDelimiter:"\r\n"}}export(){const t=this.options,e=this.dataProvider.getData();let n=this.dataProvider.getColumnHeaders();const o=n.length>0,i=this.dataProvider.getRowHeaders(),r=i.length>0;let s=t.bom?String.fromCharCode(65279):"";return o&&(n=Rp(n,(t=>this._escapeCell(t,!0))),r&&(s+=t.columnDelimiter),s+=n.join(t.columnDelimiter),s+=t.rowDelimiter),Mp(e,((e,n)=>{n>0&&(s+=t.rowDelimiter),r&&(s+=this._escapeCell(i[n])+t.columnDelimiter),s+=e.map((t=>this._escapeCell(t))).join(t.columnDelimiter)})),s}_escapeCell(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=Vp(t);return""!==n&&(e||n.indexOf(hJ)>=0||n.indexOf(cJ)>=0||n.indexOf(uJ)>=0||n.indexOf(this.options.columnDelimiter)>=0)&&(n=n.replace(new RegExp('"',"g"),'""'),n=`"${n}"`),n}}const gJ=dJ,fJ="csv",mJ={[fJ]:gJ};function pJ(t,e,n){return"function"==typeof mJ[t]?new mJ[t](e,n):null}const wJ="exportFile",AJ=240;class vJ extends jF{static get PLUGIN_KEY(){return wJ}static get PLUGIN_PRIORITY(){return AJ}isEnabled(){return!0}exportAsString(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this._createTypeFormatter(t,e).export()}exportAsBlob(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this._createBlob(this._createTypeFormatter(t,e))}downloadFile(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{rootDocument:n,rootWindow:o}=this.hot,i=this._createTypeFormatter(t,e),r=this._createBlob(i),s=o.URL||o.webkitURL,a=n.createElement("a"),l=`${i.options.filename}.${i.options.fileExtension}`;if(void 0!==a.download){const t=s.createObjectURL(r);a.style.display="none",a.setAttribute("href",t),a.setAttribute("download",l),n.body.appendChild(a),a.dispatchEvent(new MouseEvent("click")),n.body.removeChild(a),setTimeout((()=>{s.revokeObjectURL(t)}),100)}else navigator.msSaveOrOpenBlob&&navigator.msSaveOrOpenBlob(r,l)}_createTypeFormatter(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!mJ[t])throw new Error(`Export format type "${t}" is not supported.`);return pJ(t,new oJ(this.hot),e)}_createBlob(t){let e=null;return"undefined"!=typeof Blob&&(e=new Blob([t.export()],{type:`${t.options.mimeType};charset=${t.options.encoding}`})),e}}function yJ(t,e,n){return e=CJ(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function CJ(t){var e=bJ(t,"string");return"symbol"==typeof e?e:String(e)}function bJ(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class SJ{constructor(t,e){let{id:n,stateless:o=!0}=e;yJ(this,"hot",void 0),yJ(this,"id",void 0),yJ(this,"elements",[]),yJ(this,"hidden",!1),yJ(this,"stateId",""),yJ(this,"state",void 0),this.hot=t,this.id=n,this.stateId=`Filters.component.${this.id}`,this.state=o?null:this.hot.columnIndexMapper.registerMap(this.stateId,new MI)}getElements(){return this.elements}reset(){Mp(this.elements,(t=>t.reset()))}hide(){this.hidden=!0}show(){this.hidden=!1}isHidden(){return null===this.hot||this.hidden}restoreState(t){this.state&&this.setState(this.state.getValueAtIndex(t))}setState(){throw new Error("The state setting logic is not implemented")}saveState(t){this.state&&this.state.setValueAtIndex(t,this.getState())}getState(){throw new Error("The state gathering logic is not implemented")}destroy(){this.hot.columnIndexMapper.unregisterMap(this.stateId),this.clearLocalHooks(),Mp(this.elements,(t=>t.destroy())),this.state=null,this.elements=null,this.hot=null}}Jv(SJ,YT);const EJ={};function RJ(t,e){if(!EJ[t])throw Error(`Filter condition "${t}" does not exist.`);const{condition:n,descriptor:o}=EJ[t];let i=e;return o.inputValuesDecorator&&(i=o.inputValuesDecorator(i)),function(t){return n.apply(t.meta.instance,[].concat([t],[i]))}}function MJ(t){if(!EJ[t])throw Error(`Filter condition "${t}" does not exist.`);return EJ[t].descriptor}function TJ(t,e,n){n.key=t,EJ[t]={condition:e,descriptor:n}}const kJ="none";function xJ(){return!0}TJ(kJ,xJ,{name:AH,inputsCount:0,showOperators:!1});const IJ="empty";function OJ(t){return jp(t.value)}TJ(IJ,OJ,{name:vH,inputsCount:0,showOperators:!0});const HJ="not_empty";function DJ(t,e){return!RJ(IJ,e)(t)}TJ(HJ,DJ,{name:yH,inputsCount:0,showOperators:!0});const NJ="eq";function PJ(t,e){let[n]=e;return Vp(t.value).toLocaleLowerCase(t.meta.locale)===Vp(n)}TJ(NJ,PJ,{name:CH,inputsCount:1,showOperators:!0});const _J="neq";function BJ(t,e){return!RJ(NJ,e)(t)}TJ(_J,BJ,{name:bH,inputsCount:1,showOperators:!0});const LJ="gt";function VJ(t,e){let[n]=e,o=n;return"numeric"===t.meta.type&&(o=parseFloat(o,10)),t.value>o}TJ(LJ,VJ,{name:kH,inputsCount:1,showOperators:!0});const WJ="gte";function FJ(t,e){let[n]=e,o=n;return"numeric"===t.meta.type&&(o=parseFloat(o,10)),t.value>=o}TJ(WJ,FJ,{name:xH,inputsCount:1,showOperators:!0});const jJ="lt";function UJ(t,e){let[n]=e,o=n;return"numeric"===t.meta.type&&(o=parseFloat(o,10)),t.value<o}TJ(jJ,UJ,{name:IH,inputsCount:1,showOperators:!0});const YJ="lte";function zJ(t,e){let[n]=e,o=n;return"numeric"===t.meta.type&&(o=parseFloat(o,10)),t.value<=o}TJ(YJ,zJ,{name:OH,inputsCount:1,showOperators:!0});const GJ="date_after";function QJ(t,e){let[n]=e;const o=gh(t.value,t.meta.dateFormat),i=gh(n,t.meta.dateFormat);return!(!o.isValid()||!i.isValid())&&o.diff(i)>=0}TJ(GJ,QJ,{name:NH,inputsCount:1,showOperators:!0});const KJ="date_before";function XJ(t,e){let[n]=e;const o=gh(t.value,t.meta.dateFormat),i=gh(n,t.meta.dateFormat);return!(!o.isValid()||!i.isValid())&&o.diff(i)<=0}TJ(KJ,XJ,{name:PH,inputsCount:1,showOperators:!0});const qJ="between";function ZJ(t,e){let[n,o]=e,i=n,r=o;if("numeric"===t.meta.type){const t=parseFloat(i,10),e=parseFloat(r,10);i=Math.min(t,e),r=Math.max(t,e)}else if("date"===t.meta.type){const e=RJ(KJ,[r]),n=RJ(GJ,[i]);return e(t)&&n(t)}return t.value>=i&&t.value<=r}TJ(qJ,ZJ,{name:HH,inputsCount:2,showOperators:!0});const JJ="not_between";function $J(t,e){return!RJ(qJ,e)(t)}TJ(JJ,$J,{name:DH,inputsCount:2,showOperators:!0});const t$="begins_with";function e$(t,e){let[n]=e;return Vp(t.value).toLocaleLowerCase(t.meta.locale).startsWith(Vp(n))}TJ(t$,e$,{name:SH,inputsCount:1,showOperators:!0});const n$="ends_with";function o$(t,e){let[n]=e;return Vp(t.value).toLocaleLowerCase(t.meta.locale).endsWith(Vp(n))}TJ(n$,o$,{name:EH,inputsCount:1,showOperators:!0});const i$="contains";function r$(t,e){let[n]=e;return Vp(t.value).toLocaleLowerCase(t.meta.locale).indexOf(Vp(n))>=0}TJ(i$,r$,{name:RH,inputsCount:1,showOperators:!0});const s$="not_contains";function a$(t,e){return!RJ(i$,e)(t)}TJ(s$,a$,{name:MH,inputsCount:1,showOperators:!0});const l$="date_tomorrow";function h$(t){const e=gh(t.value,t.meta.dateFormat);return!!e.isValid()&&e.isSame(gh().subtract(-1,"days").startOf("day"),"d")}TJ(l$,h$,{name:BH,inputsCount:0});const c$="date_today";function u$(t){const e=gh(t.value,t.meta.dateFormat);return!!e.isValid()&&e.isSame(gh().startOf("day"),"d")}TJ(c$,u$,{name:_H,inputsCount:0});const d$="date_yesterday";function g$(t){const e=gh(t.value,t.meta.dateFormat);return!!e.isValid()&&e.isSame(gh().subtract(1,"days").startOf("day"),"d")}function f$(t,e){let n=t;return""===n&&(n=`(${e})`),n}TJ(d$,g$,{name:LH,inputsCount:0}),fy();const m$=new Set([1]).has(1),p$=m$&&"function"==typeof Array.from;function w$(t){let e=t;return m$&&(e=new Set(e)),function(t){let n;return n=m$?e.has(t):!!~e.indexOf(t),n}}function A$(t){return null==t?"":t}function v$(t){let e=t;return e=p$?Array.from(new Set(e)):Hp(e),e=e.sort(((t,e)=>"number"==typeof t&&"number"==typeof e?t-e:t===e?0:t>e?1:-1)),e}function y$(t,e,n,o){const i=[],r=t===e;let s;return r||(s=w$(e)),Mp(t,(t=>{let e=!1;(r||s(t))&&(e=!0);const a={checked:e,value:t,visualValue:f$(t,n)};o&&o(a),i.push(a)})),i}const C$="by_value";function b$(t,e){let[n]=e;return n(t.value)}TJ(C$,b$,{name:"By value",inputsCount:0,inputValuesDecorator(t){let[e]=t;return[w$(e)]},showOperators:!1});const S$={};function E$(t){if(!S$[t])throw Error(`Operation with id "${t}" does not exist.`);const e=S$[t].func;return function(t,n){return e(t,n)}}function R$(t){return S$[t].name}function M$(t,e,n){S$[t]={name:e,func:n}}const T$="conjunction",k$=FH;function x$(t,e){return t.every((t=>t.func(e)))}M$(T$,k$,x$);const I$="disjunction",O$=jH;function H$(t,e){return t.some((t=>t.func(e)))}M$(I$,O$,H$);const D$="disjunctionWithExtraCondition",N$=jH;function P$(t,e){if(t.length<3)throw Error("Operation doesn't work on less then three conditions.");return t.slice(0,t.length-1).some((t=>t.func(e)))&&t[t.length-1].func(e)}M$(D$,N$,P$);const _$="numeric",B$="text",L$="date",V$={[_$]:[kJ,cG,IJ,HJ,cG,NJ,_J,cG,LJ,WJ,jJ,YJ,qJ,JJ],[B$]:[kJ,cG,IJ,HJ,cG,NJ,_J,cG,t$,n$,cG,i$,s$],[L$]:[kJ,cG,IJ,HJ,cG,NJ,_J,cG,KJ,GJ,qJ,cG,l$,c$,d$]};function W$(t){const e=[];let n=t;return V$[n]||(n=B$),Mp(V$[n],(t=>{let n;n=t===cG?{name:cG}:Zv(MJ(t)),e.push(n)})),e}function F$(t,e,n){return e=j$(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function j$(t){var e=U$(t,"string");return"symbol"==typeof e?e:String(e)}function U$(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}const Y$="built",z$="building",G$=["click","input","keydown","keypress","keyup","focus","blur","change"];let Q$=class t{static get DEFAULTS(){return Zv({className:"",value:"",tagName:"div",children:[],wrapIt:!0})}constructor(e,n){F$(this,"hot",void 0),F$(this,"eventManager",new MC(this)),F$(this,"options",void 0),F$(this,"_element",void 0),F$(this,"buildState",void 0),this.hot=e,this.options=Kv(t.DEFAULTS,n),this._element=this.hot.rootDocument.createElement(this.options.wrapIt?"div":this.options.tagName)}setValue(t){this.options.value=t,this.update()}getValue(){return this.options.value}get element(){return this.buildState===z$?this._element:this.buildState===Y$?(this.update(),this._element):(this.buildState=z$,this.build(),this.buildState=Y$,this._element)}isBuilt(){return this.buildState===Y$}translateIfPossible(t){return"string"==typeof t&&t.startsWith(pH)?this.hot.getTranslatedPhrase(t):t}build(){const t=(t,e)=>{this.eventManager.addEventListener(t,e,(t=>this.runLocalHooks(e,t,this)))};if(this.buildState||(this.buildState=z$),this._element.setAttribute("data-hot-input",!0),void 0!==this.options.tabIndex&&this._element.setAttribute("tabindex",this.options.tabIndex),void 0!==this.options.role&&this._element.setAttribute("role",this.options.role),this.options.className&&cA(this._element,this.options.className),this.options.children.length)Mp(this.options.children,(t=>this._element.appendChild(t.element)));else if(this.options.wrapIt){const e=this.hot.rootDocument.createElement(this.options.tagName);e.setAttribute("data-hot-input",!0),ny(this.options,((t,n)=>{void 0!==e[n]&&"className"!==n&&"tagName"!==n&&"children"!==n&&(e[n]=this.translateIfPossible(t))})),this._element.appendChild(e),Mp(G$,(n=>t(e,n)))}else Mp(G$,(e=>t(this._element,e)))}update(){}reset(){this.options.value="",this.update()}show(){this.element.style.display=""}hide(){this.element.style.display="none"}focus(){}destroy(){this.eventManager.destroy(),this.eventManager=null,this.hot=null,this._element.parentNode&&this._element.parentNode.removeChild(this._element),this._element=null}};function K$(t,e){q$(t,e),e.add(t)}function X$(t,e,n){q$(t,e),e.set(t,n)}function q$(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Z$(t,e){var n=t0(t,e,"get");return J$(t,n)}function J$(t,e){return e.get?e.get.call(t):e.value}function $$(t,e,n){var o=t0(t,e,"set");return e0(t,o,n),n}function t0(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function e0(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function n0(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}Jv(Q$,YT);var o0=new WeakMap,i0=new WeakSet;class r0 extends Q${static get DEFAULTS(){return Zv({placeholder:"",type:"text",tagName:"input",tabIndex:-1})}constructor(t,e){super(t,Kv(r0.DEFAULTS,e)),K$(this,i0),X$(this,o0,{writable:!0,value:void 0}),this.registerHooks()}registerHooks(){this.addLocalHook("keyup",(t=>n0(this,i0,s0).call(this,t)))}build(){super.build();const t=this.hot.rootDocument.createElement("div");$$(this,o0,this._element.firstChild),cA(this._element,"htUIInput"),cA(t,"htUIInputIcon"),this._element.appendChild(t),this.update()}update(){this.isBuilt()&&(Z$(this,o0).type=this.options.type,Z$(this,o0).placeholder=this.translateIfPossible(this.options.placeholder),Z$(this,o0).value=this.translateIfPossible(this.options.value))}focus(){this.isBuilt()&&Z$(this,o0).focus()}}function s0(t){this.options.value=t.target.value}function a0(t,e){h0(t,e),e.add(t)}function l0(t,e,n){h0(t,e),e.set(t,n)}function h0(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function c0(t,e,n){var o=f0(t,e,"set");return u0(t,o,n),n}function u0(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function d0(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function g0(t,e){var n=f0(t,e,"get");return m0(t,n)}function f0(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function m0(t,e){return e.get?e.get.call(t):e.value}var p0=new WeakMap,w0=new WeakMap,A0=new WeakMap,v0=new WeakMap,y0=new WeakMap,C0=new WeakSet,b0=new WeakSet,S0=new WeakSet;class E0 extends Q${static get DEFAULTS(){return Zv({className:"htUISelect",wrapIt:!1,tabIndex:-1})}constructor(t,e){super(t,Kv(E0.DEFAULTS,e)),a0(this,S0),a0(this,b0),a0(this,C0),l0(this,p0,{writable:!0,value:null}),l0(this,w0,{writable:!0,value:[]}),l0(this,A0,{writable:!0,value:void 0}),l0(this,v0,{writable:!0,value:void 0}),l0(this,y0,{writable:!0,value:void 0}),this.registerHooks()}getMenu(){return g0(this,p0)}registerHooks(){this.addLocalHook("click",(()=>d0(this,S0,T0).call(this)))}setItems(t){c0(this,w0,this.translateNames(t)),g0(this,p0)&&g0(this,p0).setMenuItems(g0(this,w0))}translateNames(t){return Mp(t,(t=>{t.name=this.translateIfPossible(t.name)})),t}build(){super.build(),c0(this,p0,new eX(this.hot,{className:"htSelectUI htFiltersConditionsMenu",keepInViewport:!1,standalone:!0,container:this.options.menuContainer})),g0(this,p0).setMenuItems(g0(this,w0));const t=new Q$(this.hot,{className:"htUISelectCaption"}),e=new Q$(this.hot,{className:"htUISelectDropdown"});c0(this,A0,t),c0(this,v0,t.element),c0(this,y0,e),this.hot.getSettings().ariaTags&&(dA(e.element,[Iw()]),dA(this._element,[Sw()])),Mp([t,e],(t=>this._element.appendChild(t.element))),g0(this,p0).addLocalHook("select",(t=>d0(this,C0,R0).call(this,t))),g0(this,p0).addLocalHook("afterClose",(()=>d0(this,b0,M0).call(this))),this.update()}update(){if(!this.isBuilt())return;let t;t=this.options.value?this.options.value.name:g0(this,p0).hot.getTranslatedPhrase(AH),g0(this,v0).textContent=t,super.update()}openOptions(){const t=this.element.getBoundingClientRect();g0(this,p0)&&(g0(this,p0).open(),g0(this,p0).setPosition({left:this.hot.isLtr()?t.left-5:t.left-31,top:t.top-1,width:t.width,height:t.height}),g0(this,p0).getNavigator().toFirstItem(),g0(this,p0).getKeyboardShortcutsCtrl().addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],callback:t=>{this.closeOptions(),this.runLocalHooks("tabKeydown",t)}},{keys:[["Control/Meta","A"]],callback:()=>!1}]))}closeOptions(){g0(this,p0)&&g0(this,p0).close()}focus(){this.isBuilt()&&this.element.focus()}destroy(){g0(this,p0)&&(g0(this,p0).destroy(),c0(this,p0,null)),g0(this,A0)&&g0(this,A0).destroy(),g0(this,y0)&&g0(this,y0).destroy(),super.destroy()}}function R0(t){t.name!==cG&&(this.options.value=t,this.update(),this.runLocalHooks("select",this.options.value))}function M0(){this.runLocalHooks("afterClose")}function T0(){this.openOptions()}function k0(t,e){x0(t,e),e.add(t)}function x0(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function I0(t,e,n){return e=O0(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function O0(t){var e=H0(t,"string");return"symbol"==typeof e?e:String(e)}function H0(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function D0(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}var N0=new WeakSet,P0=new WeakSet;class _0 extends SJ{constructor(t,e){super(t,{id:e.id,stateless:!1}),k0(this,P0),k0(this,N0),I0(this,"name",""),I0(this,"addSeparator",!1),this.name=e.name,this.addSeparator=e.addSeparator,this.elements.push(new E0(this.hot,{menuContainer:e.menuContainer})),this.elements.push(new r0(this.hot,{placeholder:XH})),this.elements.push(new r0(this.hot,{placeholder:qH})),this.registerHooks()}registerHooks(){this.getSelectElement().addLocalHook("select",(t=>D0(this,N0,B0).call(this,t))).addLocalHook("afterClose",(()=>this.runLocalHooks("afterClose"))).addLocalHook("tabKeydown",(t=>this.runLocalHooks("selectTabKeydown",t))),Mp(this.getInputElements(),(t=>{t.addLocalHook("keydown",(t=>D0(this,P0,L0).call(this,t)))}))}setState(t){if(this.reset(),!t)return;const e=Zv(t.command);e.name.startsWith(wH)&&(e.name=this.hot.getTranslatedPhrase(e.name)),this.getSelectElement().setValue(e),Mp(t.args,((t,n)=>{if(n>e.inputsCount-1)return!1;const o=this.getInputElement(n);o.setValue(t),o[e.inputsCount>n?"show":"hide"](),n||this.hot._registerTimeout((()=>o.focus()),10)}))}getState(){const t=this.getSelectElement().getValue()||MJ(kJ),e=[];return Mp(this.getInputElements(),((n,o)=>{t.inputsCount>o&&e.push(n.getValue())})),{command:t,args:e}}updateState(t,e){const n=MJ(t?t.name:kJ);this.state.setValueAtIndex(e,{command:n,args:t?t.args:[]}),t||Mp(this.getInputElements(),(t=>t.setValue(null)))}getSelectElement(){return this.elements.filter((t=>t instanceof E0))[0]}getInputElement(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return this.getInputElements()[t]}getInputElements(){return this.elements.filter((t=>t instanceof r0))}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(t,e,n,o,i,r)=>{cA(e.parentNode,"htFiltersMenuCondition"),this.addSeparator&&cA(e.parentNode,"border");const s=this.hot.rootDocument.createElement("div");return cA(s,"htFiltersMenuLabel"),s.textContent=r,e.appendChild(s),Mp(this.elements,(t=>e.appendChild(t.element))),e}}}reset(){const t=this.hot.getPlugin("filters").getSelectedColumn();let e=[MJ(kJ)];if(null!==t){const{visualIndex:n}=t;e=W$(this.hot.getDataType(0,n,this.hot.countRows(),n))}Mp(this.getInputElements(),(t=>t.hide())),this.getSelectElement().setItems(e),super.reset(),this.getSelectElement().setValue(e[0])}}function B0(t){Mp(this.getInputElements(),((e,n)=>{e[t.inputsCount>n?"show":"hide"](),0===n&&this.hot._registerTimeout((()=>e.focus()),10)})),this.runLocalHooks("change",t)}function L0(t){Fy(t.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),Uy(t))}function V0(t,e,n){W0(t,e),e.set(t,n)}function W0(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function F0(t,e){var n=Y0(t,e,"get");return j0(t,n)}function j0(t,e){return e.get?e.get.call(t):e.value}function U0(t,e,n){var o=Y0(t,e,"set");return z0(t,o,n),n}function Y0(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function z0(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var G0=new WeakMap,Q0=new WeakMap;class K0 extends Q${static get DEFAULTS(){return Zv({type:"radio",tagName:"input",className:"htUIRadio",label:{}})}constructor(t,e){super(t,Kv(K0.DEFAULTS,e)),V0(this,G0,{writable:!0,value:void 0}),V0(this,Q0,{writable:!0,value:void 0})}build(){super.build();const t=this.hot.rootDocument.createElement("label");t.textContent=this.translateIfPossible(this.options.label.textContent),t.htmlFor=this.translateIfPossible(this.options.label.htmlFor),U0(this,Q0,t),U0(this,G0,this._element.firstChild),F0(this,G0).checked=this.options.checked,this._element.appendChild(t),this.update()}update(){this.isBuilt()&&(F0(this,Q0).textContent=this.translateIfPossible(this.options.label.textContent))}isChecked(){return!!this.isBuilt()&&F0(this,G0).checked}setChecked(){let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.isBuilt()&&(F0(this,G0).checked=t)}focus(){this.isBuilt()&&F0(this,G0).focus()}}function X0(t,e){q0(t,e),e.add(t)}function q0(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Z0(t,e,n){return e=J0(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function J0(t){var e=$0(t,"string");return"symbol"==typeof e?e:String(e)}function $0(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function t1(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const e1=0;var n1=new WeakSet;class o1 extends SJ{constructor(t,e){super(t,{id:e.id,stateless:!1}),X0(this,n1),Z0(this,"name",""),this.name=e.name,this.buildOperatorsElement()}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(t,e)=>(cA(e.parentNode,"htFiltersMenuOperators"),Mp(this.elements,(t=>e.appendChild(t.element))),e)}}buildOperatorsElement(){const t=[T$,I$];Mp(t,(e=>{const n=new K0(this.hot,{name:"operator",label:{htmlFor:e,textContent:R$(e)},value:e,checked:e===t[e1],id:e});n.addLocalHook("change",(t=>t1(this,n1,i1).call(this,t))),this.elements.push(n)}))}setChecked(t){if(this.elements.length<t)throw Error(Lp`Radio button with index ${t} doesn't exist.`);Mp(this.elements,((e,n)=>{e.setChecked(n===t)}))}getActiveOperationId(){const t=this.elements.find((t=>t instanceof K0&&t.isChecked()));return t?t.getValue():T$}getState(){return this.getActiveOperationId()}setState(t){this.reset(),t&&this.getActiveOperationId()!==t&&Mp(this.elements,(e=>{e.setChecked(e.getValue()===t)}))}updateState(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:T$,e=arguments.length>1?arguments[1]:void 0,n=t;n===D$&&(n=I$),this.state.setValueAtIndex(e,n)}reset(){this.setChecked(e1)}}function i1(t){this.setState(t.target.value)}function r1(t,e,n){s1(t,e),e.set(t,n)}function s1(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function a1(t,e){var n=c1(t,e,"get");return l1(t,n)}function l1(t,e){return e.get?e.get.call(t):e.value}function h1(t,e,n){var o=c1(t,e,"set");return u1(t,o,n),n}function c1(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function u1(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var d1=new WeakMap;class g1 extends Q${static get DEFAULTS(){return Zv({href:"#",tagName:"a",tabIndex:-1,role:"button"})}constructor(t,e){super(t,Kv(g1.DEFAULTS,e)),r1(this,d1,{writable:!0,value:void 0})}build(){super.build(),h1(this,d1,this._element.firstChild)}update(){this.isBuilt()&&(a1(this,d1).textContent=this.translateIfPossible(this.options.textContent))}focus(){this.isBuilt()&&a1(this,d1).focus()}activate(){a1(this,d1).click()}}function f1(t,e){p1(t,e),e.add(t)}function m1(t,e,n){p1(t,e),e.set(t,n)}function p1(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function w1(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function A1(t,e){var n=C1(t,e,"get");return v1(t,n)}function v1(t,e){return e.get?e.get.call(t):e.value}function y1(t,e,n){var o=C1(t,e,"set");return b1(t,o,n),n}function C1(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function b1(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}const S1="multipleSelect.itemBox";var E1=new WeakMap,R1=new WeakMap,M1=new WeakMap,T1=new WeakMap,k1=new WeakMap,x1=new WeakMap,I1=new WeakSet,O1=new WeakSet,H1=new WeakSet,D1=new WeakSet;class N1 extends Q${static get DEFAULTS(){return Zv({className:"htUIMultipleSelect",value:[]})}constructor(t,e){super(t,Kv(N1.DEFAULTS,e)),f1(this,D1),f1(this,H1),f1(this,O1),f1(this,I1),m1(this,E1,{writable:!0,value:[]}),m1(this,R1,{writable:!0,value:void 0}),m1(this,M1,{writable:!0,value:void 0}),m1(this,T1,{writable:!0,value:void 0}),m1(this,k1,{writable:!0,value:void 0}),m1(this,x1,{writable:!0,value:void 0}),y1(this,T1,new r0(this.hot,{placeholder:KH,className:"htUIMultipleSelectSearch"})),y1(this,k1,new g1(this.hot,{textContent:YH,className:"htUISelectAll"})),y1(this,x1,new g1(this.hot,{textContent:zH,className:"htUIClearAll"})),this.registerHooks()}getItemsBox(){return A1(this,R1)}registerHooks(){A1(this,T1).addLocalHook("keydown",(t=>w1(this,O1,_1).call(this,t))),A1(this,T1).addLocalHook("input",(t=>w1(this,I1,P1).call(this,t))),A1(this,k1).addLocalHook("click",(t=>w1(this,H1,B1).call(this,t))),A1(this,x1).addLocalHook("click",(t=>w1(this,D1,L1).call(this,t)))}setItems(t){y1(this,E1,t),A1(this,R1)&&A1(this,R1).loadData(A1(this,E1))}setLocale(t){y1(this,M1,t)}getLocale(){return A1(this,M1)}getItems(){return[...A1(this,E1)]}getValue(){return W1(A1(this,E1))}getSearchInputElement(){return A1(this,T1)}getSelectAllElement(){return A1(this,k1)}getClearAllElement(){return A1(this,x1)}isSelectedAllValues(){return A1(this,E1).length===this.getValue().length}build(){super.build();const{rootDocument:t}=this.hot,e=t.createElement("div"),n=new Q$(this.hot,{className:"htUISelectionControls",children:[A1(this,k1),A1(this,x1)]});this._element.appendChild(A1(this,T1).element),this._element.appendChild(n.element),this._element.appendChild(e);const o=e=>{if(!this._element)return;A1(this,R1)&&A1(this,R1).destroy(),cA(e,"htUIMultipleSelectHot"),y1(this,R1,new this.hot.constructor(e,{data:A1(this,E1),columns:[{data:"checked",type:"checkbox",label:{property:"visualValue",position:"after"}}],beforeRenderer:(t,e,n,o,i,r)=>{t.title=r.instance.getDataAtRowProp(e,r.label.property)},afterListen:()=>{this.runLocalHooks("focus",this)},beforeOnCellMouseUp:()=>{A1(this,R1).listen()},maxCols:1,autoWrapCol:!0,height:110,colWidths:()=>A1(this,R1).container.scrollWidth-UA(t),copyPaste:!1,disableVisualSelection:"area",fillHandle:!1,fragmentSelection:"cell",tabMoves:{row:1,col:0},layoutDirection:this.hot.isRtl()?"rtl":"ltr"})),A1(this,R1).init();const n=A1(this,R1).getShortcutManager().getContext("grid");n.removeShortcutsByKeys(["Tab"]),n.removeShortcutsByKeys(["Shift","Tab"]),n.addShortcut({keys:[["Escape"]],callback:t=>{this.runLocalHooks("keydown",t,this)},group:S1}),n.addShortcut({keys:[["Tab"],["Shift","Tab"]],callback:t=>{A1(this,R1).deselectCell(),this.runLocalHooks("keydown",t,this),this.runLocalHooks("listTabKeydown",t,this)},group:S1})};o(e),this.hot._registerTimeout((()=>o(e)),100)}focus(){this.isBuilt()&&A1(this,R1).listen()}reset(){A1(this,T1).reset(),A1(this,k1).reset(),A1(this,x1).reset()}update(){this.isBuilt()&&(A1(this,R1).loadData(V1(A1(this,E1),this.options.value)),super.update())}destroy(){A1(this,R1)&&A1(this,R1).destroy(),A1(this,T1).destroy(),A1(this,x1).destroy(),A1(this,k1).destroy(),y1(this,T1,null),y1(this,x1,null),y1(this,k1,null),y1(this,R1,null),y1(this,E1,null),super.destroy()}}function P1(t){const e=t.target.value.toLocaleLowerCase(this.getLocale());let n;n=""===e?[...A1(this,E1)]:Ep(A1(this,E1),(t=>`${t.value}`.toLocaleLowerCase(this.getLocale()).indexOf(e)>=0)),A1(this,R1).loadData(n)}function _1(t){this.runLocalHooks("keydown",t,this),hv(Fy,t.keyCode)("ARROW_DOWN")&&(t.preventDefault(),Uy(t),A1(this,R1).listen(),A1(this,R1).selectCell(0,0))}function B1(t){const e=[];t.preventDefault(),Mp(A1(this,R1).getSourceData(),((t,n)=>{t.checked=!0,e.push(eI(t,n)[0])})),A1(this,R1).setSourceDataAtCell(e)}function L1(t){const e=[];t.preventDefault(),Mp(A1(this,R1).getSourceData(),((t,n)=>{t.checked=!1,e.push(eI(t,n)[0])})),A1(this,R1).setSourceDataAtCell(e)}function V1(t,e){const n=w$(e);return Rp(t,(t=>(t.checked=n(t.value),t)))}function W1(t){const e=[];return Mp(t,(t=>{t.checked&&e.push(t.value)})),e}function F1(t,e){j1(t,e),e.add(t)}function j1(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function U1(t,e,n){return e=Y1(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Y1(t){var e=z1(t,"string");return"symbol"==typeof e?e:String(e)}function z1(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function G1(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}var Q1,K1=new WeakSet;class X1 extends SJ{constructor(t,e){super(t,{id:e.id,stateless:!1}),F1(this,K1),U1(this,"name",""),this.name=e.name,this.elements.push(new N1(this.hot)),this.registerHooks()}registerHooks(){this.getMultipleSelectElement().addLocalHook("keydown",(t=>G1(this,K1,q1).call(this,t))).addLocalHook("listTabKeydown",(t=>this.runLocalHooks("listTabKeydown",t)))}getElements(){const t=this.getMultipleSelectElement();return[t.getSearchInputElement(),t.getSelectAllElement(),t.getClearAllElement(),this.getMultipleSelectElement()]}setState(t){if(this.reset(),t&&t.command.key===C$){const e=this.getMultipleSelectElement();e.setItems(t.itemsSnapshot),e.setValue(t.args[0]),e.setLocale(t.locale)}}getState(){const t=this.getMultipleSelectElement(),e=t.getItems();return{command:{key:t.isSelectedAllValues()||!e.length?kJ:C$},args:[t.getValue()],itemsSnapshot:e}}updateState(t){const e=(e,n,o,i,r)=>{const[s]=Ep(n,(t=>t.name===C$)),a={},l=this.hot.getTranslatedPhrase(UH);if(s){const n=v$(Rp(i(e,r),(t=>t.value)));o&&(s.args[0]=o);const h=[],c=y$(n,s.args[0],l,(t=>{t.checked&&h.push(t.value)})),u=t.editedConditionStack.column;a.locale=this.hot.getCellMeta(0,u).locale,a.args=[h],a.command=MJ(C$),a.itemsSnapshot=c}else a.args=[],a.command=MJ(kJ);this.state.setValueAtIndex(e,a)};e(t.editedConditionStack.column,t.editedConditionStack.conditions,t.conditionArgsChange,t.filteredRowsFactory),t.dependentConditionStacks.length&&e(t.dependentConditionStacks[0].column,t.dependentConditionStacks[0].conditions,t.conditionArgsChange,t.filteredRowsFactory,t.editedConditionStack)}getMultipleSelectElement(){return this.elements.filter((t=>t instanceof N1))[0]}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(t,e,n,o,i,r)=>{cA(e.parentNode,"htFiltersMenuValue");const s=this.hot.rootDocument.createElement("div");return cA(s,"htFiltersMenuLabel"),s.textContent=r,e.appendChild(s),Mp(this.elements,(t=>e.appendChild(t.element))),e}}}reset(){const t=this.hot.getTranslatedPhrase(UH),e=v$(this._getColumnVisibleValues()),n=y$(e,e,t);this.getMultipleSelectElement().setItems(n),super.reset(),this.getMultipleSelectElement().setValue(e);const o=this.hot.getPlugin("filters").getSelectedColumn();null!==o&&this.getMultipleSelectElement().setLocale(this.hot.getCellMeta(0,o.visualIndex).locale)}_getColumnVisibleValues(){const t=this.hot.getPlugin("filters").getSelectedColumn();return null===t?[]:Rp(this.hot.getDataAtCol(t.visualIndex),(t=>A$(t)))}}function q1(t){Fy(t.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),Uy(t))}function Z1(t,e){J1(t,e),e.add(t)}function J1(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function $1(t,e,n){return e=t2(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function t2(t){var e=e2(t,"string");return"symbol"==typeof e?e:String(e)}function e2(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function n2(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}var o2=new WeakSet;class i2 extends SJ{static get BUTTON_OK(){return"ok"}static get BUTTON_CANCEL(){return"cancel"}constructor(t,e){super(t,{id:e.id,stateless:!0}),Z1(this,o2),$1(this,"name",""),this.name=e.name,this.elements.push(new r0(this.hot,{type:"button",value:GH,className:"htUIButton htUIButtonOK",identifier:i2.BUTTON_OK})),this.elements.push(new r0(this.hot,{type:"button",value:QH,className:"htUIButton htUIButtonCancel",identifier:i2.BUTTON_CANCEL})),this.registerHooks()}registerHooks(){Mp(this.elements,(t=>{t.addLocalHook("click",((t,e)=>n2(this,o2,r2).call(this,t,e)))}))}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(t,e)=>(cA(e.parentNode,"htFiltersMenuActionBar"),Mp(this.elements,(t=>e.appendChild(t.element))),e)}}accept(){this.runLocalHooks("accept")}cancel(){this.runLocalHooks("cancel")}}function r2(t,e){e.options.identifier===Q1.BUTTON_OK?this.accept():this.cancel()}function s2(t,e,n){return e=a2(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function a2(t){var e=l2(t,"string");return"symbol"==typeof e?e:String(e)}function l2(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}Q1=i2;const h2="ConditionCollection.filteringStates";class c2{constructor(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];s2(this,"hot",void 0),s2(this,"isMapRegistrable",void 0),s2(this,"filteringStates",new MI),this.hot=t,this.isMapRegistrable=e,!0===this.isMapRegistrable?this.hot.columnIndexMapper.registerMap(h2,this.filteringStates):this.filteringStates.init(this.hot.columnIndexMapper.getNumberOfIndexes())}isEmpty(){return 0===this.getFilteredColumns().length}isMatch(t,e){var n;const o=this.filteringStates.getValueAtIndex(e),i=null!==(n=null==o?void 0:o.conditions)&&void 0!==n?n:[],r=null==o?void 0:o.operation;return this.isMatchInConditions(i,t,r)}isMatchInConditions(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:T$;return!t.length||E$(n)(t,e)}addCondition(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:T$,o=arguments.length>3?arguments[3]:void 0;const i=this.hot.getCellMeta(0,t).locale,r=Rp(e.args,(t=>"string"==typeof t?t.toLocaleLowerCase(i):t)),s=e.name||e.command.key;this.runLocalHooks("beforeAdd",t);const a=this.getOperation(t);if(a){if(a!==n)throw Error(Lp`The column of index ${t} has been already applied with a \`${a}\`\x20
        filter operation. Use \`removeConditions\` to clear the current conditions and then add new ones.\x20
        Mind that you cannot mix different types of operations (for instance, if you use \`conjunction\`,\x20
        use it consequently for a particular column).`)}else if(Fp(S$[n]))throw new Error(Lp`Unexpected operation named \`${n}\`. Possible ones are\x20
        \`disjunction\` and \`conjunction\`.`);const l=this.getConditions(t);0===l.length?this.filteringStates.setValueAtIndex(t,{operation:n,conditions:[{name:s,args:r,func:RJ(s,r)}]},o):l.push({name:s,args:r,func:RJ(s,r)}),this.runLocalHooks("afterAdd",t)}getConditions(t){var e,n;return null!==(e=null===(n=this.filteringStates.getValueAtIndex(t))||void 0===n?void 0:n.conditions)&&void 0!==e?e:[]}getOperation(t){var e;return null===(e=this.filteringStates.getValueAtIndex(t))||void 0===e?void 0:e.operation}getFilteredColumns(){return this.filteringStates.getEntries().map((t=>{let[e]=t;return e}))}getColumnStackPosition(t){return this.getFilteredColumns().indexOf(t)}exportAllConditions(){return Sp(this.filteringStates.getEntries(),((t,e)=>{let[n,{operation:o,conditions:i}]=e;return t.push({column:n,operation:o,conditions:Rp(i,(t=>{let{name:e,args:n}=t;return{name:e,args:n}}))}),t}),[])}importAllConditions(t){this.clean(),Mp(t,(t=>{Mp(t.conditions,(e=>this.addCondition(t.column,e)))}))}removeConditions(t){this.runLocalHooks("beforeRemove",t),this.filteringStates.clearValue(t),this.runLocalHooks("afterRemove",t)}clean(){this.runLocalHooks("beforeClean"),this.filteringStates.clear(),this.runLocalHooks("afterClean")}hasConditions(t,e){const n=this.getConditions(t);return e?n.some((t=>t.name===e)):n.length>0}destroy(){this.isMapRegistrable&&this.hot.columnIndexMapper.unregisterMap(h2),this.filteringStates=null,this.clearLocalHooks()}}Jv(c2,YT);const u2=c2;function d2(t,e,n){return e=g2(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function g2(t){var e=f2(t,"string");return"symbol"==typeof e?e:String(e)}function f2(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class m2{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:()=>[];d2(this,"conditionCollection",void 0),d2(this,"columnDataFactory",void 0),this.conditionCollection=t,this.columnDataFactory=e}filter(){let t=[];return Mp(this.conditionCollection.getFilteredColumns(),((e,n)=>{let o=this.columnDataFactory(e);n&&(o=this._getIntersectData(o,t)),t=this.filterByColumn(e,o)})),t}filterByColumn(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];const n=[];return Mp(e,(e=>{void 0!==e&&this.conditionCollection.isMatch(e,t)&&n.push(e)})),n}_getIntersectData(t,e){const n=[];return Mp(e,(e=>{const o=e.meta.visualRow;void 0!==t[o]&&(n[o]=t[o])})),n}}const p2=m2;function w2(t,e){A2(t,e),e.add(t)}function A2(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function v2(t,e,n){return e=y2(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function y2(t){var e=C2(t,"string");return"symbol"==typeof e?e:String(e)}function C2(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function b2(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}var S2=new WeakSet,E2=new WeakSet,R2=new WeakSet;class M2{constructor(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:()=>[];w2(this,R2),w2(this,E2),w2(this,S2),v2(this,"hot",void 0),v2(this,"conditionCollection",void 0),v2(this,"columnDataFactory",void 0),v2(this,"changes",[]),v2(this,"grouping",!1),v2(this,"latestEditedColumnPosition",-1),v2(this,"latestOrderStack",[]),this.hot=t,this.conditionCollection=e,this.columnDataFactory=n,this.conditionCollection.addLocalHook("beforeRemove",(t=>b2(this,S2,T2).call(this,t))),this.conditionCollection.addLocalHook("afterRemove",(t=>this.updateStatesAtColumn(t))),this.conditionCollection.addLocalHook("afterAdd",(t=>this.updateStatesAtColumn(t))),this.conditionCollection.addLocalHook("beforeClean",(()=>b2(this,E2,k2).call(this))),this.conditionCollection.addLocalHook("afterClean",(()=>b2(this,R2,x2).call(this)))}groupChanges(){this.grouping=!0}flush(){this.grouping=!1,Mp(this.changes,(t=>{this.updateStatesAtColumn(t)})),this.changes.length=0}updateStatesAtColumn(t,e){var n=this;if(this.grouping)return void(-1===this.changes.indexOf(t)&&this.changes.push(t));const o=this.conditionCollection.exportAllConditions();let i=this.conditionCollection.getColumnStackPosition(t);-1===i&&(i=this.latestEditedColumnPosition);const r=o.slice(0,i),s=o.slice(i);s.length&&s[0].column===t&&s.shift();const a=cv((function(t,e){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];const i=new u2(n.hot,!1),r=[].concat(t,o);i.importAllConditions(r);const s=n.columnDataFactory(e);let a;a=i.isEmpty()?s:new p2(i,(t=>n.columnDataFactory(t))).filter(),a=Rp(a,(t=>t.meta.visualRow));const l=w$(a);return i.destroy(),Ep(s,(t=>l(t.meta.visualRow)))}))(r),l=[].concat(this.conditionCollection.getConditions(t));this.runLocalHooks("update",{editedConditionStack:{column:t,conditions:l},dependentConditionStacks:s,filteredRowsFactory:a,conditionArgsChange:e})}destroy(){this.clearLocalHooks(),ny(this,((t,e)=>{this[e]=null}))}}function T2(t){this.latestEditedColumnPosition=this.conditionCollection.getColumnStackPosition(t)}function k2(){this.latestOrderStack=this.conditionCollection.getFilteredColumns()}function x2(){Mp(this.latestOrderStack,(t=>{this.updateStatesAtColumn(t)}))}Jv(M2,YT);const I2=M2;function O2(t){return CK({initialPage:0,size:()=>t.length,onItemSelect:(e,n)=>{const o=t[e];return o instanceof N1?n:!(o.element&&!vA(o.element))&&void o.focus()}})}const H2="filters";function D2(t,e){let n=-1;const o=O2(e),i=n=>()=>{t.isOpened()&&t.getKeyboardShortcutsCtrl().listen(H2),o.setCurrentPage(e.indexOf(n))};function r(i){const r=t.getKeyboardShortcutsCtrl(),s=i.getKeyboardShortcutsCtrl();o.clear(),s.addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],forwardToContext:r.getContext(H2),callback:()=>{i.isSubMenu()&&i.close(),r.listen(H2)}}]),!i.isSubMenu()&&r.addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],callback:e=>{const i=t.getNavigator();i.getCurrentPage()>-1&&(n=i.getCurrentPage()),i.clear(),e.shiftKey?o.toPreviousItem():o.toNextItem()}},{keys:[["Escape"]],callback:()=>{t.close()}},{keys:[["Enter"],["Space"]],preventDefault:!1,callback:t=>{const n=e[o.getCurrentPage()];n instanceof E0&&(n.openOptions(),t.preventDefault()),n instanceof g1&&(n.activate(),t.preventDefault()),n instanceof Q$||t.preventDefault()}}],H2)}function s(){t.focus(),t.getKeyboardShortcutsCtrl().listen(H2)}function a(){return n}return e.forEach((t=>{t instanceof Q$&&(t.addLocalHook("click",i(t)),t.addLocalHook("focus",i(t)),t.addLocalHook("afterClose",i(t)))})),t.addLocalHook("afterSelectionChange",(t=>{t.key.startsWith("filter_")||o.clear()})),t.addLocalHook("afterSubmenuOpen",r),t.addLocalHook("afterOpen",r),w(p({},o),{listen:s,getLastMenuPage:a})}function N2(t,e){_2(t,e),e.add(t)}function P2(t,e,n){_2(t,e),e.set(t,n)}function _2(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function B2(t,e,n){return e=L2(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function L2(t){var e=V2(t,"string");return"symbol"==typeof e?e:String(e)}function V2(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function W2(t,e,n){var o=U2(t,e,"set");return F2(t,o,n),n}function F2(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function j2(t,e){var n=U2(t,e,"get");return Y2(t,n)}function U2(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function Y2(t,e){return e.get?e.get.call(t):e.value}function z2(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const G2="filters",Q2=250,K2=G2;var X2=new WeakMap,q2=new WeakSet,Z2=new WeakSet,J2=new WeakSet,$2=new WeakSet,t3=new WeakSet,e3=new WeakSet,n3=new WeakSet,o3=new WeakSet,i3=new WeakSet;class r3 extends jF{static get PLUGIN_KEY(){return G2}static get PLUGIN_PRIORITY(){return Q2}static get PLUGIN_DEPS(){return["plugin:DropdownMenu","plugin:HiddenRows","cell-type:checkbox"]}constructor(t){super(t),N2(this,i3),N2(this,o3),N2(this,n3),N2(this,e3),N2(this,t3),N2(this,$2),N2(this,J2),N2(this,Z2),N2(this,q2),B2(this,"dropdownMenuPlugin",null),B2(this,"conditionCollection",null),B2(this,"conditionUpdateObserver",null),B2(this,"components",new Map([["filter_by_condition",null],["filter_operators",null],["filter_by_condition2",null],["filter_by_value",null],["filter_action_bar",null]])),B2(this,"filtersRowsMap",null),P2(this,X2,{writable:!0,value:void 0}),this.hot.addHook("afterGetColHeader",((t,e)=>z2(this,o3,g3).call(this,t,e)))}isEnabled(){return!!this.hot.getSettings()[G2]}enablePlugin(){if(this.enabled)return;this.filtersRowsMap=this.hot.rowIndexMapper.registerMap(this.pluginName,new TI),this.dropdownMenuPlugin=this.hot.getPlugin("dropdownMenu");const t=this.hot.getSettings().dropdownMenu,e=t&&t.uiContainer||this.hot.rootDocument.body,n=t=>(t.addLocalHook("accept",(()=>z2(this,t3,c3).call(this,"accept"))),t.addLocalHook("cancel",(()=>z2(this,t3,c3).call(this,"cancel"))),t.addLocalHook("change",(e=>z2(this,e3,u3).call(this,t,e))),t),o=()=>`${this.hot.getTranslatedPhrase(VH)}:`,i=()=>`${this.hot.getTranslatedPhrase(WH)}:`;if(!this.components.get("filter_by_condition")){const t=new _0(this.hot,{id:"filter_by_condition",name:o,addSeparator:!1,menuContainer:e});t.addLocalHook("afterClose",(()=>z2(this,n3,d3).call(this))),this.components.set("filter_by_condition",n(t))}if(this.components.get("filter_operators")||this.components.set("filter_operators",new o1(this.hot,{id:"filter_operators",name:"Operators"})),!this.components.get("filter_by_condition2")){const t=new _0(this.hot,{id:"filter_by_condition2",name:"",addSeparator:!0,menuContainer:e});t.addLocalHook("afterClose",(()=>z2(this,n3,d3).call(this))),this.components.set("filter_by_condition2",n(t))}if(this.components.get("filter_by_value")||this.components.set("filter_by_value",n(new X1(this.hot,{id:"filter_by_value",name:i}))),this.components.get("filter_action_bar")||this.components.set("filter_action_bar",n(new i2(this.hot,{id:"filter_action_bar",name:"Action bar"}))),this.conditionCollection||(this.conditionCollection=new u2(this.hot)),this.conditionUpdateObserver||(this.conditionUpdateObserver=new I2(this.hot,this.conditionCollection,(t=>this.getDataMapAtColumn(t))),this.conditionUpdateObserver.addLocalHook("update",(t=>z2(this,i3,f3).call(this,t)))),this.components.forEach((t=>t.show())),this.addHook("afterDropdownMenuDefaultOptions",(t=>z2(this,$2,h3).call(this,t))),this.addHook("afterDropdownMenuShow",(()=>z2(this,Z2,a3).call(this))),this.addHook("afterDropdownMenuHide",(()=>z2(this,J2,l3).call(this))),this.addHook("afterChange",(t=>z2(this,q2,s3).call(this,t))),this.hot.getSettings().dropdownMenu&&this.dropdownMenuPlugin&&(this.dropdownMenuPlugin.disablePlugin(),this.dropdownMenuPlugin.enablePlugin()),!j2(this,X2)&&this.dropdownMenuPlugin.enabled){const t=this.dropdownMenuPlugin.menu,e=[{focus:()=>{const e=t.getNavigator(),n=j2(this,X2).getLastMenuPage();t.focus(),n>0?e.setCurrentPage(n):e.toFirstItem()}},...Array.from(this.components).map((t=>{let[,e]=t;return e.getElements()})).flat()];W2(this,X2,D2(t,e));const n=t=>{j2(this,X2).listen(),t.preventDefault(),Fy(t.keyCode,"TAB")&&(t.shiftKey?j2(this,X2).toPreviousItem():j2(this,X2).toNextItem())};this.components.get("filter_by_value").addLocalHook("listTabKeydown",n),this.components.get("filter_by_condition").addLocalHook("selectTabKeydown",n)}this.registerShortcuts(),super.enablePlugin()}disablePlugin(){var t;this.enabled&&(null!==(t=this.dropdownMenuPlugin)&&void 0!==t&&t.enabled&&this.dropdownMenuPlugin.menu.clearLocalHooks(),this.components.forEach(((t,e)=>{t.destroy(),this.components.set(e,null)})),this.conditionCollection.destroy(),this.conditionCollection=null,this.hot.rowIndexMapper.unregisterMap(this.pluginName));this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Alt","A"]],stopPropagation:!0,callback:()=>{const t=this.hot.getSelected();this.clearConditions(),this.filter(),t&&this.hot.selectCells(t)},group:K2})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(K2)}addCondition(t,e,n){let o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:T$;const i=this.hot.toPhysicalColumn(t);this.conditionCollection.addCondition(i,{command:{key:e},args:n},o)}removeConditions(t){const e=this.hot.toPhysicalColumn(t);this.conditionCollection.removeConditions(e)}clearConditions(t){if(void 0===t)this.conditionCollection.clean();else{const e=this.hot.toPhysicalColumn(t);this.conditionCollection.removeConditions(e)}}filter(){const{navigableHeaders:t}=this.hot.getSettings(),e=this._createDataFilter(),n=!this.conditionCollection.isEmpty();let o=[];const i=this.conditionCollection.exportAllConditions();if(!1!==this.hot.runHooks("beforeFilter",i))if(n){const n=[];this.hot.batchExecution((()=>{this.filtersRowsMap.clear(),o=Rp(e.filter(),(t=>t.meta.visualRow));const t=w$(o);Cb(this.hot.countSourceRows()-1,(e=>{t(e)||n.push(e)})),Mp(n,(t=>{this.filtersRowsMap.setValueAtIndex(t,!0)}))}),!0),!t&&!o.length&&this.hot.deselectCell()}else this.filtersRowsMap.clear();this.hot.runHooks("afterFilter",i),this.hot.view.adjustElementsSize(!0),this.hot.render(),this.hot.selection.isSelected()&&this.hot.selectCell(t?-1:0,this.hot.getSelectedRangeLast().highlight.col)}getSelectedColumn(){var t;const e=null===(t=this.hot.getSelectedRangeLast())||void 0===t?void 0:t.highlight;return e?{visualIndex:e.col,physicalIndex:this.hot.toPhysicalColumn(e.col)}:null}getDataMapAtColumn(t){const e=this.hot.toVisualColumn(t),n=[];return Mp(this.hot.getSourceDataAtCol(e),((t,o)=>{var i;const{row:r,col:s,visualCol:a,visualRow:l,type:h,instance:c,dateFormat:u,locale:d}=this.hot.getCellMeta(o,e),g=null!==(i=this.hot.getDataAtCell(this.hot.toVisualRow(o),e))&&void 0!==i?i:t;n.push({meta:{row:r,col:s,visualCol:a,visualRow:l,type:h,instance:c,dateFormat:u,locale:d},value:A$(g)})})),n}updateValueComponentCondition(t){const e=this.hot.getDataAtCol(t),n=v$(e);this.conditionUpdateObserver.updateStatesAtColumn(t,n)}restoreComponents(t){var e;const n=null===(e=this.getSelectedColumn())||void 0===e?void 0:e.physicalIndex;t.forEach((t=>{t.isHidden()||t.restoreState(n)})),this.updateDependentComponentsVisibility()}getOperationBasedOnArguments(t,e,n,o){let i=t;return i===I$&&e.command.key!==kJ&&n.command.key!==kJ&&o.command.key!==kJ?i=D$:o.command.key!==kJ&&(e.command.key===kJ||n.command.key===kJ)&&(i=T$),i}setListeningDropdownMenu(){this.dropdownMenuPlugin&&this.dropdownMenuPlugin.setListening()}updateDependentComponentsVisibility(){const t=this.components.get("filter_by_condition"),{command:e}=t.getState(),n=[this.components.get("filter_by_condition2"),this.components.get("filter_operators")];e.showOperators?this.showComponents(...n):this.hideComponents(...n)}_createDataFilter(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.conditionCollection;return new p2(t,(t=>this.getDataMapAtColumn(t)))}getIndexesOfComponents(){const t=[];if(!this.dropdownMenuPlugin)return t;const e=this.dropdownMenuPlugin.menu;for(var n=arguments.length,o=new Array(n),i=0;i<n;i++)o[i]=arguments[i];return Mp(o,(n=>{Mp(e.menuItems,((e,o)=>{e.key===n.getMenuItemDescriptor().key&&t.push(o)}))})),t}changeComponentsVisibility(){let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(!this.dropdownMenuPlugin)return;const e=this.dropdownMenuPlugin.menu.hotMenu,n=e.getPlugin("hiddenRows");for(var o=arguments.length,i=new Array(o>1?o-1:0),r=1;r<o;r++)i[r-1]=arguments[r];const s=this.getIndexesOfComponents(...i);t?n.showRows(s):n.hideRows(s),e.render()}hideComponents(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];this.changeComponentsVisibility(!1,...e)}showComponents(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];this.changeComponentsVisibility(!0,...e)}destroy(){this.enabled&&(this.components.forEach(((t,e)=>{null!==t&&(t.destroy(),this.components.set(e,null))})),this.conditionCollection.destroy(),this.conditionUpdateObserver.destroy(),this.hot.rowIndexMapper.unregisterMap(this.pluginName)),super.destroy()}}function s3(t){t&&Mp(t,(t=>{const[,e]=t,n=this.hot.propToCol(e);this.conditionCollection.hasConditions(n)&&this.updateValueComponentCondition(n)}))}function a3(){this.restoreComponents(Array.from(this.components.values()))}function l3(){this.components.get("filter_by_condition").getSelectElement().closeOptions(),this.components.get("filter_by_condition2").getSelectElement().closeOptions()}function h3(t){t.items.push({name:cG}),this.components.forEach((e=>{t.items.push(e.getMenuItemDescriptor())}))}function c3(t){var e;if("accept"===t){const t=this.getSelectedColumn();var n;if(null===t)return void(null===(n=this.dropdownMenuPlugin)||void 0===n||n.close());const{physicalIndex:e}=t,o=this.components.get("filter_by_condition").getState(),i=this.components.get("filter_by_condition2").getState(),r=this.components.get("filter_by_value").getState(),s=this.getOperationBasedOnArguments(this.components.get("filter_operators").getActiveOperationId(),o,i,r);this.conditionUpdateObserver.groupChanges();let a=this.conditionCollection.getColumnStackPosition(e);-1===a&&(a=void 0),this.conditionCollection.removeConditions(e),o.command.key!==kJ&&(this.conditionCollection.addCondition(e,o,s,a),i.command.key!==kJ&&this.conditionCollection.addCondition(e,i,s,a)),r.command.key!==kJ&&this.conditionCollection.addCondition(e,r,s,a),this.conditionUpdateObserver.flush(),this.components.forEach((t=>t.saveState(e))),this.filtersRowsMap.clear(),this.filter()}null===(e=this.dropdownMenuPlugin)||void 0===e||e.close()}function u3(t,e){this.updateDependentComponentsVisibility(),t.constructor===_0&&!e.inputsCount&&this.setListeningDropdownMenu()}function d3(){this.setListeningDropdownMenu()}function g3(t,e){const n=this.hot.toPhysicalColumn(t);this.enabled&&this.conditionCollection.hasConditions(n)?cA(e,"htFiltersActive"):uA(e,"htFiltersActive")}function f3(t){var e;if(null===(e=this.dropdownMenuPlugin)||void 0===e||!e.enabled)return;const{editedConditionStack:{conditions:n,column:o}}=t,i=n.filter((t=>t.name===C$)),r=n.filter((t=>t.name!==C$));if(i.length>=2||r.length>=3)Xy(Lp`The filter conditions have been applied properly, but couldnât be displayed visually.\x20
        The overall amount of conditions exceed the capability of the dropdown menu.\x20
        For more details see the documentation.`);else{const e=this.conditionCollection.getOperation(o);this.components.get("filter_by_condition").updateState(r[0],o),this.components.get("filter_by_condition2").updateState(r[1],o),this.components.get("filter_operators").updateState(e,o),this.components.get("filter_by_value").updateState(t)}}const m3="internal-use-in-handsontable",p3={licenseKey:m3,useArrayArithmetic:!0,useColumnIndex:!1,useStats:!1,evaluateNullToZero:!0,precisionEpsilon:1e-13,precisionRounding:14,smartRounding:!0,leapYear1900:!1,nullDate:{year:1899,month:12,day:30},nullYear:30,dateFormats:["DD/MM/YYYY","DD/MM/YY"],timeFormats:["hh:mm","hh:mm:ss.sss"],matchWholeCell:!0,useRegularExpressions:!1,useWildcards:!0,functionArgSeparator:",",thousandSeparator:"",decimalSeparator:".",language:"enGB"};function w3(t){var e;return{maxColumns:t.maxColumns,maxRows:t.maxRows,language:null===(e=t[O4])||void 0===e||null===(e=e.language)||void 0===e?void 0:e.langCode}}function A3(t){return Object.keys(t).reduce(((e,n)=>("hyperformula"!==n&&(e[n]=t[n]),e)),{})}function v3(t){var e;const n=t[O4],o=A3(null!=n&&null!==(e=n.engine)&&void 0!==e&&e.hyperformula?n.engine:{}),i=w3(t);return p(p(p({},p3),o),i)}function y3(t){var e;const n=t[O4],o=A3(null!=n&&null!==(e=n.engine)&&void 0!==e&&e.hyperformula?n.engine:{}),i=w3(t);return p(p({},o),i)}function C3(t,e){return Object.keys(e).some((n=>void 0!==e[n]&&e[n]!==t[n]))}function b3(){const t="engine_relationship",e=hC(O4);return e.hasItem(t)||e.register(t,new Map),e.getItem(t)}function S3(){const t="shared_engine_usage",e=hC(O4);return e.hasItem(t)||e.register(t,new Map),e.getItem(t)}function E3(t){const e=t.getSettings(),n=e[O4],o=null==n?void 0:n.engine;if(!0===n||Fp(o))return null;var i;if("function"==typeof o.hyperformula||"function"==typeof o)return R3(null!==(i=o.hyperformula)&&void 0!==i?i:o,e,t);if("object"==typeof o&&Fp(o.hyperformula)){const e=b3(),n=S3().get(o);return e.has(o)||e.set(o,[]),e.get(o).push(t),n&&n.push(t.guid),o.getConfig().licenseKey||o.updateConfig({licenseKey:m3}),(o.getConfig().leapYear1900!==p3.leapYear1900||!1===$v(o.getConfig().nullDate,p3.nullDate))&&Xy(Lp`If you use HyperFormula with Handsontable, keep the default \`leapYear1900\` and \`nullDate\` 
      settings. Otherwise, HyperFormula's dates may not sync correctly with Handsontable's dates.`),o}return null}function R3(t,e,n){const o=e[O4],i=v3(e),r=b3(),s=S3();k3(t,o.functions),x3(t,o.language);const a=t.buildEmpty(i);return r.set(a,[n]),s.set(a,[n.guid]),I3(a,o.namedExpressions),a.on("sheetAdded",(()=>{a.rebuildAndRecalculate()})),a.on("sheetRemoved",(()=>{a.rebuildAndRecalculate()})),a}function M3(t){var e;const n=b3(),o=0===n.size?[]:Array.from(null!==(e=n.get(t))&&void 0!==e?e:[]);return new Map(o.map((t=>[t.getPlugin("formulas").sheetId,t])))}function T3(t,e){if(t){const n=b3(),o=n.get(t),i=S3(),r=i.get(t);o&&o.includes(e)&&(o.splice(o.indexOf(e),1),0===o.length&&n.delete(t)),r&&r.includes(e.guid)&&(r.splice(r.indexOf(e.guid),1),0===r.length&&(i.delete(t),t.destroy()))}}function k3(t,e){e&&e.forEach((e=>{const{name:n,plugin:o,translations:i}=e;try{t.registerFunction(n,o,i)}catch(r){Xy(r.message)}}))}function x3(t,e){if(e){const{langCode:o}=e;try{t.registerLanguage(o,e)}catch(n){Xy(n.message)}}}function I3(t,e){e&&(t.suspendEvaluation(),e.forEach((e=>{const{name:n,expression:o,scope:i,options:r}=e;try{t.addNamedExpression(n,o,i,r)}catch(s){Xy(s.message)}})),t.resumeEvaluation())}function O3(t,e){return(Fp(e)||!t.doesSheetExist(e))&&(e=t.addSheet(e)),e}const H3="DD/MM/YYYY";function D3(t){return"string"==typeof t&&"'"===t.charAt(0)&&"="===t.charAt(1)}function N3(t){return D3(t)?t.substr(1):t}function P3(t){return"string"==typeof t&&t.startsWith("=")}function _3(t,e){return"string"==typeof t&&"date"===e}function B3(t,e){return gh(t,e,!0).isValid()}function L3(t,e){return gh(t,e,!0).format(H3)}function V3(t,e){return gh(t,H3,!0).format(e)}function W3(t,e){const n=new Date(Date.UTC(0,0,t+-1));return gh(n).format(e)}function F3(t,e,n){j3(t,e),e.set(t,n)}function j3(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function U3(t,e){var n=G3(t,e,"get");return Y3(t,n)}function Y3(t,e){return e.get?e.get.call(t):e.value}function z3(t,e,n){var o=G3(t,e,"set");return Q3(t,o,n),n}function G3(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function Q3(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var K3=new WeakMap,X3=new WeakMap,q3=new WeakMap,Z3=new WeakMap,J3=new WeakMap,$3=new WeakMap,t4=new WeakMap;class e4{constructor(t,e,n){F3(this,K3,{writable:!0,value:void 0}),F3(this,X3,{writable:!0,value:void 0}),F3(this,q3,{writable:!0,value:void 0}),F3(this,Z3,{writable:!0,value:[]}),F3(this,J3,{writable:!0,value:[]}),F3(this,$3,{writable:!0,value:void 0}),F3(this,t4,{writable:!0,value:[]}),z3(this,K3,t),z3(this,X3,e),z3(this,q3,n)}setRemovedHfIndexes(t){return z3(this,t4,t.map((t=>{const e=U3(this,X3).getVisualFromPhysicalIndex(t);return this.getHfIndexFromVisualIndex(e)}))),U3(this,t4)}getRemovedHfIndexes(){return U3(this,t4)}getHfIndexFromVisualIndex(t){const e=U3(this,X3).getIndexesSequence(),n=U3(this,X3).getNotTrimmedIndexes();return e.indexOf(n[t])}syncMoves(t){const e=`move${iw(U3(this,K3))}s`;U3(this,q3).getEngine().batch((()=>{t.forEach((t=>{const n=t.from!==t.to,o=t.from+1!==t.to;n&&o&&U3(this,q3).getEngine()[e](U3(this,q3).getSheetId(),t.from,1,t.to)}))}))}storeMovesInformation(t,e,n){!1!==n&&(z3(this,J3,t.map((t=>this.getHfIndexFromVisualIndex(t)))),z3(this,$3,this.getHfIndexFromVisualIndex(e)))}getMoveLine(t,e){const n=U3(this,X3).getNumberOfIndexes(),o=Array.from(Array(n).keys()).filter((e=>!1===t.includes(e)));var i;return 0===e?null!==(i=o[e])&&void 0!==i?i:0:o[e-1]+1}getInitiallyCalculatedMoves(t,e){let n=this.getMoveLine(t,e);const o=[];return t.forEach((t=>{const e={from:t,to:n};o.forEach((t=>{const n=t.from>t.to,o=t.to<=e.from;t.from>e.from&&o&&n&&(e.from+=1)})),e.from>=n&&(n+=1),o.push(e)})),o}adjustedCalculatedMoves(t){return t.forEach(((e,n)=>{t.slice(n+1).forEach((t=>{const n=t.from<t.to;t.from>e.from&&n&&(t.from-=1)}))})),t}calculateAndSyncMoves(t,e){if(U3(this,q3).isPerformingUndoRedo()||!1===t||!1===e)return;const n=this.adjustedCalculatedMoves(this.getInitiallyCalculatedMoves(U3(this,J3),U3(this,$3)));null===U3(this,q3).getSheetId()?U3(this,q3).getPostponeAction((()=>this.syncMoves(n))):this.syncMoves(n)}getIndexesChangeSyncMethod(){const t=`set${iw(U3(this,K3))}Order`;return e=>{if(U3(this,q3).isPerformingUndoRedo())return;const n=U3(this,X3).getIndexesSequence();if("update"===e){const e=U3(this,Z3).map((t=>n.indexOf(t))),o=U3(this,q3).getEngine().getSheetDimensions(U3(this,q3).getSheetId());let i;i="row"===U3(this,K3)?o.height:o.width;const r=e.length;for(let t=r;t<i;t+=1)e.push(t);U3(this,q3).getEngine()[t](U3(this,q3).getSheetId(),e)}z3(this,Z3,n)}}init(){z3(this,Z3,U3(this,X3).getIndexesSequence())}}const n4=e4;function o4(t,e,n){i4(t,e),e.set(t,n)}function i4(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function r4(t,e){var n=l4(t,e,"get");return s4(t,n)}function s4(t,e){return e.get?e.get.call(t):e.value}function a4(t,e,n){var o=l4(t,e,"set");return h4(t,o,n),n}function l4(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function h4(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var c4=new WeakMap,u4=new WeakMap,d4=new WeakMap,g4=new WeakMap,f4=new WeakMap,m4=new WeakMap,p4=new WeakMap;class w4{constructor(t,e,n){o4(this,c4,{writable:!0,value:void 0}),o4(this,u4,{writable:!0,value:void 0}),o4(this,d4,{writable:!0,value:void 0}),o4(this,g4,{writable:!0,value:!1}),o4(this,f4,{writable:!0,value:!1}),o4(this,m4,{writable:!0,value:null}),o4(this,p4,{writable:!0,value:null}),a4(this,c4,new n4("row",t,this)),a4(this,u4,new n4("column",e,this)),a4(this,d4,n)}getForAxis(t){return r4(this,"row"===t?c4:u4)}setPerformUndo(t){a4(this,g4,t)}setPerformRedo(t){a4(this,f4,t)}isPerformingUndoRedo(){return r4(this,g4)||r4(this,f4)}getSheetId(){return r4(this,p4)}getEngine(){return r4(this,m4)}getPostponeAction(){return r4(this,d4)}setupSyncEndpoint(t,e){a4(this,m4,t),a4(this,p4,e),r4(this,c4).init(),r4(this,u4).init()}}const A4=w4;function v4(t,e){E4(t,e),e.add(t)}function y4(t,e,n){return e=C4(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function C4(t){var e=b4(t,"string");return"symbol"==typeof e?e:String(e)}function b4(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function S4(t,e,n){E4(t,e),e.set(t,n)}function E4(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function R4(t,e,n){var o=k4(t,e,"set");return M4(t,o,n),n}function M4(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function T4(t,e){var n=k4(t,e,"get");return x4(t,n)}function k4(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function x4(t,e){return e.get?e.get.call(t):e.value}function I4(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const O4="formulas",H4=["maxRows","maxColumns","language"],D4=260;aC.getSingleton().register("afterNamedExpressionAdded"),aC.getSingleton().register("afterNamedExpressionRemoved"),aC.getSingleton().register("afterSheetAdded"),aC.getSingleton().register("afterSheetRemoved"),aC.getSingleton().register("afterSheetRenamed"),aC.getSingleton().register("afterFormulasValuesUpdate");const N4=t=>"UndoRedo.undo"===t||"UndoRedo.redo"===t||"auto"===t;var P4=new WeakMap,_4=new WeakMap,B4=new WeakMap,L4=new WeakSet,V4=new WeakSet,W4=new WeakSet,F4=new WeakSet,j4=new WeakSet,U4=new WeakSet,Y4=new WeakSet,z4=new WeakSet,G4=new WeakSet,Q4=new WeakSet,K4=new WeakSet,X4=new WeakSet,q4=new WeakSet,Z4=new WeakSet,J4=new WeakSet,$4=new WeakSet,t8=new WeakSet,e8=new WeakSet,n8=new WeakSet,o8=new WeakSet,i8=new WeakSet,r8=new WeakSet,s8=new WeakSet,a8=new WeakSet;class l8 extends jF{constructor(){var t;super(...arguments),t=this,v4(this,a8),v4(this,s8),v4(this,r8),v4(this,i8),v4(this,o8),v4(this,n8),v4(this,e8),v4(this,t8),v4(this,$4),v4(this,J4),v4(this,Z4),v4(this,q4),v4(this,X4),v4(this,K4),v4(this,Q4),v4(this,G4),v4(this,z4),v4(this,Y4),v4(this,U4),v4(this,j4),v4(this,F4),v4(this,W4),v4(this,V4),v4(this,L4),S4(this,P4,{writable:!0,value:!1}),S4(this,_4,{writable:!0,value:!1}),S4(this,B4,{writable:!0,value:[["valuesUpdated",function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return I4(t,n8,T8).call(t,...n)}],["namedExpressionAdded",function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return I4(t,o8,k8).call(t,...n)}],["namedExpressionRemoved",function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return I4(t,i8,x8).call(t,...n)}],["sheetAdded",function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return I4(t,r8,I8).call(t,...n)}],["sheetRenamed",function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return I4(t,s8,O8).call(t,...n)}],["sheetRemoved",function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return I4(t,a8,H8).call(t,...n)}]]}),y4(this,"staticRegister",hC("formulas")),y4(this,"engine",null),y4(this,"sheetName",null),y4(this,"indexSyncer",null),y4(this,"rowAxisSyncer",null),y4(this,"columnAxisSyncer",null)}static get PLUGIN_KEY(){return O4}static get PLUGIN_PRIORITY(){return D4}static get SETTING_KEYS(){return[O4,...H4]}get sheetId(){return null===this.sheetName?null:this.engine.getSheetId(this.sheetName)}isEnabled(){return!!this.hot.getSettings()[O4]}enablePlugin(){var t,e=this;if(!this.enabled){if(this.engine=null!==(t=E3(this.hot))&&void 0!==t?t:this.engine,!this.engine)return void Xy("Missing the required `engine` key in the Formulas settings. Please fill it with either an engine class or an engine instance.");if(null!==this.sheetName&&!this.engine.doesSheetExist(this.sheetName)){const t=this.addSheet(this.sheetName,this.hot.getSourceDataArray());!1!==t&&(this.sheetName=t)}this.addHook("beforeLoadData",(function(){for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return I4(e,W4,u8).call(e,...n)})),this.addHook("afterLoadData",(function(){for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return I4(e,j4,g8).call(e,...n)})),this.addHook("beforeUpdateData",(function(){for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return I4(e,W4,u8).call(e,...n)})),this.addHook("afterUpdateData",(function(){for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return I4(e,j4,g8).call(e,...n)})),this.addHook("modifyData",(function(){for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return I4(e,U4,f8).call(e,...n)})),this.addHook("modifySourceData",(function(){for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return I4(e,Y4,m8).call(e,...n)})),this.addHook("beforeValidate",(function(){for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return I4(e,L4,h8).call(e,...n)})),this.addHook("afterSetSourceDataAtCell",(function(){for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return I4(e,G4,w8).call(e,...n)})),this.addHook("afterSetDataAtCell",(function(){for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return I4(e,z4,p8).call(e,...n)})),this.addHook("afterSetDataAtRowProp",(function(){for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return I4(e,z4,p8).call(e,...n)})),this.addHook("beforeCreateRow",(function(){for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return I4(e,Q4,A8).call(e,...n)})),this.addHook("beforeCreateCol",(function(){for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return I4(e,K4,v8).call(e,...n)})),this.addHook("afterCreateRow",(function(){for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return I4(e,Z4,b8).call(e,...n)})),this.addHook("afterCreateCol",(function(){for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return I4(e,J4,S8).call(e,...n)})),this.addHook("beforeRemoveRow",(function(){for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return I4(e,X4,y8).call(e,...n)})),this.addHook("beforeRemoveCol",(function(){for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return I4(e,q4,C8).call(e,...n)})),this.addHook("afterRemoveRow",(function(){for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return I4(e,$4,E8).call(e,...n)})),this.addHook("afterRemoveCol",(function(){for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return I4(e,t8,R8).call(e,...n)})),this.indexSyncer=new A4(this.hot.rowIndexMapper,this.hot.columnIndexMapper,(t=>{this.hot.addHookOnce("init",(()=>{t()}))})),this.rowAxisSyncer=this.indexSyncer.getForAxis("row"),this.columnAxisSyncer=this.indexSyncer.getForAxis("column"),this.hot.addHook("afterRowSequenceChange",this.rowAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("afterColumnSequenceChange",this.columnAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("beforeRowMove",((t,e,n,o)=>{this.rowAxisSyncer.storeMovesInformation(t,e,o)})),this.hot.addHook("beforeColumnMove",((t,e,n,o)=>{this.columnAxisSyncer.storeMovesInformation(t,e,o)})),this.hot.addHook("afterRowMove",((t,e,n,o,i)=>{this.rowAxisSyncer.calculateAndSyncMoves(o,i)})),this.hot.addHook("afterColumnMove",((t,e,n,o,i)=>{this.columnAxisSyncer.calculateAndSyncMoves(o,i)})),this.hot.addHook("beforeColumnFreeze",((t,e)=>{this.columnAxisSyncer.storeMovesInformation([t],this.hot.getSettings().fixedColumnsStart,e)})),this.hot.addHook("afterColumnFreeze",((t,e)=>{this.columnAxisSyncer.calculateAndSyncMoves(e,e)})),this.hot.addHook("beforeColumnUnfreeze",((t,e)=>{this.columnAxisSyncer.storeMovesInformation([t],this.hot.getSettings().fixedColumnsStart-1,e)})),this.hot.addHook("afterColumnUnfreeze",((t,e)=>{this.columnAxisSyncer.calculateAndSyncMoves(e,e)})),this.addHook("afterCellMetaReset",(function(){for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return I4(e,F4,d8).call(e,...n)})),this.addHook("beforeUndo",(()=>{this.indexSyncer.setPerformUndo(!0),this.engine.undo()})),this.addHook("beforeRedo",(()=>{this.indexSyncer.setPerformRedo(!0),this.engine.redo()})),this.addHook("afterUndo",(()=>{this.indexSyncer.setPerformUndo(!1)})),this.addHook("afterUndo",(()=>{this.indexSyncer.setPerformRedo(!1)})),this.addHook("afterDetachChild",(function(){for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return I4(e,e8,M8).call(e,...n)})),this.addHook("beforeAutofill",(function(){for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return I4(e,V4,c8).call(e,...n)})),T4(this,B4).forEach((t=>{let[e,n]=t;return this.engine.on(e,n)})),super.enablePlugin()}}disablePlugin(){T4(this,B4).forEach((t=>{let[e,n]=t;return this.engine.off(e,n)})),T3(this.engine,this.hot),this.engine=null,super.disablePlugin()}updatePlugin(t){const e=y3(this.hot.getSettings());C3(this.engine.getConfig(),e)&&this.engine.updateConfig(e);const n=this.hot.getSettings()[O4];if(Wp(n)&&Wp(n.sheetName)&&n.sheetName!==this.sheetName&&this.switchSheet(n.sheetName),!t.data&&null===this.sheetName){const t=this.hot.getSettings()[O4].sheetName;t&&this.engine.doesSheetExist(t)?this.switchSheet(this.sheetName):this.sheetName=this.addSheet(null!=t?t:void 0,this.hot.getSourceDataArray())}super.updatePlugin(t)}destroy(){T4(this,B4).forEach((t=>{var e;let[n,o]=t;return null===(e=this.engine)||void 0===e?void 0:e.off(n,o)})),R4(this,B4,null),T3(this.engine,this.hot),this.engine=null,super.destroy()}addSheet(t,e){if(Wp(e)&&!oI(e))return Xy("The provided data should be an array of arrays."),!1;if(null!=t&&this.engine.doesSheetExist(t))return Xy("Sheet with the provided name already exists."),!1;try{const n=this.engine.addSheet(null!=t?t:void 0);return e&&this.engine.setSheetContent(this.engine.getSheetId(n),e),n}catch(n){return Xy(n.message),!1}}switchSheet(t){if(!this.engine.doesSheetExist(t))return void qy(`The sheet named \`${t}\` does not exist, switch aborted.`);this.sheetName=t;const e=this.engine.getSheetSerialized(this.sheetId);e.length>0&&this.hot.loadData(e,`${iw(O4)}.switchSheet`)}getCellType(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.sheetId;const o=this.hot.toPhysicalRow(t),i=this.hot.toPhysicalColumn(e);return null!==o&&null!==i?this.engine.getCellType({sheet:n,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(t),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(e)}):"EMPTY"}isFormulaCellType(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.sheetId;return this.engine.doesCellHaveFormula({sheet:n,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(t),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(e)})}renderDependentSheets(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=new Set;t.forEach((t=>{var e;const o=null==t||null===(e=t.address)||void 0===e?void 0:e.sheet;void 0!==o&&(n.has(o)||n.add(o))})),M3(this.engine).forEach(((t,o)=>{var i;(e||o!==this.sheetId)&&n.has(o)&&(t.render(),null===(i=t.view)||void 0===i||i.adjustElementsSize())}))}validateDependentCells(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];const n=t=>{var e;const{row:n,col:o,sheet:i}=null!==(e=null==t?void 0:t.address)&&void 0!==e?e:{};return Wp(i)?`${i}:${n}x${o}`:""},o=new Set(e.map((t=>n(t))));t.forEach((t=>{var e,i;const{row:r,col:s}=null!==(e=t.address)&&void 0!==e?e:{};if(!1===Wp(r)||!1===Wp(s)||r>=this.hot.countRows()||s>=this.hot.countCols())return;const a=null==t||null===(i=t.address)||void 0===i?void 0:i.sheet,l=n(t);if(void 0!==a&&!o.has(l)){const t=M3(this.engine).get(a);if(!t)return;t.validateCell(t.getDataAtCell(r,s),t.getCellMeta(r,s),(()=>{}))}}))}syncChangeWithEngine(t,e,n){const o={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(t),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(e),sheet:this.sheetId};if(!this.engine.isItPossibleToSetCellContents(o))return void Xy(`Not possible to set cell data at ${JSON.stringify(o)}`);const i=this.hot.getCellMeta(t,e);return _3(n,i.type)&&(B3(n,i.dateFormat)?n=L3(n,i.dateFormat):!1===P3(n)&&(n=`'${n}`)),this.engine.setCellContents(o,n)}}function h8(t,e,n){const o=this.hot.propToCol(n);if(this.isFormulaCellType(e,o)){const t={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(o),sheet:this.sheetId},n=this.hot.getCellMeta(e,o);let i=this.engine.getCellValue(t);return"date"===n.type&&vb(i)&&(i=W3(i,n.dateFormat)),"object"==typeof i&&null!==i?i.value:i}return t}function c8(t,e,n){const{row:o,col:i}=e.getTopStartCorner(),{row:r,col:s}=e.getBottomEndCorner(),{row:a,col:l}=n.getTopStartCorner(),{row:h,col:c}=n.getBottomEndCorner(),u={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(o),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(i),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(r),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(s),sheet:this.sheetId}},d={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(a),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(l),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(h),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(c),sheet:this.sheetId}};if(!1===this.engine.isItPossibleToSetCellContents(d))return!1;const g=this.engine.getFillRangeData(u,d),{row:f,col:m}=u.start,{row:p,col:w}=u.end,A=p-f+1,v=w-m+1;for(let y=0;y<g.length;y+=1)for(let t=0;t<g[y].length;t+=1){const e=g[y][t],n=y%A,o=t%v,i=this.hot.getCellMeta(n,o);_3(e,i.type)&&(e.startsWith("'")?g[y][t]=e.slice(1):!1===this.isFormulaCellType(n,o,this.sheetId)&&(g[y][t]=V3(e,i.dateFormat)))}return g}function u8(t,e){(arguments.length>2&&void 0!==arguments[2]?arguments[2]:"").includes(iw(O4))||R4(this,_4,Fp(this.hot.getSettings().data))}function d8(){const t=this.hot.getSourceDataArray();let e=!1;t.forEach(((n,o)=>{n.forEach(((n,i)=>{const r=this.hot.getCellMeta(o,i),s=r.dateFormat;_3(n,r.type)&&(e=!0,B3(n,s)?t[o][i]=L3(n,s):!1===this.isFormulaCellType(o,i)&&(t[o][i]=`'${n}`))}))})),!0===e&&(R4(this,P4,!0),this.engine.setSheetContent(this.sheetId,t),R4(this,P4,!1))}function g8(t,e){if(!(arguments.length>2&&void 0!==arguments[2]?arguments[2]:"").includes(iw(O4)))if(this.sheetName=O3(this.engine,this.hot.getSettings()[O4].sheetName),T4(this,_4))this.switchSheet(this.sheetName);else{const t=this.hot.getSourceDataArray();if(this.engine.isItPossibleToReplaceSheetContent(this.sheetId,t)){R4(this,P4,!0);const e=this.engine.setSheetContent(this.sheetId,t);this.indexSyncer.setupSyncEndpoint(this.engine,this.sheetId),this.renderDependentSheets(e),R4(this,P4,!1)}}}function f8(t,e,n,o){if("get"!==o||T4(this,P4)||null===this.sheetName||!this.engine.doesSheetExist(this.sheetName))return;const i=this.hot.toVisualRow(t);if(null===i||null===e)return;if(!this.isFormulaCellType(i,e)&&"ARRAY"!==this.getCellType(i,e))return void(D3(n.value)&&(n.value=N3(n.value)));const r={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(i),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(e),sheet:this.sheetId};let s=this.engine.getCellValue(r);const a=this.hot.getCellMeta(i,e);"date"===a.type&&vb(s)&&(s=W3(s,a.dateFormat));const l="object"==typeof s&&null!==s?s.value:s;n.value=l}function m8(t,e,n,o){if("get"!==o||T4(this,P4)||null===this.sheetName||!this.engine.doesSheetExist(this.sheetName))return;const i=this.hot.toVisualRow(t),r=this.hot.propToCol(e);if(null===i||null===r||!this.isFormulaCellType(i,r)&&"ARRAY"!==this.getCellType(i,r))return;const s=this.engine.getSheetDimensions(this.engine.getSheetId(this.sheetName));if(0===s.width&&0===s.height)return;const a={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(i),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(r),sheet:this.sheetId};n.value=this.engine.getCellSerialized(a)}function p8(t,e){if(N4(e))return;const n=[],o=[],i=this.engine.batch((()=>{t.forEach((t=>{let[e,i,,r]=t;const s=this.hot.propToCol(i),a=this.hot.toPhysicalRow(e),l=this.hot.toPhysicalColumn(s),h={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(s),sheet:this.sheetId};null!==a&&null!==l?this.syncChangeWithEngine(e,s,r):n.push([e,s,r]),o.push({address:h})}))}));n.length&&this.hot.addHookOnce("afterChange",(()=>{const t=this.engine.batch((()=>{n.forEach((t=>{let[e,n,o]=t;this.syncChangeWithEngine(e,n,o)}))}));this.renderDependentSheets(t,!0)})),this.renderDependentSheets(i),this.validateDependentCells(i,o)}function w8(t,e){if(N4(e))return;const n=[],o=[];t.forEach((t=>{let[e,i,,r]=t;const s=this.hot.propToCol(i);if(!vb(s))return;const a={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(s),sheet:this.sheetId};this.engine.isItPossibleToSetCellContents(a)?(o.push({address:a}),n.push(...this.engine.setCellContents(a,r))):Xy(`Not possible to set source cell data at ${JSON.stringify(a)}`)})),this.renderDependentSheets(n),this.validateDependentCells(n,o)}function A8(t,e){let n=this.rowAxisSyncer.getHfIndexFromVisualIndex(t);if(t>=this.hot.countRows()&&(n=t),null===this.sheetId||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddRows(this.sheetId,[n,e]))return!1}function v8(t,e){let n=this.columnAxisSyncer.getHfIndexFromVisualIndex(t);if(t>=this.hot.countCols()&&(n=t),null===this.sheetId||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddColumns(this.sheetId,[n,e]))return!1}function y8(t,e,n){return!1!==this.rowAxisSyncer.setRemovedHfIndexes(n).every((t=>this.engine.isItPossibleToRemoveRows(this.sheetId,[t,1])))&&void 0}function C8(t,e,n){return!1!==this.columnAxisSyncer.setRemovedHfIndexes(n).every((t=>this.engine.isItPossibleToRemoveColumns(this.sheetId,[t,1])))&&void 0}function b8(t,e,n){if(N4(n))return;const o=this.engine.addRows(this.sheetId,[this.rowAxisSyncer.getHfIndexFromVisualIndex(t),e]);this.renderDependentSheets(o)}function S8(t,e,n){if(N4(n))return;const o=this.engine.addColumns(this.sheetId,[this.columnAxisSyncer.getHfIndexFromVisualIndex(t),e]);this.renderDependentSheets(o)}function E8(t,e,n,o){if(N4(o))return;const i=this.rowAxisSyncer.getRemovedHfIndexes().sort().reverse(),r=this.engine.batch((()=>{i.forEach((t=>{this.engine.removeRows(this.sheetId,[t,1])}))}));this.renderDependentSheets(r)}function R8(t,e,n,o){if(N4(o))return;const i=this.columnAxisSyncer.getRemovedHfIndexes().sort().reverse(),r=this.engine.batch((()=>{i.forEach((t=>{this.engine.removeColumns(this.sheetId,[t,1])}))}));this.renderDependentSheets(r)}function M8(t,e,n){var o;R4(this,P4,!0);const i=this.hot.getSourceDataArray(n,0,n+((null===(o=e.__children)||void 0===o?void 0:o.length)||0),this.hot.countSourceCols());R4(this,P4,!1),i.forEach(((t,e)=>{t.forEach(((t,o)=>{this.engine.setCellContents({col:o,row:n+e,sheet:this.sheetId},[[t]])}))}))}function T8(t){this.hot.runHooks("afterFormulasValuesUpdate",t)}function k8(t,e){this.hot.runHooks("afterNamedExpressionAdded",t,e)}function x8(t,e){this.hot.runHooks("afterNamedExpressionRemoved",t,e)}function I8(t){this.hot.runHooks("afterSheetAdded",t)}function O8(t,e){this.hot.runHooks("afterSheetRenamed",t,e)}function H8(t,e){this.hot.runHooks("afterSheetRemoved",t,e)}function D8(t){return{key:"hidden_columns_hide",name(){const t=this.getSelectedLast();let e=0;if(Array.isArray(t)){const[,n,,o]=t;n-o!==0&&(e=1)}return this.getTranslatedPhrase(dH,e)},callback(){const{from:e,to:n}=this.getSelectedRangeLast(),o=Math.max(Math.min(e.col,n.col),0),i=Math.max(e.col,n.col),r=[];for(let t=o;t<=i;t+=1)r.push(t);t.hideColumns(r);const s=r[r.length-1],a=this.columnIndexMapper.getNearestNotHiddenIndex(s,1,!0);Number.isInteger(a)&&a>=0?this.selectColumns(a):this.deselectCell(),this.render(),this.view.adjustElementsSize(!0)},disabled:!1,hidden(){return!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())}}}function N8(t){const e=[];return{key:"hidden_columns_show",name(){const t=e.length>1?1:0;return this.getTranslatedPhrase(gH,t)},callback(){var n,o;if(0===e.length)return;let i=e[0],r=e[e.length-1];i=null!==(n=this.columnIndexMapper.getNearestNotHiddenIndex(i-1,-1))&&void 0!==n?n:0,r=null!==(o=this.columnIndexMapper.getNearestNotHiddenIndex(r+1,1))&&void 0!==o?o:this.countCols()-1,t.showColumns(e),this.render(),this.view.adjustElementsSize(!0),r-i+1===this.countCols()||this.selectColumns(i,r)},disabled:!1,hidden(){const n=Rp(t.getHiddenColumns(),(t=>this.toPhysicalColumn(t)));if(!this.selection.isSelectedByColumnHeader()&&!this.selection.isSelectedByCorner()||n.length<1)return!0;e.length=0;const o=this.getSelectedRangeLast(),i=o.getTopStartCorner().col,r=o.getBottomEndCorner().col,s=this.columnIndexMapper,a=s.getRenderableFromVisualIndex(i),l=s.getRenderableFromVisualIndex(r),h=s.getNotTrimmedIndexes(),c=[];if(i!==r){const t=r-i+1,e=l-a+1;if(t>e){const t=h.slice(i,r+1);c.push(...t.filter((t=>n.includes(t))))}}else if(0===a&&a<i)c.push(...h.slice(0,i));else if(null===a)c.push(...h.slice(0,this.countCols()));else{const t=this.countCols()-1,e=s.getRenderableFromVisualIndex(s.getNearestNotHiddenIndex(t,-1));l===e&&t>r&&c.push(...h.slice(r+1))}return Mp(c,(t=>{e.push(this.toVisualColumn(t))})),0===e.length}}}function P8(t,e){B8(t,e),e.add(t)}function _8(t,e,n){B8(t,e),e.set(t,n)}function B8(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function L8(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function V8(t,e){var n=j8(t,e,"get");return W8(t,n)}function W8(t,e){return e.get?e.get.call(t):e.value}function F8(t,e,n){var o=j8(t,e,"set");return U8(t,o,n),n}function j8(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function U8(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}aC.getSingleton().register("beforeHideColumns"),aC.getSingleton().register("afterHideColumns"),aC.getSingleton().register("beforeUnhideColumns"),aC.getSingleton().register("afterUnhideColumns");const Y8="hiddenColumns",z8=310;var G8=new WeakMap,Q8=new WeakMap,K8=new WeakSet,X8=new WeakSet,q8=new WeakSet,Z8=new WeakSet,J8=new WeakSet,$8=new WeakSet;class t9 extends jF{constructor(){super(...arguments),P8(this,$8),P8(this,J8),P8(this,Z8),P8(this,q8),P8(this,X8),P8(this,K8),_8(this,G8,{writable:!0,value:{}}),_8(this,Q8,{writable:!0,value:null})}static get PLUGIN_KEY(){return Y8}static get PLUGIN_PRIORITY(){return z8}isEnabled(){return!!this.hot.getSettings()[Y8]}enablePlugin(){var t=this;if(this.enabled)return;const e=this.hot.getSettings()[Y8];ty(e)&&(F8(this,G8,e),Fp(e.copyPasteEnabled)&&(e.copyPasteEnabled=!0)),F8(this,Q8,new AI),V8(this,Q8).addLocalHook("init",(()=>L8(this,$8,s9).call(this))),this.hot.columnIndexMapper.registerMap(this.pluginName,V8(this,Q8)),this.addHook("afterContextMenuDefaultOptions",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return L8(t,J8,r9).call(t,...n)})),this.addHook("afterGetCellMeta",((t,e,n)=>L8(this,X8,n9).call(this,t,e,n))),this.addHook("modifyColWidth",((t,e)=>L8(this,K8,e9).call(this,t,e))),this.addHook("afterGetColHeader",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return L8(t,Z8,i9).call(t,...n)})),this.addHook("modifyCopyableRange",(t=>L8(this,q8,o9).call(this,t))),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),F8(this,G8,{}),super.disablePlugin(),this.resetCellsMeta()}showColumns(t){const e=this.getHiddenColumns(),n=this.isValidConfig(t);let o=e;const i=V8(this,Q8).getValues().slice(),r=t.length>0;if(n&&r){const e=t.map((t=>this.hot.toPhysicalColumn(t)));Mp(e,(t=>{i[t]=!1})),o=Sp(i,((t,e,n)=>(e&&t.push(this.hot.toVisualColumn(n)),t)),[])}!1!==this.hot.runHooks("beforeUnhideColumns",e,o,n&&r)&&(n&&r&&V8(this,Q8).setValues(i),this.hot.view.adjustElementsSize(),this.hot.runHooks("afterUnhideColumns",e,o,n&&r,n&&o.length<e.length))}showColumn(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];this.showColumns(e)}hideColumns(t){const e=this.getHiddenColumns(),n=this.isValidConfig(t);let o=e;n&&(o=Array.from(new Set(e.concat(t)))),!1!==this.hot.runHooks("beforeHideColumns",e,o,n)&&(n&&this.hot.batchExecution((()=>{Mp(t,(t=>{V8(this,Q8).setValueAtIndex(this.hot.toPhysicalColumn(t),!0)}))}),!0),this.hot.runHooks("afterHideColumns",e,o,n,n&&o.length>e.length))}hideColumn(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];this.hideColumns(e)}getHiddenColumns(){return Rp(V8(this,Q8).getHiddenIndexes(),(t=>this.hot.toVisualColumn(t)))}isHidden(t){return V8(this,Q8).getValueAtIndex(this.hot.toPhysicalColumn(t))||!1}isValidConfig(t){const e=this.hot.countCols();return!!(Array.isArray(t)&&t.length>0)&&t.every((t=>Number.isInteger(t)&&t>=0&&t<e))}resetCellsMeta(){Mp(this.hot.getCellsMeta(),(t=>{t&&(t.skipColumnOnPaste=!1)}))}destroy(){F8(this,G8,null),F8(this,Q8,null),super.destroy()}}function e9(t,e){return this.isHidden(e)?0:V8(this,G8).indicators&&(this.isHidden(e+1)||this.isHidden(e-1))&&"number"==typeof t&&this.hot.hasColHeaders()?t+15:void 0}function n9(t,e,n){if(!1===V8(this,G8).copyPasteEnabled&&this.isHidden(e)&&(n.skipColumnOnPaste=!0),this.isHidden(e-1))n.className=n.className||"",-1===n.className.indexOf("afterHiddenColumn")&&(n.className+=" afterHiddenColumn");else if(n.className){const t=n.className.split(" ");if(t.length>0){const e=t.indexOf("afterHiddenColumn");e>-1&&t.splice(e,1),n.className=t.join(" ")}}}function o9(t){if(V8(this,G8).copyPasteEnabled)return t;const e=[],n=(t,n,o,i)=>{e.push({startRow:t,endRow:n,startCol:o,endCol:i})};return Mp(t,(t=>{let e=!0,o=0;Cb(t.startCol,t.endCol,(i=>{this.isHidden(i)?(e||n(t.startRow,t.endRow,o,i-1),e=!0):(e&&(o=i),i===t.endCol&&n(t.startRow,t.endRow,o,i),e=!1)}))})),e}function i9(t,e){if(!V8(this,G8).indicators||t<0)return;const n=[];t>=1&&this.isHidden(t-1)&&n.push("afterHiddenColumn"),t<this.hot.countCols()-1&&this.isHidden(t+1)&&n.push("beforeHiddenColumn"),cA(e,n)}function r9(t){t.items.push({name:cG},D8(this),N8(this))}function s9(){Array.isArray(V8(this,G8).columns)&&this.hideColumns(V8(this,G8).columns)}function a9(t){return{key:"hidden_rows_hide",name(){const t=this.getSelectedLast();let e=0;if(Array.isArray(t)){const[n,,o]=t;n-o!==0&&(e=1)}return this.getTranslatedPhrase(fH,e)},callback(){const{from:e,to:n}=this.getSelectedRangeLast(),o=Math.max(Math.min(e.row,n.row),0),i=Math.max(e.row,n.row),r=[];for(let t=o;t<=i;t+=1)r.push(t);t.hideRows(r);const s=r[r.length-1],a=this.rowIndexMapper.getNearestNotHiddenIndex(s,1,!0);Number.isInteger(a)&&a>=0?this.selectRows(a):this.deselectCell(),this.render(),this.view.adjustElementsSize(!0)},disabled:!1,hidden(){return!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())}}}function l9(t){const e=[];return{key:"hidden_rows_show",name(){const t=e.length>1?1:0;return this.getTranslatedPhrase(mH,t)},callback(){var n,o;if(0===e.length)return;let i=e[0],r=e[e.length-1];i=null!==(n=this.rowIndexMapper.getNearestNotHiddenIndex(i-1,-1))&&void 0!==n?n:0,r=null!==(o=this.rowIndexMapper.getNearestNotHiddenIndex(r+1,1))&&void 0!==o?o:this.countRows()-1,t.showRows(e),this.render(),this.view.adjustElementsSize(!0),r-i+1===this.countRows()||this.selectRows(i,r)},disabled:!1,hidden(){const n=Rp(t.getHiddenRows(),(t=>this.toPhysicalRow(t)));if(!this.selection.isSelectedByRowHeader()&&!this.selection.isSelectedByCorner()||n.length<1)return!0;e.length=0;const o=this.getSelectedRangeLast(),i=o.getTopStartCorner().row,r=o.getBottomEndCorner().row,s=this.rowIndexMapper,a=s.getRenderableFromVisualIndex(i),l=s.getRenderableFromVisualIndex(r),h=s.getNotTrimmedIndexes(),c=[];if(i!==r){const t=r-i+1,e=l-a+1;if(t>e){const t=h.slice(i,r+1);c.push(...t.filter((t=>n.includes(t))))}}else if(0===a&&a<i)c.push(...h.slice(0,i));else if(null===a)c.push(...h.slice(0,this.countRows()));else{const t=this.countRows()-1,e=s.getRenderableFromVisualIndex(s.getNearestNotHiddenIndex(t,-1));l===e&&t>r&&c.push(...h.slice(r+1))}return Mp(c,(t=>{e.push(this.toVisualRow(t))})),0===e.length}}}function h9(t,e){u9(t,e),e.add(t)}function c9(t,e,n){u9(t,e),e.set(t,n)}function u9(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function d9(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function g9(t,e){var n=p9(t,e,"get");return f9(t,n)}function f9(t,e){return e.get?e.get.call(t):e.value}function m9(t,e,n){var o=p9(t,e,"set");return w9(t,o,n),n}function p9(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function w9(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}aC.getSingleton().register("beforeHideRows"),aC.getSingleton().register("afterHideRows"),aC.getSingleton().register("beforeUnhideRows"),aC.getSingleton().register("afterUnhideRows");const A9="hiddenRows",v9=320;var y9=new WeakMap,C9=new WeakMap,b9=new WeakSet,S9=new WeakSet,E9=new WeakSet,R9=new WeakSet,M9=new WeakSet,T9=new WeakSet;class k9 extends jF{constructor(){super(...arguments),h9(this,T9),h9(this,M9),h9(this,R9),h9(this,E9),h9(this,S9),h9(this,b9),c9(this,y9,{writable:!0,value:{}}),c9(this,C9,{writable:!0,value:null})}static get PLUGIN_KEY(){return A9}static get PLUGIN_PRIORITY(){return v9}isEnabled(){return!!this.hot.getSettings()[A9]}enablePlugin(){var t=this;if(this.enabled)return;const e=this.hot.getSettings()[A9];ty(e)&&(m9(this,y9,e),Fp(e.copyPasteEnabled)&&(e.copyPasteEnabled=!0)),m9(this,C9,new AI),g9(this,C9).addLocalHook("init",(()=>d9(this,T9,N9).call(this))),this.hot.rowIndexMapper.registerMap(this.pluginName,g9(this,C9)),this.addHook("afterContextMenuDefaultOptions",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return d9(t,M9,D9).call(t,...n)})),this.addHook("afterGetCellMeta",((t,e,n)=>d9(this,S9,I9).call(this,t,e,n))),this.addHook("modifyRowHeight",((t,e)=>d9(this,b9,x9).call(this,t,e))),this.addHook("afterGetRowHeader",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return d9(t,R9,H9).call(t,...n)})),this.addHook("modifyCopyableRange",(t=>d9(this,E9,O9).call(this,t))),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap(this.pluginName),m9(this,y9,{}),super.disablePlugin(),this.resetCellsMeta()}showRows(t){const e=this.getHiddenRows(),n=this.isValidConfig(t);let o=e;const i=g9(this,C9).getValues().slice(),r=t.length>0;if(n&&r){const e=t.map((t=>this.hot.toPhysicalRow(t)));Mp(e,(t=>{i[t]=!1})),o=Sp(i,((t,e,n)=>(e&&t.push(this.hot.toVisualRow(n)),t)),[])}!1!==this.hot.runHooks("beforeUnhideRows",e,o,n&&r)&&(n&&r&&g9(this,C9).setValues(i),this.hot.runHooks("afterUnhideRows",e,o,n&&r,n&&o.length<e.length))}showRow(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];this.showRows(e)}hideRows(t){const e=this.getHiddenRows(),n=this.isValidConfig(t);let o=e;n&&(o=Array.from(new Set(e.concat(t)))),!1!==this.hot.runHooks("beforeHideRows",e,o,n)&&(n&&this.hot.batchExecution((()=>{Mp(t,(t=>{g9(this,C9).setValueAtIndex(this.hot.toPhysicalRow(t),!0)}))}),!0),this.hot.runHooks("afterHideRows",e,o,n,n&&o.length>e.length))}hideRow(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];this.hideRows(e)}getHiddenRows(){return Rp(g9(this,C9).getHiddenIndexes(),(t=>this.hot.toVisualRow(t)))}isHidden(t){return g9(this,C9).getValueAtIndex(this.hot.toPhysicalRow(t))||!1}isValidConfig(t){const e=this.hot.countRows();return!!(Array.isArray(t)&&t.length>0)&&t.every((t=>Number.isInteger(t)&&t>=0&&t<e))}resetCellsMeta(){Mp(this.hot.getCellsMeta(),(t=>{t&&(t.skipRowOnPaste=!1)}))}destroy(){m9(this,y9,null),m9(this,C9,null),super.destroy()}}function x9(t,e){return this.isHidden(e)?0:t}function I9(t,e,n){if(!1===g9(this,y9).copyPasteEnabled&&this.isHidden(t)&&(n.skipRowOnPaste=!0),this.isHidden(t-1))n.className=n.className||"",-1===n.className.indexOf("afterHiddenRow")&&(n.className+=" afterHiddenRow");else if(n.className){const t=n.className.split(" ");if(t.length>0){const e=t.indexOf("afterHiddenRow");e>-1&&t.splice(e,1),n.className=t.join(" ")}}}function O9(t){if(g9(this,y9).copyPasteEnabled)return t;const e=[],n=(t,n,o,i)=>{e.push({startRow:t,endRow:n,startCol:o,endCol:i})};return Mp(t,(t=>{let e=!0,o=0;Cb(t.startRow,t.endRow,(i=>{this.isHidden(i)?(e||n(o,i-1,t.startCol,t.endCol),e=!0):(e&&(o=i),i===t.endRow&&n(o,i,t.startCol,t.endCol),e=!1)}))})),e}function H9(t,e){if(!g9(this,y9).indicators||t<0)return;const n=[];t>=1&&this.isHidden(t-1)&&n.push("afterHiddenRow"),t<this.hot.countRows()-1&&this.isHidden(t+1)&&n.push("beforeHiddenRow"),cA(e,n)}function D9(t){t.items.push({name:cG},a9(this),l9(this))}function N9(){Array.isArray(g9(this,y9).rows)&&this.hideRows(g9(this,y9).rows)}function P9(t){return{key:"freeze_column",name(){return this.getTranslatedPhrase(jO)},callback(e,n){const[{start:{col:o}}]=n;t.freezeColumn(o),this.render(),this.view.adjustElementsSize(!0)},hidden(){const t=this.getSelectedRange();let e=!1;return(void 0===t||t.length>1||t[0].from.col!==t[0].to.col||t[0].from.col<=this.getSettings().fixedColumnsStart-1)&&(e=!0),e}}}function _9(t){return{key:"unfreeze_column",name(){return this.getTranslatedPhrase(UO)},callback(e,n){const[{start:{col:o}}]=n;t.unfreezeColumn(o),this.render(),this.view.adjustElementsSize(!0)},hidden(){const t=this.getSelectedRange();let e=!1;return(void 0===t||t.length>1||t[0].from.col!==t[0].to.col||t[0].from.col>=this.getSettings().fixedColumnsStart)&&(e=!0),e}}}function B9(t,e){V9(t,e),e.add(t)}function L9(t,e,n){V9(t,e),e.set(t,n)}function V9(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function W9(t,e){var n=U9(t,e,"get");return F9(t,n)}function F9(t,e){return e.get?e.get.call(t):e.value}function j9(t,e,n){var o=U9(t,e,"set");return Y9(t,o,n),n}function U9(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function Y9(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function z9(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}aC.getSingleton().register("beforeColumnFreeze"),aC.getSingleton().register("afterColumnFreeze"),aC.getSingleton().register("beforeColumnUnfreeze"),aC.getSingleton().register("afterColumnUnfreeze");const G9="manualColumnFreeze",Q9=110;var K9=new WeakMap,X9=new WeakSet,q9=new WeakSet;class Z9 extends jF{constructor(){super(...arguments),B9(this,q9),B9(this,X9),L9(this,K9,{writable:!0,value:!1})}static get PLUGIN_KEY(){return G9}static get PLUGIN_PRIORITY(){return Q9}isEnabled(){return!!this.hot.getSettings()[G9]}enablePlugin(){this.enabled||(this.addHook("afterContextMenuDefaultOptions",(t=>z9(this,X9,J9).call(this,t))),this.addHook("beforeColumnMove",((t,e)=>z9(this,q9,$9).call(this,t,e))),super.enablePlugin())}disablePlugin(){j9(this,K9,!1),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}freezeColumn(t){const e=this.hot.getSettings(),n=e.fixedColumnsStart<this.hot.countCols()&&t>e.fixedColumnsStart-1;W9(this,K9)||j9(this,K9,!0),!1!==this.hot.runHooks("beforeColumnFreeze",t,n)&&(n&&(this.hot.columnIndexMapper.moveIndexes(t,e.fixedColumnsStart),e._fixedColumnsStart+=1),this.hot.runHooks("afterColumnFreeze",t,n))}unfreezeColumn(t){const e=this.hot.getSettings(),n=e.fixedColumnsStart>0&&t<=e.fixedColumnsStart-1;W9(this,K9)||j9(this,K9,!0),!1!==this.hot.runHooks("beforeColumnUnfreeze",t,n)&&(n&&(e._fixedColumnsStart-=1,this.hot.columnIndexMapper.moveIndexes(t,e.fixedColumnsStart)),this.hot.runHooks("afterColumnUnfreeze",t,n))}}function J9(t){t.items.push({name:"---------"},P9(this),_9(this))}function $9(t,e){if(W9(this,K9)){const n=this.hot.getSettings().fixedColumnsStart;if(e<n||t.some((t=>t<n)))return!1}}function t6(t,e,n){return e=e6(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function e6(t){var e=n6(t,"string");return"symbol"==typeof e?e:String(e)}function n6(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}const o6=0,i6=1,r6=2,s6="px";let a6=class{constructor(t){t6(this,"hot",void 0),t6(this,"_element",null),t6(this,"state",o6),t6(this,"inlineProperty",void 0),this.hot=t,this.inlineProperty=t.isRtl()?"right":"left"}appendTo(t){t.appendChild(this._element),this.state=r6}build(){this.state===o6&&(this._element=this.hot.rootDocument.createElement("div"),this.state=i6)}destroy(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=o6}isAppended(){return this.state===r6}isBuilt(){return this.state>=i6}setPosition(t,e){vb(t)&&(this._element.style.top=t+s6),vb(e)&&(this._element.style[this.inlineProperty]=e+s6)}getPosition(){const t=this._element.style;return{top:t.top?parseInt(t.top,10):0,start:t[this.inlineProperty]?parseInt(t[this.inlineProperty],10):0}}setSize(t,e){vb(t)&&(this._element.style.width=t+s6),vb(e)&&(this._element.style.height=e+s6)}getSize(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}setOffset(t,e){vb(t)&&(this._element.style.marginTop=t+s6),vb(e)&&(this._element.style[`margin${iw(this.inlineProperty)}`]=e+s6)}getOffset(){const t=this._element.style,e=`margin${iw(this.inlineProperty)}`;return{top:t.marginTop?parseInt(t.marginTop,10):0,start:t[e]?parseInt(t[e],10):0}}};const l6=a6,h6="ht__manualColumnMove--backlight";let c6=class extends l6{build(){super.build(),cA(this._element,h6)}};const u6=c6,d6="ht__manualColumnMove--guideline";let g6=class extends l6{build(){super.build(),cA(this._element,d6)}};const f6=g6;function m6(t,e){w6(t,e),e.add(t)}function p6(t,e,n){w6(t,e),e.set(t,n)}function w6(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function A6(t,e,n){var o=C6(t,e,"set");return v6(t,o,n),n}function v6(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function y6(t,e){var n=C6(t,e,"get");return b6(t,n)}function C6(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function b6(t,e){return e.get?e.get.call(t):e.value}function S6(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}aC.getSingleton().register("beforeColumnMove"),aC.getSingleton().register("afterColumnMove");const E6="manualColumnMove",R6=120,M6="ht__manualColumnMove",T6="show-ui",k6="on-moving--columns",x6="after-selection--columns";var I6=new WeakMap,O6=new WeakMap,H6=new WeakMap,D6=new WeakMap,N6=new WeakMap,P6=new WeakMap,_6=new WeakMap,B6=new WeakMap,L6=new WeakMap,V6=new WeakMap,W6=new WeakMap,F6=new WeakSet,j6=new WeakSet,U6=new WeakSet,Y6=new WeakSet,z6=new WeakSet,G6=new WeakSet;class Q6 extends jF{constructor(){super(...arguments),m6(this,G6),m6(this,z6),m6(this,Y6),m6(this,U6),m6(this,j6),m6(this,F6),p6(this,I6,{writable:!0,value:new u6(this.hot)}),p6(this,O6,{writable:!0,value:new f6(this.hot)}),p6(this,H6,{writable:!0,value:[]}),p6(this,D6,{writable:!0,value:0}),p6(this,N6,{writable:!0,value:!1}),p6(this,P6,{writable:!0,value:{}}),p6(this,_6,{writable:!0,value:void 0}),p6(this,B6,{writable:!0,value:void 0}),p6(this,L6,{writable:!0,value:void 0}),p6(this,V6,{writable:!0,value:void 0}),p6(this,W6,{writable:!0,value:void 0})}static get PLUGIN_KEY(){return E6}static get PLUGIN_PRIORITY(){return R6}isEnabled(){return!!this.hot.getSettings()[E6]}enablePlugin(){var t=this;this.enabled||(this.addHook("beforeOnCellMouseDown",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return S6(t,F6,K6).call(t,...n)})),this.addHook("beforeOnCellMouseOver",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return S6(t,U6,q6).call(t,...n)})),this.addHook("afterScrollVertically",(()=>S6(this,z6,J6).call(this))),this.addHook("afterLoadData",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return S6(t,G6,$6).call(t,...n)})),this.buildPluginUI(),this.registerEvents(),cA(this.hot.rootElement,M6),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),super.updatePlugin()}disablePlugin(){uA(this.hot.rootElement,M6),this.unregisterEvents(),y6(this,I6).destroy(),y6(this,O6).destroy(),super.disablePlugin()}moveColumn(t,e){return this.moveColumns([t],e)}moveColumns(t,e){const n=y6(this,_6),o=this.isMovePossible(t,e),i=this.hot.runHooks("beforeColumnMove",t,e,n,o);if(A6(this,_6,void 0),!1===i)return;o&&this.hot.columnIndexMapper.moveIndexes(t,e);const r=o&&this.isColumnOrderChanged(t,e);return this.hot.runHooks("afterColumnMove",t,e,n,o,r),r}dragColumn(t,e){return this.dragColumns([t],e)}dragColumns(t,e){const n=this.countFinalIndex(t,e);return A6(this,_6,e),this.moveColumns(t,n)}isMovePossible(t,e){const n=this.hot.columnIndexMapper.getNotTrimmedIndexesLength(),o=t.length+e>n,i=e<0,r=t.some((t=>t<0)),s=t.some((t=>t>=n));return!(o||i||r||s)}isColumnOrderChanged(t,e){return t.some(((t,n)=>t-n!==e))}countFinalIndex(t,e){const n=Sp(t,((t,n)=>(n<e&&(t+=1),t)),0);return e-n}getColumnsWidth(t,e){const n=this.hot.columnIndexMapper;let o=0;for(let i=t;i<=e;i+=1){const t=n.getRenderableFromVisualIndex(i);i<0?o+=this.hot.view._wt.wtViewport.getRowHeaderWidth()||0:null!==t&&(o+=this.hot.view._wt.wtTable.getStretchedColumnWidth(t)||0)}return o}moveBySettingsOrLoad(){const t=this.hot.getSettings()[E6];if(Array.isArray(t))this.moveColumns(t,0);else if(void 0!==t){const t=this.persistentStateLoad();t.length&&this.moveColumns(t,0)}}isFixedColumnsStart(t){return t<this.hot.getSettings().fixedColumnsStart}persistentStateSave(){this.hot.runHooks("persistentStateSave","manualColumnMove",this.hot.columnIndexMapper.getIndexesSequence())}persistentStateLoad(){const t={};return this.hot.runHooks("persistentStateLoad","manualColumnMove",t),t.value?t.value:[]}prepareColumnsToMoving(t,e){const n=[];return Cb(t,e,(t=>{n.push(t)})),n}refreshPositions(){const t=this.hot.view.getFirstFullyVisibleColumn();this.isFixedColumnsStart(y6(this,B6))&&t>0&&this.hot.scrollViewportTo({col:this.hot.columnIndexMapper.getNearestNotHiddenIndex(t-1,-1)});const e=this.hot.view._wt.wtTable,n=this.hot.view._wt.wtOverlays.scrollableElement,o="number"==typeof n.scrollX?n.scrollX:n.scrollLeft;let i=this.hot.view.THEAD.offsetLeft+this.getColumnsWidth(0,y6(this,B6)-1);const r=e.hider.offsetWidth,s=e.TBODY.offsetLeft,a=y6(this,I6).getOffset().start,l=y6(this,I6).getSize().width;let h=0,c=0;if(this.hot.isRtl()){const t=this.hot.rootWindow,e=IA(this.hot.rootElement),i=t.innerWidth-y6(this,L6)-e;c=t.innerWidth-y6(this,P6).eventPageX-i-(void 0===n.scrollX?o:0)}else c=y6(this,P6).eventPageX-(y6(this,L6)-(void 0===n.scrollX?o:0));if(y6(this,V6)&&(h=this.hot.view._wt.wtOverlays.inlineStartOverlay.clone.wtTable.getColumnHeader(-1).offsetWidth),this.isFixedColumnsStart(y6(this,B6))&&(i+=o),i+=h,y6(this,B6)<0)y6(this,W6)>0?y6(this,P6).col=0:y6(this,P6).col=t>0?t-1:t;else if(y6(this,P6).TD.offsetWidth/2+i<=c){const t=y6(this,B6)>=y6(this,D6)?y6(this,D6)-1:y6(this,B6);y6(this,P6).col=t+1,i+=y6(this,P6).TD.offsetWidth}else y6(this,P6).col=y6(this,B6);let u=c,d=i;c+l+a>=r?u=r-l-a:c+a<s+h&&(u=s+h+Math.abs(a)),i>=r-1?d=r-1:0===d?d=1:void 0!==n.scrollX&&y6(this,B6)<y6(this,W6)&&(d-=y6(this,L6)<=n.scrollX?y6(this,L6):0),y6(this,I6).setPosition(null,u),y6(this,O6).setPosition(null,d)}registerEvents(){const{documentElement:t}=this.hot.rootDocument;this.eventManager.addEventListener(t,"mousemove",(t=>S6(this,j6,X6).call(this,t))),this.eventManager.addEventListener(t,"mouseup",(()=>S6(this,Y6,Z6).call(this)))}unregisterEvents(){this.eventManager.clear()}buildPluginUI(){y6(this,I6).build(),y6(this,O6).build()}destroy(){y6(this,I6).destroy(),y6(this,O6).destroy(),super.destroy()}}function K6(t,e,n,o){const i=this.hot.view._wt.wtTable,r=this.hot.selection.isSelectedByColumnHeader(),s=this.hot.getSelectedRangeLast(),a=hA(t.target,"sortAction");if(!s||!r||y6(this,N6)||0!==t.button||a)return A6(this,N6,!1),y6(this,H6).length=0,void uA(this.hot.rootElement,[k6,T6]);const l=y6(this,O6).isBuilt()&&!y6(this,O6).isAppended(),h=y6(this,I6).isBuilt()&&!y6(this,I6).isAppended();l&&h&&(y6(this,O6).appendTo(i.hider),y6(this,I6).appendTo(i.hider));const{from:c,to:u}=s,d=Math.min(c.col,u.col),g=Math.max(c.col,u.col);if(e.row<0&&e.col>=d&&e.col<=g){o.column=!0,A6(this,N6,!0);const r=n.firstChild?Qy(t,n.firstChild).x:t.offsetX;y6(this,P6).eventPageX=t.pageX,A6(this,B6,e.col),y6(this,P6).TD=n,y6(this,P6).col=e.col,A6(this,H6,this.prepareColumnsToMoving(d,g)),A6(this,V6,!!this.hot.getSettings().rowHeaders),A6(this,D6,this.hot.countCols()),A6(this,W6,this.hot.getSettings().fixedColumnsStart),A6(this,L6,yA(this.hot.rootElement).left);const s=y6(this,V6)?-1:0,a=i.holder.scrollTop+i.getColumnHeaderHeight(0)+1,l=e.col<y6(this,W6),h=this.hot.view._wt.wtOverlays.inlineStartOverlay.getOverlayOffset(),c=Math.abs(r-(this.hot.isRtl()?n.offsetWidth:0)),u=this.getColumnsWidth(d,e.col-1)+c,f=this.getColumnsWidth(s,d-1)+(l?h:0)+u;y6(this,I6).setPosition(a,f),y6(this,I6).setSize(this.getColumnsWidth(d,g),i.hider.offsetHeight-a),y6(this,I6).setOffset(null,-u),cA(this.hot.rootElement,k6)}else uA(this.hot.rootElement,x6),A6(this,N6,!1),y6(this,H6).length=0}function X6(t){y6(this,N6)&&(y6(this,P6).eventPageX=t.pageX,this.refreshPositions())}function q6(t,e,n,o){!this.hot.getSelectedRangeLast()||!y6(this,N6)||(y6(this,H6).indexOf(e.col)>-1?uA(this.hot.rootElement,T6):cA(this.hot.rootElement,T6),o.row=!0,o.column=!0,o.cell=!0,A6(this,B6,e.col),y6(this,P6).TD=n)}function Z6(){const t=y6(this,P6).col,e=y6(this,H6).length;if(A6(this,B6,void 0),A6(this,N6,!1),uA(this.hot.rootElement,[k6,T6,x6]),this.hot.selection.isSelectedByColumnHeader()&&cA(this.hot.rootElement,x6),e<1||void 0===t)return;const n=y6(this,H6)[0],o=this.hot.toPhysicalColumn(n),i=this.dragColumns(y6(this,H6),t);if(y6(this,H6).length=0,!0===i){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize(!0);const t=this.hot.toVisualColumn(o),n=t+e-1;this.hot.selectColumns(t,n)}}function J6(){const t=this.hot.view._wt.wtTable,e=t.getColumnHeaderHeight(0)+1,n=t.holder.scrollTop,o=e+n;y6(this,I6).setPosition(o),y6(this,I6).setSize(null,t.hider.offsetHeight-o)}function $6(){this.moveBySettingsOrLoad()}function t5(t,e){n5(t,e),e.add(t)}function e5(t,e,n){n5(t,e),e.set(t,n)}function n5(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function o5(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function i5(t,e,n){var o=a5(t,e,"set");return r5(t,o,n),n}function r5(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function s5(t,e){var n=a5(t,e,"get");return l5(t,n)}function a5(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function l5(t,e){return e.get?e.get.call(t):e.value}const h5="manualColumnResize",c5=130,u5="manualColumnWidths";var d5=new WeakMap,g5=new WeakMap,f5=new WeakMap,m5=new WeakMap,p5=new WeakMap,w5=new WeakMap,A5=new WeakMap,v5=new WeakMap,y5=new WeakMap,C5=new WeakMap,b5=new WeakMap,S5=new WeakMap,E5=new WeakMap,R5=new WeakMap,M5=new WeakMap,T5=new WeakMap,k5=new WeakSet,x5=new WeakSet,I5=new WeakSet,O5=new WeakSet,H5=new WeakSet,D5=new WeakSet,N5=new WeakSet,P5=new WeakSet,_5=new WeakSet;class B5 extends jF{static get PLUGIN_KEY(){return h5}static get PLUGIN_PRIORITY(){return c5}constructor(t){super(t),t5(this,_5),t5(this,P5),t5(this,N5),t5(this,D5),t5(this,H5),t5(this,O5),t5(this,I5),t5(this,x5),t5(this,k5),e5(this,d5,{writable:!0,value:null}),e5(this,g5,{writable:!0,value:null}),e5(this,f5,{writable:!0,value:[]}),e5(this,m5,{writable:!0,value:null}),e5(this,p5,{writable:!0,value:null}),e5(this,w5,{writable:!0,value:null}),e5(this,A5,{writable:!0,value:null}),e5(this,v5,{writable:!0,value:null}),e5(this,y5,{writable:!0,value:this.hot.rootDocument.createElement("DIV")}),e5(this,C5,{writable:!0,value:this.hot.rootDocument.createElement("DIV")}),e5(this,b5,{writable:!0,value:null}),e5(this,S5,{writable:!0,value:!1}),e5(this,E5,{writable:!0,value:0}),e5(this,R5,{writable:!0,value:null}),e5(this,M5,{writable:!0,value:void 0}),e5(this,T5,{writable:!0,value:void 0}),cA(s5(this,y5),"manualColumnResizer"),cA(s5(this,C5),"manualColumnResizerGuide")}get inlineDir(){return this.hot.isRtl()?"right":"left"}isEnabled(){return this.hot.getSettings()[h5]}enablePlugin(){this.enabled||(i5(this,M5,new wI),s5(this,M5).addLocalHook("init",(()=>o5(this,k5,L5).call(this))),this.hot.columnIndexMapper.registerMap(this.pluginName,s5(this,M5)),this.addHook("modifyColWidth",((t,e)=>o5(this,N5,Y5).call(this,t,e))),this.addHook("beforeStretchingColumnWidth",((t,e)=>o5(this,P5,z5).call(this,t,e))),this.addHook("beforeColumnResize",((t,e,n)=>o5(this,_5,G5).call(this,t,e,n))),this.bindEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){i5(this,T5,s5(this,M5).getValues()),this.hot.columnIndexMapper.unregisterMap(this.pluginName),super.disablePlugin()}saveManualColumnWidths(){this.hot.runHooks("persistentStateSave",u5,s5(this,M5).getValues())}loadManualColumnWidths(){const t={};return this.hot.runHooks("persistentStateLoad",u5,t),t.value}setManualSize(t,e){const n=Math.max(e,20),o=this.hot.toPhysicalColumn(t);return s5(this,M5).setValueAtIndex(o,n),n}clearManualSize(t){const e=this.hot.toPhysicalColumn(t);s5(this,M5).setValueAtIndex(e,null)}setupHandlePosition(t){if(!t.parentNode)return;i5(this,d5,t);const{_wt:e}=this.hot.view,n=e.wtTable.getCoords(s5(this,d5)),o=n.col;if(o<0)return;const i=OA(s5(this,d5)),r=s5(this,d5).getBoundingClientRect(),s=o<e.getSetting("fixedColumnsStart");let a;s&&(a=e.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(s5(this,d5),n.row,n.col)),a||(a=e.wtOverlays.topOverlay.getRelativeCellPosition(s5(this,d5),n.row,n.col)),i5(this,g5,this.hot.columnIndexMapper.getVisualFromRenderableIndex(o)),i5(this,f5,[]);const l=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByColumnHeader();if(this.hot.selection.isSelected()&&l){const t=this.hot.getSelectedRange();Mp(t,(t=>{const e=t.getTopStartCorner().col,n=t.getBottomEndCorner().col;Cb(e,n,(t=>{s5(this,f5).includes(t)||s5(this,f5).push(t)}))}))}s5(this,f5).includes(s5(this,g5))||i5(this,f5,[s5(this,g5)]),i5(this,v5,a.start-6),i5(this,A5,parseInt(r.width,10)),s5(this,y5).style.top=`${a.top}px`,s5(this,y5).style[this.inlineDir]=`${s5(this,v5)+s5(this,A5)}px`,s5(this,y5).style.height=`${i}px`,this.hot.rootElement.appendChild(s5(this,y5))}refreshHandlePosition(){s5(this,y5).style[this.inlineDir]=`${s5(this,v5)+s5(this,m5)}px`}setupGuidePosition(){const t=parseInt(OA(s5(this,y5)),10),e=parseInt(s5(this,y5).style.top,10)+t,n=parseInt(this.hot.view.maximumVisibleElementHeight(0),10);cA(s5(this,y5),"active"),cA(s5(this,C5),"active"),s5(this,C5).style.top=`${e}px`,this.refreshGuidePosition(),s5(this,C5).style.height=n-t+"px",this.hot.rootElement.appendChild(s5(this,C5))}refreshGuidePosition(){s5(this,C5).style[this.inlineDir]=s5(this,y5).style[this.inlineDir]}hideHandleAndGuide(){uA(s5(this,y5),"active"),uA(s5(this,C5),"active")}checkIfColumnHeader(t){const e=nA(t,["THEAD"],this.hot.rootElement),{topOverlay:n,topInlineStartCornerOverlay:o}=this.hot.view._wt.wtOverlays;return[n.clone.wtTable.THEAD,o.clone.wtTable.THEAD].includes(e)}getClosestTHParent(t){return"TABLE"!==t.tagName?"TH"===t.tagName?t:this.getClosestTHParent(t.parentNode):null}afterMouseDownTimeout(){const t=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize(!0)},e=(e,n)=>{const o=this.hot.runHooks("beforeColumnResize",s5(this,p5),e,!0);void 0!==o&&i5(this,p5,o),"all"===this.hot.getSettings().stretchH?this.clearManualSize(e):this.setManualSize(e,s5(this,p5)),this.saveManualColumnWidths(),this.hot.runHooks("afterColumnResize",s5(this,p5),e,!0),n&&t()};s5(this,E5)>=2&&(s5(this,f5).length>1?(Mp(s5(this,f5),(t=>{e(t)})),t()):Mp(s5(this,f5),(t=>{e(t,!0)}))),i5(this,E5,0),i5(this,R5,null)}bindEvents(){const{rootWindow:t,rootElement:e}=this.hot;this.eventManager.addEventListener(e,"mouseover",(t=>o5(this,x5,V5).call(this,t))),this.eventManager.addEventListener(e,"mousedown",(t=>o5(this,I5,W5).call(this,t))),this.eventManager.addEventListener(t,"mousemove",(t=>o5(this,O5,F5).call(this,t))),this.eventManager.addEventListener(t,"mouseup",(()=>o5(this,H5,j5).call(this))),this.eventManager.addEventListener(s5(this,y5),"contextmenu",(()=>o5(this,D5,U5).call(this)))}destroy(){super.destroy()}}function L5(){const t=this.hot.getSettings()[h5],e=this.loadManualColumnWidths();"undefined"!=typeof e?this.hot.batchExecution((()=>{e.forEach(((t,e)=>{s5(this,M5).setValueAtIndex(e,t)}))}),!0):Array.isArray(t)?(this.hot.batchExecution((()=>{t.forEach(((t,e)=>{s5(this,M5).setValueAtIndex(e,t)}))}),!0),i5(this,T5,t)):!0===t&&Array.isArray(s5(this,T5))&&this.hot.batchExecution((()=>{s5(this,T5).forEach(((t,e)=>{s5(this,M5).setValueAtIndex(e,t)}))}),!0)}function V5(t){if(!JA(t.target)&&!0!==s5(this,S5)&&this.checkIfColumnHeader(t.target)){const e=this.getClosestTHParent(t.target);if(!e)return;const n=e.getAttribute("colspan");e&&(null===n||"1"===n)&&(s5(this,b5)||this.setupHandlePosition(e))}}function W5(t){hA(t.target,"manualColumnResizer")&&(this.setupHandlePosition(s5(this,d5)),this.setupGuidePosition(),i5(this,b5,!0),null===s5(this,R5)&&(i5(this,R5,setTimeout((()=>this.afterMouseDownTimeout()),500)),this.hot._registerTimeout(s5(this,R5))),i5(this,E5,s5(this,E5)+1),this.startX=t.pageX,i5(this,p5,s5(this,A5)))}function F5(t){if(s5(this,b5)){const e=(t.pageX-this.startX)*this.hot.getDirectionFactor();i5(this,m5,s5(this,A5)+e),Mp(s5(this,f5),(t=>{i5(this,p5,this.setManualSize(t,s5(this,m5)))})),this.refreshHandlePosition(),this.refreshGuidePosition()}}function j5(){const t=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize(!0)},e=(e,n)=>{this.hot.runHooks("beforeColumnResize",s5(this,p5),e,!1),n&&t(),this.saveManualColumnWidths(),this.hot.runHooks("afterColumnResize",s5(this,p5),e,!1)};s5(this,b5)&&(this.hideHandleAndGuide(),i5(this,b5,!1),s5(this,p5)!==s5(this,A5)&&(s5(this,f5).length>1?(Mp(s5(this,f5),(t=>{e(t)})),t()):Mp(s5(this,f5),(t=>{e(t,!0)}))),this.setupHandlePosition(s5(this,d5)))}function U5(){this.hideHandleAndGuide(),this.hot.rootElement.removeChild(s5(this,y5)),this.hot.rootElement.removeChild(s5(this,C5)),i5(this,b5,!1),i5(this,S5,!0),this.hot._registerImmediate((()=>{i5(this,S5,!1)}))}function Y5(t,e){let n=t;if(this.enabled){const t=this.hot.toPhysicalColumn(e),o=s5(this,M5).getValueAtIndex(t);this.hot.getSettings()[h5]&&o&&(n=o)}return n}function z5(t,e){let n=s5(this,M5).getValueAtIndex(e);return null===n&&(n=t),n}function G5(){this.hot.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked()}function Q5(t,e,n){return e=K5(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function K5(t){var e=X5(t,"string");return"symbol"==typeof e?e:String(e)}function X5(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}const q5=0,Z5=1,J5=2,$5="px";let t7=class{constructor(t){Q5(this,"hot",void 0),Q5(this,"_element",null),Q5(this,"state",q5),this.hot=t}appendTo(t){t.appendChild(this._element),this.state=J5}build(){this.state===q5&&(this._element=this.hot.rootDocument.createElement("div"),this.state=Z5)}destroy(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=q5}isAppended(){return this.state===J5}isBuilt(){return this.state>=Z5}setPosition(t,e){void 0!==t&&(this._element.style.top=t+$5),void 0!==e&&(this._element.style.left=e+$5)}getPosition(){return{top:this._element.style.top?parseInt(this._element.style.top,10):0,left:this._element.style.left?parseInt(this._element.style.left,10):0}}setSize(t,e){t&&(this._element.style.width=t+$5),e&&(this._element.style.height=e+$5)}getSize(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}setOffset(t,e){t&&(this._element.style.marginTop=t+$5),e&&(this._element.style.marginLeft=e+$5)}getOffset(){return{top:this._element.style.marginTop?parseInt(this._element.style.marginTop,10):0,left:this._element.style.marginLeft?parseInt(this._element.style.marginLeft,10):0}}};const e7=t7,n7="ht__manualRowMove--backlight";class o7 extends e7{build(){super.build(),cA(this._element,n7)}}const i7=o7,r7="ht__manualRowMove--guideline";class s7 extends e7{build(){super.build(),cA(this._element,r7)}}const a7=s7;function l7(t,e){c7(t,e),e.add(t)}function h7(t,e,n){c7(t,e),e.set(t,n)}function c7(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function u7(t,e,n){var o=f7(t,e,"set");return d7(t,o,n),n}function d7(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function g7(t,e){var n=f7(t,e,"get");return m7(t,n)}function f7(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function m7(t,e){return e.get?e.get.call(t):e.value}function p7(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}aC.getSingleton().register("beforeRowMove"),aC.getSingleton().register("afterRowMove");const w7="manualRowMove",A7=140,v7="ht__manualRowMove",y7="show-ui",C7="on-moving--rows",b7="after-selection--rows";var S7=new WeakMap,E7=new WeakMap,R7=new WeakMap,M7=new WeakMap,T7=new WeakMap,k7=new WeakMap,x7=new WeakSet,I7=new WeakSet,O7=new WeakSet,H7=new WeakSet,D7=new WeakSet,N7=new WeakSet;class P7 extends jF{constructor(){super(...arguments),l7(this,N7),l7(this,D7),l7(this,H7),l7(this,O7),l7(this,I7),l7(this,x7),h7(this,S7,{writable:!0,value:new i7(this.hot)}),h7(this,E7,{writable:!0,value:new a7(this.hot)}),h7(this,R7,{writable:!0,value:[]}),h7(this,M7,{writable:!0,value:void 0}),h7(this,T7,{writable:!0,value:{}}),h7(this,k7,{writable:!0,value:void 0})}static get PLUGIN_KEY(){return w7}static get PLUGIN_PRIORITY(){return A7}isEnabled(){return!!this.hot.getSettings()[w7]}enablePlugin(){var t=this;this.enabled||(this.addHook("beforeOnCellMouseDown",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return p7(t,x7,_7).call(t,...n)})),this.addHook("beforeOnCellMouseOver",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return p7(t,O7,L7).call(t,...n)})),this.addHook("afterScrollHorizontally",(()=>p7(this,D7,W7).call(this))),this.addHook("afterLoadData",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return p7(t,N7,F7).call(t,...n)})),this.buildPluginUI(),this.registerEvents(),cA(this.hot.rootElement,v7),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),super.updatePlugin()}disablePlugin(){uA(this.hot.rootElement,v7),this.unregisterEvents(),g7(this,S7).destroy(),g7(this,E7).destroy(),super.disablePlugin()}moveRow(t,e){return this.moveRows([t],e)}moveRows(t,e){const n=g7(this,k7),o=this.isMovePossible(t,e),i=this.hot.runHooks("beforeRowMove",t,e,n,o);if(u7(this,k7,void 0),!1===i)return;o&&this.hot.rowIndexMapper.moveIndexes(t,e);const r=o&&this.isRowOrderChanged(t,e);return this.hot.runHooks("afterRowMove",t,e,n,o,r),r}dragRow(t,e){return this.dragRows([t],e)}dragRows(t,e){const n=this.countFinalIndex(t,e);return u7(this,k7,e),this.moveRows(t,n)}isMovePossible(t,e){const n=this.hot.rowIndexMapper.getNotTrimmedIndexesLength(),o=t.length+e>n,i=e<0,r=t.some((t=>t<0)),s=t.some((t=>t>=n));return!(o||i||r||s)}isRowOrderChanged(t,e){return t.some(((t,n)=>t-n!==e))}countFinalIndex(t,e){const n=Sp(t,((t,n)=>(n<e&&(t+=1),t)),0);return e-n}getRowsHeight(t,e){const n=this.hot.rowIndexMapper;let o=0;for(let i=t;i<=e;i++){const t=n.getRenderableFromVisualIndex(i);null!==t&&(o+=this.hot.view._wt.wtTable.getRowHeight(t)||23)}return o}moveBySettingsOrLoad(){const t=this.hot.getSettings()[w7];if(Array.isArray(t))this.moveRows(t,0);else if(void 0!==t){const t=this.persistentStateLoad();t.length&&this.moveRows(t,0)}}isFixedRowTop(t){return t<this.hot.getSettings().fixedRowsTop}isFixedRowBottom(t){return t>this.hot.countRows()-1-this.hot.getSettings().fixedRowsBottom}persistentStateSave(){this.hot.runHooks("persistentStateSave","manualRowMove",this.hot.rowIndexMapper.getIndexesSequence())}persistentStateLoad(){const t={};return this.hot.runHooks("persistentStateLoad","manualRowMove",t),t.value?t.value:[]}prepareRowsToMoving(){const t=this.hot.getSelectedRangeLast(),e=[];if(!t)return e;const{from:n,to:o}=t,i=Math.min(n.row,o.row),r=Math.max(n.row,o.row);return Cb(i,r,(t=>{e.push(t)})),e}refreshPositions(){const t=g7(this,T7).coords,e=this.hot.view.getFirstFullyVisibleRow(),n=this.hot.view.getLastFullyVisibleRow(),o=this.hot.countRows();this.isFixedRowTop(t.row)&&e>0&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(e-1,-1)),this.isFixedRowBottom(t.row)&&n<o&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(n+1,1),void 0,!0);const i=this.hot.view._wt.wtTable,r=g7(this,T7).TD,s=this.hot.rootElement,a=yA(s),l=MA(s),h=i.holder.scrollTop,c=this.hot.rootWindow!==l?l.scrollTop:0,u=a.top-c,d=g7(this,T7).eventPageY-u+h,g=i.hider.offsetHeight,f=i.TBODY.offsetTop,m=g7(this,S7).getOffset().top,p=g7(this,S7).getSize().height,w=r.offsetHeight/2,A=r.offsetHeight;let v=this.hot.view.THEAD.offsetHeight+this.getRowsHeight(0,t.row-1);const y=d>=v+w;this.isFixedRowTop(t.row)&&(v+=this.hot.view._wt.wtOverlays.topOverlay.getOverlayOffset()),t.row<0?g7(this,T7).row=e>0?e-1:e:y?(g7(this,T7).row=t.row+1,v+=0===t.row?A-1:A):g7(this,T7).row=t.row;let C=d,b=v;d+p+m>=g?C=g-p-m:d+m<f&&(C=f+Math.abs(m)),v>=g-1&&(b=g-1),g7(this,S7).setPosition(C),g7(this,E7).setPosition(b)}registerEvents(){const{documentElement:t}=this.hot.rootDocument;this.eventManager.addEventListener(t,"mousemove",(t=>p7(this,I7,B7).call(this,t))),this.eventManager.addEventListener(t,"mouseup",(()=>p7(this,H7,V7).call(this)))}unregisterEvents(){this.eventManager.clear()}buildPluginUI(){g7(this,S7).build(),g7(this,E7).build()}destroy(){g7(this,S7).destroy(),g7(this,E7).destroy(),super.destroy()}}function _7(t,e,n,o){const{wtTable:i,wtViewport:r}=this.hot.view._wt,s=this.hot.selection.isSelectedByRowHeader(),a=this.hot.getSelectedRangeLast();if(!a||!s||g7(this,M7)||0!==t.button)return u7(this,M7,!1),g7(this,R7).length=0,void uA(this.hot.rootElement,[C7,y7]);const l=g7(this,E7).isBuilt()&&!g7(this,E7).isAppended(),h=g7(this,S7).isBuilt()&&!g7(this,S7).isAppended();l&&h&&(g7(this,E7).appendTo(i.hider),g7(this,S7).appendTo(i.hider));const{from:c,to:u}=a,d=Math.min(c.row,u.row),g=Math.max(c.row,u.row);if(e.col<0&&e.row>=d&&e.row<=g){o.row=!0,u7(this,M7,!0),g7(this,T7).eventPageY=t.pageY,g7(this,T7).coords=e,g7(this,T7).TD=n,u7(this,R7,this.prepareRowsToMoving());const s=i.holder.scrollLeft+r.getRowHeaderWidth(),a=this.getRowsHeight(d,e.row-1)+t.offsetY;g7(this,S7).setPosition(null,s),g7(this,S7).setSize(i.hider.offsetWidth-s,this.getRowsHeight(d,g)),g7(this,S7).setOffset(-a,null),cA(this.hot.rootElement,C7),this.refreshPositions()}else uA(this.hot.rootElement,b7),u7(this,M7,!1),g7(this,R7).length=0}function B7(t){g7(this,M7)&&(g7(this,T7).eventPageY=t.pageY,this.refreshPositions())}function L7(t,e,n,o){!this.hot.getSelectedRangeLast()||!g7(this,M7)||(g7(this,R7).indexOf(e.row)>-1?uA(this.hot.rootElement,y7):cA(this.hot.rootElement,y7),o.row=!0,o.column=!0,o.cell=!0,g7(this,T7).coords=e,g7(this,T7).TD=n)}function V7(){const t=g7(this,T7).row,e=g7(this,R7).length;if(u7(this,M7,!1),uA(this.hot.rootElement,[C7,y7,b7]),this.hot.selection.isSelectedByRowHeader()&&cA(this.hot.rootElement,b7),e<1||void 0===t)return;const n=g7(this,R7)[0],o=this.hot.toPhysicalRow(n),i=this.dragRows(g7(this,R7),t);if(g7(this,R7).length=0,!0===i){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize(!0);const t=this.hot.toVisualRow(o),n=t+e-1;this.hot.selectRows(t,n)}}function W7(){const t=this.hot.view._wt.wtTable,e=this.hot.view._wt.wtViewport.getRowHeaderWidth(),n=t.holder.scrollLeft,o=e+n;g7(this,S7).setPosition(null,o),g7(this,S7).setSize(t.hider.offsetWidth-o)}function F7(){this.moveBySettingsOrLoad()}function j7(t,e){Y7(t,e),e.add(t)}function U7(t,e,n){Y7(t,e),e.set(t,n)}function Y7(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function z7(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function G7(t,e,n){var o=X7(t,e,"set");return Q7(t,o,n),n}function Q7(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function K7(t,e){var n=X7(t,e,"get");return q7(t,n)}function X7(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function q7(t,e){return e.get?e.get.call(t):e.value}const Z7="manualRowResize",J7=30,$7="manualRowHeights";var ttt=new WeakMap,ett=new WeakMap,ntt=new WeakMap,ott=new WeakMap,itt=new WeakMap,rtt=new WeakMap,stt=new WeakMap,att=new WeakMap,ltt=new WeakMap,htt=new WeakMap,ctt=new WeakMap,utt=new WeakMap,dtt=new WeakMap,gtt=new WeakMap,ftt=new WeakMap,mtt=new WeakMap,ptt=new WeakSet,wtt=new WeakSet,Att=new WeakSet,vtt=new WeakSet,ytt=new WeakSet,Ctt=new WeakSet,btt=new WeakSet;class Stt extends jF{static get PLUGIN_KEY(){return Z7}static get PLUGIN_PRIORITY(){return J7}constructor(t){super(t),j7(this,btt),j7(this,Ctt),j7(this,ytt),j7(this,vtt),j7(this,Att),j7(this,wtt),j7(this,ptt),U7(this,ttt,{writable:!0,value:null}),U7(this,ett,{writable:!0,value:null}),U7(this,ntt,{writable:!0,value:[]}),U7(this,ott,{writable:!0,value:null}),U7(this,itt,{writable:!0,value:null}),U7(this,rtt,{writable:!0,value:null}),U7(this,stt,{writable:!0,value:null}),U7(this,att,{writable:!0,value:null}),U7(this,ltt,{writable:!0,value:this.hot.rootDocument.createElement("DIV")}),U7(this,htt,{writable:!0,value:this.hot.rootDocument.createElement("DIV")}),U7(this,ctt,{writable:!0,value:!1}),U7(this,utt,{writable:!0,value:!1}),U7(this,dtt,{writable:!0,value:0}),U7(this,gtt,{writable:!0,value:null}),U7(this,ftt,{writable:!0,value:void 0}),U7(this,mtt,{writable:!0,value:void 0}),cA(K7(this,ltt),"manualRowResizer"),cA(K7(this,htt),"manualRowResizerGuide")}get inlineDir(){return this.hot.isRtl()?"right":"left"}isEnabled(){return this.hot.getSettings()[Z7]}enablePlugin(){this.enabled||(G7(this,ftt,new wI),K7(this,ftt).addLocalHook("init",(()=>z7(this,btt,Itt).call(this))),this.hot.rowIndexMapper.registerMap(this.pluginName,K7(this,ftt)),this.addHook("modifyRowHeight",((t,e)=>z7(this,Ctt,xtt).call(this,t,e))),this.bindEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){G7(this,mtt,K7(this,ftt).getValues()),this.hot.rowIndexMapper.unregisterMap(this.pluginName),super.disablePlugin()}saveManualRowHeights(){this.hot.runHooks("persistentStateSave",$7,K7(this,ftt).getValues())}loadManualRowHeights(){const t={};return this.hot.runHooks("persistentStateLoad",$7,t),t.value}setManualSize(t,e){const n=this.hot.toPhysicalRow(t),o=Math.max(e,TE.DEFAULT_HEIGHT);return K7(this,ftt).setValueAtIndex(n,o),o}setupHandlePosition(t){G7(this,ttt,t);const{view:e}=this.hot,{_wt:n}=e,o=n.wtTable.getCoords(K7(this,ttt)),i=o.row;if(i<0)return;const r=IA(K7(this,ttt)),s=K7(this,ttt).getBoundingClientRect(),a=i<n.getSetting("fixedRowsTop"),l=i>=e.countNotHiddenRowIndexes(0,1)-n.getSetting("fixedRowsBottom");let h;a?h=n.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(K7(this,ttt),o.row,o.col):l&&(h=n.wtOverlays.bottomInlineStartCornerOverlay.getRelativeCellPosition(K7(this,ttt),o.row,o.col)),h||(h=n.wtOverlays.inlineStartOverlay.getRelativeCellPosition(K7(this,ttt),o.row,o.col)),G7(this,ett,this.hot.rowIndexMapper.getVisualFromRenderableIndex(i)),G7(this,ntt,[]);const c=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByRowHeader();if(this.hot.selection.isSelected()&&c){const t=this.hot.getSelectedRange();Mp(t,(t=>{const e=t.getTopStartCorner().row,n=t.getBottomStartCorner().row;Cb(e,n,(t=>{K7(this,ntt).includes(t)||K7(this,ntt).push(t)}))}))}K7(this,ntt).includes(K7(this,ett))||G7(this,ntt,[K7(this,ett)]),G7(this,att,h.top-6),G7(this,stt,parseInt(s.height,10)),K7(this,ltt).style.top=`${K7(this,att)+K7(this,stt)}px`,K7(this,ltt).style[this.inlineDir]=`${h.start}px`,K7(this,ltt).style.width=`${r}px`,this.hot.rootElement.appendChild(K7(this,ltt))}refreshHandlePosition(){K7(this,ltt).style.top=`${K7(this,att)+K7(this,ott)}px`}setupGuidePosition(){const t=parseInt(IA(K7(this,ltt)),10),e=parseInt(K7(this,ltt).style[this.inlineDir],10)+t,n=parseInt(this.hot.view.maximumVisibleElementWidth(0),10);cA(K7(this,ltt),"active"),cA(K7(this,htt),"active"),K7(this,htt).style.top=K7(this,ltt).style.top,K7(this,htt).style[this.inlineDir]=`${e}px`,K7(this,htt).style.width=n-t+"px",this.hot.rootElement.appendChild(K7(this,htt))}refreshGuidePosition(){K7(this,htt).style.top=K7(this,ltt).style.top}hideHandleAndGuide(){uA(K7(this,ltt),"active"),uA(K7(this,htt),"active")}checkIfRowHeader(t){const e=nA(t,["TBODY"],this.hot.rootElement),{inlineStartOverlay:n,topInlineStartCornerOverlay:o,bottomInlineStartCornerOverlay:i}=this.hot.view._wt.wtOverlays;return[n.clone.wtTable.TBODY,o.clone.wtTable.TBODY,i.clone.wtTable.TBODY].includes(e)}getClosestTHParent(t){return"TABLE"!==t.tagName?"TH"===t.tagName?t:this.getClosestTHParent(t.parentNode):null}getActualRowHeight(t){const e=this.hot.view._wt.wtTable.getRowHeight(t);return void 0!==e&&K7(this,itt)<e?e:K7(this,itt)}afterMouseDownTimeout(){const t=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize(!0)},e=(e,n)=>{const o=this.hot.runHooks("beforeRowResize",this.getActualRowHeight(e),e,!0);void 0!==o&&G7(this,itt,o),this.setManualSize(e,K7(this,itt)),this.hot.runHooks("afterRowResize",this.getActualRowHeight(e),e,!0),n&&t()};K7(this,dtt)>=2&&(K7(this,ntt).length>1?(Mp(K7(this,ntt),(t=>{e(t)})),t()):Mp(K7(this,ntt),(t=>{e(t,!0)}))),G7(this,dtt,0),G7(this,gtt,null)}bindEvents(){const{rootElement:t,rootWindow:e}=this.hot;this.eventManager.addEventListener(t,"mouseover",(t=>z7(this,ptt,Ett).call(this,t))),this.eventManager.addEventListener(t,"mousedown",(t=>z7(this,wtt,Rtt).call(this,t))),this.eventManager.addEventListener(e,"mousemove",(t=>z7(this,Att,Mtt).call(this,t))),this.eventManager.addEventListener(e,"mouseup",(()=>z7(this,vtt,Ttt).call(this))),this.eventManager.addEventListener(K7(this,ltt),"contextmenu",(()=>z7(this,ytt,ktt).call(this)))}destroy(){super.destroy()}}function Ett(t){if(!JA(t.target)&&!0!==K7(this,utt)&&this.checkIfRowHeader(t.target)){const e=this.getClosestTHParent(t.target);e&&(K7(this,ctt)||this.setupHandlePosition(e))}}function Rtt(t){hA(t.target,"manualRowResizer")&&(this.setupHandlePosition(K7(this,ttt)),this.setupGuidePosition(),G7(this,ctt,!0),null===K7(this,gtt)&&(G7(this,gtt,setTimeout((()=>this.afterMouseDownTimeout()),500)),this.hot._registerTimeout(K7(this,gtt))),G7(this,dtt,K7(this,dtt)+1),G7(this,rtt,t.pageY),G7(this,itt,K7(this,stt)))}function Mtt(t){K7(this,ctt)&&(G7(this,ott,K7(this,stt)+(t.pageY-K7(this,rtt))),Mp(K7(this,ntt),(t=>{G7(this,itt,this.setManualSize(t,K7(this,ott)))})),this.refreshHandlePosition(),this.refreshGuidePosition())}function Ttt(){const t=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize(!0)},e=(e,n)=>{this.hot.runHooks("beforeRowResize",this.getActualRowHeight(e),e,!1),n&&t(),this.saveManualRowHeights(),this.hot.runHooks("afterRowResize",this.getActualRowHeight(e),e,!1)};K7(this,ctt)&&(this.hideHandleAndGuide(),G7(this,ctt,!1),K7(this,itt)!==K7(this,stt)&&(K7(this,ntt).length>1?(Mp(K7(this,ntt),(t=>{e(t)})),t()):Mp(K7(this,ntt),(t=>{e(t,!0)}))),this.setupHandlePosition(K7(this,ttt)))}function ktt(){this.hideHandleAndGuide(),this.hot.rootElement.removeChild(K7(this,ltt)),this.hot.rootElement.removeChild(K7(this,htt)),G7(this,ctt,!1),G7(this,utt,!0),this.hot._registerImmediate((()=>{G7(this,utt,!1)}))}function xtt(t,e){let n=t;if(this.enabled){const t=this.hot.toPhysicalRow(e),o=K7(this,ftt).getValueAtIndex(t);this.hot.getSettings()[Z7]&&o&&(n=o)}return n}function Itt(){const t=this.hot.getSettings()[Z7],e=this.loadManualRowHeights();this.hot.batchExecution((()=>{"undefined"!=typeof e?e.forEach(((t,e)=>{K7(this,ftt).setValueAtIndex(e,t)})):Array.isArray(t)?(t.forEach(((t,e)=>{K7(this,ftt).setValueAtIndex(e,t)})),G7(this,mtt,t)):!0===t&&Array.isArray(K7(this,mtt))&&K7(this,mtt).forEach(((t,e)=>{K7(this,ftt).setValueAtIndex(e,t)}))}),!0)}function Ott(t,e,n){return e=Htt(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Htt(t){var e=Dtt(t,"string");return"symbol"==typeof e?e:String(e)}function Dtt(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class Ntt{constructor(t,e,n,o,i,r){Ott(this,"row",void 0),Ott(this,"col",void 0),Ott(this,"rowspan",void 0),Ott(this,"colspan",void 0),Ott(this,"removed",!1),Ott(this,"cellCoordsFactory",void 0),Ott(this,"cellRangeFactory",void 0),this.row=t,this.col=e,this.rowspan=n,this.colspan=o,this.cellCoordsFactory=i,this.cellRangeFactory=r}static NEGATIVE_VALUES_WARNING(t){return Lp`The merged cell declared with {row: ${t.row}, col: ${t.col},\x20
      rowspan: ${t.rowspan}, colspan: ${t.colspan}} contains negative values, which is\x20
      not supported. It will not be added to the collection.`}static IS_OUT_OF_BOUNDS_WARNING(t){return Lp`The merged cell declared at [${t.row}, ${t.col}] is positioned\x20
      (or positioned partially) outside of the table range. It was not added to the table, please fix your setup.`}static IS_SINGLE_CELL(t){return Lp`The merged cell declared at [${t.row}, ${t.col}] has both "rowspan"\x20
      and "colspan" declared as "1", which makes it a single cell. It cannot be added to the collection.`}static ZERO_SPAN_WARNING(t){return Lp`The merged cell declared at [${t.row}, ${t.col}] has "rowspan"\x20
      or "colspan" declared as "0", which is not supported. It cannot be added to the collection.`}static containsNegativeValues(t){return t.row<0||t.col<0||t.rowspan<0||t.colspan<0}static isSingleCell(t){return 1===t.colspan&&1===t.rowspan}static containsZeroSpan(t){return 0===t.colspan||0===t.rowspan}static isOutOfBounds(t,e,n){return t.row<0||t.col<0||t.row>=e||t.row+t.rowspan-1>=e||t.col>=n||t.col+t.colspan-1>=n}normalize(t){const e=t.countRows(),n=t.countCols();this.row<0?this.row=0:this.row>e-1&&(this.row=e-1),this.col<0?this.col=0:this.col>n-1&&(this.col=n-1),this.row+this.rowspan>e-1&&(this.rowspan=e-this.row),this.col+this.colspan>n-1&&(this.colspan=n-this.col)}includes(t,e){return this.row<=t&&this.col<=e&&this.row+this.rowspan-1>=t&&this.col+this.colspan-1>=e}includesHorizontally(t){return this.col<=t&&this.col+this.colspan-1>=t}includesVertically(t){return this.row<=t&&this.row+this.rowspan-1>=t}shift(t,e){const n=t[0]||t[1],o=e+Math.abs(t[0]||t[1])-1,i=t[0]?"colspan":"rowspan",r=t[0]?"col":"row",s=Math.min(e,o),a=Math.max(e,o),l=this[r],h=this[r]+this[i]-1;if(l>=e&&(this[r]+=n),n>0)e<=h&&e>l&&(this[i]+=n);else if(n<0){if(s<=l&&a>=h)return this.removed=!0,!1;if(l>=s&&l<=a){const t=a-l+1,e=Math.abs(n)-t;this[r]-=e+n,this[i]-=t}else if(l<=s&&h>=a)this[i]+=n;else if(l<=s&&h>=s&&h<a){const t=h-s+1;this[i]-=t}}return!0}isFarther(t,e){return!t||("down"===e?t.row+t.rowspan-1<this.row+this.rowspan-1:"up"===e?t.row>this.row:"right"===e?t.col+t.colspan-1<this.col+this.colspan-1:"left"===e?t.col>this.col:null)}getLastRow(){return this.row+this.rowspan-1}getLastColumn(){return this.col+this.colspan-1}getRange(){return this.cellRangeFactory(this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.getLastRow(),this.getLastColumn()))}}const Ptt=Ntt;function _tt(t,e,n,o){e?e.row===n&&e.col===o?(t.setAttribute("rowspan",e.rowspan.toString()),t.setAttribute("colspan",e.colspan.toString())):(t.removeAttribute("rowspan"),t.removeAttribute("colspan"),t.style.display="none"):(t.removeAttribute("rowspan"),t.removeAttribute("colspan"),t.style.display="")}function Btt(t,e,n){return e=Ltt(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ltt(t){var e=Vtt(t,"string");return"symbol"==typeof e?e:String(e)}function Vtt(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class Wtt{constructor(t){Btt(this,"plugin",void 0),Btt(this,"mergedCells",[]),Btt(this,"hot",void 0),this.plugin=t,this.hot=t.hot}static IS_OVERLAPPING_WARNING(t){return Lp`The merged cell declared at [${t.row}, ${t.col}], overlaps\x20
      with the other declared merged cell. The overlapping merged cell was not added to the table, please\x20
      fix your setup.`}get(t,e){const n=this.mergedCells;let o=!1;return Mp(n,(n=>!(n.row<=t&&n.row+n.rowspan-1>=t&&n.col<=e&&n.col+n.colspan-1>=e)||(o=n,!1))),o}getByRange(t){const e=this.mergedCells;let n=!1;return Mp(e,(e=>!(e.row<=t.from.row&&e.row+e.rowspan-1>=t.to.row&&e.col<=t.from.col&&e.col+e.colspan-1>=t.to.col)||(n=e,n))),n}getWithinRange(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=this.mergedCells,o=[];let i=t;if(!i.includesRange){const t=this.hot._createCellCoords(i.from.row,i.from.col),e=this.hot._createCellCoords(i.to.row,i.to.col);i=this.hot._createCellRange(t,t,e)}return Mp(n,(t=>{const n=this.hot._createCellCoords(t.row,t.col),r=this.hot._createCellCoords(t.row+t.rowspan-1,t.col+t.colspan-1),s=this.hot._createCellRange(n,n,r);e?i.overlaps(s)&&o.push(t):i.includesRange(s)&&o.push(t)})),!!o.length&&o}add(t){const e=this.mergedCells,n=t.row,o=t.col,i=t.rowspan,r=t.colspan,s=new Ptt(n,o,i,r,this.hot._createCellCoords,this.hot._createCellRange),a=this.get(n,o),l=this.isOverlapping(s);return a||l?(Xy(Wtt.IS_OVERLAPPING_WARNING(s)),!1):(this.hot&&s.normalize(this.hot),e.push(s),s)}remove(t,e){const n=this.mergedCells,o=this.get(t,e),i=o?this.mergedCells.indexOf(o):-1;return!(!o||-1===i)&&(n.splice(i,1),o)}clear(){const t=this.mergedCells,e=[],n=[];Mp(t,(t=>{const n=this.hot.getCell(t.row,t.col);n&&e.push([n,this.get(t.row,t.col),t.row,t.col])})),this.mergedCells.length=0,Mp(e,((t,o)=>{Cb(0,t.rowspan-1,(e=>{Cb(0,t.colspan-1,(o=>{if(0!==o||0!==e){const i=this.hot.getCell(t.row+e,t.col+o);i&&n.push([i,null,null,null])}}))})),e[o][1]=null})),Mp(e,(t=>{_tt(...t)})),Mp(n,(t=>{_tt(...t)}))}isOverlapping(t){const e=this.hot._createCellRange(this.hot._createCellCoords(0,0),this.hot._createCellCoords(t.row,t.col),this.hot._createCellCoords(t.row+t.rowspan-1,t.col+t.colspan-1));let n=!1;return Mp(this.mergedCells,(t=>!this.hot._createCellRange(this.hot._createCellCoords(0,0),this.hot._createCellCoords(t.row,t.col),this.hot._createCellCoords(t.row+t.rowspan-1,t.col+t.colspan-1)).overlaps(e)||(n=!0,!1))),n}isFirstRenderableMergedCell(t,e){const n=this.get(t,e);return n&&this.hot.rowIndexMapper.getNearestNotHiddenIndex(n.row,1)===t&&this.hot.columnIndexMapper.getNearestNotHiddenIndex(n.col,1)===e}getFirstRenderableCoords(t,e){const n=this.get(t,e);if(!n||this.isFirstRenderableMergedCell(t,e))return this.hot._createCellCoords(t,e);const o=this.hot.rowIndexMapper.getNearestNotHiddenIndex(n.row,1),i=this.hot.columnIndexMapper.getNearestNotHiddenIndex(n.col,1);return this.hot._createCellCoords(o,i)}shiftCollections(t,e,n){const o=[0,0];switch(t){case"right":o[0]+=n;break;case"left":o[0]-=n;break;case"down":o[1]+=n;break;case"up":o[1]-=n;break}Mp(this.mergedCells,(t=>{t.shift(o,e)})),bb(this.mergedCells.length-1,0,(t=>{const e=this.mergedCells[t];e&&e.removed&&this.mergedCells.splice(this.mergedCells.indexOf(e),1)}))}}const Ftt=Wtt;function jtt(t,e,n){return e=Utt(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Utt(t){var e=Ytt(t,"string");return"symbol"==typeof e?e:String(e)}function Ytt(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class ztt{constructor(t){jtt(this,"plugin",void 0),jtt(this,"mergedCellsCollection",void 0),jtt(this,"currentFillData",null),this.plugin=t,this.mergedCellsCollection=this.plugin.mergedCellsCollection}correctSelectionAreaSize(t){if(t[0]===t[2]&&t[1]===t[3]){const e=this.mergedCellsCollection.get(t[0],t[1]);e&&(t[2]=t[0]+e.rowspan-1,t[3]=t[1]+e.colspan-1)}}getDirection(t,e){let n=null;return n=e[0]===t[0]&&e[1]===t[1]&&e[3]===t[3]?"down":e[2]===t[2]&&e[1]===t[1]&&e[3]===t[3]?"up":e[1]===t[1]&&e[2]===t[2]?"right":"left",n}snapDragArea(t,e,n,o){const i=e.slice(0),r=this.getAutofillSize(t,e,n),[s,a,l,h]=t,c=["up","down"].indexOf(n)>-1?l-s+1:h-a+1,u=Math.floor(r/c)*c,d=r-u,g=this.getFarthestCollection(t,e,n,o);if(g)if("down"===n){const t=g.row+g.rowspan-s-d;i[2]+t>=this.plugin.hot.countRows()?i[2]-=d:i[2]+=d?t:0}else if("right"===n){const t=g.col+g.colspan-a-d;i[3]+t>=this.plugin.hot.countCols()?i[3]-=d:i[3]+=d?t:0}else if("up"===n){const t=l-d-g.row+1;i[0]+t<0?i[0]+=d:i[0]-=d?t:0}else if("left"===n){const t=h-d-g.col+1;i[1]+t<0?i[1]+=d:i[1]-=d?t:0}return this.updateCurrentFillCache({baseArea:t,dragDirection:n,foundMergedCells:o,fillSize:r,dragArea:i,cycleLength:c}),i}updateCurrentFillCache(t){this.currentFillData||(this.currentFillData={}),Kv(this.currentFillData,t)}getAutofillSize(t,e,n){const[o,i,r,s]=t,[a,l,h,c]=e;switch(n){case"up":return o-a;case"down":return h-r;case"left":return i-l;case"right":return c-s;default:return null}}getDragArea(t,e,n){const[o,i,r,s]=t,[a,l,h,c]=e;switch(n){case"up":return[a,l,o-1,s];case"down":return[r+1,i,h,s];case"left":return[a,l,r,i-1];case"right":return[o,s+1,h,c];default:return null}}getFarthestCollection(t,e,n,o){const[i,r,s,a]=t,l=["up","down"].indexOf(n)>-1,h=l?s:a,c=l?i:r,u=this.getAutofillSize(t,e,n),d=l?s-i+1:a-r+1,g=Math.floor(u/d)*d,f=u-g;let m=null,p=null,w=null;switch(n){case"up":m="includesVertically",w=h-f+1;break;case"left":m="includesHorizontally",w=h-f+1;break;case"down":m="includesVertically",w=c+f-1;break;case"right":m="includesHorizontally",w=c+f-1;break}return Mp(o,(t=>{t[m](w)&&t.isFarther(p,n)&&(p=t)})),p}recreateAfterDataPopulation(t){if(!this.currentFillData)return;const e=this.getRangeFromChanges(t),n=this.currentFillData.foundMergedCells,o=this.currentFillData.dragDirection,i=(t,n)=>{switch(o){case"up":return t.row-n>=e.from.row;case"down":return t.row+t.rowspan-1+n<=e.to.row;case"left":return t.col-n>=e.from.column;case"right":return t.col+t.colspan-1+n<=e.to.column;default:return null}};let r=0,s=null,a=1;do{for(let t=0;t<n.length;t+=1){if(s=n[t],r=a*this.currentFillData.cycleLength,i(s,r))switch(o){case"up":this.plugin.mergedCellsCollection.add({row:s.row-r,rowspan:s.rowspan,col:s.col,colspan:s.colspan});break;case"down":this.plugin.mergedCellsCollection.add({row:s.row+r,rowspan:s.rowspan,col:s.col,colspan:s.colspan});break;case"left":this.plugin.mergedCellsCollection.add({row:s.row,rowspan:s.rowspan,col:s.col-r,colspan:s.colspan});break;case"right":this.plugin.mergedCellsCollection.add({row:s.row,rowspan:s.rowspan,col:s.col+r,colspan:s.colspan});break}t===n.length-1&&(a+=1)}}while(i(s,r));this.currentFillData=null,this.plugin.hot.render(),n.length>0&&this.plugin.ifChromeForceRepaint()}getRangeFromChanges(t){const e={min:null,max:null},n={min:null,max:null};return Mp(t,(t=>{const o=t[0],i=this.plugin.hot.propToCol(t[1]);(null===e.min||o<e.min)&&(e.min=o),(null===e.max||o>e.max)&&(e.max=o),(null===n.min||i<n.min)&&(n.min=i),(null===n.max||i>n.max)&&(n.max=i)})),{from:{row:e.min,column:n.min},to:{row:e.max,column:n.max}}}dragAreaOverlapsCollections(t,e,n){const o=this.getDragArea(t,e,n),[i,r,s,a]=o,l=this.plugin.hot._createCellCoords(i,r),h=this.plugin.hot._createCellCoords(s,a),c=this.plugin.hot._createCellRange(l,l,h);return!!this.mergedCellsCollection.getWithinRange(c,!0)}}const Gtt=ztt;function Qtt(t,e,n){return e=Ktt(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ktt(t){var e=Xtt(t,"string");return"symbol"==typeof e?e:String(e)}function Xtt(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class qtt{constructor(t){Qtt(this,"plugin",void 0),Qtt(this,"hot",void 0),Qtt(this,"fullySelectedMergedCellClassName","fullySelectedMergedCell"),this.plugin=t,this.hot=t.hot}snapDelta(t,e,n){const o=e.to,i=o.row+t.row,r=o.col+t.col;t.row?this.jumpOverMergedCell(t,n,i):t.col&&this.jumpOverMergedCell(t,n,r)}jumpOverMergedCell(t,e,n){let o=t.row||t.col,i=null,r=null,s=null;t.row?(i=e.includesVertically(n),r=e.row,s=e.getLastRow()):t.col&&(i=e.includesHorizontally(n),r=e.col,s=e.getLastColumn()),0!==o&&(o>0?i&&n!==r&&(o+=s-n+1):i&&n!==s&&(o-=n-r+1),t.row?t.row=o:t.col&&(t.col=o))}getUpdatedSelectionRange(t,e){return this.hot._createCellRange(t.highlight,t.from,this.hot._createCellCoords(t.to.row+e.row,t.to.col+e.col))}getSelectedMergedCellClassName(t,e,n,o){const i=Math.min(n[0],n[2]),r=Math.min(n[1],n[3]),s=Math.max(n[0],n[2]),a=Math.max(n[1],n[3]);if(void 0===o||!this.plugin.mergedCellsCollection.isFirstRenderableMergedCell(t,e))return;const l=this.plugin.mergedCellsCollection.get(t,e);if(!l)return;const h=l.getLastRow(),c=l.getLastColumn();return i<=l.row&&r<=l.col&&s>=h&&a>=c?`${this.fullySelectedMergedCellClassName}-${o}`:this.plugin.selectionCalculations.isMergeCellFullySelected(l,this.plugin.hot.getSelectedRange())?`${this.fullySelectedMergedCellClassName}-multiple`:void 0}isMergeCellFullySelected(t,e){const n=[];if(!e||!t)return!1;for(let o=0;o<t.rowspan;o+=1)for(let e=0;e<t.colspan;e+=1)n.push(this.hot._createCellCoords(t.row+o,t.col+e));for(let o=0;o<n.length;o+=1){const t=[];for(let i=0;i<e.length;i+=1)t[i]=e[i].includes(n[o]);if(!t.includes(!0))return!1}return!0}getSelectedMergedCellClassNameToRemove(){const t=[];for(let e=0;e<=7;e+=1)t.push(`${this.fullySelectedMergedCellClassName}-${e}`);return t.push(`${this.fullySelectedMergedCellClassName}-multiple`),t}}const Ztt=qtt;function Jtt(t){return{key:"mergeCells",name(){const e=this.getSelectedLast();if(e){const n=t.mergedCellsCollection.get(e[0],e[1]);if(n.row===e[0]&&n.col===e[1]&&n.row+n.rowspan-1===e[2]&&n.col+n.colspan-1===e[3])return this.getTranslatedPhrase(zO)}return this.getTranslatedPhrase(YO)},callback(){t.toggleMergeOnSelection()},disabled(){const t=this.getSelectedLast();return!t||(Ptt.isSingleCell({row:t[0],col:t[1],rowspan:t[2]-t[0]+1,colspan:t[3]-t[1]+1})||this.selection.isSelectedByCorner())},hidden:!1}}function $tt(t,e){eet(t,e),e.add(t)}function tet(t,e,n){eet(t,e),e.set(t,n)}function eet(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function net(t,e,n){return e=oet(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function oet(t){var e=iet(t,"string");return"symbol"==typeof e?e:String(e)}function iet(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function ret(t,e,n){var o=het(t,e,"set");return set(t,o,n),n}function set(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function aet(t,e){var n=het(t,e,"get");return cet(t,n)}function het(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function cet(t,e){return e.get?e.get.call(t):e.value}function uet(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}aC.getSingleton().register("beforeMergeCells"),aC.getSingleton().register("afterMergeCells"),aC.getSingleton().register("beforeUnmergeCells"),aC.getSingleton().register("afterUnmergeCells");const det="mergeCells",get=150,fet=det;var met=new WeakMap,pet=new WeakSet,wet=new WeakSet,Aet=new WeakSet,vet=new WeakSet,yet=new WeakSet,Cet=new WeakSet,bet=new WeakSet,Eet=new WeakSet,Ret=new WeakSet,Met=new WeakSet,Tet=new WeakSet,ket=new WeakSet,xet=new WeakSet,Iet=new WeakSet,Oet=new WeakSet,Het=new WeakSet,Det=new WeakSet,Net=new WeakSet,Pet=new WeakSet,_et=new WeakSet,Bet=new WeakSet,Let=new WeakSet;class Vet extends jF{constructor(){super(...arguments),$tt(this,Let),$tt(this,Bet),$tt(this,_et),$tt(this,Pet),$tt(this,Net),$tt(this,Det),$tt(this,Het),$tt(this,Oet),$tt(this,Iet),$tt(this,xet),$tt(this,ket),$tt(this,Tet),$tt(this,Met),$tt(this,Ret),$tt(this,Eet),$tt(this,bet),$tt(this,Cet),$tt(this,yet),$tt(this,vet),$tt(this,Aet),$tt(this,wet),$tt(this,pet),net(this,"mergedCellsCollection",null),net(this,"autofillCalculations",null),net(this,"selectionCalculations",null),tet(this,met,{writable:!0,value:null})}static get PLUGIN_KEY(){return det}static get PLUGIN_PRIORITY(){return get}isEnabled(){return!!this.hot.getSettings()[det]}enablePlugin(){var t=this;this.enabled||(this.mergedCellsCollection=new Ftt(this),this.autofillCalculations=new Gtt(this),this.selectionCalculations=new Ztt(this),this.addHook("afterInit",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return uet(t,pet,Wet).call(t,...n)})),this.addHook("modifyTransformStart",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return uet(t,Aet,jet).call(t,...n)})),this.addHook("afterModifyTransformStart",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return uet(t,_et,rnt).call(t,...n)})),this.addHook("modifyTransformEnd",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return uet(t,vet,Uet).call(t,...n)})),this.addHook("modifyGetCellCoords",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return uet(t,yet,Yet).call(t,...n)})),this.addHook("beforeSetRangeStart",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return uet(t,Eet,Qet).call(t,...n)})),this.addHook("beforeSetRangeStartOnly",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return uet(t,Eet,Qet).call(t,...n)})),this.addHook("beforeSetRangeEnd",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return uet(t,Ret,Ket).call(t,...n)})),this.addHook("afterIsMultipleSelection",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return uet(t,wet,Fet).call(t,...n)})),this.addHook("afterRenderer",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return uet(t,bet,Get).call(t,...n)})),this.addHook("afterContextMenuDefaultOptions",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return uet(t,Cet,zet).call(t,...n)})),this.addHook("afterGetCellMeta",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return uet(t,Met,Xet).call(t,...n)})),this.addHook("afterViewportRowCalculatorOverride",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return uet(t,Tet,qet).call(t,...n)})),this.addHook("afterViewportColumnCalculatorOverride",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return uet(t,ket,Zet).call(t,...n)})),this.addHook("modifyAutofillRange",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return uet(t,xet,Jet).call(t,...n)})),this.addHook("afterCreateCol",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return uet(t,Iet,$et).call(t,...n)})),this.addHook("afterRemoveCol",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return uet(t,Oet,tnt).call(t,...n)})),this.addHook("afterCreateRow",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return uet(t,Het,ent).call(t,...n)})),this.addHook("afterRemoveRow",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return uet(t,Det,nnt).call(t,...n)})),this.addHook("afterChange",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return uet(t,Net,ont).call(t,...n)})),this.addHook("beforeDrawBorders",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return uet(t,Pet,int).call(t,...n)})),this.addHook("afterDrawSelection",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return uet(t,Bet,snt).call(t,...n)})),this.addHook("beforeRemoveCellClassNames",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return uet(t,Let,ant).call(t,...n)})),this.addHook("beforeUndoStackChange",((t,e)=>{if("MergeCells"===e)return!1})),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){this.clearCollections(),this.unregisterShortcuts(),this.hot.render(),super.disablePlugin()}updatePlugin(){const t=this.hot.getSettings()[det];this.disablePlugin(),this.enablePlugin(),this.generateFromSettings(t),super.updatePlugin()}ifChromeForceRepaint(){if(!Cy())return;const t=[];let e=[];this.mergedCellsCollection.mergedCells.forEach((t=>{const{row:n,rowspan:o}=t;for(let i=n+1;i<n+o;i++)e.push(i)})),e=[...new Set(e)],e.forEach((e=>{const n=this.hot.rowIndexMapper.getRenderableFromVisualIndex(e);this.hot.view._wt.wtOverlays.getOverlays(!0).map((t=>"master"===(null==t?void 0:t.name)?t:t.clone.wtTable)).forEach((e=>{const o=e.getRow(n);o&&(o.style.background=TA(o,"backgroundColor").replace(")",", 0.99)"),t.push(o))}))})),this.hot._registerTimeout((()=>{t.forEach((t=>{t.style.background=TA(t,"backgroundColor").replace(", 0.99)",")")}))}),1)}validateSetting(t){let e=!0;return!!t&&(Ptt.containsNegativeValues(t)?(Xy(Ptt.NEGATIVE_VALUES_WARNING(t)),e=!1):Ptt.isOutOfBounds(t,this.hot.countRows(),this.hot.countCols())?(Xy(Ptt.IS_OUT_OF_BOUNDS_WARNING(t)),e=!1):Ptt.isSingleCell(t)?(Xy(Ptt.IS_SINGLE_CELL(t)),e=!1):Ptt.containsZeroSpan(t)&&(Xy(Ptt.ZERO_SPAN_WARNING(t)),e=!1),e)}generateFromSettings(t){if(Array.isArray(t)){const e=[];if(Mp(t,(t=>{if(!this.validateSetting(t))return;const n=this.hot._createCellCoords(t.row,t.col),o=this.hot._createCellCoords(t.row+t.rowspan-1,t.col+t.colspan-1),i=this.hot._createCellRange(n,n,o);this.mergeRange(i,!0,!0),Cb(t.row,t.row+t.rowspan-1,(n=>{Cb(t.col,t.col+t.colspan-1,(o=>{n===t.row&&o===t.col||e.push([n,o,null])}))}))})),0===e.length)return;this.hot.setDataAtCell(e)}}clearCollections(){this.mergedCellsCollection.clear()}canMergeRange(t){return!!(arguments.length>1&&void 0!==arguments[1]&&arguments[1])||this.validateSetting(t)}toggleMergeOnSelection(){const t=this.hot.getSelectedRangeLast();if(!t)return;t.setDirection(this.hot.isRtl()?"NE-SW":"NW-SE");const{from:e,to:n}=t;this.toggleMerge(t),this.hot.selectCell(e.row,e.col,n.row,n.col,!1)}mergeSelection(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.hot.getSelectedRangeLast();if(!t)return;t.setDirection(this.hot.isRtl()?"NE-SW":"NW-SE");const{from:e,to:n}=t;this.unmergeRange(t,!0),this.mergeRange(t),this.hot.selectCell(e.row,e.col,n.row,n.col,!1)}unmergeSelection(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.hot.getSelectedRangeLast();if(!t)return;const{from:e,to:n}=t;this.unmergeRange(t,!0),this.hot.selectCell(e.row,e.col,n.row,n.col,!1)}mergeRange(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const o=t.getTopStartCorner(),i=t.getBottomEndCorner(),r={row:o.row,col:o.col,rowspan:i.row-o.row+1,colspan:i.col-o.col+1},s=[];let a=null;return!!this.canMergeRange(r,e)&&(this.hot.runHooks("beforeMergeCells",t,e),Cb(0,r.rowspan-1,(t=>{Cb(0,r.colspan-1,(e=>{let n=null;s[t]||(s[t]=[]),0===t&&0===e?n=this.hot.getSourceDataAtCell(this.hot.toPhysicalRow(r.row),this.hot.toPhysicalColumn(r.col)):this.hot.setCellMeta(r.row+t,r.col+e,"hidden",!0),s[t][e]=n}))})),this.hot.setCellMeta(r.row,r.col,"spanned",!0),!this.mergedCellsCollection.add(r)||(n?a=[r.row,r.col,s]:this.hot.populateFromArray(r.row,r.col,s,void 0,void 0,this.pluginName),e||this.ifChromeForceRepaint(),this.hot.runHooks("afterMergeCells",t,r,e),a))}unmergeRange(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=this.mergedCellsCollection.getWithinRange(t);n&&(this.hot.runHooks("beforeUnmergeCells",t,e),Mp(n,(t=>{this.mergedCellsCollection.remove(t.row,t.col),Cb(0,t.rowspan-1,(e=>{Cb(0,t.colspan-1,(n=>{this.hot.removeCellMeta(t.row+e,t.col+n,"hidden"),this.hot.removeCellMeta(t.row+e,t.col+n,"copyable")}))})),this.hot.removeCellMeta(t.row,t.col,"spanned")})),this.hot.runHooks("afterUnmergeCells",t,e),this.hot.render())}toggleMerge(t){const e=this.mergedCellsCollection.get(t.from.row,t.from.col);e.row===t.from.row&&e.col===t.from.col&&e.row+e.rowspan-1===t.to.row&&e.col+e.colspan-1===t.to.col?this.unmergeRange(t):this.mergeSelection(t)}merge(t,e,n,o){const i=this.hot._createCellCoords(t,e),r=this.hot._createCellCoords(n,o);this.mergeRange(this.hot._createCellRange(i,i,r))}unmerge(t,e,n,o){const i=this.hot._createCellCoords(t,e),r=this.hot._createCellCoords(n,o);this.unmergeRange(this.hot._createCellRange(i,i,r))}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Control","m"]],callback:()=>{const t=this.hot.getSelectedRangeLast();t&&!t.isSingleHeader()&&(this.toggleMerge(t),this.hot.render())},runOnlyIf:t=>!t.altKey,group:fet})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(fet)}modifyViewportRowStart(t,e){const n=this.hot.rowIndexMapper,o=n.getVisualFromRenderableIndex(t.startRow);for(let i=0;i<e;i+=1){const r=this.mergedCellsCollection.get(o,i);if(ty(r)){const o=n.getRenderableFromVisualIndex(n.getNearestNotHiddenIndex(r.row,1));if(o<t.startRow)return t.startRow=o,void this.modifyViewportRowStart(t,e)}}}modifyViewportRowEnd(t,e){const n=this.hot.rowIndexMapper,o=n.getVisualFromRenderableIndex(t.endRow);for(let i=0;i<e;i+=1){const r=this.mergedCellsCollection.get(o,i);if(ty(r)){const o=r.row+r.rowspan-1,i=n.getRenderableFromVisualIndex(n.getNearestNotHiddenIndex(o,-1));if(i>t.endRow)return t.endRow=i,void this.modifyViewportRowEnd(t,e)}}}modifyViewportColumnStart(t,e){const n=this.hot.columnIndexMapper,o=n.getVisualFromRenderableIndex(t.startColumn);for(let i=0;i<e;i+=1){const r=this.mergedCellsCollection.get(i,o);if(ty(r)){const o=n.getRenderableFromVisualIndex(n.getNearestNotHiddenIndex(r.col,1));if(o<t.startColumn)return t.startColumn=o,void this.modifyViewportColumnStart(t,e)}}}modifyViewportColumnEnd(t,e){const n=this.hot.columnIndexMapper,o=n.getVisualFromRenderableIndex(t.endColumn);for(let i=0;i<e;i+=1){const r=this.mergedCellsCollection.get(i,o);if(ty(r)){const o=r.col+r.colspan-1,i=n.getRenderableFromVisualIndex(n.getNearestNotHiddenIndex(o,-1));if(i>t.endColumn)return t.endColumn=i,void this.modifyViewportColumnEnd(t,e)}}}translateMergedCellToRenderable(t,e,n,o){const{rowIndexMapper:i,columnIndexMapper:r}=this.hot;let s,a;s=0===e?i.getNearestNotHiddenIndex(t,1):i.getNearestNotHiddenIndex(t+e-1,-1),a=0===o?r.getNearestNotHiddenIndex(n,1):r.getNearestNotHiddenIndex(n+o-1,-1);const l=t>=0?i.getRenderableFromVisualIndex(s):t,h=n>=0?r.getRenderableFromVisualIndex(a):n;return[l,h]}}function Wet(){this.generateFromSettings(this.hot.getSettings()[det]),this.hot.render()}function Fet(t){if(t){const t=this.mergedCellsCollection.mergedCells,e=this.hot.getSelectedRangeLast();for(let n=0;n<t.length;n+=1)if(e.from.row===t[n].row&&e.from.col===t[n].col&&e.to.row===t[n].row+t[n].rowspan-1&&e.to.col===t[n].col+t[n].colspan-1)return!1}return t}function jet(t){const e=this.hot.getSelectedRangeLast();let n={row:t.row,col:t.col},o=null;const i=this.hot._createCellCoords(e.highlight.row,e.highlight.col),r=this.mergedCellsCollection.get(i.row,i.col);if(aet(this,met)||ret(this,met,this.hot._createCellCoords(null,null)),r){const e=this.hot._createCellCoords(r.row,r.col),o=this.hot._createCellCoords(r.row+r.rowspan-1,r.col+r.colspan-1);this.hot._createCellRange(e,e,o).includes(aet(this,met))||ret(this,met,this.hot._createCellCoords(null,null)),n.row=aet(this,met).row?aet(this,met).row-i.row:n.row,n.col=aet(this,met).col?aet(this,met).col-i.col:n.col,t.row>0?n.row=r.row+r.rowspan-1-i.row+t.row:t.row<0&&(n.row=i.row-r.row+t.row),t.col>0?n.col=r.col+r.colspan-1-i.col+t.col:t.col<0&&(n.col=i.col-r.col+t.col)}o=this.hot._createCellCoords(e.highlight.row+n.row,e.highlight.col+n.col);const s=this.mergedCellsCollection.get(o.row,o.col);if(s){const t=this.mergedCellsCollection.getFirstRenderableCoords(s.row,s.col);ret(this,met,o),n={row:t.row-i.row,col:t.col-i.col}}0!==n.row&&(t.row=n.row),0!==n.col&&(t.col=n.col)}function Uet(t){const e=this.hot.getSelectedRangeLast(),n=Zv(t),o=this.selectionCalculations.getUpdatedSelectionRange(e,t);let i=Zv(n);const r=this.mergedCellsCollection.getWithinRange(o,!0);do{i=Zv(n),this.selectionCalculations.getUpdatedSelectionRange(e,n),Mp(r,(t=>{this.selectionCalculations.snapDelta(n,e,t)}))}while(n.row!==i.row||n.col!==i.col);t.row=n.row,t.col=n.col}function Yet(t,e){if(t<0||e<0)return;const n=this.mergedCellsCollection.get(t,e);if(!n)return;const{row:o,col:i,colspan:r,rowspan:s}=n;return[o,i,o+s-1,i+r-1]}function zet(t){t.items.push({name:"---------"},Jtt(this))}function Get(t,e,n){const o=this.mergedCellsCollection.get(e,n),i=ty(o)?Zv(o):void 0;if(ty(i)){const{rowIndexMapper:t,columnIndexMapper:o}=this.hot,{row:r,col:s,colspan:a,rowspan:l}=i,[h,c]=this.translateMergedCellToRenderable(r,l,s,a),u=t.getRenderableFromVisualIndex(e),d=o.getRenderableFromVisualIndex(n),g=h-u+1,f=c-d+1;i.row=t.getNearestNotHiddenIndex(i.row,1),i.col=o.getNearestNotHiddenIndex(i.col,1),i.rowspan=Math.min(i.rowspan,g),i.colspan=Math.min(i.colspan,f)}_tt(t,i,e,n)}function Qet(t){if(this.mergedCellsCollection.isFirstRenderableMergedCell(t.row,t.col)){const e=this.mergedCellsCollection.get(t.row,t.col);[t.row,t.col]=[e.row,e.col]}}function Ket(t){const e=this.hot.getSelectedRangeLast();e.highlight=this.hot._createCellCoords(e.highlight.row,e.highlight.col),e.to=t;let n=!1;if(!this.hot.selection.isSelectedByColumnHeader()&&!this.hot.selection.isSelectedByRowHeader())do{n=!1;for(let o=0;o<this.mergedCellsCollection.mergedCells.length;o+=1){const i=this.mergedCellsCollection.mergedCells[o].getRange();e.expandByRange(i)&&(t.row=e.to.row,t.col=e.to.col,n=!0)}}while(n)}function Xet(t,e,n){const o=this.mergedCellsCollection.get(t,e);o&&(o.row!==t||o.col!==e?n.copyable=!1:(n.rowspan=o.rowspan,n.colspan=o.colspan))}function qet(t){const e=this.hot.countCols();this.modifyViewportRowStart(t,e),this.modifyViewportRowEnd(t,e)}function Zet(t){const e=this.hot.countRows();this.modifyViewportColumnStart(t,e),this.modifyViewportColumnEnd(t,e)}function Jet(t,e){this.autofillCalculations.correctSelectionAreaSize(e);const n=this.autofillCalculations.getDirection(e,t);let o=t;if(this.autofillCalculations.dragAreaOverlapsCollections(e,o,n))return o=e,o;const i=this.mergedCellsCollection.getWithinRange({from:{row:e[0],col:e[1]},to:{row:e[2],col:e[3]}});return i&&(o=this.autofillCalculations.snapDragArea(e,o,n,i)),o}function $et(t,e){this.mergedCellsCollection.shiftCollections("right",t,e)}function tnt(t,e){this.mergedCellsCollection.shiftCollections("left",t,e)}function ent(t,e,n){"auto"!==n&&this.mergedCellsCollection.shiftCollections("down",t,e)}function nnt(t,e){this.mergedCellsCollection.shiftCollections("up",t,e)}function ont(t,e){"Autofill.fill"===e&&this.autofillCalculations.recreateAfterDataPopulation(t)}function int(t,e){if(e&&"area"===e){const e=this.hot.getSelectedRangeLast(),n=this.mergedCellsCollection.getWithinRange(e);Mp(n,(n=>{e.getBottomEndCorner().row===n.getLastRow()&&e.getBottomEndCorner().col===n.getLastColumn()&&(t[2]=n.row,t[3]=n.col)}))}}function rnt(t,e,n){if(!this.enabled)return;const o=this.mergedCellsCollection.get(t.row,t.col);if(!o)return;const i=e>0,r=e<0,s=n<0,a=n>0,l=o.row+o.rowspan-1===this.hot.countRows()-1,h=0===o.row,c=o.col+o.colspan-1===this.hot.countCols()-1,u=0===o.col;(i&&l||r&&h||a&&c||s&&u)&&(t.row=o.row,t.col=o.col)}function snt(t,e,n,o){if(n)return this.selectionCalculations.getSelectedMergedCellClassName(t,e,n,o)}function ant(){return this.selectionCalculations.getSelectedMergedCellClassNameToRemove()}function lnt(t,e){return function(n,o){const[,...i]=n,[,...r]=o;return function n(o){const s=t[o],a=e[o],l=i[o],h=r[o],c=a.multiColumnSorting,u=(c.compareFunctionFactory?c.compareFunctionFactory:ZY(a.type))(s,a,c)(l,h);if(u===JY){const t=o+1;if("undefined"!=typeof e[t])return n(t)}return u}(0)}}function hnt(){Xy(Lp`Plugins \`columnSorting\` and \`multiColumnSorting\` should not be enabled simultaneously. 
    Only \`multiColumnSorting\` will work.`)}const cnt="sort";function unt(t,e,n){const o=[];return!1===n||t.isColumnSorted(e)&&t.getNumberOfSortedColumns()>1&&o.push(`${cnt}-${t.getIndexOfColumnInSortQueue(e)+1}`),o}function dnt(t){const e=t.className.split(" "),n=new RegExp(`^${cnt}-[0-9]{1,2}$`);return e.filter((t=>n.test(t)))}function gnt(t,e,n){return e=fnt(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function fnt(t){var e=mnt(t,"string");return"symbol"==typeof e?e:String(e)}function mnt(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}const pnt="multiColumnSorting",wnt=170,Ant="columnSorting",vnt=pnt;XY(pnt,lnt);class ynt extends Az{constructor(){super(...arguments),gnt(this,"pluginKey",pnt)}static get PLUGIN_KEY(){return pnt}static get PLUGIN_PRIORITY(){return wnt}isEnabled(){return super.isEnabled()}enablePlugin(){!this.enabled&&this.hot.getSettings()[this.pluginKey]&&this.hot.getSettings()[Ant]&&hnt(),super.enablePlugin()}disablePlugin(){super.disablePlugin()}registerShortcuts(){super.registerShortcuts(),this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Shift","Enter"]],callback:()=>{const{highlight:t}=this.hot.getSelectedRangeLast();-1===t.row&&t.col>=0&&this.sort(this.getNextSortConfig(t.col,uz))},runOnlyIf:()=>{var t;const e=null===(t=this.hot.getSelectedRangeLast())||void 0===t?void 0:t.highlight;return e&&this.hot.selection.isCellVisible(e)&&e.isHeader()},group:vnt})}unregisterShortcuts(){super.unregisterShortcuts(),this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(vnt)}sort(t){super.sort(t)}clearSort(){super.clearSort()}isSorted(){return super.isSorted()}getSortConfig(t){return super.getSortConfig(t)}setSortConfig(t){super.setSortConfig(t)}getNormalizedSortConfigs(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return Array.isArray(t)?t:[t]}updateHeaderClasses(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),o=1;o<e;o++)n[o-1]=arguments[o];super.updateHeaderClasses(t,...n),uA(t,dnt(t)),!1!==this.enabled&&cA(t,unt(...n))}onUpdateSettings(t){this.hot.getSettings()[this.pluginKey]&&this.hot.getSettings()[Ant]&&hnt(),super.onUpdateSettings(t)}onAfterOnCellMouseDown(t,e){!1!==xY(e.row,e.col,t)&&this.wasClickableHeaderClicked(t,e.col)&&(this.hot.getShortcutManager().isCtrlPressed()?(this.hot.deselectCell(),this.hot.selectColumns(e.col),this.sort(this.getNextSortConfig(e.col,uz))):this.sort(this.getColumnNextConfig(e.col)))}}function Cnt(t,e,n){return e=bnt(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function bnt(t){var e=Snt(t,"string");return"symbol"==typeof e?e:String(e)}function Snt(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}const Ent="multipleSelectionHandles",Rnt=160;class Mnt extends jF{constructor(){super(...arguments),Cnt(this,"dragged",[]),Cnt(this,"lastSetCell",null)}static get PLUGIN_KEY(){return Ent}static get PLUGIN_PRIORITY(){return Rnt}isEnabled(){return ky()}enablePlugin(){this.enabled||(this.registerListeners(),super.enablePlugin())}registerListeners(){const t=this,{rootElement:e}=this.hot;function n(e){if(1===t.dragged.length)return t.dragged.splice(0,t.dragged.length),!0;const n=t.dragged.indexOf(e);if(-1===n)return!1;0===n?t.dragged=t.dragged.slice(0,1):1===n&&(t.dragged=t.dragged.slice(-1))}this.eventManager.addEventListener(e,"touchstart",(e=>{let n;return hA(e.target,"topSelectionHandle-HitArea")?(n=t.hot.getSelectedRangeLast(),t.dragged.push("top"),t.touchStartRange={width:n.getWidth(),height:n.getHeight(),direction:n.getDirection()},e.preventDefault(),!1):hA(e.target,"bottomSelectionHandle-HitArea")?(n=t.hot.getSelectedRangeLast(),t.dragged.push("bottom"),t.touchStartRange={width:n.getWidth(),height:n.getHeight(),direction:n.getDirection()},e.preventDefault(),!1):void 0})),this.eventManager.addEventListener(e,"touchend",(e=>hA(e.target,"topSelectionHandle-HitArea")?(n.call(t,"top"),t.touchStartRange=void 0,e.preventDefault(),!1):hA(e.target,"bottomSelectionHandle-HitArea")?(n.call(t,"bottom"),t.touchStartRange=void 0,e.preventDefault(),!1):void 0)),this.eventManager.addEventListener(e,"touchmove",(e=>{const{rootDocument:n}=this.hot;let o,i,r,s,a,l;if(0===t.dragged.length)return;const h=n.elementFromPoint(e.touches[0].clientX,e.touches[0].clientY);!h||h===t.lastSetCell||(("TD"===h.nodeName||"TH"===h.nodeName)&&(o=t.hot.getCoords(h),-1===o.col&&(o.col=0),i=t.hot.getSelectedRangeLast(),r=i.getWidth(),s=i.getHeight(),a=i.getDirection(),1===r&&1===s&&t.hot.selection.setRangeEnd(o),l=t.getCurrentRangeCoords(i,o,t.touchStartRange.direction,a,t.dragged[0]),null!==l.start&&t.hot.selection.setRangeStart(l.start),t.hot.selection.setRangeEnd(l.end),t.lastSetCell=h),e.preventDefault())}))}getCurrentRangeCoords(t,e,n,o,i){const r=t.getTopStartCorner(),s=t.getBottomEndCorner(),a=t.getBottomStartCorner(),l=t.getTopEndCorner();let h={start:null,end:null};switch(n){case"NE-SW":switch(o){case"NE-SW":case"NW-SE":h="top"===i?{start:this.hot._createCellCoords(e.row,t.highlight.col),end:this.hot._createCellCoords(a.row,e.col)}:{start:this.hot._createCellCoords(t.highlight.row,e.col),end:this.hot._createCellCoords(e.row,r.col)};break;case"SE-NW":"bottom"===i&&(h={start:this.hot._createCellCoords(s.row,e.col),end:this.hot._createCellCoords(e.row,r.col)});break}break;case"NW-SE":switch(o){case"NE-SW":"top"===i?h={start:e,end:a}:h.end=e;break;case"NW-SE":"top"===i?h={start:e,end:s}:h.end=e;break;case"SE-NW":"top"===i?h={start:e,end:r}:h.end=e;break;case"SW-NE":"top"===i?h={start:e,end:l}:h.end=e;break}break;case"SW-NE":switch(o){case"NW-SE":h="bottom"===i?{start:this.hot._createCellCoords(e.row,r.col),end:this.hot._createCellCoords(a.row,e.col)}:{start:this.hot._createCellCoords(r.row,e.col),end:this.hot._createCellCoords(e.row,s.col)};break;case"SW-NE":h="top"===i?{start:this.hot._createCellCoords(t.highlight.row,e.col),end:this.hot._createCellCoords(e.row,s.col)}:{start:this.hot._createCellCoords(e.row,r.col),end:this.hot._createCellCoords(r.row,e.col)};break;case"SE-NW":"bottom"===i?h={start:this.hot._createCellCoords(e.row,l.col),end:this.hot._createCellCoords(r.row,e.col)}:"top"===i&&(h={start:a,end:e});break}break;case"SE-NW":switch(o){case"NW-SE":case"NE-SW":case"SW-NE":"top"===i&&(h.end=e);break;case"SE-NW":"top"===i?h.end=e:h={start:e,end:r};break}break}return h}isDragged(){return this.dragged.length>0}}function Tnt(){let{label:t="",colspan:e=1,origColspan:n=1,collapsible:o=!1,crossHiddenColumns:i=[],isCollapsed:r=!1,isHidden:s=!1,isRoot:a=!1,isPlaceholder:l=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{label:t,colspan:e,origColspan:n,collapsible:o,isCollapsed:r,crossHiddenColumns:i,isHidden:s,isRoot:a,isPlaceholder:l}}function knt(){return{label:"",isPlaceholder:!0}}function xnt(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1/0;const n=[];if(0===e)return n;Mp(t,(t=>{const o=[];let i=0;n.push(o),Mp(t,(t=>{const n=Tnt();if(ty(t)){const{label:e,colspan:o}=t;n.label=Vp(e),"number"==typeof o&&o>1&&(n.colspan=o,n.origColspan=o)}else n.label=Vp(t);i+=n.origColspan;let r=!1;if(i>=e&&(n.colspan=n.origColspan-(i-e),n.origColspan=n.colspan,r=!0),o.push(n),n.colspan>1)for(let e=0;e<n.colspan-1;e++)o.push(knt());return!r}))}));const o=Math.max(...Rp(n,(t=>t.length)));return Mp(n,(t=>{if(t.length<o){const e=Rp(new Array(o-t.length),(()=>Tnt()));t.splice(t.length,0,...e)}})),n}function Int(t,e,n){Ont(t,e),e.set(t,n)}function Ont(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Hnt(t,e){var n=Pnt(t,e,"get");return Dnt(t,n)}function Dnt(t,e){return e.get?e.get.call(t):e.value}function Nnt(t,e,n){var o=Pnt(t,e,"set");return _nt(t,o,n),n}function Pnt(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function _nt(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}const Bnt=["label","collapsible"];var Lnt=new WeakMap,Vnt=new WeakMap,Wnt=new WeakMap;class Fnt{constructor(){Int(this,Lnt,{writable:!0,value:[]}),Int(this,Vnt,{writable:!0,value:0}),Int(this,Wnt,{writable:!0,value:1/0})}setColumnsLimit(t){Nnt(this,Wnt,t)}setData(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];Nnt(this,Lnt,xnt(t,Hnt(this,Wnt))),Nnt(this,Vnt,Hnt(this,Lnt).length)}getData(){return Hnt(this,Lnt)}mergeWith(t){Mp(t,(t=>{let e=t,{row:n,col:o}=e,i=A(e,["row","col"]);const r=this.getHeaderSettings(n,o);null!==r&&Kv(r,i,Bnt)}))}map(t){Mp(Hnt(this,Lnt),(e=>{Mp(e,(e=>{const n=t(p({},e));ty(n)&&Kv(e,n,Bnt)}))}))}getHeaderSettings(t,e){var n;if(t>=Hnt(this,Vnt)||t<0)return null;const o=Hnt(this,Lnt)[t];return!1===Array.isArray(o)||e>=o.length?null:null!==(n=o[e])&&void 0!==n?n:null}getHeadersSettings(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;const o=[];if(t>=Hnt(this,Vnt)||t<0)return o;const i=Hnt(this,Lnt)[t];let r=0;for(let s=e;s<i.length;s++){const t=i[s];if(t.isPlaceholder)throw new Error("The first column settings cannot overlap the other header layers");if(r+=t.colspan,o.push(t),t.colspan>1&&(s+=t.colspan-1),r===n)break;if(r>n)throw new Error("The last column settings cannot overlap the other header layers")}return o}getLayersCount(){return Hnt(this,Vnt)}getColumnsCount(){return Hnt(this,Vnt)>0?Hnt(this,Lnt)[0].length:0}clear(){Nnt(this,Lnt,[]),Nnt(this,Vnt,0)}}function jnt(t,e,n){return e=Unt(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Unt(t){var e=Ynt(t,"string");return"symbol"==typeof e?e:String(e)}function Ynt(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}const znt="DF-pre-order";function Gnt(t,e){let n=t.call(e,this);for(let o=0;o<this.childs.length;o++){if(!1===n)return!1;n=Gnt.call(this.childs[o],t,e)}return n}const Qnt="DF-post-order";function Knt(t,e){for(let n=0;n<this.childs.length;n++)if(!1===Knt.call(this.childs[n],t,e))return!1;return t.call(e,this)}const Xnt="BF";function qnt(t,e){const n=[this];function o(){if(0===n.length)return;const i=n.shift();n.push(...i.childs),!1!==t.call(e,i)&&o()}o()}const Znt=Xnt,Jnt=new Map([[znt,Gnt],[Qnt,Knt],[Xnt,qnt]]);class $nt{constructor(t){jnt(this,"data",{}),jnt(this,"parent",null),jnt(this,"childs",[]),this.data=t}addChild(t){t.parent=this,this.childs.push(t)}cloneTree(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this;const e=new $nt(p({},t.data));for(let n=0;n<t.childs.length;n++)e.addChild(this.cloneTree(t.childs[n]));return e}replaceTreeWith(t){this.data=p({},t.data),this.childs=[];for(let e=0;e<t.childs.length;e++)this.addChild(t.childs[e])}walkDown(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Znt;if(!Jnt.has(e))throw new Error(`Traversal strategy "${e}" does not exist`);Jnt.get(e).call(this,t,this)}walkUp(t){const e=this,n=o=>{!1!==t.call(e,o)&&null!==o.parent&&n(o.parent)};n(this)}}function tot(t,e,n){eot(t,e),e.set(t,n)}function eot(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function not(t,e){var n=rot(t,e,"get");return oot(t,n)}function oot(t,e){return e.get?e.get.call(t):e.value}function iot(t,e,n){var o=rot(t,e,"set");return sot(t,o,n),n}function rot(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function sot(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var aot=new WeakMap,lot=new WeakMap,hot=new WeakMap;class cot{constructor(t){tot(this,aot,{writable:!0,value:new Map}),tot(this,lot,{writable:!0,value:new Map}),tot(this,hot,{writable:!0,value:null}),iot(this,hot,t)}getRoots(){return Array.from(not(this,aot).values())}getRootByColumn(t){let e;return not(this,lot).has(t)&&(e=not(this,aot).get(not(this,lot).get(t))),e}getNode(t,e){const n=this.getRootByColumn(e);if(!n)return;const o=e-not(this,lot).get(e);let i,r=0;return n.walkDown((n=>{const{data:{origColspan:s,headerLevel:a}}=n;if(t===a){if(o>=r&&o<=r+s-1)return i=n,i.data.isRoot=e===i.data.columnIndex,!1;r+=s}})),i}rebuildTreeIndex(){let t=0;not(this,lot).clear(),Mp(not(this,aot),(e=>{let[,{data:{colspan:n}}]=e;for(let o=t;o<t+n;o++)not(this,lot).set(o,t);t+=n}))}buildTree(){this.clear();const t=not(this,hot).getColumnsCount();let e=0;for(;e<t;){const t=not(this,hot).getHeaderSettings(0,e),n=new $nt;not(this,aot).set(e,n),this.buildLeaves(n,e,0,t.origColspan),e+=t.origColspan}this.rebuildTreeIndex()}buildLeaves(t,e,n){let o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;const i=not(this,hot).getHeadersSettings(n,e,o);n+=1,Mp(i,(o=>{const i=w(p({},o),{headerLevel:n-1,columnIndex:e});let r;1===n?(t.data=i,r=t):(r=new $nt(i),t.addChild(r)),n<not(this,hot).getLayersCount()&&this.buildLeaves(r,e,n,o.origColspan),e+=o.origColspan}))}clear(){not(this,aot).clear(),not(this,lot).clear()}}function uot(t,e){t.walkDown((t=>{let{data:n,childs:o}=t;if(!n.isHidden&&(e(n.columnIndex),0===o.length))for(let i=1;i<n.colspan;i++)e(n.columnIndex+i)}))}function dot(t,e){let{childs:n}=t;if(0!==n.length)return n[0].data[e]}function got(t){return dot(t,"origColspan")===t.data.origColspan}function fot(t){const{data:e,childs:n}=t;if(!e.isCollapsed||e.isHidden||e.origColspan<=1)return{rollbackModification:()=>{},affectedColumns:[],colspanCompensation:0};if(got(t))return fot(n[0]);e.isCollapsed=!1;const o=n.slice(1),i=new Set;let r=0;if(o.length>0)Mp(o,(t=>{t.replaceTreeWith(t.data.clonedTree),t.data.clonedTree=null;const e=t.data;r+=e.colspan,uot(t,(t=>{i.add(t)}))}));else{const{colspan:t,origColspan:n,columnIndex:o}=e;r=n-t;for(let e=1;e<n;e++)i.add(o+e)}return t.walkUp((t=>{const{data:e}=t;e.colspan+=r,e.colspan>=e.origColspan?(e.colspan=e.origColspan,e.isCollapsed=!1):got(t)&&(e.isCollapsed=dot(t,"isCollapsed"))})),{rollbackModification:()=>mot(t),affectedColumns:Array.from(i),colspanCompensation:r}}function mot(t){var e;const{data:n,childs:o}=t;if(n.isCollapsed||n.isHidden||n.origColspan<=1)return{rollbackModification:()=>{},affectedColumns:[],colspanCompensation:0};if(got(t))return mot(o[0]);n.isCollapsed=!0;const i=o.slice(1),r=new Set;if(i.length>0)Mp(i,(t=>{uot(t,(t=>{r.add(t)})),t.data.clonedTree=t.cloneTree(),t.walkDown((t=>{let{data:e}=t;e.isHidden=!0}))}));else{const{origColspan:t,columnIndex:e}=n;for(let n=1;n<t;n++){const t=e+n;r.add(t)}}const s=n.colspan-(null!==(e=dot(t,"colspan"))&&void 0!==e?e:1);return t.walkUp((t=>{const{data:e}=t;e.colspan-=s,e.colspan<=1?(e.colspan=1,e.isCollapsed=!0):got(t)&&(e.isCollapsed=dot(t,"isCollapsed"))})),{rollbackModification:()=>fot(t),affectedColumns:Array.from(r),colspanCompensation:s}}function pot(t,e){if(!Number.isInteger(e))throw new Error("The passed gridColumnIndex argument has invalid type.");if(t.childs.length>0)throw new Error(Lp`The passed node is not the last node on the tree. Only for\x20
the last node, the hide column modification can be applied.`);const{crossHiddenColumns:n}=t.data;if(n.includes(e))return;let o=!1;t.walkUp((t=>{const{data:{collapsible:e}}=t;if(e)return o=!0,!1})),!o&&t.walkUp((t=>{const{data:n}=t;n.crossHiddenColumns.push(e),n.colspan>1?n.colspan-=1:n.isHidden=!0}))}function wot(t,e){if(!Number.isInteger(e))throw new Error("The passed gridColumnIndex argument has invalid type.");if(t.childs.length>0)throw new Error(Lp`The passed node is not the last node on the tree. Only for\x20
the last node, the show column modification can be applied.`);const{crossHiddenColumns:n}=t.data;if(!n.includes(e))return;let o=!1;t.walkUp((t=>{const{data:{collapsible:e}}=t;if(e)return o=!0,!1})),!o&&t.walkUp((t=>{const{data:n}=t;n.crossHiddenColumns.splice(n.crossHiddenColumns.indexOf(e),1),!n.isHidden&&n.colspan<n.origColspan&&(n.colspan+=1),n.isHidden=!1}))}const Aot=new Map([["collapse",mot],["expand",fot],["hide-column",pot],["show-column",wot]]);function vot(t,e,n){if(!Aot.has(t))throw new Error(`The node modifier action ("${t}") does not exist.`);return Aot.get(t)(e,n)}function yot(t){const e=[];return Mp(t,(t=>{t.walkDown((t=>{const n=t.data,{origColspan:o,columnIndex:i,headerLevel:r,crossHiddenColumns:s}=n,a=bot(e,r);let l=!1;for(let e=i;e<i+o;e++)if(s.includes(e)||l)a.push(knt());else{const t=Cot(n);t.isRoot=!0,a.push(t),l=!0}}))})),e}function Cot(t){const e=Tnt(t),{crossHiddenColumns:n}=e;return A(e,["crossHiddenColumns"])}function bot(t,e){let n;return Array.isArray(t[e])?n=t[e]:(n=[],t[e]=n),n}function Sot(t,e,n){Eot(t,e),e.set(t,n)}function Eot(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Rot(t,e,n){var o=kot(t,e,"set");return Mot(t,o,n),n}function Mot(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function Tot(t,e){var n=kot(t,e,"get");return xot(t,n)}function kot(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function xot(t,e){return e.get?e.get.call(t):e.value}var Iot=new WeakMap,Oot=new WeakMap,Hot=new WeakMap;class Dot{constructor(){Sot(this,Iot,{writable:!0,value:new Fnt}),Sot(this,Oot,{writable:!0,value:new cot(Tot(this,Iot))}),Sot(this,Hot,{writable:!0,value:[[]]})}setState(t){Tot(this,Iot).setData(t);let e=!1;try{Tot(this,Oot).buildTree()}catch(n){Tot(this,Oot).clear(),Tot(this,Iot).clear(),e=!0}return Rot(this,Hot,yot(Tot(this,Oot).getRoots())),e}setColumnsLimit(t){Tot(this,Iot).setColumnsLimit(t)}mergeStateWith(t){const e=Rp(t,(t=>{let e=t,{row:n}=e,o=A(e,["row"]);return p({row:n<0?this.rowCoordsToLevel(n):n},o)}));Tot(this,Iot).mergeWith(e),Tot(this,Oot).buildTree(),Rot(this,Hot,yot(Tot(this,Oot).getRoots()))}mapState(t){Tot(this,Iot).map(t),Tot(this,Oot).buildTree(),Rot(this,Hot,yot(Tot(this,Oot).getRoots()))}mapNodes(t){return Sp(Tot(this,Oot).getRoots(),((e,n)=>(n.walkDown((n=>{const o=t(n.data);void 0!==o&&e.push(o)})),e)),[])}triggerNodeModification(t,e,n){e<0&&(e=this.rowCoordsToLevel(e));const o=Tot(this,Oot).getNode(e,n);let i;return o&&(i=vot(t,o,n),Rot(this,Hot,yot(Tot(this,Oot).getRoots()))),i}triggerColumnModification(t,e){return this.triggerNodeModification(t,-1,e)}rowCoordsToLevel(t){if(t>=0)return null;const e=t+Math.max(this.getLayersCount(),1);return e<0?null:e}levelToRowCoords(t){if(t<0)return null;const e=t-Math.max(this.getLayersCount(),1);return e>=0?null:e}getHeaderSettings(t,e){var n,o;return t<0&&(t=this.rowCoordsToLevel(t)),null===t||t>=this.getLayersCount()?null:null!==(n=null===(o=Tot(this,Hot)[t])||void 0===o?void 0:o[e])&&void 0!==n?n:null}getHeaderTreeNodeData(t,e){const n=this.getHeaderTreeNode(t,e);return n?p({},n.data):null}getHeaderTreeNode(t,e){if(t<0&&(t=this.rowCoordsToLevel(t)),null===t||t>=this.getLayersCount())return null;const n=Tot(this,Oot).getNode(t,e);return n||null}findTopMostEntireHeaderLevel(t){var e;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t;const o=n-t+1;let i=!1,r=null;for(let s=t;s<=n;s++){const e=Tot(this,Oot).getRootByColumn(s);if(!e)break;i=!0,e.walkDown((e=>{const{columnIndex:i,headerLevel:s,origColspan:a,isHidden:l}=e.data;l||a<=o&&i>=t&&i+a-1<=n&&(null===r||s<r)&&(r=s)}),znt)}return i&&null===r?-1:this.levelToRowCoords(null!==(e=r)&&void 0!==e?e:0)}findLeftMostColumnIndex(t,e){var n;const{isRoot:o}=null!==(n=this.getHeaderSettings(t,e))&&void 0!==n?n:{isRoot:!0};if(o)return e;let i=e-1;for(;i>=0;){var r;const{isRoot:e}=null!==(r=this.getHeaderSettings(t,i))&&void 0!==r?r:{isRoot:!0};if(e)break;i-=1}return i}findRightMostColumnIndex(t,e){var n;const{isRoot:o,origColspan:i}=null!==(n=this.getHeaderSettings(t,e))&&void 0!==n?n:{isRoot:!0,origColspan:1};if(o)return e+i-1;let r=e+1;for(;r<this.getColumnsCount();){var s;const{isRoot:e}=null!==(s=this.getHeaderSettings(t,r))&&void 0!==s?s:{isRoot:!0};if(e)break;r+=1}return r-1}getLayersCount(){return Tot(this,Iot).getLayersCount()}getColumnsCount(){return Tot(this,Iot).getColumnsCount()}clear(){Rot(this,Hot,[]),Tot(this,Iot).clear(),Tot(this,Oot).clear()}}function Not(t,e,n){return e=Pot(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Pot(t){var e=_ot(t,"string");return"symbol"==typeof e?e:String(e)}function _ot(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class Bot{constructor(t,e){Not(this,"hot",void 0),Not(this,"nestedHeaderSettingsGetter",void 0),Not(this,"layersCount",0),Not(this,"container",void 0),Not(this,"widthsMap",void 0),this.hot=t,this.nestedHeaderSettingsGetter=e,this.widthsMap=this.hot.columnIndexMapper.createAndRegisterIndexMap("nestedHeaders.widthsMap","physicalIndexToValue")}setLayersCount(t){return this.layersCount=t,this}getWidth(t){return this.widthsMap.getValueAtIndex(this.hot.toPhysicalColumn(t))}buildWidthsMap(){this.container=this.hot.rootDocument.createElement("div"),this.container.classList.add("handsontable","htGhostTable","htAutoSize"),this._buildGhostTable(this.container),this.hot.rootDocument.body.appendChild(this.container);const t=this.container.querySelectorAll("tr:last-of-type th"),e=t.length;this.widthsMap.clear();for(let n=0;n<e;n++){const e=this.hot.columnIndexMapper.getVisualFromRenderableIndex(n),o=this.hot.toPhysicalColumn(e);this.widthsMap.setValueAtIndex(o,t[n].offsetWidth)}this.container.parentNode.removeChild(this.container),this.container=null}_buildGhostTable(t){const{rootDocument:e,columnIndexMapper:n}=this.hot,o=e.createDocumentFragment(),i=e.createElement("table"),r=!!this.hot.getSettings().dropdownMenu,s=n.getRenderableIndexesLength();for(let a=0;a<this.layersCount;a++){const t=e.createElement("tr");for(let o=0;o<s;o++){let i=n.getVisualFromRenderableIndex(o);null===i&&(i=o);const s=e.createElement("th"),l=this.nestedHeaderSettingsGetter(a,i);if(l&&(!l.isPlaceholder||l.isHidden)){let e=l.label;r&&(e+='<button class="changeType"></button>'),wA(s,e),s.colSpan=l.colspan,t.appendChild(s)}}i.appendChild(t)}o.appendChild(i),t.appendChild(o)}clear(){this.widthsMap.clear(),this.container=null}}const Lot=Bot;function Vot(t,e){Yot(t,e),e.add(t)}function Wot(t,e,n){return e=Fot(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Fot(t){var e=jot(t,"string");return"symbol"==typeof e?e:String(e)}function jot(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function Uot(t,e,n){Yot(t,e),e.set(t,n)}function Yot(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function zot(t,e,n){var o=Kot(t,e,"set");return Got(t,o,n),n}function Got(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function Qot(t,e){var n=Kot(t,e,"get");return Xot(t,n)}function Kot(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function Xot(t,e){return e.get?e.get.call(t):e.value}function qot(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const Zot="nestedHeaders",Jot=280;var $ot=new WeakMap,tit=new WeakMap,eit=new WeakMap,nit=new WeakMap,oit=new WeakSet,iit=new WeakSet,rit=new WeakSet,sit=new WeakSet,ait=new WeakSet,lit=new WeakSet,hit=new WeakSet,cit=new WeakSet,uit=new WeakSet,dit=new WeakSet,git=new WeakSet,fit=new WeakSet,mit=new WeakSet,pit=new WeakSet,wit=new WeakSet,Ait=new WeakSet,vit=new WeakSet,yit=new WeakSet;class Cit extends jF{constructor(){super(...arguments),Vot(this,yit),Vot(this,vit),Vot(this,Ait),Vot(this,wit),Vot(this,pit),Vot(this,mit),Vot(this,fit),Vot(this,git),Vot(this,dit),Vot(this,uit),Vot(this,cit),Vot(this,hit),Vot(this,lit),Vot(this,ait),Vot(this,sit),Vot(this,rit),Vot(this,iit),Vot(this,oit),Uot(this,$ot,{writable:!0,value:new Dot}),Uot(this,tit,{writable:!0,value:null}),Uot(this,eit,{writable:!0,value:null}),Uot(this,nit,{writable:!0,value:!1}),Wot(this,"ghostTable",new Lot(this.hot,((t,e)=>this.getHeaderSettings(t,e)))),Wot(this,"detectedOverlappedHeaders",!1)}static get PLUGIN_KEY(){return Zot}static get PLUGIN_PRIORITY(){return Jot}isEnabled(){return!!this.hot.getSettings()[Zot]}enablePlugin(){var t=this;if(this.enabled)return;const{nestedHeaders:e}=this.hot.getSettings();(!Array.isArray(e)||!Array.isArray(e[0]))&&Xy(Lp`Your Nested Headers plugin configuration is invalid. The settings has to be\x20
                        passed as an array of arrays e.q. [['A1', { label: 'A2', colspan: 2 }]]`),this.addHook("init",(()=>qot(this,vit,Lit).call(this))),this.addHook("afterLoadData",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return qot(t,yit,Vit).call(t,...n)})),this.addHook("beforeOnCellMouseDown",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return qot(t,ait,Mit).call(t,...n)})),this.addHook("afterOnCellMouseDown",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return qot(t,lit,Tit).call(t,...n)})),this.addHook("beforeOnCellMouseOver",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return qot(t,hit,kit).call(t,...n)})),this.addHook("beforeOnCellMouseUp",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return qot(t,cit,xit).call(t,...n)})),this.addHook("beforeSelectionHighlightSet",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return qot(t,uit,Iit).call(t,...n)})),this.addHook("modifyTransformStart",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return qot(t,dit,Oit).call(t,...n)})),this.addHook("afterSelection",(()=>qot(this,oit,bit).call(this))),this.addHook("beforeViewportScrollHorizontally",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return qot(t,iit,Sit).call(t,...n)})),this.addHook("afterGetColumnHeaderRenderers",(t=>qot(this,fit,Dit).call(this,t))),this.addHook("modifyColWidth",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return qot(t,pit,Pit).call(t,...n)})),this.addHook("modifyColumnHeaderValue",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return qot(t,wit,_it).call(t,...n)})),this.addHook("beforeHighlightingColumnHeader",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return qot(t,rit,Eit).call(t,...n)})),this.addHook("beforeCopy",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return qot(t,sit,Rit).call(t,...n)})),this.addHook("beforeSelectColumns",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return qot(t,git,Hit).call(t,...n)})),this.addHook("afterViewportColumnCalculatorOverride",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return qot(t,mit,Nit).call(t,...n)})),this.addHook("modifyFocusedElement",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return qot(t,Ait,Bit).call(t,...n)})),this.hot.columnIndexMapper.addLocalHook("cacheUpdated",(()=>qot(this,oit,bit).call(this))),this.hot.rowIndexMapper.addLocalHook("cacheUpdated",(()=>qot(this,oit,bit).call(this))),super.enablePlugin(),this.updatePlugin()}updatePlugin(){if(!this.hot.view)return;const{nestedHeaders:t}=this.hot.getSettings();Qot(this,$ot).setColumnsLimit(this.hot.countCols()),Array.isArray(t)&&(this.detectedOverlappedHeaders=Qot(this,$ot).setState(t)),this.detectedOverlappedHeaders&&Xy(Lp`Your Nested Headers plugin setup contains overlapping headers. This kind of configuration\x20
                        is currently not supported.`),this.enabled&&this.hot.columnIndexMapper.hidingMapsCollection.getMergedValues().forEach(((t,e)=>{const n=!0===t?"hide-column":"show-column";Qot(this,$ot).triggerColumnModification(n,e)})),!Qot(this,tit)&&this.enabled&&zot(this,tit,this.hot.columnIndexMapper.createChangesObserver("hiding").subscribe((t=>{t.forEach((t=>{let{op:e,index:n,newValue:o}=t;if("replace"===e){const t=!0===o?"hide-column":"show-column";Qot(this,$ot).triggerColumnModification(t,n)}})),this.ghostTable.buildWidthsMap()}))),this.ghostTable.setLayersCount(this.getLayersCount()).buildWidthsMap(),super.updatePlugin()}disablePlugin(){this.clearColspans(),Qot(this,$ot).clear(),Qot(this,tit).unsubscribe(),zot(this,tit,null),this.ghostTable.clear(),super.disablePlugin()}getStateManager(){return Qot(this,$ot)}getLayersCount(){return Qot(this,$ot).getLayersCount()}getHeaderSettings(t,e){return Qot(this,$ot).getHeaderSettings(t,e)}clearColspans(){if(!this.hot.view)return;const{_wt:t}=this.hot.view,e=t.getSetting("columnHeaders").length,n=t.wtTable.THEAD,o=t.wtOverlays.topOverlay.clone.wtTable.THEAD,i=t.wtOverlays.topInlineStartCornerOverlay?t.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null;for(let r=0;r<e;r++){const t=n.childNodes[r];if(!t)break;const e=o.childNodes[r],s=i?i.childNodes[r]:null;for(let n=0,o=t.childNodes.length;n<o;n++)t.childNodes[n].removeAttribute("colspan"),uA(t.childNodes[n],"hiddenHeader"),e&&e.childNodes[n]&&(e.childNodes[n].removeAttribute("colspan"),uA(e.childNodes[n],"hiddenHeader")),i&&s&&s.childNodes[n]&&(s.childNodes[n].removeAttribute("colspan"),uA(s.childNodes[n],"hiddenHeader"))}}headerRendererFactory(t){var e=this;const n=this.hot.view._wt.getSetting("fixedColumnsStart");return(o,i)=>{var r;const{columnIndexMapper:s,view:a}=this.hot;let l=s.getVisualFromRenderableIndex(o);null===l&&(l=o),i.removeAttribute("colspan"),uA(i,"hiddenHeader");const{colspan:h,isHidden:c,isPlaceholder:u}=null!==(r=Qot(this,$ot).getHeaderSettings(t,l))&&void 0!==r?r:{label:""};if(u||c)cA(i,"hiddenHeader");else if(h>1){var d,g;const{wtOverlays:t}=a._wt,e=null===(d=t.topInlineStartCornerOverlay)||void 0===d?void 0:d.clone.wtTable.THEAD.contains(i),r=null===(g=t.inlineStartOverlay)||void 0===g?void 0:g.clone.wtTable.THEAD.contains(i),s=e||r?Math.min(h,n-o):h;s>1&&i.setAttribute("colspan",s)}this.hot.view.appendColHeader(l,i,(function(){return e.getColumnHeaderValue(...arguments)}),t)}}getColumnHeaderValue(t,e){var n;const{isHidden:o,isPlaceholder:i}=null!==(n=Qot(this,$ot).getHeaderSettings(e,t))&&void 0!==n?n:{};return i||o?"":this.hot.getColHeader(t,e)}destroy(){zot(this,$ot,null),null!==Qot(this,tit)&&(Qot(this,tit).unsubscribe(),zot(this,tit,null)),super.destroy()}_getHeaderTreeNodeDataByCoords(t){if(!(t.row>=0||t.col<0))return Qot(this,$ot).getHeaderTreeNodeData(t.row,t.col)}}function bit(){var t;const e=null===(t=this.hot)||void 0===t?void 0:t.getSelectedRangeLast();if(!e)return;const{highlight:n}=e;if(n.isHeader()&&n.col>=0){const t=Qot(this,$ot).findLeftMostColumnIndex(n.row,n.col),e=this.hot.selection.highlight.getFocus();e.visualCellRange.highlight.col=t,e.visualCellRange.from.col=t,e.visualCellRange.to.col=t,e.commit()}}function Sit(t){const e=this.hot.getSelectedRangeLast();if(!e)return t;const{highlight:n}=e;if(!(n.isHeader()&&n.col>=0))return t;const o=this.hot.view.getFirstFullyVisibleColumn(),i=this.hot.view.getLastFullyVisibleColumn(),r=Qot(this,$ot).findLeftMostColumnIndex(n.row,n.col),s=Qot(this,$ot).findRightMostColumnIndex(n.row,n.col);return r<o&&s>i?t:r<o?r:s}function Eit(t,e,n){const o=Qot(this,$ot).getHeaderTreeNodeData(e,t);if(!o)return t;const{columnCursor:i,selectionType:r,selectionWidth:s}=n,{isRoot:a,colspan:l}=Qot(this,$ot).getHeaderSettings(e,t);if(r===KT){if(!a)return o.columnIndex}else if(r===QT&&(l>s-i||!a))return null;return t}function Rit(t,e,n){let{columnHeadersCount:o}=n;if(0!==o)for(let r=0;r<e.length;r++){const{startRow:n,startCol:o,endRow:s,endCol:a}=e[r],l=s-n+1,h=o-a+1;if(n>=0||1===h)break;for(let e=o;e<=a;e++)for(let r=n;r<=s;r++){var i;const n=l+r,s=e-o;0!==s&&(!1===(null===(i=Qot(this,$ot).getHeaderTreeNodeData(r,e))||void 0===i?void 0:i.isRoot)&&(t[n][s]=""))}}}function Mit(t,e,n,o){this._getHeaderTreeNodeDataByCoords(e)&&(o.column=!0)}function Tit(t,e){const n=this._getHeaderTreeNodeDataByCoords(e);if(!n)return;zot(this,eit,e.clone()),zot(this,nit,!0);const{selection:o}=this.hot,i=o.isSelected()?o.getSelectedRange().current():null,r=[],{columnIndex:s,origColspan:a}=n,l=!o.inInSelection(e);t.shiftKey&&i?e.col<i.from.col?r.push(i.getTopEndCorner().col,s,e.row):e.col>i.from.col?r.push(i.getTopStartCorner().col,s+a-1,e.row):r.push(s,s+a-1,e.row):(Gy(t)||zy(t)&&l)&&r.push(s,s+a-1,e.row),o.selectColumns(...r)}function kit(t,e,n,o){if(!this.hot.view.isMouseDown())return;const i=this._getHeaderTreeNodeDataByCoords(e);if(!i)return;const{columnIndex:r,origColspan:s}=i,a=this.hot.getSelectedRangeLast(),l=a.getTopStartCorner(),h=a.getBottomEndCorner(),{from:c}=a;o.column=!0,o.cell=!0;const u=[],d=Eb(e.row,-1/0,-1);e.col<c.col?u.push(h.col,r,d):e.col>c.col?u.push(l.col,r+s-1,d):u.push(r,r+s-1,d),this.hot.selection.selectColumns(...u)}function xit(){zot(this,nit,!1)}function Iit(){const{navigableHeaders:t}=this.hot.getSettings();if(!this.hot.view.isMouseDown()||!Qot(this,nit)||!t)return;const e=this.hot.getSelectedRangeLast(),n=e.getTopStartCorner().col,o=e.getBottomEndCorner().col,{columnIndex:i,origColspan:r}=Qot(this,$ot).getHeaderTreeNodeData(Qot(this,eit).row,Qot(this,eit).col);if(e.setHighlight(Qot(this,eit)),r>e.getWidth()||i<n||i+r-1>o){const t=Qot(this,$ot).findTopMostEntireHeaderLevel(Eb(n,i,i+r-1),Eb(o,i,i+r-1));e.highlight.row=t,e.highlight.col=e.from.col}}function Oit(t){const{highlight:e}=this.hot.getSelectedRangeLast(),n=this.hot._createCellCoords(e.row+t.row,e.col+t.col);if(!(n.isHeader()&&n.col>=0))return;const o=Qot(this,$ot).findLeftMostColumnIndex(n.row,n.col),i=Qot(this,$ot).findRightMostColumnIndex(n.row,n.col);if(t.col<0){const n=e.col>=o&&e.col<=i?o-1:i,r=this.hot.columnIndexMapper.getNearestNotHiddenIndex(n,-1);t.col=null===r?-this.hot.view.countRenderableColumnsInRange(0,e.col):-Math.max(this.hot.view.countRenderableColumnsInRange(r,e.col)-1,1)}else if(t.col>0){const n=e.col>=o&&e.col<=i?i+1:o,r=this.hot.columnIndexMapper.getNearestNotHiddenIndex(n,1);t.col=null===r?this.hot.view.countRenderableColumnsInRange(e.col,this.hot.countCols()):Math.max(this.hot.view.countRenderableColumnsInRange(e.col,r)-1,1)}}function Hit(t,e){const n=t.row,o=this._getHeaderTreeNodeDataByCoords({row:n,col:t.col}),i=this._getHeaderTreeNodeDataByCoords({row:n,col:e.col});e.col<t.col?(o&&(t.col=o.columnIndex+o.origColspan-1),i&&(e.col=i.columnIndex)):e.col>=t.col&&(o&&(t.col=o.columnIndex),i&&(e.col=i.columnIndex+i.origColspan-1))}function Dit(t){t.length=0;for(let e=0;e<Qot(this,$ot).getLayersCount();e++)t.push(this.headerRendererFactory(e))}function Nit(t){const e=Qot(this,$ot).getLayersCount();let n=t.startColumn,o=!!e;for(let i=0;i<e;i++){const e=Qot(this,$ot).findLeftMostColumnIndex(i,t.startColumn),r=this.hot.columnIndexMapper.getRenderableFromVisualIndex(e);if(e>=0&&(o=!1),vb(r)&&r<t.startColumn){n=r;break}}t.startColumn=o?Qot(this,$ot).getHeaderTreeNodeData(0,n).columnIndex:n}function Pit(t,e){const n=this.ghostTable.getWidth(e);return t>n?t:n}function _it(t,e,n){var o;const{label:i}=null!==(o=Qot(this,$ot).getHeaderTreeNodeData(n,e))&&void 0!==o?o:{label:""};return i}function Bit(t,e){if(t<0)return this.hot.getCell(t,Qot(this,$ot).findLeftMostColumnIndex(t,e),!0)}function Lit(){this.updatePlugin()}function Vit(t,e){e||this.updatePlugin()}function Wit(t,e,n){return e=Fit(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Fit(t){var e=jit(t,"string");return"symbol"==typeof e?e:String(e)}function jit(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class Uit{constructor(t,e){Wit(this,"hot",void 0),Wit(this,"data",null),Wit(this,"plugin",void 0),Wit(this,"parentReference",new WeakMap),Wit(this,"cache",{levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap}),this.hot=e,this.plugin=t}setData(t){this.data=t}getData(){return this.data}getRawSourceData(){let t=null;return this.plugin.disableCoreAPIModifiers(),t=this.hot.getSourceData(),this.plugin.enableCoreAPIModifiers(),t}updateWithData(t){this.setData(t),this.rewriteCache()}rewriteCache(){this.cache={levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap},Cb(0,this.data.length-1,(t=>{this.cacheNode(this.data[t],0,null)}))}cacheNode(t,e,n){this.cache.levels[e]||(this.cache.levels[e]=[],this.cache.levelCount+=1),this.cache.levels[e].push(t),this.cache.rows.push(t),this.cache.nodeInfo.set(t,{parent:n,row:this.cache.rows.length-1,level:e}),this.hasChildren(t)&&Mp(t.__children,(n=>{this.cacheNode(n,e+1,t)}))}getDataObject(t){return null==t?null:this.cache.rows[t]}readTreeNodes(t,e,n,o){let i=!1,r=e;if(isNaN(r)&&r.end)return r;let s=t;return s||(s={__children:this.data},i=!0,r-=1),null!=n&&r===n?{result:s,end:!0}:null!=o&&s===o?{result:r,end:!0}:(r+=1,s.__children&&Mp(s.__children,(t=>{if(this.parentReference.set(t,i?null:s),r=this.readTreeNodes(t,r,n,o),isNaN(r)&&r.end)return!1})),r)}mockParent(){const t=this.mockNode();return t.__children=this.data,t}mockNode(){const t={};return ny(this.data[0],((e,n)=>{t[n]=null})),t}getRowIndex(t){return null==t?null:this.cache.nodeInfo.get(t).row}getRowIndexWithinParent(t){let e=null;e=isNaN(t)?t:this.getDataObject(t);const n=this.getRowParent(t);return null==n?this.data.indexOf(e):n.__children.indexOf(e)}countAllRows(){const t={__children:this.data};return this.countChildren(t)}countChildren(t){let e=0,n=t;return isNaN(n)||(n=this.getDataObject(n)),n&&n.__children?(Mp(n.__children,(t=>{e+=1,t.__children&&(e+=this.countChildren(t))})),e):0}getRowParent(t){let e;return e=isNaN(t)?t:this.getDataObject(t),this.getRowObjectParent(e)}getRowObjectParent(t){return t&&"object"==typeof t?this.cache.nodeInfo.get(t).parent:null}getRowLevel(t){let e=null;return e=isNaN(t)?t:this.getDataObject(t),e?this.getRowObjectLevel(e):null}getRowObjectLevel(t){return null==t?null:this.cache.nodeInfo.get(t).level}hasChildren(t){let e=t;return isNaN(e)||(e=this.getDataObject(e)),!(!e.__children||!e.__children.length)}isChild(t){return null!==this.getRowParent(t)}getChild(t,e){var n;return(null===(n=t.__children)||void 0===n?void 0:n[e])||null}isRowHighestLevel(t){return!this.isChild(t)}isParent(t){var e;let n=t;return isNaN(n)||(n=this.getDataObject(n)),n&&!!n.__children&&0!==(null===(e=n.__children)||void 0===e?void 0:e.length)}addChild(t,e){let n=e;this.hot.runHooks("beforeAddChild",t,n);let o=null;t&&(o=this.getRowIndex(t)),this.hot.runHooks("beforeCreateRow",o+this.countChildren(t)+1,1);let i=t;t||(i=this.mockParent()),i.__children||(i.__children=[]),n||(n=this.mockNode()),i.__children.push(n),this.rewriteCache();const r=this.getRowIndex(n);this.hot.rowIndexMapper.insertIndexes(r,1),this.hot.runHooks("afterCreateRow",r,1),this.hot.runHooks("afterAddChild",t,n)}addChildAtIndex(t,e,n){let o,i=n;if(i||(i=this.mockNode()),this.hot.runHooks("beforeAddChild",t,i,e),t){const n=this.getRowIndex(t)+e+1;this.hot.runHooks("beforeCreateRow",n,1),t.__children.splice(e,null,i),this.rewriteCache(),this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndexWithinParent(t),"__children",t.__children,"NestedRows.addChildAtIndex"),this.hot.rowIndexMapper.insertIndexes(n,1),this.plugin.enableCoreAPIModifiers(),this.hot.runHooks("afterCreateRow",n,1),o=n}else this.plugin.disableCoreAPIModifiers(),this.hot.alter("insert_row_above",e,1,"NestedRows.addChildAtIndex"),this.plugin.enableCoreAPIModifiers(),o=this.getRowIndex(this.data[e]);i=this.getDataObject(o),this.hot.runHooks("afterAddChild",t,i,e)}addSibling(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"below";const n=this.translateTrimmedRow(t),o=this.getRowParent(n),i=this.getRowIndexWithinParent(n);switch(e){case"below":this.addChildAtIndex(o,i+1,null);break;case"above":this.addChildAtIndex(o,i,null);break}}detachFromParent(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=null;const o=[];Array.isArray(t)?(Cb(t[0],t[2],(t=>{const e=this.translateTrimmedRow(t);o.push(this.getDataObject(e))})),Cb(0,o.length-2,(t=>{this.detachFromParent(o[t],!1)})),n=o[o.length-1]):n=t;const i=this.getRowIndex(n),r=this.countChildren(n),s=this.getRowIndexWithinParent(n),a=this.getRowParent(n),l=this.getRowParent(a),h=this.getRowIndex(l);let c=null;if(this.hot.runHooks("beforeDetachChild",a,n),null!=s){const t=Array.from(new Array(i+r+1).keys()).splice(-1*(r+1));if(this.hot.runHooks("beforeRemoveRow",i,r+1,t,this.plugin.pluginName),a.__children.splice(s,1),this.rewriteCache(),this.hot.runHooks("afterRemoveRow",i,r+1,t,this.plugin.pluginName),l){c=h+this.countChildren(l);const t=this.getChild(l,this.countChildren(l)-1),e=this.getRowIndex(t);this.hot.runHooks("beforeCreateRow",e+1,r+1,this.plugin.pluginName),l.__children.push(n)}else c=this.hot.countRows()+1,this.hot.runHooks("beforeCreateRow",c-2,r+1,this.plugin.pluginName),this.data.push(n)}this.rewriteCache(),this.hot.runHooks("afterCreateRow",c-2,r+1,this.plugin.pluginName),this.hot.runHooks("afterDetachChild",a,n,this.getRowIndex(n)),e&&this.hot.render()}filterData(t,e,n){const o=[];Mp(n,(t=>{o.push(this.getDataObject(t))})),Mp(o,(t=>{const e=this.getRowIndexWithinParent(t),n=this.getRowParent(t);null===n?this.data.splice(e,1):n.__children.splice(e,1)})),this.rewriteCache()}spliceData(t,e,n){const o=this.getDataObject(t-1);let i=null,r=t;o&&o.__children&&0===o.__children.length?(i=o,r=0):t<this.countAllRows()&&(i=this.getRowParent(t),r=this.getRowIndexWithinParent(t)),i?n?i.__children.splice(r,e,...n):i.__children.splice(r,e):n?this.data.splice(r,e,...n):this.data.splice(r,e),this.rewriteCache()}syncRowWithRawSource(t){let e=t,n=null;do{n=this.getRowParent(n),null!==n&&(e=n)}while(null!==n);this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndex(e),"__children",e.__children,"NestedRows.syncRowWithRawSource"),this.plugin.enableCoreAPIModifiers()}moveRow(t,e,n,o){const i=e===this.hot.countRows(),r=this.getRowParent(t),s=this.getRowIndexWithinParent(t),a=r.__children.slice(s,s+1),l=t>e;let h=i?this.getRowParent(e-1):this.getRowParent(e);null==h&&(h=this.getRowParent(e-1)),null==h&&(h=this.getDataObject(e-1)),h?h.__children||(h.__children=[]):(h=this.getDataObject(e),h.__children=[]);const c=i||n||o?h.__children.length:this.getRowIndexWithinParent(e),u=r===h;h.__children.splice(c,0,a[0]),r.__children.splice(s+(l&&u?1:0),1),this.syncRowWithRawSource(r),u||this.syncRowWithRawSource(h)}translateTrimmedRow(t){return this.plugin.collapsingUI?this.plugin.collapsingUI.translateTrimmedRow(t):t}untranslateTrimmedRow(t){return this.plugin.collapsingUI?this.plugin.collapsingUI.untranslateTrimmedRow(t):t}}const Yit=Uit;function zit(t,e,n){return e=Git(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Git(t){var e=Qit(t,"string");return"symbol"==typeof e?e:String(e)}function Qit(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class Kit{constructor(t,e){zit(this,"hot",void 0),zit(this,"plugin",void 0),this.hot=e,this.plugin=t}}const Xit=Kit;class qit extends Xit{static get CSS_CLASSES(){return{indicatorContainer:"ht_nestingLevels",parent:"ht_nestingParent",indicator:"ht_nestingLevel",emptyIndicator:"ht_nestingLevel_empty",button:"ht_nestingButton",expandButton:"ht_nestingExpand",collapseButton:"ht_nestingCollapse"}}constructor(t,e){super(t,e),this.dataManager=this.plugin.dataManager,this.collapsingUI=this.plugin.collapsingUI,this.rowHeaderWidthCache=null}appendLevelIndicators(t,e){const n=this.hot.toPhysicalRow(t),o=this.dataManager.getRowLevel(n),i=this.dataManager.getDataObject(n),r=e.getElementsByTagName("DIV")[0],s=r.querySelector("span.rowHeader"),a=r.querySelectorAll('[class^="ht_nesting"]'),l=this.hot.getSettings().ariaTags;if(Mp(a,(t=>{t&&r.removeChild(t)})),cA(e,qit.CSS_CLASSES.indicatorContainer),o){const{rootDocument:t}=this.hot,e=s.cloneNode(!0);r.innerHTML="",Cb(0,o-1,(()=>{const e=t.createElement("SPAN");cA(e,qit.CSS_CLASSES.emptyIndicator),r.appendChild(e)})),r.appendChild(e)}if(this.dataManager.hasChildren(i)){const t=this.hot.rootDocument.createElement("DIV");l&&dA(t,[Iw()]),cA(e,qit.CSS_CLASSES.parent),this.collapsingUI.areChildrenCollapsed(n)?(cA(t,`${qit.CSS_CLASSES.button} ${qit.CSS_CLASSES.expandButton}`),l&&dA(e,[Lw(!1)])):(cA(t,`${qit.CSS_CLASSES.button} ${qit.CSS_CLASSES.collapseButton}`),l&&dA(e,[Lw(!0)])),r.appendChild(t)}}updateRowHeaderWidth(t){let e=t;e||(e=this.dataManager.cache.levelCount),this.rowHeaderWidthCache=Math.max(50,11+10*e+25),this.hot.render()}}const Zit=qit;class Jit extends Xit{constructor(t,e){var n;super(t,e),n=this,this.dataManager=this.plugin.dataManager,this.collapsedRows=[],this.collapsedRowsStash={stash:function(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];n.lastCollapsedRows=n.collapsedRows.slice(0),n.expandMultipleChildren(n.lastCollapsedRows,t)},shiftStash:function(t,e){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;null==e&&(e=1/0),Mp(n.lastCollapsedRows,((i,r)=>{i>=t&&i<e&&(n.lastCollapsedRows[r]=i+o)}))},applyStash:function(){let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];n.collapseMultipleChildren(n.lastCollapsedRows,t),n.lastCollapsedRows=void 0},trimStash:(t,e)=>{Cb(t,t+e-1,(t=>{const e=this.lastCollapsedRows.indexOf(t);e>-1&&this.lastCollapsedRows.splice(e,1)}))}}}collapseChildren(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const o=[];let i=null,r=null,s=null;return isNaN(t)?(i=t,r=this.dataManager.getRowIndex(i)):(i=this.dataManager.getDataObject(t),r=t),this.dataManager.hasChildren(i)&&Mp(i.__children,(t=>{o.push(this.dataManager.getRowIndex(t))})),s=this.collapseRows(o,!0,!1),n&&this.trimRows(s),e&&this.renderAndAdjust(),-1===this.collapsedRows.indexOf(r)&&this.collapsedRows.push(r),s}collapseMultipleChildren(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const o=[];Mp(t,(t=>{o.push(...this.collapseChildren(t,!1,!1))})),n&&this.trimRows(o),e&&this.renderAndAdjust()}collapseRow(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.collapseRows([t],e)}collapseRows(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const o=[];return Mp(t,(t=>{o.push(t),e&&this.collapseChildRows(t,o)})),n&&this.trimRows(o),o}collapseChildRows(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(this.dataManager.hasChildren(t)){const n=this.dataManager.getDataObject(t);Mp(n.__children,(t=>{const n=this.dataManager.getRowIndex(t);e.push(n),this.collapseChildRows(n,e)}))}n&&this.trimRows(e)}expandRow(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.expandRows([t],e)}expandRows(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const o=[];return Mp(t,(t=>{o.push(t),e&&this.expandChildRows(t,o)})),n&&this.untrimRows(o),o}expandChildRows(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(this.dataManager.hasChildren(t)){const n=this.dataManager.getDataObject(t);Mp(n.__children,(t=>{if(!this.isAnyParentCollapsed(t)){const n=this.dataManager.getRowIndex(t);e.push(n),this.expandChildRows(n,e)}}))}n&&this.untrimRows(e)}expandChildren(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const o=[];let i=null,r=null,s=null;return isNaN(t)?(i=t,r=this.dataManager.getRowIndex(t)):(i=this.dataManager.getDataObject(t),r=t),this.collapsedRows.splice(this.collapsedRows.indexOf(r),1),this.dataManager.hasChildren(i)&&Mp(i.__children,(t=>{const e=this.dataManager.getRowIndex(t);o.push(e)})),s=this.expandRows(o,!0,!1),n&&this.untrimRows(s),e&&this.renderAndAdjust(),s}expandMultipleChildren(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const o=[];Mp(t,(t=>{o.push(...this.expandChildren(t,!1,!1))})),n&&this.untrimRows(o),e&&this.renderAndAdjust()}collapseAll(){const t=this.dataManager.getData(),e=[];Mp(t,(t=>{this.dataManager.hasChildren(t)&&e.push(t)})),this.collapseMultipleChildren(e),this.renderAndAdjust()}expandAll(){const t=this.dataManager.getData(),e=[];Mp(t,(t=>{this.dataManager.hasChildren(t)&&e.push(t)})),this.expandMultipleChildren(e),this.renderAndAdjust()}trimRows(t){this.hot.batchExecution((()=>{Mp(t,(t=>{this.plugin.collapsedRowsMap.setValueAtIndex(t,!0)}))}),!0)}untrimRows(t){this.hot.batchExecution((()=>{Mp(t,(t=>{this.plugin.collapsedRowsMap.setValueAtIndex(t,!1)}))}),!0)}areChildrenCollapsed(t){let e=isNaN(t)?t:this.dataManager.getDataObject(t),n=!0;return null===e&&(e={__children:this.dataManager.data}),this.dataManager.hasChildren(e)&&Mp(e.__children,(t=>{const e=this.dataManager.getRowIndex(t);if(!this.plugin.collapsedRowsMap.getValueAtIndex(e))return n=!1,!1})),n}isAnyParentCollapsed(t){let e=t;for(;null!==e;){e=this.dataManager.getRowParent(e);const t=this.dataManager.getRowIndex(e);if(this.collapsedRows.indexOf(t)>-1)return!0}return!1}toggleState(t,e){if(e.col>=0)return;const n=this.translateTrimmedRow(e.row);hA(t.target,Zit.CSS_CLASSES.button)&&(this.areChildrenCollapsed(n)?this.expandChildren(n):this.collapseChildren(n),Uy(t))}translateTrimmedRow(t){return this.hot.toPhysicalRow(t)}untranslateTrimmedRow(t){return this.hot.toVisualRow(t)}renderAndAdjust(){this.hot.render(),this.hot.view.adjustElementsSize()}}const $it=Jit;function trt(t,e,n){ert(t,e),e.set(t,n)}function ert(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function nrt(t,e,n){return e=ort(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ort(t){var e=irt(t,"string");return"symbol"==typeof e?e:String(e)}function irt(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function rrt(t,e){var n=srt(t,e,"get");return art(t,n)}function srt(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function art(t,e){return e.get?e.get.call(t):e.value}var lrt=new WeakMap;class hrt extends Xit{constructor(){super(...arguments),nrt(this,"dataManager",this.plugin.dataManager),trt(this,lrt,{writable:!0,value:{row_above:(t,e)=>{const n=e[e.length-1];this.dataManager.addSibling(n.start.row,"above")},row_below:(t,e)=>{const n=e[e.length-1];this.dataManager.addSibling(n.start.row,"below")}}})}appendOptions(t){const e=[{key:"add_child",name(){return this.getTranslatedPhrase(cH)},callback:()=>{const t=this.dataManager.translateTrimmedRow(this.hot.getSelectedLast()[0]),e=this.dataManager.getDataObject(t);this.dataManager.addChild(e)},disabled:()=>{const t=this.hot.getSelectedLast();return!t||t[0]<0||this.hot.selection.isSelectedByColumnHeader()||this.hot.countRows()>=this.hot.getSettings().maxRows}},{key:"detach_from_parent",name(){return this.getTranslatedPhrase(uH)},callback:()=>{this.dataManager.detachFromParent(this.hot.getSelectedLast())},disabled:()=>{const t=this.hot.getSelectedLast(),e=this.dataManager.translateTrimmedRow(t[0]);return!this.dataManager.getRowParent(e)||!t||t[0]<0||this.hot.selection.isSelectedByColumnHeader()||this.hot.countRows()>=this.hot.getSettings().maxRows}},{name:"---------"}];return Cb(0,t.items.length-1,(n=>{if(0===n)return Mp(e,((e,o)=>{t.items.splice(n+o,0,e)})),!1})),this.modifyRowInsertingOptions(t)}modifyRowInsertingOptions(t){return Cb(0,t.items.length-1,(e=>{const n=rrt(this,lrt)[t.items[e].key];null!=n&&(t.items[e].callback=n)})),t}}const crt=hrt;function urt(t,e,n){return e=drt(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function drt(t){var e=grt(t,"string");return"symbol"==typeof e?e:String(e)}function grt(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class frt{constructor(t){urt(this,"plugin",void 0),urt(this,"hot",void 0),urt(this,"dataManager",void 0),urt(this,"collapsingUI",void 0),this.plugin=t,this.hot=t.hot,this.dataManager=t.dataManager,this.collapsingUI=t.collapsingUI}onBeforeRowMove(t,e,n,o){if(this.displayAPICompatibilityWarning({rows:t,finalIndex:e,dropIndex:n,movePossible:o}))return!1;this.movedToCollapsed=!1;const i=n===this.hot.countRows(),r=i?this.hot.countSourceRows():this.dataManager.translateTrimmedRow(n);let s=!0;const a=t.map((t=>{if(!s)return!1;const e=this.dataManager.translateTrimmedRow(t);return s=this.shouldAllowMoving(e,r),e})),l=-1===a.indexOf(r);if(!s||!l)return!1;const h=this.getBaseParent(a),c=this.getTargetParent(i,r),u=h===c;return this.movedToCollapsed=this.collapsingUI.areChildrenCollapsed(c),this.collapsingUI.collapsedRowsStash.stash(),this.shiftCollapsibleParentsLocations(a,r,u),this.moveRows(a,r,c),this.dataManager.rewriteCache(),this.moveCellsMeta(a,r),this.collapsingUI.collapsedRowsStash.applyStash(!1),this.hot.runHooks("afterRowMove",t,e,n,o,o&&this.isRowOrderChanged(t,e)),this.hot.render(),this.selectCells(t,n),!1}displayAPICompatibilityWarning(t){const{rows:e,finalIndex:n,dropIndex:o,movePossible:i}=t;let r=!1;return Fp(o)&&(Xy(Lp`Since version 8.0.0 of the Handsontable the 'moveRows' method isn't used for moving rows\x20
      when the NestedRows plugin is enabled. Please use the 'dragRows' method instead.`),this.hot.runHooks("afterRowMove",e,n,o,i,!1),r=!0),r}shouldAllowMoving(t,e){return!(this.dataManager.isParent(t)||this.dataManager.isRowHighestLevel(t)||t===e||0===e)}getBaseParent(t){return this.dataManager.getRowParent(t[0])}getTargetParent(t,e){let n=this.dataManager.getRowParent(t?e-1:e);return null==n&&(n=this.dataManager.getRowParent(e-1)),n}shiftCollapsibleParentsLocations(t,e,n){n||(Math.max(...t)<=e?this.collapsingUI.collapsedRowsStash.shiftStash(t[0],e,-1*t.length):this.collapsingUI.collapsedRowsStash.shiftStash(e,t[0],t.length))}moveRows(t,e,n){const o=e===this.dataManager.getRowIndex(n)+this.dataManager.countChildren(n)+1;this.hot.batchRender((()=>{t.forEach((t=>{this.dataManager.moveRow(t,e,this.movedToCollapsed,o)}))}))}moveCellsMeta(t,e){const n=[],o=Math.max(...t)<e;t.forEach((t=>{n.push(this.hot.getCellMetaAtRow(t))})),this.hot.spliceCellsMeta(t[0],t.length),this.hot.spliceCellsMeta(e-(o?n.length:0),0,...n)}selectCells(t,e){const n=t.length;let o=0,i=0,r=null,s=null;if(this.movedToCollapsed){let r=null;r=t[n-1]<e?this.dataManager.translateTrimmedRow(e-n):this.dataManager.translateTrimmedRow(e);const s=this.dataManager.getRowParent(null===r?this.hot.countSourceRows()-1:r-1),a=this.dataManager.getRowIndex(s);o=this.dataManager.untranslateTrimmedRow(a),i=o}else t[n-1]<e?(i=e-1,o=i-n+1):(o=e,i=o+n-1);r=this.hot.selection,s=this.hot.countCols()-1,r.setRangeStart(this.hot._createCellCoords(o,0)),r.setRangeEnd(this.hot._createCellCoords(i,s),!0)}isRowOrderChanged(t,e){return t.some(((t,n)=>t-n!==e))}}function mrt(t,e){wrt(t,e),e.add(t)}function prt(t,e,n){wrt(t,e),e.set(t,n)}function wrt(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Art(t,e,n){return e=vrt(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function vrt(t){var e=yrt(t,"string");return"symbol"==typeof e?e:String(e)}function yrt(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function Crt(t,e){var n=Ert(t,e,"get");return brt(t,n)}function brt(t,e){return e.get?e.get.call(t):e.value}function Srt(t,e,n){var o=Ert(t,e,"set");return Rrt(t,o,n),n}function Ert(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function Rrt(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function Mrt(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const Trt="nestedRows",krt=300,xrt=Trt,Irt="The Nested Rows plugin requires an Array of Objects as a dataset to be provided. The plugin has been disabled.";var Ort=new WeakMap,Hrt=new WeakMap,Drt=new WeakSet,Nrt=new WeakSet,Prt=new WeakSet,_rt=new WeakSet,Brt=new WeakSet,Lrt=new WeakSet,Vrt=new WeakSet,Wrt=new WeakSet,Frt=new WeakSet,jrt=new WeakSet,Urt=new WeakSet,Yrt=new WeakSet,zrt=new WeakSet,Grt=new WeakSet,Qrt=new WeakSet,Krt=new WeakSet;class Xrt extends jF{constructor(){super(...arguments),mrt(this,Krt),mrt(this,Qrt),mrt(this,Grt),mrt(this,zrt),mrt(this,Yrt),mrt(this,Urt),mrt(this,jrt),mrt(this,Frt),mrt(this,Wrt),mrt(this,Vrt),mrt(this,Lrt),mrt(this,Brt),mrt(this,_rt),mrt(this,Prt),mrt(this,Nrt),mrt(this,Drt),Art(this,"dataManager",null),Art(this,"headersUI",null),Art(this,"collapsedRowsMap",null),prt(this,Ort,{writable:!0,value:!1}),prt(this,Hrt,{writable:!0,value:!1})}static get PLUGIN_KEY(){return Trt}static get PLUGIN_PRIORITY(){return krt}isEnabled(){return!!this.hot.getSettings()[Trt]}enablePlugin(){var t=this;this.enabled||(this.collapsedRowsMap=this.hot.rowIndexMapper.registerMap("nestedRows",new TI),this.dataManager=new Yit(this,this.hot),this.collapsingUI=new $it(this,this.hot),this.headersUI=new Zit(this,this.hot),this.contextMenuUI=new crt(this,this.hot),this.rowMoveController=new frt(this),this.addHook("afterInit",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return Mrt(t,Grt,hst).call(t,...n)})),this.addHook("beforeViewRender",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return Mrt(t,Qrt,cst).call(t,...n)})),this.addHook("modifyRowData",(function(){return t.onModifyRowData(...arguments)})),this.addHook("modifySourceLength",(function(){return t.onModifySourceLength(...arguments)})),this.addHook("beforeDataSplice",(function(){return t.onBeforeDataSplice(...arguments)})),this.addHook("filterData",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return Mrt(t,Prt,Jrt).call(t,...n)})),this.addHook("afterContextMenuDefaultOptions",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return Mrt(t,_rt,$rt).call(t,...n)})),this.addHook("afterGetRowHeader",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return Mrt(t,Brt,tst).call(t,...n)})),this.addHook("beforeOnCellMouseDown",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return Mrt(t,Nrt,Zrt).call(t,...n)})),this.addHook("beforeRemoveRow",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return Mrt(t,Wrt,ost).call(t,...n)})),this.addHook("afterRemoveRow",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return Mrt(t,Vrt,nst).call(t,...n)})),this.addHook("beforeAddChild",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return Mrt(t,Frt,ist).call(t,...n)})),this.addHook("afterAddChild",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return Mrt(t,jrt,rst).call(t,...n)})),this.addHook("beforeDetachChild",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return Mrt(t,Urt,sst).call(t,...n)})),this.addHook("afterDetachChild",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return Mrt(t,Yrt,ast).call(t,...n)})),this.addHook("modifyRowHeaderWidth",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return Mrt(t,Lrt,est).call(t,...n)})),this.addHook("afterCreateRow",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return Mrt(t,zrt,lst).call(t,...n)})),this.addHook("beforeRowMove",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return Mrt(t,Drt,qrt).call(t,...n)})),this.addHook("beforeLoadData",(t=>Mrt(this,Krt,ust).call(this,t))),this.addHook("beforeUpdateData",(t=>Mrt(this,Krt,ust).call(this,t))),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("nestedRows"),this.unregisterShortcuts(),super.disablePlugin()}updatePlugin(){this.disablePlugin();const t=this.dataManager.getData();this.enablePlugin(),this.dataManager.updateWithData(t),super.updatePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{const{highlight:t}=this.hot.getSelectedRangeLast();if(-1===t.col&&t.row>=0){const e=this.collapsingUI.translateTrimmedRow(t.row);this.collapsingUI.areChildrenCollapsed(e)?this.collapsingUI.expandChildren(e):this.collapsingUI.collapseChildren(e)}},runOnlyIf:()=>{var t;const e=null===(t=this.hot.getSelectedRangeLast())||void 0===t?void 0:t.highlight;return e&&this.hot.selection.isCellVisible(e)&&e.isHeader()},group:xrt})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(xrt)}disableCoreAPIModifiers(){Srt(this,Hrt,!0)}enableCoreAPIModifiers(){Srt(this,Hrt,!1)}onModifyRowData(t){if(!Crt(this,Hrt))return this.dataManager.getDataObject(t)}onModifySourceLength(){if(!Crt(this,Hrt))return this.dataManager.countAllRows()}onBeforeDataSplice(t,e,n){return!(!Crt(this,Hrt)&&!this.dataManager.isRowHighestLevel(t))||(this.dataManager.spliceData(t,e,n),!1)}destroy(){super.destroy()}}function qrt(t,e,n,o){return this.rowMoveController.onBeforeRowMove(t,e,n,o)}function Zrt(t,e,n){this.collapsingUI.toggleState(t,e,n)}function Jrt(t,e,n){return this.collapsingUI.collapsedRowsStash.stash(),this.collapsingUI.collapsedRowsStash.trimStash(n[0],e),this.collapsingUI.collapsedRowsStash.shiftStash(n[0],null,-1*e),this.dataManager.filterData(t,e,n),Srt(this,Ort,!0),this.dataManager.getData().slice()}function $rt(t){return this.contextMenuUI.appendOptions(t)}function tst(t,e){this.headersUI.appendLevelIndicators(t,e)}function est(t){return Math.max(this.headersUI.rowHeaderWidthCache,t)}function nst(t,e,n,o){o!==this.pluginName&&this.hot._registerTimeout((()=>{Srt(this,Ort,!1),this.headersUI.updateRowHeaderWidth(),this.collapsingUI.collapsedRowsStash.applyStash()}))}function ost(t,e,n){const o=Array.from(n.reduce(((t,e)=>{if(this.dataManager.isParent(e)){const n=this.dataManager.getDataObject(e).__children;return t.add(e),Array.isArray(n)&&n.forEach((e=>t.add(this.dataManager.getRowIndex(e)))),t}return t.add(e)}),new Set));n.length=0,n.push(...o)}function ist(){this.collapsingUI.collapsedRowsStash.stash()}function rst(t,e){this.collapsingUI.collapsedRowsStash.shiftStash(this.dataManager.getRowIndex(e)),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}function sst(){this.collapsingUI.collapsedRowsStash.stash()}function ast(t,e,n){this.collapsingUI.collapsedRowsStash.shiftStash(n,null,-1),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}function lst(){this.dataManager.rewriteCache()}function hst(){this.headersUI.updateRowHeaderWidth()}function cst(t,e){Crt(this,Ort)&&(e.skipRender=!0)}function ust(t){if(!iI(t))return qy(Irt),this.hot.getSettings()[Trt]=!1,void this.disablePlugin();this.dataManager.setData(t),this.dataManager.rewriteCache()}function dst(t,e,n){return e=gst(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function gst(t){var e=fst(t,"string");return"symbol"==typeof e?e:String(e)}function fst(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class mst{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window;dst(this,"rootWindow",void 0),dst(this,"prefix",void 0),dst(this,"savedKeys",[]),this.rootWindow=e,this.prefix=t,this.loadSavedKeys()}saveValue(t,e){this.rootWindow.localStorage.setItem(`${this.prefix}_${t}`,JSON.stringify(e)),-1===this.savedKeys.indexOf(t)&&(this.savedKeys.push(t),this.saveSavedKeys())}loadValue(t,e){const n="undefined"==typeof t?e:t,o=this.rootWindow.localStorage.getItem(`${this.prefix}_${n}`);return null===o?void 0:JSON.parse(o)}reset(t){this.rootWindow.localStorage.removeItem(`${this.prefix}_${t}`)}resetAll(){Mp(this.savedKeys,((t,e)=>{this.rootWindow.localStorage.removeItem(`${this.prefix}_${this.savedKeys[e]}`)})),this.clearSavedKeys()}loadSavedKeys(){const t=this.rootWindow.localStorage.getItem(`${this.prefix}__persistentStateKeys`),e="string"==typeof t?JSON.parse(t):void 0;this.savedKeys=e||[]}saveSavedKeys(){this.rootWindow.localStorage.setItem(`${this.prefix}__persistentStateKeys`,JSON.stringify(this.savedKeys))}clearSavedKeys(){this.savedKeys.length=0,this.saveSavedKeys()}}const pst=mst;function wst(t,e,n){return e=Ast(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ast(t){var e=vst(t,"string");return"symbol"==typeof e?e:String(e)}function vst(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}aC.getSingleton().register("persistentStateSave"),aC.getSingleton().register("persistentStateLoad"),aC.getSingleton().register("persistentStateReset");const yst="persistentState",Cst=0;class bst extends jF{constructor(){super(...arguments),wst(this,"storage",void 0)}static get PLUGIN_KEY(){return yst}static get PLUGIN_PRIORITY(){return Cst}isEnabled(){return!!this.hot.getSettings()[yst]}enablePlugin(){this.enabled||(this.storage||(this.storage=new pst(this.hot.rootElement.id,this.hot.rootWindow)),this.addHook("persistentStateSave",((t,e)=>this.saveValue(t,e))),this.addHook("persistentStateLoad",((t,e)=>this.loadValue(t,e))),this.addHook("persistentStateReset",(()=>this.resetValue())),super.enablePlugin())}disablePlugin(){this.storage=void 0,super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}loadValue(t,e){e.value=this.storage.loadValue(t)}saveValue(t,e){this.storage.saveValue(t,e)}resetValue(t){"undefined"==typeof t?this.storage.resetAll():this.storage.reset(t)}destroy(){super.destroy()}}function Sst(t,e){Est(t,e),e.add(t)}function Est(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Rst(t,e,n){return e=Mst(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Mst(t){var e=Tst(t,"string");return"symbol"==typeof e?e:String(e)}function Tst(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function kst(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const xst="search",Ist=190,Ost="htSearchResult",Hst=function(t,e,n,o,i){t.getCellMeta(e,n).isSearchResult=i},Dst=function(t,e,n){return!(Fp(t)||null===t||!t.toLocaleLowerCase||0===t.length||Fp(e)||null===e)&&-1!==e.toString().toLocaleLowerCase(n.locale).indexOf(t.toLocaleLowerCase(n.locale))};var Nst=new WeakSet;class Pst extends jF{constructor(){super(...arguments),Sst(this,Nst),Rst(this,"callback",Hst),Rst(this,"queryMethod",Dst),Rst(this,"searchResultClass",Ost)}static get PLUGIN_KEY(){return xst}static get PLUGIN_PRIORITY(){return Ist}isEnabled(){return this.hot.getSettings()[xst]}enablePlugin(){var t=this;if(this.enabled)return;const e=this.hot.getSettings()[xst];this.updatePluginSettings(e),this.addHook("beforeRenderer",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return kst(t,Nst,_st).call(t,...n)})),super.enablePlugin()}disablePlugin(){var t=this;const e=function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return kst(t,Nst,_st).call(t,...n)};this.hot.addHook("beforeRenderer",e),this.hot.addHookOnce("afterViewRender",(()=>{this.hot.removeHook("beforeRenderer",e)})),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}query(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.getCallback(),n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.getQueryMethod();const o=this.hot.countRows(),i=this.hot.countCols(),r=[],s=this.hot;return Cb(0,o-1,(o=>{Cb(0,i-1,(i=>{const a=this.hot.getDataAtCell(o,i),l=this.hot.getCellMeta(o,i),h=l.search.callback||e,c=(l.search.queryMethod||n)(t,a,l);if(c){const t={row:o,col:i,data:a};r.push(t)}h&&h(s,o,i,a,c)}))})),r}getCallback(){return this.callback}setCallback(t){this.callback=t}getQueryMethod(){return this.queryMethod}setQueryMethod(t){this.queryMethod=t}getSearchResultClass(){return this.searchResultClass}setSearchResultClass(t){this.searchResultClass=t}updatePluginSettings(t){ty(t)&&(t.searchResultClass&&this.setSearchResultClass(t.searchResultClass),t.queryMethod&&this.setQueryMethod(t.queryMethod),t.callback&&this.setCallback(t.callback))}destroy(){super.destroy()}}function _st(t,e,n,o,i,r){const s=r.className||[];let a=[];"string"==typeof s?a=s.split(" "):a.push(...s),this.isEnabled()&&r.isSearchResult?a.includes(this.searchResultClass)||a.push(`${this.searchResultClass}`):a.includes(this.searchResultClass)&&a.splice(a.indexOf(this.searchResultClass),1),r.className=a.join(" ")}function Bst(t,e){Lst(t,e),e.add(t)}function Lst(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Vst(t,e,n){return e=Wst(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Wst(t){var e=Fst(t,"string");return"symbol"==typeof e?e:String(e)}function Fst(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function jst(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const Ust="touchScroll",Yst=200;var zst=new WeakSet,Gst=new WeakSet,Qst=new WeakSet;class Kst extends jF{constructor(){super(...arguments),Bst(this,Qst),Bst(this,Gst),Bst(this,zst),Vst(this,"scrollbars",[]),Vst(this,"clones",[]),Vst(this,"lockedCollection",!1),Vst(this,"freezeOverlays",!1)}static get PLUGIN_KEY(){return Ust}static get PLUGIN_PRIORITY(){return Yst}static get SETTING_KEYS(){return!0}isEnabled(){return uy()}enablePlugin(){this.enabled||(this.addHook("afterViewRender",(()=>jst(this,zst,Xst).call(this))),this.registerEvents(),super.enablePlugin())}updatePlugin(){this.lockedCollection=!1,super.updatePlugin()}disablePlugin(){super.disablePlugin()}registerEvents(){this.addHook("beforeTouchScroll",(()=>jst(this,Gst,qst).call(this))),this.addHook("afterMomentumScroll",(()=>jst(this,Qst,Zst).call(this)))}}function Xst(){if(this.lockedCollection)return;const{topOverlay:t,bottomOverlay:e,inlineStartOverlay:n,topInlineStartCornerOverlay:o,bottomInlineStartCornerOverlay:i}=this.hot.view._wt.wtOverlays;this.lockedCollection=!0,this.scrollbars.length=0,this.scrollbars.push(t),e.clone&&this.scrollbars.push(e),this.scrollbars.push(n),o&&this.scrollbars.push(o),i&&i.clone&&this.scrollbars.push(i),this.clones=[],t.needFullRender&&this.clones.push(t.clone.wtTable.holder.parentNode),e.needFullRender&&this.clones.push(e.clone.wtTable.holder.parentNode),n.needFullRender&&this.clones.push(n.clone.wtTable.holder.parentNode),o&&this.clones.push(o.clone.wtTable.holder.parentNode),i&&i.clone&&this.clones.push(i.clone.wtTable.holder.parentNode)}function qst(){this.freezeOverlays=!0,Mp(this.clones,(t=>{cA(t,"hide-tween")}))}function Zst(){this.freezeOverlays=!1,Mp(this.clones,(t=>{uA(t,"hide-tween"),cA(t,"show-tween")})),this.hot._registerTimeout((()=>{Mp(this.clones,(t=>{uA(t,"show-tween")}))}),400),Mp(this.scrollbars,(t=>{t.refresh(),t.resetFixedPosition()})),this.hot.view._wt.wtOverlays.syncScrollWithMaster()}function Jst(t,e){$st(t,e),e.add(t)}function $st(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function tat(t,e,n){return e=eat(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function eat(t){var e=nat(t,"string");return"symbol"==typeof e?e:String(e)}function nat(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function oat(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const iat="trimRows",rat=330;var sat=new WeakSet;class aat extends jF{constructor(){super(...arguments),Jst(this,sat),tat(this,"trimmedRowsMap",null)}static get PLUGIN_KEY(){return iat}static get PLUGIN_PRIORITY(){return rat}isEnabled(){return!!this.hot.getSettings()[iat]}enablePlugin(){this.enabled||(this.trimmedRowsMap=this.hot.rowIndexMapper.registerMap("trimRows",new TI),this.trimmedRowsMap.addLocalHook("init",(()=>oat(this,sat,lat).call(this))),super.enablePlugin())}updatePlugin(){const t=this.hot.getSettings()[iat];Array.isArray(t)&&this.hot.batchExecution((()=>{this.trimmedRowsMap.clear(),Mp(t,(t=>{this.trimmedRowsMap.setValueAtIndex(t,!0)}))}),!0),super.updatePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("trimRows"),super.disablePlugin()}getTrimmedRows(){return this.trimmedRowsMap.getTrimmedIndexes()}trimRows(t){const e=this.getTrimmedRows(),n=this.isValidConfig(t);let o=e;n&&(o=Array.from(new Set(e.concat(t)))),!1!==this.hot.runHooks("beforeTrimRow",e,o,n)&&(n&&this.hot.batchExecution((()=>{Mp(t,(t=>{this.trimmedRowsMap.setValueAtIndex(t,!0)}))}),!0),this.hot.runHooks("afterTrimRow",e,o,n,n&&o.length>e.length))}trimRow(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];this.trimRows(e)}untrimRows(t){const e=this.getTrimmedRows(),n=this.isValidConfig(t);let o=e;const i=this.trimmedRowsMap.getValues().slice(),r=t.length>0;n&&r&&(Mp(t,(t=>{i[t]=!1})),o=Sp(i,((t,e,n)=>(e&&t.push(n),t)),[])),!1!==this.hot.runHooks("beforeUntrimRow",e,o,n&&r)&&(n&&r&&this.trimmedRowsMap.setValues(i),this.hot.runHooks("afterUntrimRow",e,o,n&&r,n&&o.length<e.length))}untrimRow(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];this.untrimRows(e)}isTrimmed(t){return this.trimmedRowsMap.getValueAtIndex(t)||!1}untrimAll(){this.untrimRows(this.getTrimmedRows())}isValidConfig(t){const e=this.hot.countSourceRows();return t.every((t=>Number.isInteger(t)&&t>=0&&t<e))}destroy(){super.destroy()}}function lat(){const t=this.hot.getSettings()[iat];Array.isArray(t)&&this.hot.batchExecution((()=>{Mp(t,(t=>{this.trimmedRowsMap.setValueAtIndex(t,!0)}))}),!0)}var hat={},cat=ke,uat=hat,dat=cat("iterator"),gat=Array.prototype,fat=function(t){return void 0!==t&&(uat.Array===t||gat[dat]===t)},mat=Zr,pat=Yt,wat=J,Aat=hat,vat=ke,yat=vat("iterator"),Cat=function(t){if(!wat(t))return pat(t,yat)||pat(t,"@@iterator")||Aat[mat(t)]},bat=x,Sat=Ft,Eat=gn,Rat=Bt,Mat=Cat,Tat=TypeError,kat=function(t,e){var n=arguments.length<2?Mat(t):e;if(Sat(n))return Eat(bat(n,t));throw new Tat(Rat(t)+" is not iterable")},xat=x,Iat=gn,Oat=Yt,Hat=function(t,e,n){var o,i;Iat(t);try{if(o=Oat(t,"return"),!o){if("throw"===e)throw n;return n}o=xat(o,t)}catch(r){i=!0,o=r}if("throw"===e)throw n;if(i)throw o;return Iat(o),n},Dat=ta,Nat=x,Pat=gn,_at=Bt,Bat=fat,Lat=ni,Vat=ft,Wat=kat,Fat=Cat,jat=Hat,Uat=TypeError,Yat=function(t,e){this.stopped=t,this.result=e},zat=Yat.prototype,Gat=function(t,e,n){var o,i,r,s,a,l,h,c=n&&n.that,u=!(!n||!n.AS_ENTRIES),d=!(!n||!n.IS_RECORD),g=!(!n||!n.IS_ITERATOR),f=!(!n||!n.INTERRUPTED),m=Dat(e,c),p=function(t){return o&&jat(o,"normal",t),new Yat(!0,t)},w=function(t){return u?(Pat(t),f?m(t[0],t[1],p):m(t[0],t[1])):f?m(t,p):m(t)};if(d)o=t.iterator;else if(g)o=t;else{if(i=Fat(t),!i)throw new Uat(_at(t)+" is not iterable");if(Bat(i)){for(r=0,s=Lat(t);s>r;r++)if(a=w(t[r]),a&&Vat(zat,a))return a;return new Yat(!1)}o=Wat(t,i)}for(l=d?t.next:o.next;!(h=Nat(l,o)).done;){try{a=w(h.value)}catch(A){jat(o,"throw",A)}if("object"==typeof a&&a&&Vat(zat,a))return a}return new Yat(!1)},Qat=We,Kat=sn,Xat=_,qat=function(t,e,n){var o=Qat(e);o in t?Kat.f(t,o,Xat(0,n)):t[o]=n},Zat=Ki,Jat=Gat,$at=qat;Zat({target:"Object",stat:!0},{fromEntries:function(t){var e={};return Jat(t,(function(t,n){$at(e,t,n)}),{AS_ENTRIES:!0}),e}});const tlt="undoRedo",elt="undoRedo";function nlt(t){const e=this;this.instance=t,this.doneActions=[],this.undoneActions=[],this.ignoreNewActions=!1,this.enabled=!1,t.addHook("afterChange",(function(n,o){const i=n&&n.length;if(!i||!n.find((t=>{const[,,e,n]=t;return e!==n})))return;const r=()=>{const e=n.reduce(((t,e)=>(t.push([...e]),t)),[]);Mp(e,(e=>{e[1]=t.propToCol(e[1])}));const o=i>1?this.getSelected():[[e[0][0],e[0][1]]];return new nlt.ChangeAction(e,o)};e.done(r,o)})),t.addHook("afterCreateRow",((t,n,o)=>{e.done((()=>new nlt.CreateRowAction(t,n)),o)}));const n=(e,n,o,i)=>{const r=["visualRow","visualCol","row","col","prop"],s=r.length,a=[];return Cb(o,i,(o=>{Cb(e,n,(e=>{const n=t.getCellMeta(e,o);if(Object.keys(n).length!==s){const t=Object.fromEntries(Object.entries(n).filter((t=>{let[e]=t;return!1===r.includes(e)})));a.push([n.visualRow,n.visualCol,t])}}))})),a};t.addHook("beforeRemoveRow",((o,i,r,s)=>{const a=()=>{const r=t.toPhysicalRow(o),s=r+i-1,a=qv(e.instance.getSourceData(r,0,r+i-1,e.instance.countSourceCols()-1));return new nlt.RemoveRowAction(r,a,t.getSettings().fixedRowsBottom,t.getSettings().fixedRowsTop,t.rowIndexMapper.getIndexesSequence(),n(r,s,0,t.countCols()-1))};e.done(a,s)})),t.addHook("afterCreateCol",((t,n,o)=>{e.done((()=>new nlt.CreateColumnAction(t,n)),o)})),t.addHook("beforeRemoveCol",((o,i,r,s)=>{const a=()=>{const r=e.instance.getSourceDataArray(),s=(e.instance.countCols()+o)%e.instance.countCols(),a=s+i-1,l=[],h=[],c=[];Cb(r.length-1,(e=>{const n=[],o=r[e];Cb(s,a,(e=>{n.push(o[t.toPhysicalColumn(e)])})),l.push(n)})),Cb(i-1,(e=>{c.push(t.toPhysicalColumn(s+e))})),Array.isArray(t.getSettings().colHeaders)&&Cb(i-1,(e=>{h.push(t.getSettings().colHeaders[t.toPhysicalColumn(s+e)]||null)}));const u=t.columnIndexMapper.getIndexesSequence(),d=t.rowIndexMapper.getIndexesSequence();return new nlt.RemoveColumnAction(s,c,l,h,u,d,t.getSettings().fixedColumnsStart,n(0,t.countRows(),s,a))};e.done(a,s)})),t.addHook("beforeCellAlignment",((t,n,o,i)=>{e.done((()=>new nlt.CellAlignmentAction(t,n,o,i)))})),t.addHook("beforeFilter",(t=>{e.done((()=>new nlt.FiltersAction(t)))})),t.addHook("beforeRowMove",((t,n)=>{!1!==t&&e.done((()=>new nlt.RowMoveAction(t,n)))})),t.addHook("beforeMergeCells",((n,o)=>{o||e.done((()=>new nlt.MergeCellsAction(t,n)))})),t.addHook("afterUnmergeCells",((n,o)=>{o||e.done((()=>new nlt.UnmergeCellsAction(t,n)))})),t.addHook("afterInit",(()=>{e.init()}))}nlt.prototype.done=function(t,e){if(this.ignoreNewActions||"UndoRedo.undo"===e||"UndoRedo.redo"===e||"auto"===e)return;const n=this.doneActions.slice();if(!1===this.instance.runHooks("beforeUndoStackChange",n,e))return;const o=t(),i=this.undoneActions.slice();this.doneActions.push(o),this.instance.runHooks("afterUndoStackChange",n,this.doneActions.slice()),this.instance.runHooks("beforeRedoStackChange",i),this.undoneActions.length=0,this.instance.runHooks("afterRedoStackChange",i,this.undoneActions.slice())},nlt.prototype.undo=function(){if(this.isUndoAvailable()){const t=this.doneActions.slice();this.instance.runHooks("beforeUndoStackChange",t);const e=this.doneActions.pop();this.instance.runHooks("afterUndoStackChange",t,this.doneActions.slice());const n=qv(e);if(!1===this.instance.runHooks("beforeUndo",n))return;this.ignoreNewActions=!0;const o=this,i=this.undoneActions.slice();this.instance.runHooks("beforeRedoStackChange",i),e.undo(this.instance,(()=>{o.ignoreNewActions=!1,o.undoneActions.push(e)})),this.instance.runHooks("afterRedoStackChange",i,this.undoneActions.slice()),this.instance.runHooks("afterUndo",n)}},nlt.prototype.redo=function(){if(this.isRedoAvailable()){const t=this.undoneActions.slice();this.instance.runHooks("beforeRedoStackChange",t);const e=this.undoneActions.pop();this.instance.runHooks("afterRedoStackChange",t,this.undoneActions.slice());const n=qv(e);if(!1===this.instance.runHooks("beforeRedo",n))return;this.ignoreNewActions=!0;const o=this,i=this.doneActions.slice();this.instance.runHooks("beforeUndoStackChange",i),e.redo(this.instance,(()=>{o.ignoreNewActions=!1,o.doneActions.push(e)})),this.instance.runHooks("afterUndoStackChange",i,this.doneActions.slice()),this.instance.runHooks("afterRedo",n)}},nlt.prototype.isUndoAvailable=function(){return this.doneActions.length>0},nlt.prototype.isRedoAvailable=function(){return this.undoneActions.length>0},nlt.prototype.clear=function(){this.doneActions.length=0,this.undoneActions.length=0},nlt.prototype.isEnabled=function(){return this.enabled},nlt.prototype.enable=function(){if(this.isEnabled())return;const t=this.instance;this.enabled=!0,slt(t),this.registerShortcuts(),t.addHook("afterChange",rlt)},nlt.prototype.disable=function(){if(!this.isEnabled())return;const t=this.instance;this.enabled=!1,alt(t),this.unregisterShortcuts(),t.removeHook("afterChange",rlt)},nlt.prototype.destroy=function(){this.clear(),this.instance=null,this.doneActions=null,this.undoneActions=null},nlt.Action=function(){},nlt.Action.prototype.undo=function(){},nlt.Action.prototype.redo=function(){},nlt.ChangeAction=function(t,e){this.changes=t,this.selected=e,this.actionType="change"},Qv(nlt.ChangeAction,nlt.Action),nlt.ChangeAction.prototype.undo=function(t,e){const n=qv(this.changes),o=t.countEmptyRows(!0),i=t.countEmptyCols(!0);for(let s=0,a=n.length;s<a;s++)n[s].splice(3,1);t.addHookOnce("afterChange",e),t.setDataAtCell(n,null,null,"UndoRedo.undo");for(let s=0,a=n.length;s<a;s++){const[e,r]=n[s];t.getSettings().minSpareRows&&e+1+t.getSettings().minSpareRows===t.countRows()&&o===t.getSettings().minSpareRows&&(t.alter("remove_row",parseInt(e+1,10),t.getSettings().minSpareRows),t.undoRedo.doneActions.pop()),t.getSettings().minSpareCols&&r+1+t.getSettings().minSpareCols===t.countCols()&&i===t.getSettings().minSpareCols&&(t.alter("remove_col",parseInt(r+1,10),t.getSettings().minSpareCols),t.undoRedo.doneActions.pop())}const r=t.getSelectedLast();if(void 0!==r){const[e,o]=n[0],[i,s]=r,a=t.view.getFirstFullyVisibleRow(),l=t.view.getFirstFullyVisibleColumn(),h=e>=a,c=o>=l;if(!1===(h&&c)&&!0===(i!==e||s!==o)){const n={row:e,col:o};!1===h&&(n.verticalSnap="top"),!1===c&&(n.horizontalSnap="start"),t.scrollViewportTo(n)}}t.selectCells(this.selected,!1,!1)},nlt.ChangeAction.prototype.redo=function(t,e){const n=qv(this.changes);for(let o=0,i=n.length;o<i;o++)n[o].splice(2,1);t.addHookOnce("afterChange",e),t.setDataAtCell(n,null,null,"UndoRedo.redo"),this.selected&&t.selectCells(this.selected,!1,!1)},nlt.CreateRowAction=function(t,e){this.index=t,this.amount=e,this.actionType="insert_row"},Qv(nlt.CreateRowAction,nlt.Action),nlt.CreateRowAction.prototype.undo=function(t,e){const n=t.countRows(),o=t.getSettings().minSpareRows;this.index>=n&&this.index-o<n&&(this.index-=o),t.addHookOnce("afterRemoveRow",e),t.alter("remove_row",this.index,this.amount,"UndoRedo.undo")},nlt.CreateRowAction.prototype.redo=function(t,e){t.addHookOnce("afterCreateRow",e),t.alter("insert_row_above",this.index,this.amount,"UndoRedo.redo")},nlt.RemoveRowAction=function(t,e,n,o,i,r){this.index=t,this.data=e,this.actionType="remove_row",this.fixedRowsBottom=n,this.fixedRowsTop=o,this.rowIndexesSequence=i,this.removedCellMetas=r},Qv(nlt.RemoveRowAction,nlt.Action),nlt.RemoveRowAction.prototype.undo=function(t,e){const n=t.getSettings(),o=[];n.fixedRowsBottom=this.fixedRowsBottom,n.fixedRowsTop=this.fixedRowsTop,this.data.forEach(((t,e)=>{Object.keys(t).forEach((n=>{const i=parseInt(n,10);o.push([this.index+e,isNaN(i)?n:i,t[n]])}))})),t.alter("insert_row_above",this.index,this.data.length,"UndoRedo.undo"),this.removedCellMetas.forEach((e=>{let[n,o,i]=e;t.setCellMetaObject(n,o,i)})),t.addHookOnce("afterViewRender",e),t.setSourceDataAtCell(o,null,null,"UndoRedo.undo"),t.rowIndexMapper.setIndexesSequence(this.rowIndexesSequence)},nlt.RemoveRowAction.prototype.redo=function(t,e){t.addHookOnce("afterRemoveRow",e),t.alter("remove_row",this.index,this.data.length,"UndoRedo.redo")},nlt.CreateColumnAction=function(t,e){this.index=t,this.amount=e,this.actionType="insert_col"},Qv(nlt.CreateColumnAction,nlt.Action),nlt.CreateColumnAction.prototype.undo=function(t,e){t.addHookOnce("afterRemoveCol",e),t.alter("remove_col",this.index,this.amount,"UndoRedo.undo")},nlt.CreateColumnAction.prototype.redo=function(t,e){t.addHookOnce("afterCreateCol",e),t.alter("insert_col_start",this.index,this.amount,"UndoRedo.redo")},nlt.RemoveColumnAction=function(t,e,n,o,i,r,s,a){this.index=t,this.indexes=e,this.data=n,this.amount=this.data[0].length,this.headers=o,this.columnPositions=i.slice(0),this.rowPositions=r.slice(0),this.actionType="remove_col",this.fixedColumnsStart=s,this.removedCellMetas=a},Qv(nlt.RemoveColumnAction,nlt.Action),nlt.RemoveColumnAction.prototype.undo=function(t,e){const n=t.getSettings();n.fixedColumnsStart=this.fixedColumnsStart;const o=this.indexes.slice(0).sort(),i=(t,e,n)=>n[this.indexes.indexOf(o[e])],r=this.data.length,s=[];for(let h=0;h<r;h++)s.push(Rp(this.data[h],i));const a=Rp(this.headers,i),l=[];t.alter("insert_col_start",this.indexes[0],this.indexes.length,"UndoRedo.undo"),Mp(t.getSourceDataArray(),((t,e)=>{Mp(o,((n,o)=>{t[n]=s[e][o],l.push([e,n,t[n]])}))})),t.setSourceDataAtCell(l,void 0,void 0,"UndoRedo.undo"),"undefined"!=typeof this.headers&&Mp(a,((e,n)=>{t.getSettings().colHeaders[o[n]]=e})),this.removedCellMetas.forEach((e=>{let[n,o,i]=e;t.setCellMetaObject(n,o,i)})),t.batchExecution((()=>{t.rowIndexMapper.setIndexesSequence(this.rowPositions),t.columnIndexMapper.setIndexesSequence(this.columnPositions)}),!0),t.addHookOnce("afterViewRender",e),t.render()},nlt.RemoveColumnAction.prototype.redo=function(t,e){t.addHookOnce("afterRemoveCol",e),t.alter("remove_col",this.index,this.amount,"UndoRedo.redo")},nlt.CellAlignmentAction=function(t,e,n,o){this.stateBefore=t,this.range=e,this.type=n,this.alignment=o},nlt.CellAlignmentAction.prototype.undo=function(t,e){Mp(this.range,(e=>{e.forAll(((e,n)=>{e>=0&&n>=0&&t.setCellMeta(e,n,"className",this.stateBefore[e][n]||" htLeft")}))})),t.addHookOnce("afterViewRender",e),t.render()},nlt.CellAlignmentAction.prototype.redo=function(t,e){rG(this.range,this.type,this.alignment,((e,n)=>t.getCellMeta(e,n)),((e,n,o,i)=>t.setCellMeta(e,n,o,i))),t.addHookOnce("afterViewRender",e),t.render()},nlt.FiltersAction=function(t){this.conditionsStack=t,this.actionType="filter"},Qv(nlt.FiltersAction,nlt.Action),nlt.FiltersAction.prototype.undo=function(t,e){const n=t.getPlugin("filters");t.addHookOnce("afterViewRender",e),n.conditionCollection.importAllConditions(this.conditionsStack.slice(0,this.conditionsStack.length-1)),n.filter()},nlt.FiltersAction.prototype.redo=function(t,e){const n=t.getPlugin("filters");t.addHookOnce("afterViewRender",e),n.conditionCollection.importAllConditions(this.conditionsStack),n.filter()};class olt extends nlt.Action{constructor(t,e){super(),this.cellRange=e;const n=this.cellRange.getTopStartCorner(),o=this.cellRange.getBottomEndCorner();this.rangeData=t.getData(n.row,n.col,o.row,o.col)}undo(t,e){const n=t.getPlugin("mergeCells");t.addHookOnce("afterViewRender",e),n.unmergeRange(this.cellRange,!0);const o=this.cellRange.getTopStartCorner();t.populateFromArray(o.row,o.col,this.rangeData,void 0,void 0,"MergeCells")}redo(t,e){const n=t.getPlugin("mergeCells");t.addHookOnce("afterViewRender",e),n.mergeRange(this.cellRange)}}nlt.MergeCellsAction=olt;class ilt extends nlt.Action{constructor(t,e){super(),this.cellRange=e}undo(t,e){const n=t.getPlugin("mergeCells");t.addHookOnce("afterViewRender",e),n.mergeRange(this.cellRange,!0)}redo(t,e){const n=t.getPlugin("mergeCells");t.addHookOnce("afterViewRender",e),n.unmergeRange(this.cellRange,!0),t.render()}}function rlt(t,e){const n=this;if("loadData"===e)return n.undoRedo.clear()}function slt(t){t.undo=function(){return t.undoRedo.undo()},t.redo=function(){return t.undoRedo.redo()},t.isUndoAvailable=function(){return t.undoRedo.isUndoAvailable()},t.isRedoAvailable=function(){return t.undoRedo.isRedoAvailable()},t.clearUndo=function(){return t.undoRedo.clear()}}function alt(t){delete t.undo,delete t.redo,delete t.isUndoAvailable,delete t.isRedoAvailable,delete t.clearUndo}nlt.UnmergeCellsAction=ilt,nlt.RowMoveAction=function(t,e){this.rows=t.slice(),this.finalIndex=e,this.actionType="row_move"},Qv(nlt.RowMoveAction,nlt.Action),nlt.RowMoveAction.prototype.undo=function(t,e){const n=t.getPlugin("manualRowMove"),o=[].concat(this.rows),i=o.filter((t=>t>this.finalIndex)),r=o.filter((t=>t<=this.finalIndex)),s=i.sort(((t,e)=>e-t)).concat(r.sort(((t,e)=>t-e)));t.addHookOnce("afterViewRender",e);for(let a=0;a<s.length;a+=1){const e=t.toVisualRow(s[a]);n.moveRow(e,s[a])}t.render(),t.deselectCell(),t.selectRows(this.rows[0],this.rows[0]+this.rows.length-1)},nlt.RowMoveAction.prototype.redo=function(t,e){const n=t.getPlugin("manualRowMove");t.addHookOnce("afterViewRender",e),n.moveRows(this.rows.slice(),this.finalIndex),t.render(),t.deselectCell(),t.selectRows(this.finalIndex,this.finalIndex+this.rows.length-1)},nlt.prototype.init=function(){const t=this.instance.getSettings().undo,e="undefined"==typeof t||t;this.instance.undoRedo||(this.instance.undoRedo=this),e?this.instance.undoRedo.enable():this.instance.undoRedo.disable()},nlt.prototype.registerShortcuts=function(){const t=this.instance.getShortcutManager().getContext("grid"),e={runOnlyIf:t=>!t.altKey,group:tlt};t.addShortcuts([{keys:[["Control/Meta","z"]],callback:()=>{this.undo()}},{keys:[["Control/Meta","y"],["Control/Meta","Shift","z"]],callback:()=>{this.redo()}}],e)},nlt.prototype.unregisterShortcuts=function(){this.instance.getShortcutManager().getContext("grid").removeShortcutsByGroup(tlt)};const llt=aC.getSingleton();function hlt(){zb(bj),zb(Kj),zb(gU),zb(BU),zb(lY),zb(Az),zb(Wz),zb(RQ),zb(mX),zb(kq),zb(fZ),zb(MZ),zb(zZ),zb(vJ),zb(r3),zb(l8),zb(t9),zb(k9),zb(Z9),zb(Q6),zb(B5),zb(P7),zb(Stt),zb(Vet),zb(ynt),zb(Mnt),zb(Cit),zb(Xrt),zb(bst),zb(Pst),zb(Kst),zb(aat),zb(nlt)}function clt(){aW(),jW(),iF(),RF(),hlt()}function ult(t){const e="undefined"!=typeof window&&window.jQuery;e&&(e.fn.handsontable=function(e){const n=this.first();let o,i=n.data("handsontable");if("string"!=typeof e){const o=e||{};return i?i.updateSettings(o):(i=new t.Core(n[0],o),n.data("handsontable",i),i.init()),n}if(i){if("undefined"==typeof i[e])throw new Error(`Handsontable do not provide action: ${e}`);for(var r=arguments.length,s=new Array(r>1?r-1:0),a=1;a<r;a++)s[a-1]=arguments[a];o=i[e].call(i,...s),"destroy"===e&&n.removeData()}return o})}var dlt,glt,flt,mlt,plt;llt.add("afterUpdateSettings",(function(){var t;null===(t=this.getPlugin("undoRedo"))||void 0===t||t.init()})),llt.register("beforeUndo"),llt.register("afterUndo"),llt.register("beforeRedo"),llt.register("afterRedo"),nlt.PLUGIN_KEY=elt,nlt.SETTING_KEYS=!0,clt(),ult(WB),WB.__GhostTable=KF,WB._getListenersCounter=TC,WB._getRegisteredMapsCounter=LI,WB.EventManager=MC;const wlt=[Bp,Ny,rI,QW,my,gv,ow,Rb,ly,uw,jy,Ab],Alt=[ov,Ky];WB.helper={},WB.dom={},Mp(wlt,(t=>{Mp(Object.getOwnPropertyNames(t),(e=>{"_"!==e.charAt(0)&&(WB.helper[e]=t[e])}))})),Mp(Alt,(t=>{Mp(Object.getOwnPropertyNames(t),(e=>{"_"!==e.charAt(0)&&(WB.dom[e]=t[e])}))})),WB.cellTypes=null!==(dlt=WB.cellTypes)&&void 0!==dlt?dlt:{},Mp(nP(),(t=>{WB.cellTypes[t]=iP(t)})),WB.cellTypes.registerCellType=rP,WB.cellTypes.getCellType=iP,WB.editors=null!==(glt=WB.editors)&&void 0!==glt?glt:{},Mp(fC(),(t=>{WB.editors[`${iw(t)}Editor`]=AC(t)})),WB.editors.registerEditor=vC,WB.editors.getEditor=AC,WB.renderers=null!==(flt=WB.renderers)&&void 0!==flt?flt:{},Mp(Zb(),(t=>{const e=$b(t);"base"===t&&(WB.renderers.cellDecorator=e),WB.renderers[`${iw(t)}Renderer`]=e})),WB.renderers.registerRenderer=tS,WB.renderers.getRenderer=$b,WB.validators=null!==(mlt=WB.validators)&&void 0!==mlt?mlt:{},Mp(iS(),(t=>{WB.validators[`${iw(t)}Validator`]=sS(t)})),WB.validators.registerValidator=aS,WB.validators.getValidator=sS,WB.plugins=null!==(plt=WB.plugins)&&void 0!==plt?plt:{},Mp(jb(),(t=>{WB.plugins[t]=Ub(t)})),WB.plugins[`${iw(jF.PLUGIN_KEY)}Plugin`]=jF,WB.plugins.registerPlugin=zb,WB.plugins.getPlugin=Ub;
/**
 * @preserve
 * Authors: soakit, HChenZi
 * Last updated: Mar 09, 2023
 *
 * Description: Definition file for Chinese - China language-country.
 */
const vlt={languageCode:"zh-CN",[TO]:"ä¸æ¹æå¥è¡",[kO]:"ä¸æ¹æå¥è¡",[xO]:"å·¦æ¹æå¥å",[IO]:"å³æ¹æå¥å",[OO]:["ç§»é¤è¯¥è¡","ç§»é¤å¤è¡"],[HO]:["ç§»é¤è¯¥å","ç§»é¤å¤å"],[DO]:"æ¤é",[NO]:"æ¢å¤",[PO]:"åªè¯»",[_O]:"æ¸ç©ºè¯¥å",[qO]:"å¯¹é½",[ZO]:"å·¦å¯¹é½",[JO]:"æ°´å¹³å±ä¸­",[$O]:"å³å¯¹é½",[tH]:"ä¸¤ç«¯å¯¹é½",[eH]:"é¡¶ç«¯å¯¹é½",[nH]:"åç´å±ä¸­",[oH]:"åºç«¯å¯¹é½",[jO]:"å»ç»è¯¥å",[UO]:"åæ¶å»ç»",[iH]:"è¾¹æ¡",[rH]:"ä¸",[sH]:"å³",[aH]:"ä¸",[lH]:"å·¦",[hH]:"ç§»é¤è¾¹æ¡",[GO]:"æå¥æ¹æ³¨",[QO]:"ç¼è¾æ¹æ³¨",[KO]:"å é¤æ¹æ³¨",[XO]:"åªè¯»æ¹æ³¨",[YO]:"åå¹¶",[zO]:"åæ¶åå¹¶",[BO]:"å¤å¶",[LO]:"å¸¦æ é¢çå¤å¶",[VO]:"å¸¦æ é¢ç»çå¤å¶",[WO]:"ä»å¤å¶æ é¢",[FO]:"åªå",[cH]:"æå¥å­è¡",[uH]:"ä¸æ¯è¡åç¦»",[dH]:["éèè¯¥å","éèå¤å"],[gH]:["æ¾ç¤ºè¯¥å","æ¾ç¤ºå¤å"],[fH]:["éèè¯¥è¡","éèå¤è¡"],[mH]:["æ¾ç¤ºè¯¥è¡","æ¾ç¤ºå¤è¡"],[AH]:"æ ",[vH]:"ä¸ºç©º",[yH]:"ä¸ä¸ºç©º",[CH]:"ç­äº",[bH]:"ä¸ç­äº",[SH]:"å¼å¤´æ¯",[EH]:"ç»å°¾æ¯",[RH]:"åå«",[MH]:"ä¸åå«",[kH]:"å¤§äº",[xH]:"å¤§äºæç­äº",[IH]:"å°äº",[OH]:"å°äºæç­äº",[HH]:"å¨æ­¤èå´",[DH]:"ä¸å¨æ­¤èå´",[NH]:"ä¹å",[PH]:"ä¹å",[_H]:"ä»å¤©",[BH]:"æå¤©",[LH]:"æ¨å¤©",[UH]:"ç©ºç½ååæ ¼",[VH]:"ææ¡ä»¶è¿æ»¤",[WH]:"æå¼è¿æ»¤",[FH]:"ä¸",[jH]:"æ",[YH]:"å¨é",[zH]:"æ¸é¤",[GH]:"ç¡®è®¤",[QH]:"åæ¶",[KH]:"æç´¢",[XH]:"å¼",[qH]:"ç¬¬äºå¼"},ylt=vlt;hD(ylt);const Clt=function(t,e,n,o,i,r,s){if(WB.renderers.getRenderer("text")(t,e,n,o,i,r,s),s.style){const t=e.style;Object.assign(t,s.style)}};WB.renderers.registerRenderer("styleRender",Clt);const blt=t=>{const e=(0,o.ref)(!0),n=t(),i={emit:(t,o)=>{e.value=!0,null==n||n.postMessage({type:t,payload:o})}},r={},s=[],a=[];return null==n||n.addEventListener("message",(t=>{const{type:e,payload:n}=t.data,o=r[e];null!=o&&o.length&&o.forEach((t=>t(n))),s.forEach((e=>e(t)))})),null==n||n.addEventListener("error",(t=>{console.error(t),a.forEach((e=>e(t)))})),(0,o.onUnmounted)((()=>{null==n||n.terminate()})),{loading:e,worker:i,onWorkerMessage:t=>s.push(t),onWorkerError:t=>a.push(t),onWorkerEvent:(t,e)=>{let n=r[t];n||(n=r[t]=[]),n.push(e)},mapEvents:t=>Array.isArray(t)?t.reduce(((t,e)=>(t[e]=t=>i.emit(e,t),t)),{}):Object.keys(t).reduce(((e,n)=>{const o=t[n];return e[o]=t=>i.emit(n,t),e}),{})}},Slt=(0,o.defineComponent)({__name:"XlsxTable",props:{data:null,type:null},setup(t){const e=t,n=(0,o.ref)(null),i=(0,o.ref)([]),r=(0,o.ref)(0);let s;const a={language:"zh-CN",colHeaders:!0,rowHeaders:!0,autoRowSize:!1,autoColumnSize:!1,height:"100%",cells(t,e){const n=null==s?void 0:s.cell;return n&&Object.keys(n).length?n[KL(t,e)]:{}},columns(t){const e=null==s?void 0:s.columns;return null!=e&&e.length?e[t]:{}},colWidths(t){const e=null==s?void 0:s.colWidths;return"number"==typeof e?e:e&&e[t]||(null==s?void 0:s.defaults.colWidth)},rowHeights(t){const e=null==s?void 0:s.rowHeights;return"number"==typeof e?e:e&&e[t]||(null==s?void 0:s.defaults.rowHeight)},outsideClickDeselects:!1,licenseKey:"non-commercial-and-evaluation"},l=(0,o.computed)((()=>{var t;return null==(t=n.value)?void 0:t.hotInstance})),h=()=>"binary"===e.type?qL.create():XL.create(),{loading:c,worker:u,onWorkerEvent:d}=blt(h),g=t=>{var e;r.value!==t&&(r.value=t,u.emit("parseSheet",{sheet:null!=(e=r.value)?e:i.value[0].id}))},f=()=>(0,o.nextTick)((()=>{setTimeout((()=>{var t;null==(t=l.value)||t.updateSettings({data:null==s?void 0:s.data,mergeCells:null==s?void 0:s.merge})}),0)}));return d("sheets",(({sheets:t})=>{if(i.value=t,t.length){const[{id:e}]=t;r.value=e,u.emit("parseSheet",{sheet:r.value})}})),d("parseSheet",(({sheetData:t})=>{s=t,f()})),(0,o.watch)((()=>e.data),(()=>{u.emit("parseWorkbook",{workbook:e.data})})),(0,o.onMounted)((()=>{var t;null==(t=l.value)||t.addHook("afterUpdateSettings",(()=>c.value=!1)),u.emit("parseWorkbook",{workbook:e.data})})),{__sfc:!0,props:e,table:n,sheets:i,sheetIndex:r,sheetData:s,hotSettings:a,tableInstance:l,compositeWorkerFactory:h,loading:c,worker:u,onWorkerEvent:d,handleSheet:g,updateTable:f,HotTable:TL}}}),Elt="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIACAMAAADDpiTIAAAC9FBMVEUAAAABAQEODw8AAAAAAAAAAAAzMzMBAQEAAAABAQFycnIAAAD9/f0mJiYAAAD9/f2EhITS0tIbf0qBgYHOzs6Kiorl5eVpgHRXWVgLDQz7+/v39/dDmWoObzoQfEIqi1YVf0Ukh1Ha2tofhE2lpaVebGTt7e15eXnh4eHX19cZgUmYmJg8Pj1VVVWoqKiEhIQObznGxsaxsbEng1C1tbXMzMy+vr7CwsLR0dHFxcVmZmampqa2trY/cFVTU1PZ2dnW1tYAAgDm5ubY2Ng/lmcObzo/lmcNbzo+lmYOcDo2kV////8QfEH9/f3+/v77+/v4+Pgri1YRfUIsjFjy8vIdg0v6+vopilXw8PAniVMTfkTt7e0liFIXgEfo6Ogbgkr3+PcVf0UfhU3q6uohhk/29vYZgUj19fX09PQjh1Dm5ubs7Ozk5OTv7+/e3t7i4uIho2YUSixbz5owuHkfmWAYXDdNtYT4+/nb29vc3NwjhlDg4ODW1tYtjFnQ0NDU1NTY2NjU1tUOcTsQekDIyclEmWvKysrHx8cxjlsXfUNAlmi/wL9OtYUAeDdFiFtYn3Y7l2YTbzsAbTQzdUpQvYVVzpcBoWEAQhkht3VHblVGYU8AViozuHpJqnZJoXHMzMwAl1tjuo4jmmFGtIEeXTn1+fbExMS7u7sAejoThk1FnGxs0qEogUwAfT5Nk2jBwcEyilc6hFQAeS0uiFQBgEMrhVAObjm0tLQAdiZCjmAbf0YigEkAfDOpqany9vRHjmIdiFEChEcWfEK4uLg/ilsAbwHO39Vt0qIAdBxzqIc8h1cOdT03kV8AchC/1Meurq6kw7ADk1jo8eygoKCXl5dgtozt9PC3z8APg0ni7OaxsrFr0aDc6eGNtZwjll7W5NysyLaevalEsX9poH6Aq5BUmXAdXDiTuaGGspfG2c0gckBLqnYAZx8AZAZo0Z9edmY9aE09XEgLfkJhroFhkXF61KdxvJZlwY88sH0BtXFXi2gATxf6D1MSAAAAS3RSTlMACQYNExgZHSQpVTD3Njb2O/wOPfwr9w0LEPb28fHx8fHx+/FxF/VD9vzxWy4RiUz91JhUrPLIspTmOMvjJGLlvEbSzbGxiorOzuSptM5HAAA3i0lEQVR42uycy04aURzGC0JvK0mxxXRn6C22Nppae9G0SdetLIiZhISYEILhuoVgABMDCx7CHSxZ+gC+RZ+m58rHOWeOA1bAtOc7MAzD0NjMr9/3P/859Z6Tk5OTk5OT020pHL53lxQO37Ef6J9W+K5K/GSOhv9U7Lo/oyPhQJiPwom1O6uDg/sPotH1lYlr/uxZwmFwu7n/4vXTJeu1rzY2vhH9+PH9+97ep09byc3VtYPoisTAUXBrDrv2NJPNzV1Z8vBRkT+EymPV+As9SL5ZKmXLzfqb2O723qed5OpBJMwoSDgG/h6ARHjtaS67EBXtKkO1sZpMVaKGULNWztbqbwgHW5trUQaBM4K/u/4hALAATUFATREHQCJQr28Q1euNZrl6trv9IbkaIX8HZwR/B0Bo7WkpuwT5IECeEFxAUkARIOrUO503b047jerp7sedzQdhwoBD4KbXP/RuhQDAQzrLttiRR7PihUicIT7C53Krfw/nkuGb/nxQkcC3IgACGAJEp6ftWKzdqbc+f9h8SBhwNnAzAFYoAJncQkQBstkBHVK+CIyDAASctWOteKvdiX/eeR9xNnBTANYBwMKkg8DeX1cUGggIAtqtVjx+0WoPPiYfOgRucv1X1iNrLzMlrhzZgXAsWDgNB7CXK7HBxPdFQGjxABvgiaCUhRoCHSLmAa3WxcX5eau7v/XWBcHsAKyvR1ZfVkoLEQfBKp/iUHEBoxZgBLRjlIBur9cVCDgCZgfAyyxAJcjCgW2SQAlQGWgQyRgQBJz3Rr3efjJ6z+XAbADcj84bACBABnnAD0xj8EcAPtBkDIxdAIUAJWDQHwy+vg+5HJgFgIgEoEIGfTEG2wQP/Tx5INgOYAqYP2KmyKVNClALCBMQBIz6g6udh84EplN4DEC6Mmd5GQ8oWInI2BJhwgXUIKiDgJYgYDjYfxxOuEpgBgCevEx785XkIOPRDX1YXcGOgGwTwQUEAjwG+GSAEtC/3Iq6GJglAuYMgAmCJAAZgSpBnTPqFQEDoIzGAGpBWgh0z2khMByOvr69lwg5AgIBCAkHOPEWrYomxQfQP2DSbIBJ5IBOgIyB0f77sCNgNgDS8x7XXn+PuwE3AUgnICsJqCkmYBYC/d9JR8D0ABTSCxAQMKV6AeQzO5ycEmgEnLFCgBIwGg6vtkKOgLsFwITL2BDIGHGAgpCMAAJOxx5AC4Hh1oqbDEwJQD69cFmcwDNNABTABCaDoNpUJwNxTgCJgZ31RCLkCJgOgJP5DjMP7G5QQS8JBMAEMCGACagEsBTo968GHyIhR8AUAFSOT25XaW2P8DVTdWAUBIgC5AAQQFOIVoIxRkCPEHDZ3Yu6QmDBANhVgBsYAEg/MCoCVIPIgZxiAigEpAfEeB1ACWg7AqYBwDsunJxoD2UX78ULhMP8Hd/iGzhfXHxrKPAy0bABeEDJtytQo5oggAIgU2B42dh74AgIBiBVWIT0mLDFQVoPAzSIDAbQE+D3B2U/IN5lbeGrYfnjQ0fAnQDAqBMmCk+tHtDCIGMDQCsF4QGtcUfoclB0BAQBsPo8lfdVIR+kwpSfEADyCg0KEAHzxIqHIEA5iJ4AhQClYKczcXuYhECsuP0o/MwREADA/BUQCBYvgA1I+caAJKBhEHDZb5S33zoClghAgW0CEPCdHAABBYCSMR+UMYAUEATQEIg1yp+/OAKuBeAof3xz5ac5h51kt4QT0GDLATCAFNBbApMp0BIEDIfNuiMgGIB5K09kEgD5x4G4fSAI8ER/UK8GJQCcANkPEIUgsYDyRm33lSNgOQDAJnyiQQGg4BMFRltAiwEhWEATFiAJGA5rtXpt970j4BoAUsdSKSKyPfYRPY4dCPvmoZTcpCQF7MH9gM8MJjCQLUPCAdkUcNfAhgAAwDIRVgeAgMHosl1s1pu7m44AKwCHqflKUGWiYkaCZX4IBtAXAgJFLk6ANhkkFtAvlpuNatwRsDwA4Cp2AHwnBzoAcAG5klwFgBIgJ4PizuBgcNXJUgJijoAlAWBPFbUmsF9/dIgNC9CXjCIEYAG9bLFcazRiSUfAEgAAA+Q5RgFI5PMgYcwAeXIWzHoQFpDRUwCFICfgrC0IaHIC2smQI2AWAI5SU+qIjBtIdQMyjPmhhoCU7AkoJoCOEBpCnIBhO0c+a5JgoAS4JSK+AByZAweDBlXwOaZ8E8GYF6T1UsAOADyALhOU3YD+IJflBNS3VhwBd8cBQAAACLAAvS3o2w/S5oLng2GtRAmoNeoNR4DNAZR/r4oDHOIYXnBcXPxD9UPttOsJSKEe0OcEZASGAJYKlkUdiI5grNUiFnCWyQoPaLiloiYAP4/mLcZGsMzJgcyBNDDQZwO4MYA6kKUAWyvOQmDQJWcJD6g6AhYKAHQYVBgcpybbxqgHaAqw56QN+LaF0QxAP4iFwCibkQRsND9EEm6JSDAAy7GAlFkNyOmgRAAA+FhAGRYgQoB2A7qjqpcDAW6p6DIAmGpqYLaIpAWgFgQB1gwQZQBmAoN2OiNToLrRdEtFVQB+HY51xJ9HZHAR65aHsCfe4Rg+wR/Bviw+YmIvKYUKf2n3ENEfRAhgpVgJKQACsEKM1YHx3gU5uQQP+OgIUAGYo4CWxRow7F6AO4XoB/jVAT7rgzo0BC56JU8hwC0VXTAAwg58Lr+lnaB0B7BmSK4UYfJbIzQZAg3ZDWjFB+W06gHbjxwBiwEABmBxAUtFgBiYTAGlDGC/wkoFoJhVLUDWgb1qwaMElMYEuKWiCwIAsmcAHMDMAAAAC+D/h6jiKRFAZVQB0gLOT088T/OA/36h4MIBCHYAgwBkgOoB44ZgRSFAbwgTcQv4Q97Z6zgNRFFYAiRKFLEVPACioaBD4g0sj1NYq0iRokhRtBabQJtoo9iRUCh4CDq2pKSi4gEo6Hga5tdnfuMJxc5i30ASktiLmI9zZ+49nhxHZWkTMHiraAtAViSIS4uIsXos9KqAREGWBPXugD0PFBDIkrCRBMQ0cKIIuFarwfdvBm4VVQA8YwDkxo2/wO87bojgu3gWyAtubnDXhaZjxF0MwiCCLKAtBev9cXoFDVAEDNwqqgGAwJiFB8477OF3gVMgvEnBygbwDJoSEADAloD6OFuyY0wCtsO2iuoA5H4JyGMlIPxuFEhBAYAE0PAQsLZngmgJ6BJwqL+s5lXlZIHNoAkIKgAkoDMw1OF3uxnoXBiq2rAnB6x9EoCrxlU58HgzFseZq8HNkM3CGgB+CYi68Tj5LrJAfAZwJcCnAGV0Djh82Y7ZoZwbXQOai+FaRYMKAN2OlYCOd/nd+bMAPYQE2AS4CgAJMPeN2G/mbDFZugTsB2sUBABsiPhQ5aQgRU74n9pX+HP2RP0m/AVxJw/Fh+QdzoPzdaQBjgF7LGT7sDAaxcslZgKV1RhUbaEFHVjLGCAJGO3o0dAALQvs6lcDJUAD4E6CYxGtLKImoMsAWkMgoHT2EUESMEzi9WFJVcSbBXa7gRoF7xoASzFw84TtI5IA6P1hCwBFgOMOEwAc9hQAg4CpImCza14/HKJN7M4BKBQB5zQO4FCGAtDwA6CXA62FwL4auwSwDzICNoM0CiZQAPnfv1sBQAAUABLQCQAIAAAlZ4gfCwIW7zgBLzdDNAomAIAzECcB5pqQ3cMvGGwJTAGAPQkYTdic0p0JtgQMzyh45wAI9c+7JgEgABoAApZzNwes7VkgWkKtPXS0FosKTxZYMQK2w7OKJpkEEvo7NrRJAEfAngYGZoHedUAzmkoAbAIWfB7QvBzerqIAgI4KISSnwe7YM/mL5AQv8j/JFxDEfUa019TR2mGmBpATKiBKAoWSANjG2cYiFQ1IAAqCXgI2GwaAgIlLiI+AoRkFNQDuKnLFlhsxZUK7NQQCOASBaYCQgPqaut9PEbChBAzLKJgAAJDgBgn3Gh0AVGfAAgAEmMYQDsCCXHYSMKxdRVMoAFKKp0oQXRQYAwDPtULoCaEYJAAo5CnmQQIGZRVNAoB89IcjAUECYgHALOAwYz2vTg0YklEwVQrISbBIlHdpABTAIWDtmwTAG8YA8BMw0QnYDMgomAaAnN5IrADknTnAd72o5gwyAVBnOk3AYIyCSQBg2T+kAeE2QTgHVNhWGrsJAwBsIbvjAIQJuFYENIOxiiYAABCEekWnZwEAQLlEjYKwDQByAACg0aEBzVCMgvdsGRi3EnDXAZVWEbYAoBEAgFeVQgTsPg6DgHQA5KGJgOsudABAMcDTEnDKwcgBzSzD2QwCqpaAmSTgcByEUTAhAOwusleQB3LAWCqAJMBIAT4JaBYZr0BHZYHDlyHsKQkAKAEMghAImfH4T7hk9pGBqaBtGCKuTcxQgCVM4tbOUTMWJgDy/GECpu1MsB6CVRQAiOHJMEyZO9h4EaxwcnCgeJLJD6hX1Qfw4MkGshVltItoCHOpcY25aAupwVvaXcEpZ6AFADvHba4zSZhHAwQCfAWpCBj13yioAZBpw6f+lOFODSJ/g6hP4xPidfUWjiWZOkw8B1sIOfCKBTlGyn3sFIc4ANAARsCVlgRY6P2AWbsO2EwzKTmuBnARmJgEjOpXfTcKKgCeZAiSRcS/fx44sQHvLBMW8jGwGlA9IZjE10wCnHIwAFB8uQSUtgbs6kPfjYIAIEVEl4pRItQJQEXYLAZgGmBdJSQACGsAO94kYLR7/ajXBCQF4LxeAS4zhQToAJhJwNsQ2K7ZzwxpwNJPQL+NgokBCFPQoQAFAAABavwnE8sZpBRgO+E/DhoQJuC6JaDpNQFpAQiPP1YDCFxfCgkAABUNZ8MAY/tQAUBIA+ZhAvpsFEwFABYQWXQOkAqAFKCPHAgQgUmAlIB3DIAya1egIQ2oPAT02CiYCgBgECoTdl1PgBzACbAtwk45UAIA5KAB3QT01yiYGoDwFMA3DSDYaQISMKehJMACwN4w5H2V0YjQgNIl4EE/CUgOABCIWgk6/hBIgD0LcAFYvb/KsmgNWBsE9NUomA4ATANCi4BTrUIAoAgAAI4EAIA5qDt3HtDTPSWTAhC/EkT4OoO+HDARG8iapYCbsaU77logSMCun0bBB8lTwMneYsAyljsAzB0A1gBgoQMQpwGlh4BeGgUfJFeAyPFHoB6IHEDDXgdMLAAYATdFpsW5a4FDHwl4kF4BkAKiEcg9SQCVADjEre+RAABhDXAvGQEB9df+2cTuAQBnSgAUwJ0GOgBMTQA+5Bkish7QcwLSA4BiUPz1g2Y5GPNASwLMvUMBAKJTAywCRp/6ZhRM3A4W9+chgA0sHQlov2TWBADTQFgXghqADpOPgP3HnhkF74UCkOzMtSAxe4KXAMAxCBsAvCOBKlQcATeMgGO/jIL3AQD4EKMJQGvYmQWUVg6YgoDVLEPEEeDWBPcXvTIK6qbQpOE2gGJmgkoCMGIgwM0Bq0WwEp3HEtCM9vs+GQUBAEkUOUq/JHqvQbMejOuEPC1BKMBsdZ15ApiFsoBDQI+MghoAebIg2tA6gYHxSIBxpYgnCZgtwdU08wayQAcBM0rAdje6GPXHKCgAePz0WZYnDG7+t4O/YncBveUgSIDvMiFIwGqS+SNCA6YtAZumvqh7YxO7JwAQNPlC31eDD1jmEBCgOgKuL6QFgPiHH6f0EVCZFaFtnwhQADwnxf8RHAKrL4hNQ9wdQ3Rr4KrUxjwsBuy8cvw9WUCsBSgB/TAKtgDQdJouvD+bjoJn8JEbIBlWErgqjZYQcsCqMhSAZf3L8bKU3yg8Yx+aricV25KyyLMsZxjMOVLm5uKCgH4YBQHA5ThdXOLRCM6BGTCFQbNBwJKPV8gatprzYS/m5XrByzr1/uLL8eOnr1+/ff58e3v78+d3Hj9vP3891s12Na2W46Kgp237AlMKCiOgoQT0wigoAXjxvGD/3sluJ4NTABZaGdAuGsUswE0CmAW8m1zRkb+hSbzZHQ6Huq5HdE1HIfhypBi0HFAM/vz6wePX98/H3c11uRyPr0qhJpwABs9F3QejYAvA5Xh+T2IpH+lfSKdABHKB/CXrgS4BrjeMt4PEThHqW+V3jALGAFOCj1QLGASUAoaB5OA3jR+3x+bdpFpWE3oioQGcgLf/v1HwL3vn9jJTFIbxGGdXNDlEKTkkh3IocsgFScqpmdiamtROMxnMrWkcyyku+AvMHZkLLuVCyJWaHKJE+RDCf+Fda717nv3utfaMzDDbzH4cvtworZ/ned611nzLADBl6bx9RwauUkn9RuI/MwoSAkYAy89CDzwCAEAAPiMUek4UDMwIfOCCcYJ7gMBQ8OYNUdCoFbz8cdME64aA//6iYACAd7g0OJUptekXSf2BvyoZDkjdEQgcAM9BOO6GtT8iVLcZ0FmQJQguGQgCCgwDGgKi4GmjWvAoR4IU2Py/XxQMAFhyJJ80BSAYBkgSASy/k4AyAPBgAZIATgJCgBjQNmAaQUNDACswaRBA8PDWuWKBSqROgRn/+zWxNgDl/CDl8ROQef1DfwUFcILY0QA9UJFSAgFGrqekqoyAsYFTphXOICkI7DzgSsBGcO3UUf+oJuDM7f+bgPHjFQBTly7JH0+EzGd76SuLKaAV7YbAARDg+C7yCAEQoBhAHyQpBAiCqBPcCo8H8IHa0WpNEXDt/74mRgTMnTCFAPASIcbAiNdffbEQAAFdQwAAcA3Ac2KyCpgkICENLpECIzAMwAfeZ0/UaT8gm2AC5szupJlKixdP2rJl+rRZfjF58kmVgnfkSJltwCRBdwJwLAiuAgtADCAHiADuAvCBM8yAHQZg4PW9U7Xz2ca9JBKweO2O7Tvn/7auJ1Vfnv349PxdWXdUdoGuBDAATgKKnAKCgBoToKQZgA1kzzTAgPABg8DtGafONG4l7qLg2u3zmzdvNn9fN5KrK6/Grn//efwIXAAE2ABYnxMBAEyAEgiowwOYAUSBtAGzUwQGgjrw9MyMxuVkXRRcu7N58+LwqNm8Ojb27LlX8hgBMgEnAQeYABwM258WlgRUQQAQUIomAf0IMcBzAdvA66fZ7AW6JpYUArZs5+W/OhS6eFUz0Hr14+MRTUBZEiBvEsSOAvAAIAAPwECoxAjwcQGPBVmCADsEzECAwO1GIzEErJ1/U6/+jVbrylCo1bqhGRhrPi97bAIgIKp98TWgYA5zLBOok9gFhA9wIWQjMBQQB2I2pDagEKCpMCkXBXc0zepfOX06lzs9BFL/iiuKgebVVy/z3QmABRACkoDYGGAEBATtKAAEQR7AB7QNGATuNxJxUXDHTb38p4di7aHcaY3Aq8+eJECEgD0L8reRxiaDfEoAVVDYAHwAY4HYI0IWKBtgBN48vJyAa2J6/Vv8fz83JGIfaN0gAuABggBxqzRMQHQUwBUxeICbAR4NTwKCMAXZsA2YLvD69bWBE7C2Scs/NAsvpRAgAt6WC4SAaYIIgd0gAB7g3g6AB8AEsDVMBCALrErQLobSBu4FCNwf8EXBLfOHef0VATQSfMwfVzvEIAAW0MkDcDlAFgEZBMwAq4Y8AAXcDNkG+B4JI/D6/aaBXhTcfvNqKzfUal0c+0r3NpkACgFYgCTggCBAFIECYkAiUAUDoIAwYMlSIGzAIKBM4MWmFQMgAAEw5OuvCHj1PF/g46GIBYQRCN0Qw7EAYgAmYCUBICBFIBC7BGBAI8BVYJAE7GzeGGL/5xS40Xrmq+NCEQJm+UmuWYAUQwAQAAPoA0wBOIhAwDbAjTDIgRfvB0bA2hFYfyLg6hhZgCKg3A4BdgCtAABBgLsKUgzoIEAhtCiAG9hWIGygYRC4TTlwfwAEcAMY+gBQao19oLXzmAAFgLAAx6aweGCWhcflQAAQgMBAaEJAJeA2MIMRMCbwdNPUcQPYEVo8fxQMQI0C3+oFUwRtC5CfF+tOABAABEWm4GgcBWBA3idkE6BTok2TM/+egLUXr+zPjYJaY8+9ChHAPRDbgSz7pjgI0IrsC0oEungBIMB1wrYN6CqgTOD2pgn//mRoR3MkDIAAePLyuE8eYFmA/R2EJAK4Ls5iAuACNgPSC6oseXqEQkg5oEyACBjA2eD2G7nR0JU7X4s+WQAGAZQAknUuwDlQcpoAkgCNUIwGkMMKhA0YBLgJ3P73N0R2jkQFJJ1+/OWYTxaAGrgPJcBOATQBBwLHtQqBKiTfdoMYCIAAPmemtgX0nsD7aeNX/tNRYM6uEakABMC3qh+yAAbA/d1DXAgwAbYNIBBsBiAnA5wE540JUAzc2/yPh8HZC3K5/SOh04/vVotFbQFEgCwBgaz7AbgnJh6ZDCQZ0AoQAATurQJGAC6gTIBi4MKmiXMy/zAEZo4SAPUiWkCoBECOIgAT4F0h2QdJYQQKgCCuHIIBIKC6AJlAVk0Dlzp+P8EUgF4AOGEB4M4ATgEgIF8YkwgoCLxCwEEFZuDDDFxGYCFAZVDFwOV7yzvUgBSAngCg7RqugaWSswWKJ8eZAPnSLBhAELAKwgziIQACCALKAWMCjcuNzVMz48alAPQfgEcEAFsAlwDMgZB8Yk6aAB8PkOw2wCCIWljBmIgjxBAE0Q8aqm2hxoWz6+bOjqsBKQC9AFA7dkzVQACADIAUD24TQBBEowAcRGsBM1CRDBiJLmDmARoH1OnA8tjdgBSAP1ZOA8AZgBIAB5AQuJqAOR+AC8jBEGZgGgEwkGkgGeAggAnQd6CasXpqJpMC0H8ATlaPcQbIFtjhseEDSiEAgokAMwEQgLgQRJzAr1ibBPiUSbsMkglkz63JxIRACkBvAFQJAD8A4HCcA+wRl4SMmAF2AbkxYHPASYBmWOHtQjsLjh2VJqC2BGZcWDpu5d8NAQAwIuvPAHAG5PMEAKYAVwIgBuQTM3xbCDZAP2wKUAcYgQADX2SBCAL+sKnqgrX1E2ZnUgD6DcA5A0BFXwzSpwGOKQBHgyCAFTYBEhNA6ugEJA8QVFjCBczNUn1SSATo04Hl41a6CEgB6AmAet04AEqACwDsCaIIsORMiJlAQuA5GAjtFKEOhKsAJkLlAbXVkxUAFgEpAH0AoGLGAN4IiHttgJdfICCembAYEC4ACoCAYy5QAOATxyBgWW2RsoAUgH4DoDOAHYAjAB3AIgAuAABkHyShE1qtMAoB+kClIGxAToTUBBbW3RaQAvDnevzoFAEQjAFogarzxyKAOmgHgYsACwEFgTw6QhQELuC3mwApIODE37UAALB//8GRkALgRN0eA5ABtjgEWBEAMBRgMMRYIH0AEmcGvEcoTYAHwqrTAlIAegPgBMYAAIDXhyzBAQQF6jNk7SQInKCEsSAfooBYkzYgs4AJAAImBogAYwEpAP0FoO4AYG8sAegAUQT2hcU+EK2EgEC6gNUHnSZw4ujqibYFpAD0CgDmwLADdHh6Dg4gEYAJiLmgRD9dDHjhueC4J9oATEB8G7qTyzNEwF8HYETWnwB40I4AC4COBMhvJiLOCSUC7dlQbg4AgrBEF5AIcA746+daFpAC0GsHqB7DRoB0gDgEsPRScAAQ4NggKjEEaASOsTAUA8W2CRzbunEunQqmAPQNgPMKgPBOEACg5Y97bpg7gA2C7AKYDNEGAmEssI6OnU2AEfBXZVamAPTTAWq6AxR9vhEAAJQ6TAPxj+M5GSDhc2UwAsjZByu+YIAIqGyjSVASkALQSwc4X1Md4KhfcQHQuQfghxAOCmMIcPuAFx4LwghEtgbrVANTAPoKQL1K9wJ1CZQAdEOggwWwJAG4OyIZCGTtETsJ8DZkIjUwBaB3AIo+IoAJwPLHCxYQYwJuBGwXKAOBfBcEClunTPhLGQAADh48NBI6CABwGmQBoNqgQ1h4iwA8YCoYQA5IBsITgRgJUAfDCFAGpAD0D4ATBoCKBQDUzQKAAIQUCG0Rh7qAhQDkhRGwZ8LyhrmLhQWkAPQNgLwFQHcESEDAQcBevGSrDwkYANhA5y4AAgIX8LZOmZsC0HcA/HgAEAG23A4ABNAF8NlieV4IBNwm4EkTIKkMSDIA+zsoSX8nOkDHCOi2H8AO4N4cDMUAEEAbjCBQcpqA50kXKJY2ZEQGJA2AOx30h6u1/04HHeqqHjoAq+PRkFl/tw64EYCYAfaAX+ydSajTQBjHUZ8bXgRBUE/igqDgVTyJHocmT7TVYsQSU2sRLyoWCh4FD4IXBQ8iLhRcqJSmBQWpFsQFRFRww31DvXgRt5uTpf6TZmaaZqmJ+m9eUh5JfDK/fvN9/5lJS2x70J0OFqkXNCe5AKy9wNcVEDBc+18R3HRtSADssQD4AB4ABheE8IX75cgEcn0EoCo0IUBRyIDAmQ3unL1yTnIBaLQ+kUKOI/ljvRHglvWPco6jAvnU8nNLMQCu0cDxAADwIwAyAdlGgL5c5qDlC7DnkzOWFlEENi6kfcCECTECECYAdA/VCFdPugFuvaH7hHBVO9RdGx0AJQEA4lwQL24yaBLAdIZcVSFnUQlqgq0yLQQdISBZAOQbzbskQ9jKkLuXG0Pf8LLwhs2hbygGQNAF+LCFxZaAudkvJwHCyeS2P4g5IzvG10ybk1wA8nr3GZEIUxLp7PebBiAB2N/h3+9ZV88HFADAjCB2EghLUCBZ4tjCNgKoBaECoyRkLixy5wIbZ88aixWA+aEAaLRuZQj3E3vHbwhAALhD+Pe7FSADEOcAOWskiPAk0Y0pMwxgVREnJ2AtJ8DUIXcuCPX1AxsXxtIHAIB8XgmhRvMRv8nkt611yhBaJ8Tp0eWGEkJ5OwIAgGKnU6oVaoXK8MJUwUqNq1KpU3Ko45D1jbZFyxFwRgHziGnENAbIKxINwIbqgftE4rXZy/pQbdaov+TRJJH7B7QNSgjlz/YDsP7bA6qTw+vBt4pkWwKVr59v3DjvR0/d+vx1vWUQmwiUMFK43T1OtCmzamqSAVAal58TiRtBn59pRHYrBIBA0i0A8IyQwvoHP95QnR5aPx5UJDsG1D4fCajPHbiDSAbMzZIdA4qrl40lGQDabNf5H9snZ/3fPq9cFQST6wHanx8BNpoR4MGbg3upDg6r0ycNAEwEajeO7AqkI0879iJzqIdAybWybMfyMWNAKLEA6N33NX7m/qrpu90azVd8kmrvu2uVAOIBsN4CYK8tCoJ/2QBQ0S4gBADjRTcBePAM3QOB7c4sMIEAKNQMEJSCFx777Lk3PBaBdBcg+ZcYgAIFAM0fCICMVDkfBIAjFgCYRQ5ZyYCTAGnFpHgBUMIKZgCrFPTbco3Ln0hGYAEoQSUGAATEDwCa3waAyg2AuarIbRFtJKsmLxpLNABr66jeWNX7Wp83kQQ3qTcSCkCYLqDfHDaORc9Igbx6+pRkRwCRGSD5LQX11ssIwgjkE4DTaNdRAnDEAmAcq0qLJgB08xBQWLxyzHCDEwxAXtt3n999fxDl7+gAPhCJbwGoQSwAcRXgjgAHD9L9qCMAVcGioGjPH+0xAARoj7Bz+RiSgOgBUMIIFbyg+a5WB0KWr64DQpFZAP6TQFrb/YEuwCYAM8cgJwIlVxmQxAggNAMyPkrBMkrAKC0A/zkAlXGg2+gBsAQEXAQYOykeMxgRoBxeG2AGMGv4DYMuPzTg8vASAGA0v0nAHwAAAgCOEWNjR1aMLRpLOABlgRmQIZ+aDfHVwhLwLq4OI0UYAWwGDo6uCzjfB0B/R4C5Q2TV1OQDIDIDiHSrrosu1uvvCOFbAHnxXxgeAGbzxw9Abtyj3wQAAwrA6mlTjOGARANQ1mEGMErBlu79V8LDI9aQANhpwOgAKAEAZhjomUTb5SXLJvfGg5ILQBlmALsUFF35WmgBlMPJPwBUowRAHhcRgOUE44tnjU2JEYByNMqrqOS8peA6VeFemL39kHvhwwNqfgQAIAaYx5EAUEMEYCDgDAUbl6cBgDLMAFYpeJH1QUboEFgA5VASA2C0+NCKCgBEAC8CzkmE49uXpgKAMswARi13qMX5JG9oHaoQvgUQMgEQA/CDTgcJNCEEAASfEEIByI3zZTNAd8XcQloHpgCAPMwA/6WgGJv3LmyiBuDbg5MPTgadEiZZANApYX06b/wM1OevNdleRsYRlhiTFXECUK5GJpgBDL07o7Ou0S9/5JeAdy82qlHJA0Cx0DG+N6YSRJnf4p5Soy9zT7dCoeaVPVeYbgNEAZhjADAhJgAiJKDdQj3nqedbLADK7e4T/iXddtg/TghATpYxKXwoSVKmFwOgAWuLWE+Zcz9WIIeDsycomhFgzqQUACA0A143vR9nDUGDbQFUQ0oIgP2FETYDkmRt9MeHMtZeKFkgo91zCAKy3fo4AIMinRISKwBadGpcREbvreiySv/5yuNLKAE9FsDFhhadyo+9ALBXhkiAgSc8SEAoibuMEI8XgtwRAG8KhhdsOUGJB0DJrr3PbdBHaFAAc0cAzBZFC61gAIAAMQJ+hEVEA9cO0Zfd8lZuYFNB1kxLCwCazjUDJFKhpWDf2fW3MuG6h01d+2MAoO3DI4AIwAfAPDrDP6gYLxiDAVNSAoCmN1HVear6pt6Py0v+yZdx8kgBwKJAEh4B5H4iDBxBwEwIrbe/f0dWT48TAC1S5VswAzx6h0ZFuOBbAFqUqvoAALIBIITuwqYCspkLQOw44H7gIN0gsnrG5NQAQLv1u8K6DmeWq4IS8FV0GWCwCNDrBkgk/YAsTget5rfeekVmL4sPgAVRAyA0A14bzQpUXnFPfNKlNeIoIoDMAUDyK9MK8EGAf3kBWBwnAFrUghnAyOxvb/7drkrrAv9pELfOoLOICoBrURpBPSFiGBKBgt5iEBJeAFamCQBVhxnAKAV19fdpd7in3TFOi1JMADqGF8w1g3PYe4R2rfgVNYbdhrDMFwuAsdQAoFWzG7hzvCtv63Zu1z6DQMGwAKpa3AAU1h86dzyQzn2pEMkUqXw/HFDfa35jgEzmzYoVADVq6U1k94zqTjXVrr8kEt8CUKMWA4D99+6dCKJ75wDA4Z9HA+nnYQAgJIC+l9IGgAozgFkK+oQkdgCO3zv14lQAnTjuAODosUA6KgYADhElQJo3M2UAKDADGGsF2/QMDaOArMkjihqxmACcu/diTwD1A7A7gAYBAH9IdgIwMSUAqLrADHje1I0A8EFgAZgB4K8HQPJTEcrxA6DGIK1dhxngKfHbNCdDAGBYAHH8TVrSAChIMIjFBJBYAVBjEXJ8lhuk6xdf8y2Ay23V0N8OQE3qtT0gYEtKIQCqfhNmgGe5sKqeRaHIsABM/e0AVCTZMVIoQoAgCUwPANUtMAO8q/0uIwB4LIDNVdXU3w9AxhAiAMYKEBZcAExIEwCo81iGcJcLx4ffAeAfAaBnCiMlBAeZNAPANwMy5PVHXgdwHQnAvwNARjbTAesh1C4MzN9myNx4AcjGo2rrQo1I7BCAANA/aahezcYjNcEAOL+o2jggMUgzAFn95l1eoOf9/tVNPRuT1G6SAZBdb+0IYGaJKQZA5ZsBfAtAzdpKOgDGfyIaAECA7KLAOKQagCzMAJ+iFgCuTjoAJDwAPMm9Q7ojQDbLNQM4FoCrA0g4ANF0AWKlHgB1m8JM93gWwGMN1yYfAPIfgIFqN5kFH9cCyEYvABDhcHCOmAQEHw5OEgDZONW+6DUDuKsGYkkAAEC0E0KIoTATQirkXwCgWmeYASO1AABAtFPCCAk5JcwAQPrrAfjF3rn8vhBFcdx/IKxEQmxsrCTWliIyv1KNiveoMB7xXIhHSUQXzKKEBUHsSCq5FcrImBGvqJSqiIVHQhDvVzxXbNyZaXvQnkunc5t5nG9+9fvJb2Za7mfu955zz72DJAMkpgBwANCi0N4Fn3uTb7XKhGMOQHZrRzIASQFIGowAAMGVhUMyg7/8qrmJgFcxHmMAjAvPU/+TApA0AgAAzl5DF4b4aj9YPsR/7E0p9wuUguUlgwcgK1kqJAPEKQA1K0cAAL40rH8BBS4TPohADWF6tAEQJgNggvjr3z1RpADwWh1A8KFU2xLcRofmlwzAhKxsqU4y4B96bBpqVrLkATAdW1LoF4WmH7T+iD0AvEww0gD80fztb/0KrEEyAKpkLfm6G/YBQncDKG9V5Uo+ACAAIABFHgCjBg8DEKUBVZmSBABOgPsiALgMEwxAZAI1yQRkAwwD8SIX2GiOegBPS3J/VgfjjxgtL1XlCQBAEkGDV0IAMGqwC4DYBEyZXUBXAFZ4qeD0ptm9Smlrk28lAwCj8uK/Z4NrhqZKEwAAk0E/Tu/xpdPf2wRs+nb0/dFOvXde8DP8DQ7gE0r/DcBwmQCoMpVd2PlIeDwZdHaJikgGAOlZp82iH5XM0wDA0QM+dfS/AVCiC4BmNLqlgbEd5SV2AV0B2FO0rl69qvcqq7QHAHh/YL0vHXjPp4P/2fRNAEZHFADNqNzoZRz9xpRGAALA1UKhMNSr9OJvABz1CwD0AHjTexNO0bWArIYsAsdMYPvX4EckAMDNUAKgKJ0NDwBwybcATZJwA8DnBA1NlsIGALeA35ofMgjuVyup7CqyAHADSCm96YUpiYDwAeD0AK0ZBJhHgkyyMjAANElS7bMPkSWA168jv7h7OZfVPCUBgJbJN+96pd0ReGhEHACj8VRJISH/DWx18P2GrC5ADSEAMJXcvPXb3z1FGgB24fkMZAR4/OQJmB8cjAmEFgBHnc8riAEAqs2LQVPYJgD4/jEPr2ieCSQHgOlKHAHgBoA/NqBSgkLRwZhAaAHoPhbir4gDwC7s3YRuFXmBscoTfJewylYtcIUSALSqfKAAaFJkuw+DwWyeMfMFvkLgrITINKQACDRAABYGL6NxB98J2GQLFzITf7TQ06qxMHhp4QNgemwBsIsv0X9e6nnF5kdgy0X4aTOeVxi/SPwBiG0PoHGLR+/vtw3D6yPwx0U8Ktn8QxEAkQXAaDwTPA2slHWOyZZOHse3i3YgCR6AsE0HhwKAccEDYONty6O8lsEbVZ4oRJeKF20JAIStICSuALgDPHQbmLLqHaV+nYk/NvjJBZkAyC8JwwUlYbEFwGi8RmN85U7DEBsFHBc8AOEqClViCkC2fOkiau53r1jtt9Ossw9FQ4WA+wAOQLjKwkMDwMJgxWqIAXiVv+z3I9EdpLgJmEwqALAwJAIMRAkAoQE8+tPaRQlh5VnAJqCVuwKQSjwAwbZ/tnxLsBL0xZ+3tV25gR3KTeAkjxcDEQEwOAByrIGuBOVJYM8AQP86mgAYBAC5AMVqj/H7n6d47T8Px1PG7oChwXLBySIA5AOglk+hBsBrfjsblFXv4yPGi+dLdq5fEQCDBIBhCX7P1KE9gZjzF3Fi3taaxBAA0QDAiesQuUlg1uWU6h0MGQ7G4xoLEAAKAyUDYA2tvIs7+r1TZavLOfqVf5wjEQCn+UPf+BECgFUxA3CTu1XW9SQ0b+DNHTOJAMxasXwZzwWne9ZvqeDZaZ+aHTsAWA0r8/IKvazu72RfEG0l+6bGZAGweNanz4d86fOn2e32//TlsC99+TQ7ZgBo8x5gnblr59i9bJsibu7O/WpJAiA96/PPI77083NaaSr95aBPfUnHC4B5eETnJoEraESHTx64sSM4h0/hABw6cuzVq2O968ghAODwwQ2+dPBwzABgpnArgBcmCoBdeT5DdGaNyQPg1UYfIgC6SNPRud1mWhc/Vzx4vHsioxEAEgHgvXffEhuAlwTGz7bwErJm/oC/Qd+yyqcJgK4AzAtAtulVeeNGLjqbueWBqG6Y9jwCINQA8P71oSKa2S1awrb5uoBPIQgiSH0hARBqAAS3sLfUh/3rfK88EDcBAiDMALjjePwOvnembPnpQQCB56ZNAIQXgJzFk3kpPJnz7N83sFceiGcRylaOAAgtAHxGT9R6D8t67j9GkU/+YSIEQFgBsCuwFQCSBP6fMOKGYK08xJH+pRMAcgDgmbwnIgN48n9Nx6pvRV3AowtWjgAIJQBgAH1F8RaUB2KzyQRAGAHgdZ3HRSHcdTAAocS5RL5e9GXFJgDCCAAyekOTwHhCGC8o9ZYKEQDhAyADKRwfSWDES/BoMjPPhwAAmg4OHACriMzjoElgXLmrZ+8GcS0cACoI6QLAWH4b+xU3ACjmwOL3zH9fnzW8VSX4nLLdx4flAFBJWFcAMv7Fqq+Fvfa9BeVcDzzZlUf/NIF+AKCi0IABsIrnLwbZYragrNRdKnSpaPUDAJWFBwwAa+AG0EwC64Fd0Isp7X4AoIUhwQLAqo8V/D+P/+ZNr+1ledOK+BUfV1kfANDSsKAAAAMQyI3ce2bqtiLSxfNFiwAIBwA8BXRbWTz7b21qiv/Ak8C9Q3Xy3oxNLXVcfLFym0NFAIQCgMyQfmlPpy61da2kZ3qWXjp9CdTl8vpQxp/0EgEQ9CCwWCz9rSKopPtrpyKoy+UzGQIgNADoYoXoogSACIBkiAAgAAgAAoAAIAAIAAKAACAACAACgAAgAAiAkWMzQ8nQVQKAACAACAACgAAgAAgAAoAAIAAIAAKAACAAEgnAmjlzCAACgAAgAAiA5AKwnABINAB8XShvfwIgaQDkW1GAC0B6hrM8lABIhAgAAmAbtwACIMEAtMYA851EkDsGIAASBcC2tXkCgADgAKxxAFhMACQSAD4EcABYQQAkGABIBM5IEQBDyZADQD6/btWqRQTAbxo1NpMQAvTi6R35ZhpgDQHQ1rTkAHBpsweA0/4uALMJgGHDpiQFAMt8viX/51zQ7IjsEicVgKlDCQHA/vh4HeSBnERgZLYJlArApJ2FoSQoY314utoNAlwLoB6gpfFj6kNJ0NX9bIQTBLhRYDsNEI3ZYBkAgKbUE9EF6B+et6eCIAigHsDxgCSYQOHdx6fOEACCgAglAqUAAJq2M/4m8PXdhx87/pgJiFIUKBmASfWJsSeg/u7jnXVr8+AAy6OUB5IDAGhK7Amov/vwfbPXAcAYkHqAliaP2RlvAur7zhV35dsOAEMAAqBtAhPjGwsU6jvffXyWb6UBvSEAAfCHptYnnotrLFDYue/dxxdbWg4wP4IOIBMAIGDizjh2AoW62/6bN/MOgGeB2g5AAHQQsJN3AvV4MVCo13eee3fOaX+nA4AYIGIOIBEA0KRf7Jk/S8NAGMax1QgOhUgHM3RxE9yKo4EORTr5IRwLmRM88qeEZBCF1g+QrY7FJV/Cb+BWdArp1snJ9+5Nc9cuFirNXcnvIHO533PPe0c7UAIpy8CBQO2n4yx/nqN/XgD0n6A6AJvc9j9oBIDRQZBS+1m+WE4d33aszSsgToA6ACLdwQgGAZBuzVhismyS5z/zwOb+ywLgE6AOgEi33xlBc27PRF7yRZ59feo2WfkXC0CtCbCfACBa964/6GzNq6y8vyy/53HgE/TPBwBcAZWbAHsMAHJx/heGoWmn1z3zbfYkBbOSKRDHcRi5xCdeIPp/EP2rNAGEAEhDo9E0tJ45DWMZCAsiIEmStuu6uq4z/aV/eAHQAVAH4H/8Hx0ZxycQgCiUhgjg/j0vYPXP/Q/X/Ss0AeQMQJMG4KadRJWScNqAi4ef6cfjD/e/wj8fAKoVgMwBcHHXq10iIB/tU/14/Ll/+gLgBVAHYPcAtD3Y8qpZ/QSPQgIC9rl+OP7cf1kA90oVgMwBIHTPK10BPfFgPaCfQj6zz9of3/9r/tUrAGkD0DJ1n1SOD4t+GDYF7a/00/ffpn8sgDoAuwVAa5lXji0VDmBR+6z8C/1DwT9eABQrAHkDcHZpOfJgIY949lE/TH+o/9I/HwAqFYDMAfhlvw5SHASCKAwvZyazz2b2OreJCxFBaAQJSqvjAebyqdRLpTtZB3wF+TXkAN/rDtn+CPq/PtZm+jHkxz/3fw/gRQP4PvwuG0XijpZr0fTBr/6jY3/mAcSFK9ibvvDDf8L//9z/PYBXDOAYIlEhRNhLM/hx+z/7O7sAaAfwdTgOgachx4c+/O/Xv1N/5gF0w0zyKLy8wDd98OP4m7+3HwDmARRrt3dzp+jqrvTd2iZ98Nv179SfdwBl0e69gNXCnS8v8HH4M37H/rQD+CyLut01gOfVho/Dn/H79WcewFQTJOxZk+Lj7Is++Bvw+/QnHsB6rgmatNv3qPZJ//n4O/RnHkA/7p6YI8DDPuknfrf+tAP4KH+qM089qtQe+Ekf/D79mQfQVD1Bgp3YYf+gfwK/V3/mAZwqsppGPglf/Z3zEw/gwj4d2wAIw0AUragp0sEADBPZ7th/FEAIGURFd1j/eYPcT5vjeG+Bu1bP6fPvH/zP++sGsMwWq4JIyS7+7/mFA2iThyCzsDrrawfQTUKc5/bgXmF9Avgipy+zvnAAwx6AmwK/KTa+fADCehVj0w1AroBekG4AY8cbAYAAQAAgABAACAAEAAIAAYAAQAAgABAACAAEAAIAAYAAQAAgABAANnbpoASAGAiAGNTA1b/ag37qoCxMoiECIAACIAACIAACxAkQJ0CcAHECxAkQJ0CcAHECxAkQJ0CcAHECxAkQJ0CcAHECxAkQJ0CcAHECxAkQJ0CcAHECxAkQJ0CcAHECxAkQJ0CcAHECxAkQJ0CcAHECxAkQJ0CcAHECxAkQJ0CcAHECxAkQJ0CcAHECxAkQJ0DcwADrBNgCPPHtE2CNCbAEeOgGGDPgb88OchsEYjAKS2QmMy60QcoKcgA2SBwEKfc/To1Tkl27qStTve8EUf4ngwQBfOv/B/B8BIzrfYWz+zpGewRYAIMG0K34A50GMAQMIPW3bryYDg4uZuxufYoYQMqlv07TsrzBzbJM07UvOcUL4JRyLqWKtOoDDlolUkvJOZ1CBbCfgHOp8yzyDicyz3Mt52gHYA/ATkAVkVZa/DppRaRuByBkAK8CqsBJfe0fKwA7AVZALtoAXJRadP5t/2BvAI8ArIBHArnAhc2v+4c7AM8CNIGU4Sbp/CH3t+8BmsDWwJDgZND1t/kjfQfYNV8JwJfNH3B/1VgDcNYEnX/TGEJw0ZjI85sGHg6y/u4Yv/Jo+FcBAAAAAAAAAAAAAAAA/OQT3R040atZehsAAAAASUVORK5CYII=",Rlt="data:image/gif;base64,R0lGODlhbwBvAPcAADS/SUDDVEHDVE3HX03HYFnLa1rLa2bPdmfPd3PTgXTTgoDXjYDXjozbmI3bmZnfpJrfpKbjr6fjsLPnurPnu7/rxszv0c3v0tnz3eb36PL79P///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////yH/C05FVFNDQVBFMi4wAwEAAAAh+QQJAwAbACwAAAAAbwBvAAAI/gA3CBxIsKDBgwgTKlzIsKHDhxAjSpxIsaLFixgzatzIsaPHjyBDihxJsqTJkyhTqlzJsqXLlzBjypxJs6bNmzhz6tzJs6fPn0CDOsxw4YIECBOEitRAQYEAAFCjHlDqEQMEA1GzSqW6sQIBrWChTuV60QKCsGjHkp2Y4SzatGsnOnhLV23chhrc0oV7tyEGrHujFkjw4MEECxj6MqzwNHCCCRkUR5QQeEBSyRIj7A1wGXPECnQDPNDgWSKGxmEHJC4dUcNXtAVIs44IOOyC2RIbvH2AO2KGt7d7Q9SrtYBwiBbQDpB9vCHxqAFWN1+Mlvf0hq+1BmB+PSEGtJ27/id8kFo8w9pZw5s3qAHteoUTwiZ4nzBBWPX0B6LOGjm/wbDG+VfQb2DNJyBByYFl3YECJajVggxqBhZ+/pEHlgUMDmShVhjalAEEIIYIQYckbZgViTQ5mBWEIkmoFYUwxQdWBCapGBWLMpkYFYoi2QgVjjHpCBWPIRGolYE12QcWdyOFZcBN6EWFUgBh9TeTkVkFgJKSL9bkYlZIliTjkUneh1J7YdGE5pIpFWCmTGNmFSBKQgJAwEzZZUVjSt+9+dKXWUmH0gBhCcCkShrsF9UALIEWFpB0okXkSQcUKiifiorlko9QEXBoSYlK+lKlTiIaZVRhsoSlVgykxMBb31a6pBtaEJw0F1oNzERqWK2OpMGrfMmkgZtoGfCpRhqcKtixLWFAJVoEXKrRaW9FdxOnUQkAAbMSaQBBpifmFGehEmQkAbjp7TRuWARQUBEFeYLXkwXP7qWABLEmlIEECgQGQACT4oQBsf4aoACIFBR1AQUgKqAsbNLupMGu/la81wHc6jSrxRyDlStZGXDZscUJ5MuVBRSP/NYBAZNVAaEqp9byXRhEQPDIBUQQMWsaTJBAvaE9lrFwGlhgQQSFPRCB0UNn6PTTUEct9dRUV2311VhnrfXWXHft9deSBQQAIfkECQQAHAAsAAAAAG8AbwCHNL9JQMNUQcNUTcdfTcdgWctrWstrZs92Z893c9OBdNOCgNeNgNeOjNuYjduZmd+kmt+kpuOvp+Ows+e6s+e7v+vGwOvHzO/Rze/S2fPd5vfo8vv0////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////CP4AOQgcSLCgwYMIEypcyLChw4cQI0qcSLGixYsYM2rcyLGjx48gQ4ocSbKkyZMoU6pcybKly5cwY8qcSbOmzZs4c+rcybOnz59AgzbUgEECBAgOGByFYAGD0I4YICgQAKCq1atWCWh4alEDBAJYw4rlSpECArFosR4gG/HC2bRwqz5g61CDgrh4AVSgyxBC3rxb+SLccPdv3AGCEWYwYLhAgwcXIkuu8CBBg8QGJ1DFu6DCBswRHeAdMOEz6IgP4gaYcHrihLgPTLeGmAFugAyzJWrYLLaA7NwONzBGexl4xAVpWRuHqCHtguURC4dNAB3iBbS+qz98izVAYO0MK/6gnQu+4fDuv8sjbC5WuXqFr8Mifr8wQXv6CjegTY+foPiwBfSXEHJhRSAgQudd9d2BBIk1H4ME6RfWWhASdF1YxVUo0IVYkachB6mFtdeHIIp1AYkcNGAiiiFidSKJLV714ofxYWUgiRxe5aGGOVqVoYbsYWXATUwtmFIAYhkJU21VCaAABBjwJ5J9YbknUwRiPXdSjVdRR1OCVo1okoRh0RQkVioVINaNMXFplZcoxWiVAFKuBFaVKjEZ1o4tYSlWnSMdIBadL23A21UBrtSjVXyqJGeYLREYFm4s7SYWhZWiRahKwqE1I0uSCrkSd1jB2dKZWDGQEgNpKbnSo9tWWTmSm1dpGROVYqlKEqvYAcqpmmgh4OtFnaLlXU0ZIImWAa5idMGh3VFa03+aQjAsRBv4BZesNKkIlwASZEQBtHvuBCtWBFDQ7EIbSHAnXD/mNIGycRkgwboRWsCramLylKxhBDzZFAYEEwwBA2DCVYC0PmkArGEQo5XAtTdtEGrEGLPJlQa4YvxXAvgCdYGgHsd1wKeJVfBwyVcdwC1oG0zQccQDPBAyzBUsMEBeASQA2YEXUPbAAws89sAEF9yM4tJMN+3001BHLfXUVFdt9dVYZ6311lyXFBAAIfkECQMAwAAsAAAAAG8AbwCHNL9JNb9KNr9LN8BLN8BMOMBNOcBNOcBOOsFOO8FPO8FQPcJRP8JSP8JTQMNUQsNVQ8RXRMRXRsRZR8VaScVcSsZcSsZdTcdfTsdgT8dhT8diU8hkU8llVMlmV8poWMppW8tsXMttXsxuX8xvX8xwYM1wYM1xYc1xYc1yYs1yY81zZM50Zc51Zs52Z893atB5atB6a9B7bNF7bdF8btF9b9J+cNJ/ctKAc9OCdtSEdtSFd9SFeNSGedWHetWHetWIe9WIe9WJfNWJfNaKftaMgNeNgtePg9iQhdiRhtmTiNmVidqVitqWi9qXjNuYjduZjtuZj9ybkNybkdycktydkt2ek92eld2glt6glt6hl96imN6jmd+jmt+lnOCmneConuGon+GpoOGqoeGqouKso+KtpOKtpeOupeOvp+OwqOSxqeSyquSzq+W0rOW0reW1reW2r+a3sOa4sea5see5s+e7tOe8tei9tui+uOm/uunBu+nCvOrDvuvFv+vGwOvGwevHwezIwuzIxOzKxe3Lx+3NyO7Nyu7Qy+/QzO/Rze/Sz/DU0PHV0fDV0vHX1PHY1PLZ1fLa1/Lb2PLc2PPc3PTg3fTh3fXh3vXh3/Xi4PXj4Pbk4fbk5Pbn5Pfn5ffo5vfo6Pfq6Pjq6Pjr6fjr6vjs6vns6/nt7Pnu7fnv7vnw7/rw8fry8fvz8vvz8/v08/v19Pz19fz29vz39/z39/z4+P34+P35+f36+v36+/37+/77+/78/P78/P79/v7+////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////CP4AgQkcSLCgwYMIEypcyLChw4cQI0qcSLGixYsYM2rcyLGjx48gQ4ocSbKkyZMoU6pcybKly5cwY8qcSbOmzZs4c+rcybOnz59Agza0VYkQnC1EYPSAQiaPIk62hG6U9WfJBgBYs2rVOuKMKakUKW1RsbWs2awr2qwC69BRjbNw477AxDZhIhdx854tkKquQUMr9Aoue8QvwVo5BivWqsmwwE4dFku+4RiYnwWKTWSBEygSKWCfDsnJ8sND2UWGfU0R3ICHnbUMMV3BgFWEYyJ6LbChyKgJIcNc8l54s6tyRT1xNczxZbyiIgJwd/BqXjETA7hdqFfsxWHvH+0V1/7AFQSeoisHZ8eUp7jkLJD1EzMJMHtCF3yJKcwS+HwfIqCzVPQXEQ1mMQCLgA+xMl9ZZCD4UBxmUWCfgw29YFYYFDakoFmhZMhQG2aN4CFDLZhlxogK/TKAWaigmNApZmngYkKOmCXDjAghVxYTOB5Ehllp9GgQE2b9JiRBSJjFyZEEUWGWKEwOFIZZkUQp0BtmDWIlMDpuRceWhpglxpaQmBXElrIEUJYDWwJjglmUbJmFWepZqYhZL7SZgFlRWSmDWWds+WNZEOQSEy4ggPEKTJucpUZMXmCVwBOjvISDWRMY6pIqCmg1wBCXtETJWW68dMRZjrRkg1kOgNKSJf5nleCSJGd9gMtKsERm1iQvzXDWECr1wsJZRMDUCFxxpFTEWQaUElMSZwmAx0ljwKWFTLqEANcWJPlSBVwR0DITKeidJcSEH6mCAlwDoEZTIXGxsKhHj0wQ1x43bRGXBGT0mZEpRix4Vhk5RZEXBGHMclErUiCQlxI7iZfXA06kKtEtX5Qblw49/WGAYBlgQRdDq9SxQwOCOdGLT4xorJcHQWQhByKfAENKJIC8gYUIijXQR1CaVCDZ0GV50IlUsUxxANFEI3ErW6L4wLRiMFhsWCQkTB1XDFVSxwcMWm91Q9fltSIH2ExzYEWcCJodw4p6CbBCGZ7M+AkjepgxRSYPL+iQhBZo3FFIK20WbvjhiCeu+OKMN+7445BHLvnklFdueUcBAQAh+QQJAwAcACwAAAAAbwBvAIc0v0k/wlNAw1RMxl9Nx19Zympay2tmznZnz3Zy04Fz04J/14yA142M25iN25mZ36Oa36Sl46+m46+y57qz57u/68bA68bM79HN79LY89zl9+jy+/P///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8I/gA5CBxIsKDBgwgTKlzIsKHDhxAjSpxIsaLFixgzatzIsaPHjyBDihxJsqTJkyhTqlzJsqXLlzBjypxJs6bNmzhz6tzJs6fPn0CDNtyAwQKEo0ghYMCQQWhHCw4MAJhKtSpVAQokNHU6MQMEBFbDir3qQANXhxfAjl27VoGFswnTsp3LlkAFuAQrqKXLd6wCs3Ah9B28VoAErhv2El5sdYHQCwIGB0jwYMKFy5crPGhQgG+ArT8leE4QAbTCDRUWBFgbIegDugMibJi4IcKAsAmCTpg7YELGCaunDpj988Lc1hs3NJhqmmeGyGMHNNd4wffPDdDFJiCON6PUsci7/meMsLaBeI3Yxzo+n3HB2ALsM2Z4zz1+RcVVL9i/uFvs+v0VJSBWAPUBGJEG4BlYEXlhDaBgRd9ZFd6DECEoVoEUNvQabhlKdIBY1nX4EAEXigiRWAeY+NB8HKrYkHFhPeBiQwxKOCNDG1ql340K5Zgfjz2KtSOQB/lI1ZBEFtSfVSEmSRCMVsnoZEFQViXllANVSVVuWA60gVgCdElQZ2FN5+RyYU2IZQXaiTkQmBg6+WGMbnJg5FQE1MliWE1iOadVebqpJVVqTvmnVWYSOSiecZK0AQOA1XRoVQqotIFUAtxV06JTXWkSA1Ux0GhLd1LlwEmgWmVAoi1NGmpJxoKNpalMGwQnlgGjYrSBAmsNtylbq36UAYljfXZTjWM5kKtEorHFKkzIgklBRhQQu1afNi25FgESLIvQBhBkx1pPF9haGAMWeMtBBhIoIO64PmVg7lwGOAABBUvlSwEE7kr27E0bkMnYwFMdoO6x8xLMl6dOaSCgwnwdgCRcFdwG8VgS71fBwxcXPLF9GjSQ8GAHPBBphhlEkMDIYRXwwMcuZnDZAzTX/PIFB9ep88489+zzz0AHLfTQRBdt9NFIJ6300iMFBAAh+QQJBAAcACwAAAAAbwBvAIc0v0k/wlNAw1RMxl9Nx19Zympay2tmznZnz3Zy04Fz04J/14yA142M25iN25mZ36Oa36Sl46+m46+y57qz57u/68bA68bM79HN79LY89zl9+jy+/P///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8I/gA5CBxIsKDBgwgTKlzIsKHDhxAjSpxIsaLFixgzatzIsaPHjyBDihxJsqTJkyhTqlzJsqXLlzBjypxJs6bNmzhz6tzJs6fPn0CDOsSAwQKEo0cpYNggtKMGCgoEAJhKtSpVBAwkaGhK8YIDA1bDiqVqQCtXhxcQjF3LVgEFpmcPpmVLly2BCnEJZlBbt+9aBVvjSvBLeK0ACFw3KCjMeCyBDEEzECBcoMGDBxUuaL7woMGBAYQFQPY5oW+ABBMCL9wwIUFf0T1L0x0wgeKGCAXq1tYpey3tjBUC0N198wLdBxw3NKA7umYGqWMDXPiYIbdY4jSfrz0A9+OGA1YD/mCnOXnsgpILqAZoXvPB2vMm06/HqQF6WPgnH3S3uVjsgbwdVTBWAfsBeNEG5YXFnoEX9WZVAwxu5FpYAxQYIUUajIXXhRhFIFYBHGYEVlgRhHhRhmJZaCJE7oWVwIoWTWjVeDBCBF5YKtbYkFgD6DjRBv75KJFxYUEoJEQOUoXckQ+1aNV0TDrkZFVQRsnQlFRVaaVCWE6l5ZYIJTnVhmAmRKRVS5aJ0JlVpammQWxShd+bBQEZFgF0IgRaWKrlOVB6YdGYp5gAzOknByhaJUCOb+6J5qEEAWoVnpAKlOiMlQp046SZchCnkp1u+mSmn061aKaiVoVAphkIJxYDxZl6OBaslcoYFq0jfZnTBo6GhQCjGG2glqA3ZcCWAQtqdAF0sMVGlwPASgSBosniRGhVApBpEQUJYhvtTNdWVVafEHF77LcyXeAqXW6h+1RUfWm7U6uEEYCAAxAQRZRREDAwYl8DVKtTdY0VXFUC6N70wLoGE1ZiXBrY2jBbBwgs1AW9TmzVAbrmxZrEE3Nc423WFVyZxSFqEMECBzAcHWrkbrnBBRNcZvNmneas88489+zzz0AHLfTQRBdt9NFIJ620TAEBACH5BAkDABwALAAAAABvAG8AhzS/ST/CU0DDVEzGX03HX1nKalrLa2bOdmfPdnLTgXPTgn/XjIDXjYzbmI3bmZnfo5rfpKXjr6bjr7LnurPnu7/rxsDrxszv0c3v0tjz3OX36PL78////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////wj+ADkIHEiwoMGDCBMqXMiwocOHECNKnEixosWLGDNq3Mixo8ePIEOKHEmypMmTKFOqXMmypcuXMGPKnEmzps2bOHPq3Mmzp8+fQIM21GABglEGCoxCoIBBaMcMEBAIAEC1qtWqBhhI0OCUogYHBK6KHVtVAYUNXR1eQEC2bVsBDC6kTbjWrV23BCrMJaiB7d2/bRVwnVthKuDDYwVA6LpBAeLHZA1kCHohLOACCyZc2Mz5woMEAxBP+PkA8AK9DTdMKAB4NM8JdwdMQCtRw4PQdl3nhO1WdsYKuNvqtsm7bQPaGTc0sBvhZvGxAeR6zHDArfSZF9wmQP5xQVsC3GH+GmjbnKR3sgpmlia74OT5sahfajAstj3K9WIFDHbpeKz9lAmw91IFZB3A0gYBXBXAAzBZJtZkLBFY1QLhrSShWA28tNwBEML0nlUDVJjSBvHBtAF9VpW4l0bPVTXAih75dRWDMG6kAVn71YhRBGMVoONGy4k13I8WVSeWiERKhCJVASSJ0QZjGeikRdlhOKVF+FlV3pUTZVnVdVxG5CVVYIb50JgAlGlmQ2iqueZCbb4JUZxyOoTmlnUudKFV/+WpEJRiEeBnQ6yJleOgB31Y1ZCIFtQiVX02WtCNYx0q6UDBWUXjpQWhKQCSjVIqFp6cCqQoVeCVyhdZGao6UIDK8LkqUJX5gYqokWKlJ6sGCY61mKx7XsWArBzAOtawrm6QqbCy0jqWZK7y6JYDttb56FUCqEgRBQhUu9O1VxHggKWpUWDZpl2BK5YBZzlkQX9V6beXumMRkJQFGGBwQb4YSMDAeOitmEGhkD3mplAP9FowYAbUqIGxC9+lbVrARezWAQfPdcECClsMAMZcqgbxYwM8QO6UGkSwAMFuBXDAAx0iekEFD9ScwAI1P3DBycT27PPPQAct9NBEF2300UgnrfTSTDftNE8BAQAh+QQJAwAcACwAAAAAbwBvAIc0v0k/wlNAw1RMxl9Nx19Zympay2tmznZnz3Zy04Fz04J/14yA142M25iN25mZ36Oa36Sl46+m46+y57qz57u/68bA68bM79HN79LY89zl9+jy+/P///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8I/gA5CBxIsKDBgwgTKlzIsKHDhxAjSpxIsaLFixgzatzIsaPHjyBDihxJsqTJkyhTqlzJsqXLlzBjypxJs6bNmzhz6tzJs6fPn0CDNtyAAQOEowgYHIWAQYNQjhosODAAoKrVq1YFIJDg9OnEDRIIYB1L1ioBB129MtTAQEDZt28VXFCb0AICuHjhGphLd2AGqnkDv2Wwoa8Et4ITkxVQwauGu4ojk0WQ1ucExIEHJHgw4cKFDBcqPGhw4EBiARN+PhCcYELlhBsiFBCcmueEvAEavHaYoUGAvLVz3oY7YELhixN+ww1uc/jbBxw3LMAL4aZzsgP4drwwAG5jmhow/o9tcPyj9LcCdruETDZCyellEcy8jnXBSfjtY24Qf9U+ytWLZQATfvWt1EBZBrx0QVkDlIfSBt2R9R1LgI2lnUoLTtZSBmX519KBZKn3HlkBOMhShAWqtB9ZzLVEX1UCmFjSiwAEINMGymHlXkoVXtXATCBi9SNKHIY4kwZXtSYjSQBidUBNCyww4UoEWtViXxr1aNWSWF6EXZcdFekkmBzRCB2ZGjV51ZRoWqSmVRe2WdGbVcUp50R0AmDnnRHluSefD/kJ6Jxk/TkoQxGQdeahEYl51ZOMSrRYpBKZNpaAlAaaX6YOVUBWApw6tEFZIoZaEIo+moroYlyqKhCOyiy6qlCVVREga0JIKnorQpZauKtBnpJFQKuuzkbWkL/6lSNW1SU7UKJlMeDsQL2OJe20GiyLFWHT0miWoabmeRW3yXqbFQXOmpsVA5jequ5VBkhA7EAaUNAumcklZgACDkBgAQYZFEUBBAog5iGaGlQr2aR8VqDtwlfd2+Z5EI936AXGVlxrpBckoHFVEgOqQQOoRrZjphpEcMDDZBXQQAXzHqrBBQ/UvMABNT/gWczT9uzzz0AHLfTQRBdt9NFIJ6300kw37fStAQEAIfkECQQAHAAsAAAAAG8AbwCHNL9JP8JTQMNUTMZfTcdfWcpqWstrZs52Z892ctOBc9OCf9eMgNeNjNuYjduZmd+jmt+kpeOvpuOvsue6s+e7v+vGwOvGzO/Rze/S2PPc5ffo8vvz////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////CP4AOQgcSLCgwYMIEypcyLChw4cQI0qcSLGixYsYM2rcyLGjx48gQ4ocSbKkyZMoU6pcybKly5cwY8qcSbOmzZs4c+rcybOnz59AgzrUYAGC0aMUMGDQIJQjUQgIBACYSrXqVAEKJDBtOlEDBAJWw4qlSoBBBq4OLzAYy7YtggtoE1IA27YuWwQU4hLMYMCuX7db0UqQ+rewWAESuGpAYLjxWAUbgk4g/PdAgwkXMmeO8KBBgcICzvqc8HdBhcAKN0xYEMDvhJ6k6w54EFnihggD7L7WGZttgQoZJ+Ruu/tm77EPOG5oULc4zQttB8D1eGH4WOcxN1AOu6D2xw0L2P4KQA1TAdsFJcOPRTCzwvmT6sVGyL69KnqU8a2OLz/2fsr8VRnwkntiDeAdShtYZxV2KdEV1nQrQScWAS1JGFYDLzEnFoT/FXggS59xt5IGYwEH03FVkVfSAwXOpCBVyTUoVowxsRgWhShZaNWHLpEolooiRSCWfzIBOJWJJhkJAJIyoTgVjSX1FRaPL2Ug1gEotWjTYSdZGVYCNx3wo0lOAgDlTBpaxaRINqp5UwUHPPAAZhyS1GZVdeql0Z1U5aknRnxO5eefFgUKwKCEUmQooolKZCiDjVJEoFUYRoqRj1ZhaSlGrYW1KUZihgXkpw8ZuiapEE1qH6oUYbojq8cTvfgkrI5OSGtErlZ16q0KKSkgr2khB6xDsgo6LENlAkAAlccSFGJYDDSrkAadQittQkKOFe21B4Uq1rbcEkQtWwww22yyUxHA6LDoTuWAuezWRUBe4QrUbroSwHvrvVcxQIG+rF5QrV0GOACBBEolPGqkGyTgmFVnohrBwI2ByasG3jamKbATZPzXr8de4LFd3GawQLFi1cuBBhEkQLFV6w6rQWYTyGnzAwurrPPOPPfs889ABy300EQXbfTRSCet9NJMVxQQACH5BAkDABwALAAAAABvAG8AhzS/ST/CU0DDVEzGX03HX1nKalrLa2bOdmfPdnLTgXPTgn/XjIDXjYzbmI3bmZnfo5rfpKXjr6bjr7LnurPnu7/rxsDrxszv0c3v0tjz3OX36PL78////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////wj+ADkIHEiwoMGDCBMqXMiwocOHECNKnEixosWLGDNq3Mixo8ePIEOKHEmypMmTKFOqXMmypcuXMGPKnEmzps2bOHPq3Mmzp8+fQIM21IABAwUISJNa0CC0owYJCgQAmEq16lQBCCAsbUoxAwMCVsOKpUoAAlOuDS8gGMu2LYMLaBNSMNC2blsCFOIS1LDWrl+2Bs6ilSD1r2GxAiRw3dD3sOOwCAT7rFDYb4EGDyJc2Lx5QoMDhwVM+DnBb4AFEzY0zFBhwd/RPEvXHRBBtcQNDwbYhZ1TNtsBvC1WKFA3eE3fYxvY1tig+E3kYQfA9XhB91gBGWpqqBx2wXKPG1z+X/8Os3H3kuLFKpgZge2Ck+nDVoiZgXvV9yjjVxVAfiVdsfillMBY67kEHVUD9FfSBgGMNV9LYIk13UoVjEVASxeM9cBLA0rIkn5TFQDTBtZZFSBKGjgYU4ViKTjSA2INMFOJVW2YUoRW2RgTjGFdiOJYLq6UoocnsWhiTSACEAFKPFr14ExG3ocSaGFJFtMGYhmAkn1T3UQjVScNadUBN1FpVXYlRUlVAzc1WZVxIblJFZwriqXji0TWlGFYd4ok51QT0rRnjib9CUCgMw1aY6F5Cmono2EhKpOiVPUZp1hP0pTBAV9aCtKBAHhK0wabPWBlSBmIRaZeH4nlI6vSHREXVpCwUpRkprVi1N55uWpEKVW09grRl1OJKmxEhr56bEViOrnsRUkSEOyzCv06FZvUUkQsoNlOpCZZ03ZrUIdhMSBuRAyOZe65D31L1brsNkRuufE2lK664bJrLVmS1lsQqFU54K9CAFNlgAUDI1QwWWYl/O9fDFCApsMTNGgYAg70K64GZv5lrLgRWOwXrv5qIKtdGtc7wbZWnerwBUmC6TBCGuQm1swLaVDBAwc0uCrOQ00M9NBEF2300UgnrfTSTDft9NNQRy311FRXnWtAACH5BAkDABwALAAAAABvAG8AhzS/ST/CU0DDVEzGX03HX1nKalrLa2bOdmfPdnLTgXPTgn/XjIDXjYzbmI3bmZnfo5rfpKXjr6bjr7LnurPnu7/rxsDrxszv0c3v0tjz3OX36PL78////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////wj+ADkIHEiwoMGDCBMqXMiwocOHECNKnEixosWLGDNq3Mixo8ePIEOKHEmypMmTKFOqXMmypcuXMGPKnEmzps2bOHPq3Mmzp8+fQIM21IABglEGCIxCwIBhg1COGiQgEACgqtWrVg04sOD06UQNDghgHUvWKgEJXb0yvKCgrFu3AhhoUJvwgoG3eN8isECX4AYGeQO/NZChbwWqghOTFSDBqwYEiiOXRTAX6ATEgQ8caPCgwoUMFy5MeJBgQGIBFX5OEFwgQlqFGiYkEPyg52q8ARoUlqihQYC8E3bedhsg+MUNE0y/NX4TAt4FrzE2wMuc5nCyAy58vKC8bPWYGjD+j4UecsP0sgIqy4RcdkHJB24RzIzg1r3JBW5Tw8wg/mqElPgtFt1Kd5HVwEoBjvdSBWUNMGBJG3SHlXYtsTcWhStdUJYBLWlQVm0uzUbWbioleNUAMG3wm4IqbdBfVd+xdJ1VAjw4En1jBWCjSitiFSNJYo11oEznYcUhShuUpR5MHo6IEoNjJVDTAWT9dxJ8Y1k504xV2WcSlWORKFOSYx1pElkB3CShVSdlQNYBN4GJlZgi4YgViDVh6aNJel6FIU1Q3sknWX/OpOFYeI7Up1WFynSooO8RetOjVyUq0qJVNRoTpVZZGhKmAGgKE6dVeQoSqPrVRCoApn7EJav3N4Gq5UhujgWnTXJeRadIZBFwU1koFUDWjizVitWt95H1o0t2VooSqPIBuiYAqZZkLFZLypRBBMJWRexH3WI15E0aRODlSa8K0NdHKiq7rkcm0vjtuxFde9W59GIU7oT5arQqAATM229D8VrFwMAYtUvWwQhbFOhYDDdMUa6QSsxbj2M5ILDFBb1qlqgcJ+SxVRCEDNHIVRFAwcYho1yVAA5ka/JBoJLV6swDVYCxdzgvpAHFY7FscgQ7WyVlzw1lsK9VsyK9UAUUy+w0bAv8VsDUEm0QwbJYd+3112CHLfbYZJdt9tlop6322my37fbbcMct90oBAQAh+QQJBAAcACwAAAAAbwBvAIc0v0k/wlNAw1RMxl9Nx19Zympay2tmznZnz3Zy04Fz04J/14yA142M25iN25mZ36Oa36Sl46+m46+y57qz57u/68bA68bM79HN79LY89zl9+jy+/P///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8I/gA5CBxIsKDBgwgTKlzIsKHDhxAjSpxIsaLFixgzatzIsaPHjyBDihxJsqTJkyhTqlzJsqXLlzBjypxJs6bNmzhz6tzJs6fPn0CDOsRAAYJRBQyMQrCgQShHDRIYGABAtarVqgIQQMjglOIGCgquih1blQCEpl0bXmAggKxbtwgupE1YgcDbu2/jziWoISzev3DRpoXQFrDhsQIqdL0w9bDjsQo2BJ1weECCBxcya74wYUEBwwTk+qT8t8AEyQ0rJAAcoSfptwMeCIa4YcIAvBN2viY7QDFG23dz44xwtwHqjBsaBL954e0Brh4rBHgrfOYGu2QXiNyw2i10mX7H/mon+cCtgZkV3I4vucDtg5gaCottjbI94tksEZBNsNK+WAUvNTdWAMel9NlYvrHUnViirZQBWQS0pAFZDbyk3FgNpuSfVQMUuNIG04m1HkoTjkXfS+mJJYCHJZUnFoEy3SZWdSdhd9V7Ml14FX8kksWihGThN9JuVY0Y04FXncjeWDTGRCRVFZ7U2FVCvlTiVQectMFYA9wUolUCnJTiVUbKdMBYP37kYpI36WhVhiKt+eZNxM1nkpxVwSmTgDfeiSFzY+FI3p828WmVoCPhSZWeMRlaFaJxElqTo1RBGlKdbBYaqEmUAhBlTZgeatKWYmVp04JWJUjSl1jdZKNV5Wl+dKZYsbJ0pVUFoORmVU3C9KSnKIVa1Xk0bchrj2NVaWuQKc3ap0yKAtBlSr9GGNMG8omaEogIxhQtALWGZCxVBIRb0qtFstQpsC9l4GxVypYko1jfuQQcVWWiNOZVCMi0gYuMooSqVQzMpIGlKmnAKsF7efQtAAU3zBGSYkEg8UYPuhXZxRn9ipWqHFPkcVUOmBuyQiMDEEC8Jzc0MsItQyQsVdPGbNEF81IFss0TcVeVqTxjJB0A9QZtkQZKGq300kw37fTTUEct9dRUV2311VhnrfXWXHft9ddghy322GR/FBAAIfkECQMAHAAsAAAAAG8AbwCHNL9JP8JTQMNUTMZfTcdfWcpqWstrZs52Z892ctOBc9OCf9eMgNeNjNuYjduZmd+jmt+kpeOvpuOvsue6s+e7v+vGwOvGzO/Rze/S2PPc5ffo8vvz////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////CP4AOQgcSLCgwYMIEypcyLChw4cQI0qcSLGixYsYM2rcyLGjx48gQ4ocSbKkyZMoU6pcybKly5cwY8qcSbOmzZs4c+rcybOnz59AgzrcgIEChKNHLWDAILSjBggKEACYSrUqVQEKKGhoSlGDBANWw4qlasDBBa4NN1BQMLatWwRn0SKsQMCt3bdx5QrUwPau37YIMuiFIOCv4bYSuGaoe7ixWAUbgmYo/HfAgQYPLmi+UOHBgwYFDBMQ7PMCZbsJJkRmqGFCggB+J/SccLdAhNUSJwy4K1snbbcDKmTUbbf3zd9tG+DO+MAu6ZoZ3BZ4zvEC7LECqMfcwFjsgeUdN/4caJudZl+xC0ouaGtgZoS26U2uH/sgZvSx8U/ODytg60up3q003mMvXTBWAOCZtEFoYuW1EoBhOZjSfWERkKBJBopVn0sNjGVcShBWNQBMG1xnVQIraeBhTBWMdeFI+4k4E4NWRaBSd1VtGNN7YbWHkophITgTkGH5ZxJyVeUnUwJi2aifWB/GhCRVSpKEI1VGyrRBgAqKNaJNu1klwEkZWlWlTANaRaaGN3UYIYZs2tRcWFGGNOVUwtlUZo4mzWmVhDLtSZWOI/lZFaAxCToVoSIZShWiMCkKAKMhOToVpC/dCUCeJGlKaUyWAoBpR5I2cFOoo3K0ZVgH3BTjo+oniUXATVdO9eJHaVZ1K0tEVlUASkzSWZOmpp4UKoo0vTpVnSL1qutMG5xWVZYl0ViVk6B6qRKPVvkYk7RUquQsVZy6pCkA1JoUrJi7mlQrAMiqdG6xLYUqKksbhBmWdihJCkCrLbUolgHtghTtWKmStK5VCDw4FsAuaWCiVQykdG4A/K5kLwAVo6QsAMyypK+wKLkZ7kwZTHyyxVQVUPCEKv/K0m8ZR+rryyFdELKUUw2As14WTYAx0CX9TPTRSCet9NJMN+3001BHLfXUVFdt9dVYZ6311lx37fXXYIct9thkl2322WhbFBAAIfkECQMAGwAsAAAAAG8AbwCHNL9JP8JTQMNUTMZfTcdfWcpqWstrZs52Z892ctOBc9OCf9eMgNeNjNuYjduZmd+jmt+kpeOvpuOvsue6v+vGwOvGzO/Rze/S2PPc5ffo8vvz////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////CP4ANwgcSLCgwYMIEypcyLChw4cQI0qcSLGixYsYM2rcyLGjx48gQ4ocSbKkyZMoU6pcybKly5cwY8qcSbOmzZs4c+rcybOnz59AgzbEcOEChKNIIVS4oEEoRwwSFAgAQLWq1aoGHFxwWjGDg6lXw4qligACBq4OKyAYy7YtAgtoE1Ig0LauW7hxB2ZQYLfv3bwSwPodLBYCVw0GCCsei6ApUAyC7RZo8ICChcuXJzxIEGCwALw9LUQeG2ABBccLMUTg3FdCzwl2B0RADVHDgwF2I+yEUHfAhIwTcLf9jTNC3Qa0MRpve9amhbYFmnfEIFysAOkyNYy2WiA5Rw0J2P4K8O5y7dgFJR+wNTBT/dgGJxewJf6SAlvdKOVbJ5/SfNgEKxXw3kvPiTUAfyNpIKBY2Knk31UNolRgWAi0NOFV+LWkX1j09WcgTBp09t9KGIzVYUvLhYVgSO5dNcBM1VmV4UkHiDXjSylaxV5KYgWwYkoajJUBSvaNSFN4Yd04UgM21gRbWAeglFhYEb4UZFgEnHTlVQHcVGNYJ11YFYA2fQmhSWJS9cBNLVoF2khpArCmTTlWpSRIT151okxxzklSm1W9OVOfJgFKlaB8iuXnSIYCgGhMhKYn1qMw1UkVBSZZCsCdMDVKqUeR1uSpSSUaWROSV33qkVhR2rQdANc/chRjVbGmVOpVBaBkplV74qgoSo2SOROqbqKUwVi1mqSdWCotiGF7rKqkaZYyvbqoScc2CVOeVw2pErFVjQcTXVCyxK1V6LmkqaMt7VosS7de1Sq8BlZZkgbkhqVqSUxalUCyH/EVrZUiBtDrSY0eGpNx0bnEAFvXuhQxSho8PNa8eWGEGFs+ZqyRu2d6nFGR2oqc0YYymryRBrMerDJFtwZg78sVGTfAzDRXhFzOPPfs889ABy300EQXbfTRSCet9NJMN+3001BHLfXUVFdt9dVYZ11QQAAh+QQJBAC+ACwAAAAAbwBvAIc0v0k1v0o2v0s3wEs3wEw4wE06wU47wVA8wVA9wlE/wlI/wlNAw1RBw1VCw1VDw1ZDxFdExFhIxVtJxVxKxlxLxl5Mxl9Nx19Ox2BPx2FRyGNTyWVWymhXymhay2tby2xcy21dzG5ezG5fzHBizXJjznNlznVmznZnz3Znz3doz3hp0Hhq0Hlq0Hps0Xtu0X1v0n5w0n9x0oBy0oBy04F004J104N31IV51Yd61Yh71Yh71Yl+1oyC14+C2I+E2JGG2ZKI2ZSJ2pWK2paN25mO25mO25qQ3JuS3J2S3Z6T3Z6V3aCW3qCW3qGY3qOZ36Oa36Wc4Kad4Ked4Kie4aif4amg4aqh4aqh4qui4qyj4q2k4q2l466l46+m46+n47Co5LGp5LKq5LOr5bSs5bSt5bWt5bau5rew5rix5rmx57mz57u057y26L636L636L+46b+56cC56cG66cG86sO+68XA68bB68fB7MjC7MjD7MnE7MrF7MvF7cvH7c3J7s/L79DM79HN79LP8NTQ8NXQ8dXR8dbS8dfU8tnV8trX89vY8tzY89zZ893c9N/c9ODd9OHd9eHe9eHf9eLg9uTh9eTh9uTi9uXj9ubk9ufk9+bk9+fl9+jn9+no+Oro+Ovp+Ovq+Ozq+ezs+e7t+e/u+vDv+vDw+vHw+vLw+/Lx+vLy+/Pz+/X0+/X0/PX1/Pb2/Pf3/Pj3/fj4/fj4/fn5/fr6/fr7/fv7/vv8/vz8/v39/v39//3+/v7///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8I/gB9CRxIsKDBgwgTKlzIsKHDhxAjSpxIsaLFixgzatzIsaPHjyBDihxJsqTJkyhTqlzJsqXLlzBjypxJs6bNmzhz6tzJs6fPn0CDMpxlKZCbLEVwtODh5EyfSLOEchSVJQSAq1izZt0wBM8rqRRHgSmhtaxZrCWeMALrkI6Ks3DjwkjENiGjEXHzxmVxqC5BTzn0Co6LIlBdV0kMDF4MV0ctqZAqMJ58tkOmoH8QLO6wowkaQJx8gUp0pwwTEYsT6PnJRoDgDEwkNTS15sYCwUt48Tyid8GQQhTFTNDbQyetGHkHCDl1EVcZC3ml5KyRVwamjbnQZIj75maZuBwI/n20hQMuAUE1Hyk+i2OXSCdwFVSaSUsDXCG9SMYpcNZD/pg/wPXESXfAZUZMi8A1REpRnNVAKzC9cNYHt6h0w1lEvJSgWQ6EslItqJUlwCUuIVdWAOixlAkBZrXQkiJnAfFSEWftwdIMZhlAykuo3FYWDCtJclYSMVlx1ioqXWGWAqzERAsFZqmhUgpmWTETFWa5kNIrZ8ky0yZnpYKSHVnWBIJZZ6AEhFle1ISFWSygJIFZlNTUiVkHnLSKWRLcJFlZppg0iVlB3LSCWYqYJIhZZNy0Zll1mDSHWXLcpAWbJn1hlh83FViWESYtYRYiNwlZlhAm+WAWiTZpYlYT/iY9qtUjNxli1hYmTWFWHjeRWVYaJrVhVhg3nWFWpCUNYhaoNjVYlmEleWKWDTddWFYjJvUyQFkf2NSLj1kN8JhJF5RFgCo1IWKWCSgFVtaBNOlaFhQo0WHWCTWdYBZwJ82ynlafzDSLWQmoRF1ZWMx0aVkyqCRsVg0sUYpMsUCAaUquYDUBF17O1MVZrKb0wgdw6FKTLRaXVQNLo+AExlmO+NVRJ+BmRYPMHNXSwVmL4LyRDmfF4LNGY8DV89AXtXbWgkhbpARcH+TSNEW22ABXh1NPpApeZ6GYdUSwVBFBXFF8/ZArUTyQFxJmO+QKA3qJ0fZDKMRlAB9zP4THStV05e1QLxiYZcF1fj9EhlYGIOFK4RDZ0gBWO3jCuERMAEDCWpNLNIodmXfu+eeghy766KSXbvrpqKeu+uqst+7667DHLvvsdQUEACH5BAkDABwALAAAAABvAG8AhzS/ST/CU0DDVEzGX03HX1nKalrLa2bOdmfPdnLTgXPTgn/XjIDXjYzbmI3bmZnfo5rfpKXjr6bjr7LnurPnu7/rxsDrxszv0c3v0tjz3OX36PL78////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////wj+ADkIHEiwoMGDCBMqXMiwocOHECNKnEixosWLGDNq3Mixo8ePIEOKHEmypMmTKFOqXMmypcuXMGPKnEmzps2bOHPq3Mmzp8+fQIM6xGABglEGDoxKwKBBKMcNFhgQAEC1qtWqAhRAwOCU4gYKCq6KHVuVAISmXRtWMEC2rVsEFNImvIDArd23F+QS1BD2rt+2CtB23cDgr2G3ELpqYHu48VgFG4JmEGB4QIIHFS5o3vygQQHDBjL8nPC3QATBCjdUWOBXQIWeEO4OmID64YYIA+462NnAboAJGScEsPsgJ+m2AR5E1rjhgV3gNie3LVBbY4bhZAWIprmB8dgEyz/+bvicvbrLvmMXlGRN1kD4l87JQi95PH1MDW0bpGQ/1vx+sgWsdABZCryE31gBvHfSeGTl1RJ6V223kgbYXYVASxeQVZxL8Yn12kp1iZXgSxtUaJUBK2WgYUwRkKVgSR1aNWJMuYk130neWRXBTPVZlUBKG5BF04FipdRjVT/SRN5VH5qUwFg3smjfSZSJ5V9LRJ54kopiBWhTjVedlKFY+tk0YJEmjXnVhjX1JpaDJB1J1Y42xVgVnCPZSRWeM1UwFpt5jsWnTGpaBahI/Fk1aEyFVnVoSHoCsChMjVL1KEiRNklTpQBc+hGnnsI3lqYicVpmTZFO6lGQYh1wk5vjV6nq0VWWRSlTjlVd6dEBB2D24kxZVhWAXh+1KJZ6xHb0pI3JduRisxtF6iW0GG1Q5VV0UntRpABIqK1X11rl6rcWcSsruQtxCgCy6EpkLVm6tpsQrlWxK+9DhcF7L0RyVpXtvgzl+x3ADW0Q4lgF/ErwXvQK6+3CBW0AQbgeQoyQBBSTaXFBGlAwlV3/QpyBBA2LaCvBy/oVwMMQw2oXdRsT1O+xCi/MZVsJxLuwieKea/GZVhVAaswGdZjABDUTPdAFCwyt9NNQRy311FRXbfXVWGet9dZcd+3112CHLbbUAQEAIfkECQMAGwAsAAAAAG8AbwCHNL9JP8JTQMNUTMZfTcdfWcpqWstrZs52Z892ctOBc9OCf9eMgNeNjNuYjduZmd+jmt+kpeOvpuOvsue6s+e7v+vGzO/Rze/S2PPc5ffo8vvz////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////CP4ANwgcSLCgwYMIEypcyLChw4cQI0qcSLGixYsYM2rcyLGjx48gQ4ocSbKkyZMoU6pcybKly5cwY8qcSbOmzZs4c+rcybOnz59AgzrMcOGCBAhIJRTNILSjBgoKBACYSrUqVQEKKGhoShEDBANWw4qlakACBq4OKxAYy7YtgQpoE1pA0LZuWwQW4hLMQNeuX7YKmMZ18LdwWwdcNfQ1zDgsgq1AMYD9WyDBgwcTLGiecDlBgcIGzvqsINVuggmCF2aYkMCvgLw8JdgdMKHihAF2a+uMUDeA7osTAtT9bbNC2wAPIGfU8EA4W9g1MZQWO0B0Rwy4xwqwLlPD2rEFlP571PB5rAHxMCeLXVByAVsEMxuwfXDyAdsGMTOwZY/S/djULS1mVQEqkTeWAi9ZMNYA6JmkgXNhQbeSgFQFwF1KGEBYFXwsGScWfS7ZJ5aEKH1nVQANpvSgWASshMFYxLXEm1gXliSiVQPMlJ1VEaikXlUxujSBWAaoOFZNY6UY0pBhJVBTa2EFKRKUVknp0oxWOXnSdFUBmJ9YAqAkFoE2lWfVSfo1eROVVSnpkYJhgVjTjVWRGBKcVslJE51U2QkSlkDexCSPJvE5lZ8w4VmVniJZcNmjl3kpk6JUMaqXRpROZemlGA1aVY+ccmQoAIiGStGopZoqEZtUualqRN4/UvVqRmmeOCtGgFKl5a0VsTqVlbw2pEGSwVLkKVVkFiuRiZ8qK1GuVNXorEIacElVjtM+NCqp2ToknVgHdCustX2Ku5AGsepq7kIMsCXpugMRNhZ+8BqkQbtjhVtvQeiyFd6+BH07loUAC6QBBOTWWfAGEiQcKMAUMAtjvRlIoIBfAaSqKgYXUICUAun6Ky2vBzQ21QGuzlpyY/SKu3JhCbzr7Mt2HaBxsTSzNcDNyuY8YAQjm+tzAKelbC5nEWhm9MJMN+3001BHLfXUVFdt9dVYZ6311lx37XVJAQEAIfkECQQAHAAsAAAAAG8AbwCHNL9JP8JTQMNUTMZfTcdfWcpqWstrZs52Z892ctOBc9OCf9eMgNeNjNuYjduZmd+jmt+kpeOvpuOvsue6s+e7v+vGwOvGzO/Rze/S2PPc5ffo8vvz////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////CP4AOQgcSLCgwYMIEypcyLChw4cQI0qcSLGixYsYM2rcyLGjx48gQ4ocSbKkyZMoU6pcybKly5cwY8qcSbOmzZs4c+rcybOnz59AgzbUgEECBAgOGByFYAGD0I4YICgQAKCq1atWCTCwsOEpRQ0QCGAdS9aqAgpdvTakgKCs27cGKqhNeKHt27tuEVyYS1CDAryA3yrQwBdC4MNvGaQNuuEv4sdkDRAGmsHA4QINHlzYzLnCgwQDDgvI8HMCVbwLKixWqCFCAcACJvR0gHfAhNUPNUwIfRfCzgd3A8jGGCHA3QY5J9x9gNvihgfG3cq1meFtANIeNbwuO7qmhtNkC/4037jhgFsD41lusFwWOckFbhXMhF92eEnlZSPE1OB2QUr6ZE3mkmNjJbDSdmP559IFZYm30gbRjSXgSnZhFcCEKVVHloIrVVDWAy8BR9ZeK7FnYXonQUgWAivxR5Z9Lok4FnYo4YfVADKpOJZ+KSXw4kwyXmVAShuUheJKRqLk4VgF1OTjWDC+RxaPM0VAloEpXvBZhBjC5CJWArSkgWc3IXhVl3xl1MCIaXoUpFUktrnRm1VNJ6dGDI4F4p14krUnnxjliZV7gF4k6FV/FlrRklglquhEdAIQ56MTrTnWpJRGZN5YmVYkFqedSqQhVk2GGpGVCZoakYlX2akqQ9ZfYvXqQzZeheWsDH2KVZS4HoTqWEf2ugF4V5Xaa0KRAuDqsQV9R9YBzCK0XlmYRitQhVjdau1ADLiFJrO1YsXhthx022Cwqk5b1oXkcnABsRbSGO0Ghr3Fa68UwKuntRtIoKtbhOK6gQXmBrfsnQ0owBQGDDcMAQOs3lWAvIDqC1lVCaCrVqwXW0Xlo4x2DEAC3/JpaccHVPvoppAdcC+lkA3wQMmPasBbcAlotu0Fnj3wwAKZPTDBBTS3a/TRSCet9NJMN+3001BHLfXUVFdt9dVYSxQQACH5BAkDALoALAAAAABvAG8AhzS/STa/SzfASzfATDjATTnATTrBTjvBTzvBUDzBUD3CUT/CUj/CU0DDVETEV0fFWkrGXUvGXk3HX07HYE/HYU/HYlHIY1PIZFPJZVTJZlbKaFfKaFvLbFzLbV7Mbl/Mb1/McGDNcGDNcWHNcWHNcmLNcmPNc2TOdGXOdWfPd2nQeGrQeWrQemvQe2/SfnDSf3HSgHLSgHTTgnXTg3XThHbUhHbUhXfUhXjUhnnVh3rViHvViHvViXzViX3Win7Wi37WjIDXjYLXj4LYj4PYkITYkYXYkYbZk4fZk4jZlIjZlYnalYralozbmI3bmY7bmZDcm5HcnJLcnZLdnpPdnpXdoJbeoJbeoZfeopjeo5nfo5rfpZvgpZ3gqKHhqqLirKPiraTiraXjrqXjr6fjsKnksqrks6vltK3lta3ltrDmuLHmubPnu7TnvLXovbjpv7npwbrpwbvpwrvqwr3qw77rxb/rxsDrxsHrx8HsyMLsyMPsycXty8ftzcjuzcru0Mvv0Mzv0c3v0s/w1NDx1dHx1tLx19Px19Tx2NTy2dXy2tfy29jy3Njz3Nv039z04N304d314d714d/14uD14+D25OH25OT25+T35uT35+X36Oj46+n46+r47Or57Oz57u357+758O/68PD68fD68vH68vH78/L78/P79PP79fT89fX89vb89/f89/f8+Pj9+Pj9+fn9+vr9+vv9+/v++/v+/Pz+/Pz+/f3+/f7+/v///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////wj+AHUJHEiwoMGDCBMqXMiwocOHECNKnEixosWLGDNq3Mixo8ePIEOKHEmypMmTKFOqXMmypcuXMGPKnEmzps2bOHPq3Mmzp8+fQIM2fPWIT5osQFjkePLljSBLr4RuXHVnyQUAWLNq1fpBjCepFBtlMbG1rNmsJ86IAuvQkIuzcOOumMM2YaAUcfPGBdGoLkE/J/QKjuvjK1tXNQYrhmugiiqplzIsnnw2AqWgdhQoFnElTR5FnHRp+qPmio4NihkE8nkrimAGONqsZSipygTBA9r0BKIXghmKhJgw0Etlp5a8EtDQujgqiYC8M2DhjBO3wppbGyu9jUvjpqABcG/+1PooSEPcNTUnLYC7RSSuHowvy7SF4SyBOyRzIYGrQZbMMnDpcZIVcCUR0ykNnOVFSkbAtQhMS5y1g0qzdHBWDC9NEoBZI8yyEicJmvWISyWYNUBoLPVxlgwtFXKWFC8JcZYjLTnCw3NZLZDKS5uAV1YNPDpxAFZgxPTEWZbAhEoXHCwHEykJmPWFXx9xYZYKVHq0ylmsZNkRC2YJ6OVGYZi1xJgbRWJWBGhuFIFZXbaJURFmYSInRmSYVcidF7lhlh18WrSHWWkEWhEhZnFhKEWSmLnoRI2Y1cSjEtVhVhiURlRmWXRkChETZiXi6UMvmPXJqA6htpUAuaDKUCn+G25lgasMAVjWD7QuNIJZ+OWK0CZmHeCfrwd1YRYOxB4UywNmwZGsQVaWRYArzxIUCgJmYVjtQESclce2AkFyVgjg6pKKZGYxAq4tKJwFRLlBnFVAJ+B6ARcW294yBVwOtFJtKCTAJcAg1SLCLFxyPOuJELGeVSSxpkBhQF5KULlHE4ZMBEsXIcZlQ5YeYEWBFZI0JAobNwynVxO2UDlIWRvwcIUagGiiCyeK4IGGFSEPxkAdXsJAmWIbXOIlJUMPZkQsYw6RdF4sZDwmKAQ8fVYLisgpCZhWaxXDIYaaogbXQ2NARV+Zit0CjnkFcAIYmRCrCSFxhBFFDivYcAQhFmO40Ycp5QYu+OCEF2744YgnrvjijDfu+OOQRy55pgEBACH5BAkDABwALAAAAABvAG8AhzS/ST/CU0DDVEzGX03HX1nKalrLa2bOdmfPdnLTgXPTgn/XjIDXjYzbmI3bmZnfo5rfpKXjr6bjr7LnurPnu7/rxsDrxszv0c3v0tjz3OX36PL78////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////wj+ADkIHEiwoMGDCBMqXMiwocOHECNKnEixosWLGDNq3Mixo8ePIEOKHEmypMmTKFOqXMmypcuXMGPKnEmzps2bOHPq3Mmzp8+fQIM23IDBAoSjSCFgwJBBaEcLDgwAmEq1KlUBCiQ0dToxAwQEVsOKvepAA1eHF8COXbtWgYWzCdOyncuWQAW4BCuopct3rAKzcCH0HbxWgASuG/YSXmzVwIagFwQMDpDgwYQLmDFXeNCgwGABW3tK4Es5QmiFGyosCEAXdM8HdAdEeCxxQ4QBdCfsnDB3gG6ME1izPYzzwtwIHDc0OH4zg+SxA05vvOB57YWaG56LTUD744bqYgX+dI9ZYS3ykRsWrEVQMwN4qg1Oqh/7APv8qQtSwh57vWYF1gWslMBY7NmkwQLjnbQBbmL1hxdHGRD4oEcR8DdhRwxaVeCFGvEmFmAcZpRhVfWFmNF+Vh1gYkYbCGfVihkNGJaDMFJUYVgl1khRhGEZoKNFLlaV4I8PyWgVjUQ+hGJVSCbZ0JJUNenkQjdaddeUDxmHI5ZZipUjlwtpadWXYMblZZkMVVnVeWgmBOVUUrY50AEfypkQnWHZidAGYg2g50EepvinQUauOShBGowF4qFqUhXgoQMRIBabjI41pJ3ZbQepQPdZ9duhYgoK6QZSiSUdpqWGFR+kDIwVwKXCbbY61qd/CjbWo39uoMBaA8CK0wSnZpSBpK4Gm5OWDvg60WhsGYvTBsQCIAAFGVEQ7axB7WoVARIom9AGEGhnXlCNViUAAxZ4K1AGEigg7rhA8UiXAQ5AQMFS+FIAgbuTOZtTp4wFfIC6OEUQZMCDkSmUBoUiPNcBcQpVwYgOhwXxihU0XPHFOmrQwMGEHfDAokRmEEECIItVwAMRT5kBZg/ELDPLFxC86c0456zzzjz37PPPQAct9NBEF2300UhfGBAAIfkECQQAHAAsAAAAAG8AbwCHNL9JP8JTQMNUTMZfTcdfWcpqWstrZs52Z892ctOBc9OCf9eMgNeNjNuYjduZmd+jmt+kpeOvpuOvsue6s+e7v+vGwOvGzO/Rze/S2PPc5ffo8vvz////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////CP4AOQgcSLCgwYMIEypcyLChw4cQI0qcSLGixYsYM2rcyLGjx48gQ4ocSbKkyZMoU6pcybKly5cwY8qcSbOmzZs4c+rcybOnz59AgzrEgMEChKNHKWDYILSjBgoKBACYSrUqVQQMJGhoSvGCAwNWw4qlakArV4cXEIxdy1YBBaZnD6ZlS5ctgQpxCWZQW7fvWgVb40rwS3itAAhcNygozHgsgQxBMxAgXKDBgwcVLmi+8KDBgQGEBUD2WaFvgAQTAi/cMCFBX9E+NxRgO2ACxQ0RZtO13XNDALG1M1b4zZY3zwzEqT7guKHBbp/Ipwa48DGD7rGjeU4AcADuxw0H1v4a8L6TOskFaxnk9Yh+rPH1GtuHhQ1/Y3ixCOpv9D3WvH6MF4yV338ZPdAfgRmBFlYCCGK0nViqNUhRclUtIKFFBoZFwIUV8RdWhBxCJF9V74X40INWNWCiRBqIZcCKEiloFXkwMuRaWP7VyFCGVuWoo0I8VuXjjwihWBVeRC4UYFjLJanQklY16SRCUFYl5ZQGVakclggFSVWJXArkHI5hGnTfjGUWJJVVAaRJ0AZiHeDmQEZSZeGcHNxoVQR4tgghnhGIVQCeHIAVFp9z1kkVjVxusKZVDM45ZlhgYpnBWAMwOuUGhpLpZqeQ5rQBYigxMFYAIM6UgVTqmWTqWMFX0rQqVa2O9KqgOCmKgKYabcCXWAFkR5OiUxkg7EYXPBpWsDddypYDvFIEAV3HDkuXAEheRMFkxe1ErFVlperQtnVVatMFFP71VkNPRdWXuc2maxcCDkBAFFFGQcAAqHQNUO1O1jUmcFUJRLvTA/IOXBeiZ2mgp8J0HfBvUxfICHFYBwyZF2sPX5wxh7hd11hlEzeoQQQLHJAwm6iJq+MGF0xw2cybEWrzzTjnrPPOPPfs889ABy300EQXbfTRMgUEACH5BAkDABwALAAAAABvAG8AhzS/ST/CU0DDVEzGX03HX1nKalrLa2bOdmfPdnLTgXPTgn/XjIDXjYzbmI3bmZnfo5rfpKXjr6bjr7LnurPnu7/rxsDrxszv0c3v0tjz3OX36PL78////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////wj+ADkIHEiwoMGDCBMqXMiwocOHECNKnEixosWLGDNq3Mixo8ePIEOKHEmypMmTKFOqXMmypcuXMGPKnEmzps2bOHPq3Mmzp8+fQIM21GABglEGCoxCoIBBaMcMEBAIAEC1qtWqBhhI0OCUogYHBK6KHVtVAYUNXR1eQEC2bVsBDC6kTbjWrV23BCrMLVjhrl+3CrjuFVjgr2GxAiAM5nDhsGOrBjIMTtC2wIIJFzJrvvAgwYDDE/ZqELtAb8MNEwr7DT33AdUBE9BK1PDgs13WXTccwG2xgu22vBdX3NDAbgThGTMccCsXOcYFbQnIdm4ROlkF1J+3NZ29ouuxAgT+d6dIeSyC8cMDkG2OXmLfsQvaUyw+Vrz8hxt+W41/P+J3sdP1d5p6Yj0gIET/WUXAgQ+NVh+DDll3VXAQIjTBWA1UyJCDVxmgIUP6VRXghwaVdxV3JBoUwVgGpnhQYwW6+CKLMhoE41Ut1jjQjVblqCNjNP4oEI9V+ajjimIdJyQH9F3F3o/LAbgkB1NdFcCUHFp1wJQXipXhkgaMpeSPWVplX41NWpXAlGGJRaGL71k5oksVzJnSBlVexR9MGbD1ZUtpWvUkSxswYBWKKWVA1gAwQZAnVQLYWVKYYw2qkoRXYaeSoWOt+ZIGBIqlGEqcihXAmSzFKRYDJ5Wa5EzGJq5akgOV0ZRfW6yGtIECbklGE5Ed+tpRBY+6eROSbTkg6UQb0OrWmzJ1+RaiFFHQJnA7SRudA6ieZu1d0NakrVsGnOWQBbyu9tO4dhGQlAUYYHBBvBhIwAClfg1g6U4ZqPbYv1QlsOxOD4QK8F8BUBuUBrEe7NYB3Trlm8NtHbDvXhcsYLDDFreHWsOHDfBAxN1pEMEC/roVwAEPCPvhBRU8IHMCC8j8wAUkT6nzzjz37PPPQAct9NBEF2300UgnrfTSKAUEACH5BAkDABwALAAAAABvAG8AhzS/ST/CU0DDVEzGX03HX1nKalrLa2bOdmfPdnLTgXPTgn/XjIDXjYzbmI3bmZnfo5rfpKXjr6bjr7LnurPnu7/rxsDrxszv0c3v0tjz3OX36PL78////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////wj+ADkIHEiwoMGDCBMqXMiwocOHECNKnEixosWLGDNq3Mixo8ePIEOKHEmypMmTKFOqXMmypcuXMGPKnEmzps2bOHPq3Mmzp8+fQIM23IABA4SjCBgchYBBg1COGiw4MACgqtWrVgUgkOD0acUHWMOKtUrAQVevEDOMXStWwQW0EAewnXvVwFu4DBvQ3VuVwQa8Ci/w5SugAuCEAQbzRXD28MAFVQckeDDhwoUMFyo8aHDgwGABExwTzDChccINEQrwDS2aYoYGieeybk1xQuy1s2lL3ACZLQTdFS/IXWsY+ETeawWYNv6wt1gEzCk6Dxsh+kSwYgVksC5Rr1gD3CP+bhgetnh4h4Kfn4foPezy9QnJX10A3+GE7H/rL9xw+2p1/Qu1VxeAC2kwVn4EIpSAWOYlaFAEYj3gIEJqhXXAhAiNheFBnoW13YYEYYfVfyAKlB5WEpZoYoQqrhhWiiqeeBWMJcpoFY0g2lgVjhtWwGKLIl6VG4gdYvWhigSI1SIHG4hVwJL3hUVfSxYwMOVMCIhF4kkbUKDAVe+xZKBYR5okoFUNzHRmVU+mBGFYAiD4kgBiDVkSf3XGFCVWAch50nRkwbQBnVKKORaPKX1JZktFYnXXSjqy6ZKPYhHgp0kbJCnWoyypJlaaKjEw1pUtZdDfVb+hJKpYfcb0pljWDJy0KoMzNYpVrCStadWFM2lw6lV+hbSBA2sFEGZLe1bK6UYXaDqWnTEFCeulFhHLFrQyJZsdBRh16eyzO2mbHQNlPqSBA4Re25O4YxkgAbUGaeAlX1uG++taBiDgAAQWYJBBURRAoEC6dAXQYE8a2KrYwrseu1MF9zJccL1CISfxYAU4DNQFnl681gEHH3bBgh5fFcACGuOlQQPyLVxABPACp0EEB0SMVQENVBBzeBpc8MDPCxzw8wOW7bzk0UgnrfTSTDft9NNQRy311FRXbfXVWJ8UEAAh+QQJBAAbACwAAAAAbwBvAIc0v0k/wlNAw1RMxl9Nx19Zympay2tmznZnz3Zy04Fz04J/14yA142M25iN25mZ36Oa36Sl46+m46+y57qz57u/68bM79HN79LY89zl9+jy+/P///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8I/gA3CBxIsKDBgwgTKlzIsKHDhxAjSpxIsaLFixgzatzIsaPHjyBDihxJsqTJkyhTqlzJsqXLlzBjypxJs6bNmzhz6tzJs6fPn0CDPswAoahRChcuZBAq0gKAp1CjClAgYSnTjlGzZiXAAMNVjVrDRkVg4evFAWLTAkBAwSzFA2rVIrDq9mGCuGoFSKj78AHeuAo08GWYwYJhwxEeNCjw96kAr4MnapiwIMDfCZEraoiANi7mzBUndE77GbTkBp5NV7QwOmxp1RE1LEgrgC7siLPFIrhNMXfYCLwn+s5aO7jE4VENGI/dOurr5QydhiUAHSLqsGWrO2SsdYF2hxPE/tr+nrD50wfkGfrVSj29wgzi3StE/rSC/IThtaK/fxBD2AP8IRSWAAEeBJdW4xV4XVb2FUhQflnt56BA0kU44UAVRiXhhBlCtaGDHZ53IYVhfThSUhQUhUCDNVVQokkuatXATetl9VxI8GkFoE0HZgVZSZZpdRMBYaHUY1QJvqTBfyjVGBWLMsWYlXcnSRkVlTPRBwBwJ+WolWAyeZlVdieZB4CJLTkJ1QAqqflUezERqZ9KYj4ZE4RZgZmSlsopKUBYWKYUooguKSAWmSqZCQCiKVkZFZst4RkVAXqipMGfYUG5EndaMbCSoWElAFMGQXaaEgNiBVBpSxGk5alJz6iKpalLR2b16kixhkoTqa6uypEGuWqlak2SbsWoRhbIKdaPNBWblQO+WuRAajg5O2lbGFFgALU5WTupBNESBoGypPXkrVQMUBBuQRhQEKxaN+ZkQal4GeAABBIkpS8FDiDQ2FMBzLqTBnf9a3BaByTZUwT0HmxwAFx+lUGtDuNVgMJCTUBxxVoVEK9bFmzM8QLHZobBAor+NcAD65qWQQQJNBxWAAc8UAHGyxVmwQQP9OzzzSMGLfTQRBdt9NFIJ6300kw37fTTUEct9VcBAQAh+QQJAwAcACwAAAAAbwBvAIc0v0k/wlNAw1RMxl9Nx19Zympay2tmznZnz3Zy04Fz04J/14yA142M25iN25mZ36Oa36Sl46+m46+y57qz57u/68bA68bM79HN79LY89zl9+jy+/P///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8I/gA5CBxIsKDBgwgTKlzIsKHDhxAjSpxIsaLFixgzatzIsaPHjyBDihxJsqTJkyhTqlzJsqXLlzBjypxJs6bNmzhz6tzJs6fPn0CDXsygQejKAwAEIIBgoahRkgCiSgVAAILTpx+nagXA4ALWjhm2biVA4avGC2LFGrhqlmKFtGIFSGhb8QHctAjY0nV4oQHSu1oFTNhLMUOFBYClDiZMccODAYkXM3ZbALDkyRMbWMZc8QJkuBk4N0acVsAG0RRJi1WAOjXcCq0nqg58OnbEBGlZ24a4IUBa2LsfvhVLIDhE3GK9Gm+44bPWBcsdDt9aO/pC51MfWGdod+z2hRrS/ir/jnC21AjkE06fCj39wQ1q3SPELlX+wb9aQ5fMAAEDhuo4dafVZSIJGBUBCOhX03pSaVeSgVKNRxNaWzlIEoRRSTgThVpZOBKGAGgoE4fZmQSiiDGR2KCJyd2kYlQeFigWcDVNIFaMIdlY4U2abYXiR2FtdcBN+E2ll0jE3SRWAChVRl1NQWo15EnmRUWjTDp2iFIEYrU3U5UAXEnSi1EB+FJ4Yh05En0wzgTiACqBWJxMBNyoEppbiclSllqZaRKYBPipkgFdskQmAA281KOPLbGZYUuHFuASg1IFutIGdYpFoErIbcXASgykJelLvaX1KUqhLqmmSpRKdWpJ0amKhZ5MnXoKK1xTylSqqYJqtIECcAWwKqR3EfDjRRdk+ttNfIrlAEcbOLAZTs1uZYAFGVGgbFqb1phYVcMqtIEE23LbU7WmUqCgQhpQwIAAiQHQLbW+xRsVAg5Q4N++EkDgAKH2BrBuTxoUae/BaSXQK08R1Ivww1EFMCtWGjgJ8cEHhAvUBI5eLOW8X10ApscHHEuXBo95DMAACwzcmgYVPHCAw8EmEIHGtsH8wM48T3DBBTjbJ/TQRBdt9NFIJ6300kw37fTTUEct9dRUQxQQACH5BAkDABwALAAAAABvAG8AhzS/ST/CU0DDVEzGX03HX1nKalrLa2bOdmfPdnLTgXPTgn/XjIDXjYzbmI3bmZnfo5rfpKXjr6bjr7LnurPnu7/rxsDrxszv0c3v0tjz3OX36PL78////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////wj+ADkIHEiwoMGDCBMqXMiwocOHECNKnEixosWLGDNq3Mixo8ePIEOKHEmypMmTKFOqXMmypcuXMGPKnEmzps2bOHPq3Mmzp8+fQIMKHUp05gQJG4qeNABAAAMNSkdqAECVKgILUUFGqMrVQIasHZlyrSpAAliNG8aqRQD1rMUJatUKqOC24oO4cSPUpaihQQC8XCfspbhhwgDAVAUPptgAMQDFiyVeOAwYcmSIGxrjFdD2csS7eBF4nrgAMN3REUvHFZAUNUTVahe4xkxZ7YXZDy/gNYD7YQK8X3sz3PA3tvCGcOW2Pq6w+FjLJhVI6GxT81jeKNNSNSAhOM2pcb3+l6yglsDpmQfyogQ9Vi/N5GNln0yvVnxM7ddRxg1wszbXkxnEdcBN9I1lX0hbqfXATewFZlKDVd1mE3kKPhiXhDXpVmFJEFKFIU0ajrUghxfeFCJXI5LUIQAfznRiVSmOtGKLMr1IVYwirXgeiHHhGBJ8KDKoXkkBqjWgTQVydWBIcRFwE14oFRDXcjIVOdaRJsHmIE0JirheXKLR9JtaO5Jk5VjUvQSeWlSWJKVaDcxkHVcFqAQkWTJtIMCQ2Tm35Ut3UhVAm1muRqhKBMQln0pncrUoS3NylWaUeNF4ko1UYbkSpgAQcChJGyQaV5kqackVAytFWlWdLxGHF6ryKDmAVwCTrkRhXLCWxABg7sWUpJck7YqXpjBp4OdYDnya0QbC7lerS4FyRYClGF0gKl6kxhQtVxBwtIECjvVq07ZVEUCBsg9RsCdi0I3rWFMOPLtQBgysy25PK8alAAXyErSBBGK9225OFRyLmAAKQEABBhhkgIEFEDiAQMDvBjCwThr8+u7Gjh3Qr04RGMzxyIJmC1QGb5Ks8gLoAlWBxirjVQC1SmmwgMgxA5AAzWBtEIF/Kg/QwMd1bVBBAykjFsABERDt2QYXXPDA1AcsMPUDFzjN3NZcd+3112CHLfbYZJdt9tlop6322my37TZGAQEAIfkECQQAHAAsAAAAAG8AbwCHNL9JP8JTQMNUTMZfTcdfWcpqWstrZs52Z892ctOBc9OCf9eMgNeNjNuYjduZmd+jmt+kpeOvpuOvsue6s+e7v+vGwOvGzO/Rze/S2PPc5ffo8vvz////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////CP4AOQgcSLCgwYMIEypcyLChw4cQI0qcSLGixYsYM2rcyLGjx48gQ4ocSbKkyZMoU6pcybKly5cwY8qcSbOmzZs4c+rcybOnz59AgwodSrSo0aNIk5KMoEGpyAwABFRwChIBgKsKNlDlWOGqVwIXtmbcQMCr2QhiLz4wy3ZCWooaBLBt+1bihgZz6daNWCFAXq9u90LckODv1QyCI679ayBxxAWGHziGCDmvgKYvIWCOWXmugpcXrkLQGrPA36ktC18lQCEm1LwEWmqYiwDxS7x5w67sbHYAzA1+5y5YOTsvWphd5wogjXIx2wDMXw7IGxhl2bmSZeJmmyBl8bnRX/5+Z7u55IS8w2mannvcJG/ANc/PbYDSQN7yMcd7PXByQ17fNgVnlgAnJcdWejUdkFd4ITl31k3bmaUbSQ56NSFNERhnUoVXXThTaNhtmNtNILKVHYUj2lSiWSeOxCEAHsq0olctivRijDHNeFWNIWXIHol58QiSjgDQZ5OPJprk31z82aQaW6iVJKBXBNp0HVsMhqQgeDXpd1UBKEUIH03ysWWkSUia1RhN711VXUleXoWfS3ECMOdIWyYp04sAolSmWbHFtIFcIaYEXF5RuvQiAFmS1CYABDTa35VmIZgSkUXe9tedJk2Xl20rGXigS6KahQBLg/6FI0pPssXASvAK/NUknVOa9SpKDvwVAKcpLQrArSUxYFiiL62XFwTBGmYpTK/9lZVIwv41gKQs/akcsRplYJ9hq75k7VwOUBvRBrkaBsCb8ZkLaWsYVUCoYeja9O1crImLkAYOUPpXvDelaa4CFji0AQXbqnvuTxd4ajAABjAgAQYQXwCxBRAooK+6/OpE2MIcc1wAqEH11fHIcwUgJFAa5ElyxwnwGtQFKq9s2ADdFgWzzHkFsEDNSGnwgMIrJzCBvU5l8MABtf5VwAJMTXbvBQ9EvUACUT9QAc9OZ6311lx37fXXYIct9thkl2322WinrfbabLc9UEAAIfkECQMAHAAsAAAAAG8AbwCHNL9JP8JTQMNUTMZfTcdfWcpqWstrZs52Z892ctOBc9OCf9eMgNeNjNuYjduZmd+jmt+kpeOvpuOvsue6s+e7v+vGwOvGzO/Rze/S2PPc5ffo8vvz////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////CP4AOQgcSLCgwYMIEypcyLChw4cQI0qcSLGixYsYM2rcyLGjx48gQ4ocSbKkyZMoU6pcybKly5cwY8qcSbOmzZs4c+rcybOnz59AgwodSrSo0aNIkypdyrSp06cbN0DtmEHAhKkaNwgAAOAqzgkXXG4wwJVrhpsZuHpVObYsVwFnaW4gUHYtSgZuy8KlqSCvg5QT8ro1MDOCYAAMUi44zPVBzLSM7ZZcfFiABpgIGB9YeYCxgpcXGAeQyrYA47AtMx9GvRKyYAKkVYY+7Nhlg8gsVecdAHNDgMMJVmrADbMC49gnKe+eaVpwBJV0BdeOaVgwYZTDBY+emV3w5ZOBBf4vqJng8PPkhyXDDJ93/Mnoeb/P3HB4s0n6gnnbHCBYwMnZ7d3UmWD/0XbTbYKxNhKAbk1H0wPpmcSeWxXcxGBZDooEYYIWGljShnkpONOFjZkEolsiykQiABmGdGJZKcY0YVkVljRjiTa9yFWMH63YwE06AsCjR/jlZV9NyqF40mEE3ASfW8iNNGBeUcLUnVsFoFSeYOq9dCMAP54UZHA0JVkXdsfNt5V3KTWX13kxBakfStXldV1MawaY0pUUysiYfFpWViV0wLH0JZgvBSkkSxvwd1hcK60IwJErGXeYAYOSpNVpL20pGAIr6Waklb8dlthdokHqkqKInYQXcdwxOWpqSa8e5p5MGZR6GAKZZtQWYwX0ylKujAEgwJAWZUBWsaqOWCxXEHC0gQPPdpXToWURQEFGFeQJ61fVAqAtRRpIsOyzXdqErVsCKEABoAltQEFf4QbQrE4ZyBquAQxAAIEFGASMAQQOIPBktfYGtYGn4TbccAH3+lSnwxRr12JQGUxZccUJwFvUBRpv/OwAyBIFssjFJjCBsEdl0ICbIhcQActMaTBBAroWG8ABC0TgMVYHXSD0A0QTDRbNQCet9NJMN+3001BHLfXUVFdt9dVYZ6311lx3/XRAACH5BAkDABwALAAAAABvAG8AhzS/ST/CU0DDVEzGX03HX1nKalrLa2bOdmfPdnLTgXPTgn/XjIDXjYzbmI3bmZnfo5rfpKXjr6bjr7LnurPnu7/rxsDrxszv0c3v0tjz3OX36PL78////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////wj+ADkIHEiwoMGDCBMqXMiwocOHECNKnEixosWLGDNq3Mixo8ePIEOKHEmypMmTKFOqXMmypcuXMGPKnEmzps2bOHPq3Mmzp8+fQIMKHUq0qNGjSJMqXVp0gwOmIDMIABABascLUwEAyGBV4wStYAls6HoRAtizDMhWjHC2bQW1Ei+0bXsALsQNWecCKDDWrkMEerUueAlh5oPAABq4zGAAwISYFRBXbTkhq4C+LgHrTdByg4K2il3K1TsAc8oMBPRybal57uqVo+ciaBm77eSWCwI/Xtn67ACYGwJsXplBd0y2ek2bPDz3t8wBem+fPBB9JvK2BlTqDaDc5YbAGlD+Rp7LmWaC6icboJ/5dW7dk41d1/w+l8BJ+m0D3KQ+92RtsOXVxF9br430n1YP3MRcWxeYdCAACdp03VnSidReW7vV9GCEJC14VoM2bbicXiBqqBeHI3kIVok0iViSilqxaJ1eb5U0IVgVygQjADKG5GJNO/YY1XA2nTeXkCDp9V5NeZ3VXUjQzfXkYnoVgNKAZ2Uo040IorRjgDIZySBKGgQ25Up46aVSAevBtOOSJ3EJgH0yNQkWiiaV2SZl4K0k5lmXwZSaeyxd2NZgLsnJY0tYfthScUpSqZcBZ4q0waBHvqTepCt9FulLwQWWlpeIIZmSoomdxABieLrEZmDahY20waqBwQmccIEpUOlFG8S33a4qZYCrXgQUuNEFvqp204NnScCRU4hplSN70c5JQUYU2DnXtDShGhYEwB60gQSYIqZlTt6CJYACEhiL0AYWMKDtXAG4m9MFw1YLwLoQUIDBv/9SAIEDyVY7gL06bdCovgxXyxdROzYssVYBcPvTBQtPzHAC4SWFscYND1AjUx+DHFgCpialwQMZNxxAAx37JdAFDbxabQAJRICwzBxscMEFDwQt9AM/78zz0UgnrfTSTDft9NNQRy311FRXbfXVWGet9dYaBQQAIfkECQQAvAAsAAAAAG8AbwCHNL9JNb9KNr9LN8BLN8BMOsFOO8FPO8FQPMFQPcJRPsJSP8JSP8JTQMNUQcNVQsNVQ8NWQ8RXRMRYSMVbScVcS8ZeTMZfTcdfTsdgUchjUshkU8hkVMlmVspoV8poWstrW8tsXMttX8xwYM1xYc1yYs1yY85zZc51Zs52Z893adB4atB5atB6a9B7bNF7btF9b9J+cNJ/cdKActKActOBdNOCddODdtSFd9SFeNSGedWHetWHetWIe9WIe9WJfNaKgNeNgtiPhNiRhdiRhtmSiNmUidqVitqWi9qXjtuaktydkt2ek92elN2fld2glt6hl96imd+jmt+lnOCmneConuGon+GpoOGqoeGqoeKrouKso+KtpOKtpeOupeOvpuOvp+OwqOSxqeSyquSzq+W0rOW0reW1reW2rua3r+a3sOa4sea5see5tOe8tei9tui+uenBuunBvOrDverDvuvFwOvGwevHwezIwuzIxezLxe3Lx+3Nye7Oy+7Qy+/QzO/Rze/Sz/DU0PDV0PHV0fHW0vHX0/HX1PHY1PLZ1fLa1/Lb1/Pb2PLc2PPc2fPd3PTf3PTg3fTh3vXh3/Xi4Pbk4vbl4/bm5Pbn5Pfm5Pfn5ffo5/fp6Pjq6Pjr6fjr6vjs7Pnu7fnv7frv7vrw7/rw8Prx8Pry8Pvy8fry8fvz8vvz8/v19Pz19fz29vz39/z49/34+P34+P35+f36+v36+v76+/37/P78/P79/f79/f/9/v7+////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////CP4AeQkcSLCgwYMIEypcyLChw4cQI0qcSLGixYsYM2rcyLGjx48gQ4ocSbKkyZMoU6pcybKly5cwY8qcSbOmzZs4c+rcybOnz59AgwodSrToUDmjjJZsJAJAFKUiOfEAQNUBLageWS0pQLVrGqwcI1XoSlbDLrAZ+yQgy1YP2ottBLBlu+JtRSVz5zJwZTeirBh5yQ4wUqpvxBqBu8qwZDiimcQAOghqHBES18A6clGGKCtDYiNnNz8Ukvip6IeMEh85DfFFYBC2WDtMnffBJ9kOAc8NAAh3w0WBieAUxXJG3gKhauJ68wHGSkmBl9CE1YVCV1UqseRdsErmKCYN2P6yUZki75WZVfK6SNkqMKyZmQKfQllHfc0QedGgJJL3S80sedV10gR5UVLTJnkdcJIqeU1w01hzkWLSJHkVcZMKeS1iEiB5lXETf3PRYVIcecFx0xb9mQRGXnvcZEdeSZjkRF6I3ATdXEaYFEReldyESV5PmAQiW5DcREheXJhERV543FTfXGuY9EZeYtyERl4ilhQIjDdNkdcfJnGSlw034ZCXIybtMsBcINi0CwNzDTDLSRfMRQAqNSGS1wkoTTXXGTUtOZcUKMmRFwo1oZDXICjFchlbncwUS14JqITYXFnMhOJcMqg05VwUyBLTKxGkmBIrgVERkxeB9aiSa/5zIZCcS7SUOlcNLL2Yl3AuhRHYIy2RkFcAwLK0CZxz0eCSIoFxwJdKs3gQGCMv/RAYC7eo1ENgMcDkyaNsAZESGYlRC1MTiXVxUlyBrRaTKw8kBoUuJDGRGAjZysQHAYmdYEpItNiQmG01kZgYBYd8hEpTgfF2U3qJDTAEKBu5YoUEkE2RE2mQGcAEKxexMgUEkAGgxE40lAyAA1iIKhEhSIRX8hg81XKEygAwkEMbEjIkiRMY4FxAHj/NoQDOVI3wxBl3JOIJL5r4ocYTPEiL9AOGBHWJ1Uh3DZkFjAk1yxBel81WAUqAXFQgK5hdtg+cgFUIC26rXEIjfRXiQkzdebEgx2aNMLEB3y2skQpumWhhQgA4E+CCGof7RtApe7jhBRRE3LDCDkp0Eccgmkgu+uikl2766ainrvrqrLfu+uuwxy777LTXblhAACH5BAkDABsALAAAAABvAG8AhzS/ST/CU0DDVEzGX03HX1nKalrLa2bOdmfPdnLTgXPTgn/XjIDXjYzbmJnfo5rfpKXjr6bjr7LnurPnu7/rxsDrxszv0c3v0tjz3OX36PL78////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////wj+ADcIHEiwoMGDCBMqXMiwocOHECNKnEixosWLGDNq3Mixo8ePIEOKHEmypMmTKFOqXMmypcuXMGPKnEmzps2bOHPq3Mmzp8+fQIMKtamhAgMLQ0tqmKAAgFMHSUVSMOC0KoADUT9aQGDVqoCsHDM07do1A1iMGhiQXSvhrMUMVNeSbeCWIgYBctcmqCtRQt6uBSCY5QvxwV+nAyQMJgyxweEAbRn3/RvAgQbJEu/mLbAY80MNcfVe9hxx7NoFpCU6yBs59cMMeem6hrhAboHZEGGvDTAad0PTXTH4dmhBLtThDbmS5Y2cIQbjzRmuXt47OsLQViFYV6hB7naFfsn+7v2OMAFb8gjxku1cs+gDBAhOPid726YEBQS6niw+9+aBtfutdVxNjpGFVEnhdaWdTdN1dSBJDVr1IE0UCGhShFVNOBN/XQ04Um0G3sShVR6KhKFTGso0YlUlhnQiABSIaGFJKz5104sx0riWbDW9mCJI3ZGFlU0FOnjSWgTchF1V7IlUwFpNvqRbVwGgBKKCNUFwGkoVkmVATeaR1ZpSckXZklzVlRRmV2O+9GJ9KCVoVZIxaaAelikFKWZMLwIgnEpPkiVAmirZudaQKnVJVosp9fmjSf8JaqaOW7ZUo1MGEKrUnWW9tGZXCqy0ZFWoSZkXAympVWZMV+5pkpzceMKkQaBroUqSqnrRlEEAeWUakgbKrVWApi7NJ5cAf3YEV14BJEsTrGQ9QOxEGjzAKVk53niYABNkFMG1/elUZF4ERDCtQhlMkN9hC+5EAa+HAcBABecOhEEEo+7Wpk4Y0BqvAQw8cMHABFfwAH7xVtVsUBp8mvDDf3GWVJ8QV7xAvTtl4HDFDycwaVAWRMpxvAc8mpUEIo9MX7aYZeDAACo7lYAEGPNlgQMJwHvYAAuwbF0GFkjggAMNLDC0AxSYjN7STDft9NNQRy311FRXbfXVWGet9dZcd81TQAA7AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA=";var Mlt=function(){var t=this,e=t._self._c,n=t._self._setupProxy;return e("div",{staticClass:"excel-wrapper"},[n.loading?e("div",{staticClass:"loading"},[e("img",{staticClass:"lg",attrs:{src:Elt,alt:"xlsx"}}),e("img",{staticClass:"sm",attrs:{src:Rlt,alt:"loading"}}),t._v(" å è½½ä¸­ï¼è¯·èå¿ç­å¾... ")]):t._e(),e("div",{staticClass:"table-wrapper"},[e(n.HotTable,{ref:"table",attrs:{settings:n.hotSettings}})],1),e("div",{staticClass:"btn-group"},t._l(n.sheets,(function(o){return e("button",{key:o.id,class:{active:n.sheetIndex===o.id},staticStyle:{padding:"0 30px"},on:{click:function(t){return n.handleSheet(o.id)}}},[t._v(" "+t._s(o.name)+" ")])})),0)])},Tlt=[],klt=(0,a.n)(Slt,Mlt,Tlt,!1,null,"fc74b552",null,null);const xlt=klt.exports},4025:function(t,e,n){function o(t){throw new Error('Could not dynamically require "'+t+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}n.d(e,{c:function(){return o}})},258:function(t,e,n){n.d(e,{a:function(){return r},c:function(){return o},g:function(){return i}});var o="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof n.g?n.g:"undefined"!=typeof self?self:{};function i(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function r(t){if(t.__esModule)return t;var e=t.default;if("function"==typeof e){var n=function t(){return this instanceof t?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};n.prototype=e.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(t).forEach((function(e){var o=Object.getOwnPropertyDescriptor(t,e);Object.defineProperty(n,e,o.get?o:{enumerable:!0,get:function(){return t[e]}})})),n}},5107:function(t,e,n){n.d(e,{r:function(){return l}});n(8858),n(1318),n(3228);var o=Object.defineProperty,i=(t,e,n)=>e in t?o(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,r=(t,e,n)=>(i(t,"symbol"!=typeof e?e+"":e,n),n);const s="/node_modules/@flyfish-group/file-viewer/dist/worker/";class a{constructor(t){r(this,"worker",null),this.worker=t}defaults(t){return this.worker||t()}}function l(t,e=!1){let n=null;const o=`${s}${t}`;return"file:///F:/IDEA/library-management-system-main-zjp/vue/node_modules/@flyfish-group/file-viewer/dist/components/worker-ref.js".startsWith("file:")||(n=new Worker(new URL(o,"file:///F:/IDEA/library-management-system-main-zjp/vue/node_modules/@flyfish-group/file-viewer/dist/components/worker-ref.js"),{type:e?"module":"classic"})),new a(n)}}}]);
//# sourceMappingURL=106.2bfae374.js.map